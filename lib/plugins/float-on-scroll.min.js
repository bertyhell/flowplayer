!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):((t=t||self).flowplayer=t.flowplayer||{},t.flowplayer["float_on-scroll"]=e())}(this,(function(){"use strict";var t="resize",e="viewenter",n="viewleave";var o=[].slice;function r(t,e,n){for(e=function(t){return Array.isArray(t)?t.slice(0):t.split(".")}(e);e.length;){if(null==t)return n;t=t[e.shift()]}return null==t?n:t}var i="function"==typeof requestAnimationFrame?requestAnimationFrame:setTimeout;var a=!!function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("testPassive",null,e),window.removeEventListener("testPassive",null,e)}catch(t){}return t}()&&{passive:!0},u=["touchstart","touchmove"];function l(t){return t.emit=function(e,n,o){o=o||{};var r=function(t){var e=document.createEvent("Event");return e.initEvent(t,!1,!0),e}(e);return n&&function(t,e){for(var n in e)t[n]=e[n]}(r,{data:n||{}}),t.dispatchEvent(r),!1===o.return_self?r:t},t.on=function(e,n){return"string"==typeof e&&(e=e.split(" ")),e.forEach((function(e){return function(t){return~u.indexOf(t)}(e)?t.addEventListener(e,n,a):t.addEventListener(e,n)})),t},t.off=function(e,n){return t.removeEventListener(e,n),t},t.one=t.once=function(e,n){return t.on(e,(function o(r){t.off(e,o),n(r)}))},t}var f=Array.isArray,s="undefined"!=typeof window&&l(window),c="undefined"!=typeof document&&l(document),p=["span","a","em","p","i"],d=p.concat(["div","strong","video","img","ol","ul","li","script"]);function v(t,e,n){var o=y(document.createElement(t));if(f(e)&&(n=e,e=!1),f(n)||(n=[n]),o.append(n.filter((function(t){return t}))),"object"!=typeof e)return o;for(var r in e)r in o?o[r]=e[r]:o.setAttribute(r,e[r]);return o}function m(t){var e=t.tagName;t.__flowplayer__=1,t.find=function(e){var n=t.querySelector(e);return n?y(n):n},t.html=function(e){return t.innerHTML=e,t},t.empty=function(){return t.innerHTML="",t},t.offset=function(){var e={top:0,left:0},n=t;do{e.left+=n.offsetLeft||0,e.top+=n.offsetTop||0}while(n=n.offsetParent);return e},t.innerWidth=function(){var e=getComputedStyle(t);return t.clientWidth-parseFloat(e.paddingLeft)-parseFloat(e.paddingRight)};var n=t.insert=function(e,n){return f(n)?n.map((function(n){return t.insert(e,n)}))[0]:y(n="string"==typeof n?t.insertAdjacentHTML(e,n):t.insertAdjacentElement?t.insertAdjacentElement(e,n):t.appendChild(n))};return t.append=n.bind(t,"beforeend"),t.prepend=n.bind(t,"afterbegin"),t.css=function(e,n){if("object"==typeof e){for(var o in e)t.css(o,e[o]);return t}return void 0===n?getComputedStyle(t)[e]:(1*n&&(n+="px"),t.style[e]=n,t)},t.show=function(){return t.css({display:~p.indexOf(e)?"inline":"block"})},t.hide=function(){return t.css({display:"none"})},t.remove=function(){var e=t.parentNode;e&&e.removeChild(t)},t.attr=function(e,n){return null==n?t.getAttribute(e):(t.setAttribute(e,n),t)},t.txt=function(e){return t.textContent=e,t},t.fp=function(e){return t.addClass("fp-"+e)},t.addClass=function(e){return e.split(" ").forEach((function(e){t.hasClass(e)||(t.className+=(t.className?" ":"")+e)})),t},t.removeClass=function(e){e=e.split(" ");var n=t.className.split(" ");return t.className=n.filter((function(t){return!~e.indexOf(t)})).join(" "),t},t.toggleClass=function(e,n){return void 0===n&&(n=!t.hasClass(e)),n?t.addClass(e):t.removeClass(e)},t.findAll=function(e){return n=t.querySelectorAll(e),o.call(n);var n},t.hasClass=function(e){return~t.className.split(" ").indexOf(e)},t}function y(t){return void 0===t||function(t){return t&&t.__flowplayer__}(t)?t:m(l(t))}function g(t,e){if("string"==typeof t&&"<"==t[0])return v(t.slice(1,-1),e);if("string"!=typeof t)return y(t);var n=e instanceof HTMLElement&&e.querySelector(".fp-"+t)||document.querySelector(t);return n?y(n):void 0}g.window=s,g.document=c,g.el=v,d.forEach((function(t){g[t]=function(e,n){return"string"==typeof e&&(e={class:e}),v(t,e,n)}}));var w="float:pop:in",_=Object.freeze({__proto__:null,POP_IN:w,POP_OUT:"float:pop:out"});var h=Object.freeze({__proto__:null,NO_STANDARD_CONTROLS:1<<20}),A={coords:"-22 -22 122 122",link:"#fp-mute",translation_key:"core.mute",name:"fp-mute"},b={coords:"-22 -22 122 122",link:"#fp-unmute",translation_key:"core.mute",name:"fp-unmute"},C={coords:"19 0 80 80",link:"#fp-close",translation_key:"core.close",name:"fp-close"};function E(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function N(t){var e,n,o=E("svg");return o.setAttribute("viewBox",t.coords),t.name&&o.setAttribute("class",t.name),t.title&&o.setAttribute("title",t.title),t.title&&o.setAttribute("aria-label",t.title),o.setAttribute("tabindex","0"),o.setAttribute("focusable","true"),o.appendChild((e=t.link,(n=E("use")).setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",e),n)),g(o)}var O={PLACEHOLDER:void 0,FLOATING_CONTAINER:void 0},x="flowplayer-floating-container",L="flowplayer-floating-placeholder",T="fp-on",k="no-standard-controls";function P(){return function(t){const e=t.getBoundingClientRect(),n=window.innerHeight,o=e.y;return o>n||o+e.height<0?0:e.y<0?(e.height+o)/e.height:n-e.y>e.height?1:Math.abs((n-e.y)/e.height)}(j())>.8}function S(){return O.FLOATING_CONTAINER=O.FLOATING_CONTAINER||g.div().attr("id",x)}function j(){return O.PLACEHOLDER=O.PLACEHOLDER||g.div().attr("id",L)}function R(t,e){var n=e.parentNode;n&&n.replaceChild(t,e)}function H(e,n,o){if(0!=o.reaper&&!o.floating){var i=S(),a=j(),u=g.p().txt(o._t("float_on_scroll.popped_out","video playing in floating mode"));a.empty().appendChild(u);var l=n.aspect_ratio.cloneNode(!1);l&&a.append(l),R(a,n),i.append(n),i.addClass(T),i.toggleClass(k,function(t){return 1<<20&r(t,"opts.ui",0)}(o)),e.pop_out_container.appendChild(i),o.emit(t),o.emit("float:pop:out")}}function D(e,n,o){if(0!=o.reaper&&o.floating){var r=S();R(n,j()),r.removeClass(T),r.parentElement.removeChild(r),o.emit(t),o.emit(w)}}function F(t,o,a){if(!(t.multiplay||"float_on_scroll"in t&&0==t.float_on_scroll)){(function(){try{return window.self!==window.top}catch(t){return!0}})()&&console.warn("iframe detected - floating player not supported in iframe");var u={pop_out_container:r(t,"float_on_scroll.container",document.body),was_user_toggled:!1},l=r(o,"ui.header");l&&function(t,e,n,o){var r=g.div("fp-exit-float");r.append(N(C).attr("role","button")),r.on("click",(function(){e.was_user_toggled=!0,o.togglePlay(!1),D(0,n,o)})),t.append(r);var i=g.div("fp-mute-float"),a=N(A).attr("role","button"),u=N(b).attr("role","button");i.append([a,u]),i.on("click",(function(){o.toggleMute(!o.muted)})),t.append(i)}(l,u,o,a);var f,s,c,p,d,v,m=(f=function(){P()&&D(0,o,a)},c=s||60,p=Math.ceil(1e3/c),d=0,v=null,function(){var t=Date.now()-d;null===v&&(v=i((function(){v=null,f.apply(this,arguments),d=Date.now()}),p-t))});a.on(n,(function(){a.paused||u.was_user_toggled||H(u,o,a)})),a.on(e,(function(){u.was_user_toggled=!1})),a.on("float:pop:out",(function(){window.on("scroll",m),a.floating=!0,a.setState("is-popped-out",!0)})),a.on(w,(function(){window.off("scroll",m),a.floating=!1,a.setState("is-popped-out",!1)}))}}return F.events=_,F.flags=h,function(t,e){if("object"==typeof exports&&"undefined"!=typeof module)return e;"flowplayer"in t||(t.flowplayer={extensions:[]});var n=t.flowplayer;return"function"==typeof n?(n(e),e):(Array.isArray(n.extensions)||(n.extensions=[]),~n.extensions.indexOf(e)||n.extensions.push(e),e)}(window,F)}));
