!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):((t=t||self).flowplayer=t.flowplayer||{},t.flowplayer.share=e())}(this,(function(){"use strict";var t="mount",e="click",n="mouseleave",r="state",i="config",o=[].slice;function a(t,e){for(var n in e)t[n]=e[n];return t}function s(t,e,n){for(e=function(t){return Array.isArray(t)?t.slice(0):t.split(".")}(e);e.length;){if(null==t)return n;t=t[e.shift()]}return null==t?n:t}var u=!!function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("testPassive",null,e),window.removeEventListener("testPassive",null,e)}catch(t){}return t}()&&{passive:!0},c=["touchstart","touchmove"];function l(t){return t.emit=function(e,n,r){r=r||{};var i=function(t){var e=document.createEvent("Event");return e.initEvent(t,!1,!0),e}(e);return n&&a(i,{data:n||{}}),t.dispatchEvent(i),!1===r.return_self?i:t},t.on=function(e,n){return"string"==typeof e&&(e=e.split(" ")),e.forEach((function(e){return function(t){return~c.indexOf(t)}(e)?t.addEventListener(e,n,u):t.addEventListener(e,n)})),t},t.off=function(e,n){return t.removeEventListener(e,n),t},t.one=t.once=function(e,n){return t.on(e,(function r(i){t.off(e,r),n(i)}))},t}var f=Array.isArray,d="undefined"!=typeof window&&l(window),p="undefined"!=typeof document&&l(document),h=["span","a","em","p","i"],m=h.concat(["div","strong","video","img","ol","ul","li","script"]);function v(t,e,n){var r=b(document.createElement(t));if(f(e)&&(n=e,e=!1),f(n)||(n=[n]),r.append(n.filter((function(t){return t}))),"object"!=typeof e)return r;for(var i in e)i in r?r[i]=e[i]:r.setAttribute(i,e[i]);return r}function g(t){var e=t.tagName;t.__flowplayer__=1,t.find=function(e){var n=t.querySelector(e);return n?b(n):n},t.html=function(e){return t.innerHTML=e,t},t.empty=function(){return t.innerHTML="",t},t.offset=function(){var e={top:0,left:0},n=t;do{e.left+=n.offsetLeft||0,e.top+=n.offsetTop||0}while(n=n.offsetParent);return e},t.innerWidth=function(){var e=getComputedStyle(t);return t.clientWidth-parseFloat(e.paddingLeft)-parseFloat(e.paddingRight)};var n=t.insert=function(e,n){return f(n)?n.map((function(n){return t.insert(e,n)}))[0]:b(n="string"==typeof n?t.insertAdjacentHTML(e,n):t.insertAdjacentElement?t.insertAdjacentElement(e,n):t.appendChild(n))};return t.append=n.bind(t,"beforeend"),t.prepend=n.bind(t,"afterbegin"),t.css=function(e,n){if("object"==typeof e){for(var r in e)t.css(r,e[r]);return t}return void 0===n?getComputedStyle(t)[e]:(1*n&&(n+="px"),t.style[e]=n,t)},t.show=function(){return t.css({display:~h.indexOf(e)?"inline":"block"})},t.hide=function(){return t.css({display:"none"})},t.remove=function(){var e=t.parentNode;e&&e.removeChild(t)},t.attr=function(e,n){return null==n?t.getAttribute(e):(t.setAttribute(e,n),t)},t.txt=function(e){return t.textContent=e,t},t.fp=function(e){return t.addClass("fp-"+e)},t.addClass=function(e){return e.split(" ").forEach((function(e){t.hasClass(e)||(t.className+=(t.className?" ":"")+e)})),t},t.removeClass=function(e){e=e.split(" ");var n=t.className.split(" ");return t.className=n.filter((function(t){return!~e.indexOf(t)})).join(" "),t},t.toggleClass=function(e,n){return void 0===n&&(n=!t.hasClass(e)),n?t.addClass(e):t.removeClass(e)},t.findAll=function(e){return n=t.querySelectorAll(e),o.call(n);var n},t.hasClass=function(e){return~t.className.split(" ").indexOf(e)},t}function b(t){return void 0===t||function(t){return t&&t.__flowplayer__}(t)?t:g(l(t))}function y(t,e){if("string"==typeof t&&"<"==t[0])return v(t.slice(1,-1),e);if("string"!=typeof t)return b(t);var n=e instanceof HTMLElement&&e.querySelector(".fp-"+t)||document.querySelector(t);return n?b(n):void 0}function w(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function _(t){var e,n,r=w("svg");return r.setAttribute("viewBox",t.coords),t.name&&r.setAttribute("class",t.name),t.title&&r.setAttribute("title",t.title),t.title&&r.setAttribute("aria-label",t.title),r.setAttribute("tabindex","0"),r.setAttribute("focusable","true"),r.appendChild((e=t.link,(n=w("use")).setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",e),n)),y(r)}y.window=d,y.document=p,y.el=v,m.forEach((function(t){y[t]=function(e,n){return"string"==typeof e&&(e={class:e}),v(t,e,n)}}));var x={TOGGLE_OPEN:"menu:toggle:open",RENDER:"menu:render",PUSH:"menu:push"},C={ON:"fp-on",INVIS:"fp-invis"};function E(t,e,n){var r=n.id||"menu-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,5);return n=n||{},t.attr("role","button").attr("aria-haspopup","true").attr("aria-expanded","false").attr("aria-controls",r).attr("aria-label",n.title),n.options=n.options||[],n.id=r,E._interface(t,e,function(){var t=o.call(arguments),e=t.shift();return t.reduce(a,e)}({},n))}E.title=function(t){return y("<h3>").txt(t)},E.close=function(t){return y.span("fp-close").on(e,t).html("&times;")},E.option=function(t,n){var r=this,i=y("<li>").attr("tabindex","0").attr("role","menuitem"),o=r._attrs;t.icon&&i.append(_(t.icon)),i.append(y("<span>").txt(t.text)),i.on(e,(function(e){o.multi||r.options().forEach(E.off),r.activate(n),"function"==typeof t.onclick&&t.onclick(e,t,n,r)})),i.idx=n,r.append(i)},E._interface=function(t,r,i){t.addClass("fp-menu-container");var o=y("<ul>").attr("id",i.id).addClass("fp-menu").attr("role","menu");return i.icons&&o.addClass("fp-icons"),o._attrs=i,t.on(e,(function(t){setTimeout((function(){if(!t.defaultPrevented)return o.hasClass(C.ON)?r.emit(x.TOGGLE_OPEN,{menu:o,open:!1}):void r.emit(x.TOGGLE_OPEN,{menu:o,open:!0})}),0)})),o.on(n,(function(){r.emit(x.TOGGLE_OPEN,{menu:o,open:!1})})),r.on(x.TOGGLE_OPEN,(function(e){if(s(e,"data.menu")!==o)return o.toggleClass(C.ON,!1),t.attr("aria-expanded","false");var n=s(e,"data.open",!1);if(o.toggleClass(C.ON,n),t.attr("aria-expanded",n?"true":"false"),r.hasClass("is-accessibility"))if(n){var i=o.options()[0];i&&i.focus()}else t.focus()})),o.push=function(t){return o._attrs.options=s(o,"_attrs.options",[]),o._attrs.options.push(t),o.render()},o.select=function(t){return o.render(o.options.filter(t))},o.render=function(e){var n=o._attrs;return o.empty(),o.prepend(E.close()),n.title&&o.prepend(E.title(n.title)),n.options=e||n.options,n.options.forEach(E.option,o),t.toggleClass(C.INVIS,0==n.options.length),o._activate(),o},o.close=function(){o.hasClass(C.ON)&&r.emit(x.TOGGLE_OPEN,{menu:o,open:!1})},o._activate=function(){o.options().forEach((function(t){t.toggleClass(C.ON,t.idx===o.idx)}))},o.options=function(){return[].slice.call(o.querySelectorAll("li"))},o.activate=function(t,e){void 0===o.idx||o.idx!==t||e?o.idx=t:delete o.idx,o._activate()},o.deactivate=function(){o.activate(o.idx)},o.render(i.options),t.appendChild(o),o},E.on=function(t){return t.addClass(C.ON),t},E.off=function(t){return t.removeClass(C.ON),t},E.CONTAINER_CLASS="fp-menu",E.Events=x,E.States=C;var O={coords:"-5 25 460 460",link:"#fp-facebook",name:"fp-facebook"},N={coords:"0 0 512 512",link:"#fp-link",name:"fp-link"},A={coords:"0 0 448 512",link:"#fp-share",name:"fp-share"},k={coords:"0 0 512 512",link:"#fp-share",name:"fp-embed"},S={coords:"0 0 512 512",link:"#fp-twitter",name:"fp-twitter"},L="is-playing";function R(){try{return(document.querySelector("meta[name='description']")||{content:""}).content}catch(t){return""}}function T(t){if("string"==typeof t.link)return t.link;var e=document.querySelector("link[rel=canonical]");return e?e.href:window.location.toString()}function G(n,o,a){var u=0,c=y.span("fp-share-menu fp-menu-container").attr("tabindex","0");c.append(_(A).attr("tabindex",""));var l={prev_config:0,webshare_listener:0};a.on(t,(function(){var t=s(o,"ui.header.secondary");t&&t.append(c)}));var f=E(c,o,{title:a._t("share.menu_title"),icons:!0,options:[]});function d(t,e,n){return{text:(r=t,0===r.indexOf("share.")?a._t(r):r),icon:n,onclick:P.bind(null,a,f,e)};var r}a.on(i,(function(t){var r=s(t,"data.share",{});if(!1===r)return function(t){t.removeClass("webshare-enabled")}(c);if(l.prev_config!==r){if(l.prev_config=r,function(){try{return"https:"===window.location.protocol&&"function"==typeof navigator.share}catch(t){return!1}}()&&s(r,"web_share",!0))return function(t){t.addClass("webshare-enabled")}(c),l.webshare_listener||function(t,n,r){r.webshare_listener=!0,n.on(e,(function(e){if(!r&&n.hasClass("webshare-enabled")){e.preventDefault();var r=navigator.share({title:s(t,"share.title",document.title),text:s(t,"share.text",R()),url:T(s(t,"share",{}))});r.catch((function(){}))}}))}(n,c,l);var i=[],o="string"==typeof r.link?r.link:window.location.toString();if(r.iframe){var u="string"==typeof r.iframe?r.iframe:o;i.push(d("share.embed",I.bind(null,u,a),k))}r.link&&i.push(d("share.link",H.bind(null,o),N)),r.facebook&&i.push(d("Facebook",M.bind(null,o),O)),r.twitter&&i.push(d("Twitter",j.bind(null,o),S)),f.render(i)}}));o.on(E.Events.TOGGLE_OPEN,(function(t){if(t.data&&t.data.menu===f){if(a.root.toggleClass("is-share-menu",t.data.open),o.hasClass("is-small"))return(e=!!t.data)&&!a.paused&&(a.pause(),u=1),!e&&u&&(a.play(),u=0),void function(t,e,n,r){var i=r.getBoundingClientRect(),o=function(t,e){var n={top:0,left:0},r=t;for(;r.parentElement&&r.parentElement!==e;)r=r.parentElement,n.top+=r.offsetTop,n.left+=r.offsetLeft;return n}(e,r),a=(s=n,[].reduce.call(s.childNodes,(function(t,e){return t+e.getBoundingClientRect().height}),0));var s;n.css({position:"absolute",right:"auto",bottom:"auto",top:-o.top+"px",left:-o.left+"px",width:i.width+"px",height:a+"px",minHeight:i.height+"px",maxHeight:i.height+"px",margin:0})}(0,c,f,o);var e;!function(t,e,n,r){var i,o=function(t,e){var n=t.getBoundingClientRect(),r=e.getBoundingClientRect();return{left:n.left-r.left,right:n.right-r.left,top:n.top-r.top,bottom:n.bottom-r.top}}(e,r),a=r.getBoundingClientRect(),s=r.hasClass("logo-on-right");i={right:"auto",left:o.right+"px",top:(s?0:o.top)+"px",bottom:"auto",width:"auto",height:"auto",minHeight:"",maxHeight:.75*a.height+"px",margin:"0.5em"},n.css(i)}(0,c,f,o)}})),a.on(r,(function(t){a.hasState("is-touched")||a.hasState("is-hovered")||!a.hasState(L)||f.close()}))}function P(t,e,n){e.deactivate();var r=n();r.success&&r.message&&t.message&&t.root.emit(t.message.events.SHOW_MESSAGE,{message:r.message})}function I(t,e){var n=e.videoHeight/e.videoWidth;return H('<div style="position:relative;width:100%;display:inline-block;"><iframe src="__IFRAME_SRC__" allowfullscreen style="border:none;position:absolute;top:0;left:0;width:100%;height:100%;"></iframe><div style="padding-top: __RATIO__%;"></div></div>'.replace("__IFRAME_SRC__",encodeURI(t)).replace("__RATIO__",100*n))}function H(t){var e=y.el("textarea").css({opacity:0,position:"absolute"});e.value=t;var n=y(document.body);n.append(e),e.select();var r=document.execCommand("copy");return n.removeChild(e),{success:r,message:r?"<trans share.clipboard_success trans>":"<trans share.clipboard_failure trans>"}}function M(t){return q("https://www.facebook.com/sharer.php?u="+encodeURIComponent(t)),{success:!0}}function j(t){return q("https://twitter.com/intent/tweet?url="+encodeURIComponent(t)),{success:!0}}function q(t){var e,n,r=screen.height,i=screen.width;e=Math.round(i/2-275),n=0,r>420&&(n=Math.round(r/2-210)),window.open(t,"sharer","scrollbars=yes,resizable=yes,toolbar=no,location=yes,width=550,height=420,left="+e+",top="+n)}return function(t,e){if("object"==typeof exports&&"undefined"!=typeof module)return e;"flowplayer"in t||(t.flowplayer={extensions:[]});var n=t.flowplayer;"function"==typeof n?n(e):(Array.isArray(n.extensions)||(n.extensions=[]),~n.extensions.indexOf(e)||n.extensions.push(e))}(window,G),G}));
