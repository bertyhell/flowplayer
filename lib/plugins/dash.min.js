/*
   Flowplayer 
   @version 2.2.0
   @built   Mon, 14 Oct 2019 07:46:01 GMT
   @commit  1c041ed02b7ffd0f70168cae6c677143bcac890c
   @license Flowplayer commercial license - https://flowplayer.com/commercial-license
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e.flowplayer=e.flowplayer||{},e.flowplayer.dash=t())}(this,function(){"use strict";function e(e){var t=document.createElement("a");t.href=e;var n=t.pathname&&t.pathname.split(".");return n.length>1&&n[n.length-1]}function t(e){switch(e){case"video/mpd":return"application/dash+xml";case"video/m3u8":return"application/x-mpegurl";default:return e}}function n(n){var r=n.split("{"),i=r[1];if(!i){return[{src:n,type:t("video/"+e(n))}]}return i.slice(0,-1).split(",").map(function(e){return{src:r[0]+e,type:t("video/"+e)}})}function r(e,t){try{var n=t.exec(e)[1];return parseFloat(n,10)}catch(e){return console.error(e),0}}function i(){var e="undefined"!=typeof document&&"undefined"!=typeof window,t=e?navigator.userAgent:"",n=/iP(hone|od)/i.test(t)&&!/iPad/.test(t)&&!/IEMobile/i.test(t),i=/Android/.test(t)&&!/Firefox/.test(t),a=/IEMobile/.test(t),o=a?r(t,/Windows Phone (\d+\.\d+)/):0,s=a?r(t,/IEMobile\/(\d+\.\d+)/):0,u=function(){if(!e)return!1;if(document.documentMode)return document.documentMode;for(var t=9;t>3;t--){var n=document.createElement("div");if(n.innerHTML="\x3c!--[if IE "+t+"]><span></span><![endif]--\x3e",n.getElementsByTagName("span").length)return t}return!1}();return{controls:!n&&(!a||o>=8.1&&s>=11),video:function(t){return e&&document.createElement("video").canPlayType(t)},lang:e&&(window.navigator.userLanguage||window.navigator.language),android:i,iphone:n,ie:u,ios:e&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream}}function o(e){var t=e.split("?").shift();return t&&wa.test(t)}function u(e){return"object"==typeof e}function l(e){if(i().video(Oa))return!1;if(u(e)&&e.type&&~La.indexOf(e.type))return e.src;if(u(e)&&e.src&&o(e.src))return e.src;e=Array.isArray(e)?e:n(e);for(var t=e.length-1;t>=0;t--){var r=e[t];if(r.type&&~La.indexOf(r.type))return r.src;if(o(r.src))return r.src}return!1}function c(e,t){return t={exports:{}},e(t,t.exports),t.exports}function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g(e,t,n){return t&&h(e.prototype,t),n&&h(e,n),e}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function E(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_(e,t)}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _(e,t){return(_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function T(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?y(e):t}function v(){function e(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ru;if(!e)throw new Error("event type cannot be null or undefined");if(!t||"function"!=typeof t)throw new Error("listener must be a function: "+t);if(!(r(e,t,n)>=0)){a[e]=a[e]||[];var o={callback:t,scope:n,priority:i};a[e].some(function(t,n){if(t&&i>t.priority)return a[e].splice(n,0,o),!0})||a[e].push(o)}}function t(e,t,n){if(e&&t&&a[e]){var i=r(e,t,n);i<0||(a[e][i]=null)}}function n(e,t){if(e&&a[e]){if(t=t||{},t.hasOwnProperty("type"))throw new Error("'type' is a reserved word for event dispatching");t.type=e,a[e]=a[e].filter(function(e){return e}),a[e].forEach(function(e){return e&&e.callback.call(e.scope,t)})}}function r(e,t,n){var r=-1;return a[e]?(a[e].some(function(e,i){if(e&&e.callback===t&&(!n||n===e.scope))return r=i,!0}),r):r}function i(){a={}}var a={};return{on:e,off:t,trigger:n,reset:i}}function S(){function e(e){return e&&e.bind?e.bind(window.console):window.console.log.bind(window.console)}function t(e){return{fatal:u.bind(e),error:l.bind(e),warn:c.bind(e),info:f.bind(e),debug:d.bind(e)}}function n(e){_=e}function r(){return _}function i(e){p=e}function a(e){E=e}function o(e){_=e?pu:cu}function s(){return _!==cu}function u(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];h.apply(void 0,[fu,this].concat(t))}function l(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];h.apply(void 0,[du,this].concat(t))}function c(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];h.apply(void 0,[hu,this].concat(t))}function f(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];h.apply(void 0,[gu,this].concat(t))}function d(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];h.apply(void 0,[pu,this].concat(t))}function h(e,t){var n="",r=null;p&&(r=(new Date).getTime(),n+="["+(r-m)+"]"),E&&t&&t.getClassName&&(n+="["+t.getClassName()+"]",t.getType&&(n+="["+t.getType()+"]")),n.length>0&&(n+=" ");for(var i=arguments.length,a=new Array(i>2?i-2:0),o=2;o<i;o++)a[o-2]=arguments[o];Array.apply(null,a).forEach(function(e){n+=e+" "}),v[e]&&_>=e&&v[e](n),T.trigger(uu.LOG,{message:n,level:e})}var g,p,E,m,_,y=this.context,T=iu(y).getInstance(),v=[];return g={getLogger:t,setLogTimestampVisible:i,setCalleeNameVisible:a,setLogToBrowserConsole:o,getLogToBrowserConsole:s,setLogLevel:n,getLogLevel:r},function(){p=!0,E=!0,_=hu,m=(new Date).getTime(),"undefined"!=typeof window&&window.console&&(v[fu]=e(window.console.error),v[du]=e(window.console.error),v[hu]=e(window.console.warn),v[gu]=e(window.console.info),v[pu]=e(window.console.debug))}(),g}function A(e){function t(e){D=e}function n(){return D}function r(e){var t=function(e,t){return e.action===lu.ACTION_COMPLETE&&e.action===t.action},n=function(e,t){return!isNaN(e.index)&&e.startTime===t.startTime&&e.adaptationIndex===t.adaptationIndex&&e.type===t.type},r=function(e,t){return isNaN(e.index)&&isNaN(t.index)&&e.quality===t.quality};return!!e&&function(i){var a=!1;return i.some(function(i){if(n(e,i)||r(e,i)||t(e,i))return a=!0}),a}(b)}function i(e){var t,n=!1,i=0;if(!(n=r(e)))for(i=0;i<M.length;i++)t=M[i],e.url===t.url&&e.startTime===t.startTime&&(n=!0);return n}function a(e){var t=e?e.state instanceof Array?e.state:[e.state]:[],n=[];return t.forEach(function(t){var r=E(t);n=n.concat(p(r,e))}),n}function o(e){return isNaN(e.duration)?.25:Math.min(e.duration/8,.5)}function s(e){b=b.filter(function(t){var n=o(t);return isNaN(t.startTime)||void 0!==e&&t.startTime>=e-n})}function u(e){b=b.filter(function(t){return isNaN(t.startTime)||void 0!==e&&t.startTime+t.duration<e})}function l(e,t){t<=e+.5||(b=b.filter(function(n){var r=o(n);return isNaN(n.startTime)||n.startTime>=t-r||isNaN(n.duration)||n.startTime+n.duration<=e+r}))}function c(e,t){if(!e||0===e.length)return void s();for(var n=0,r=0,i=e.length;r<i;r++)l(n,e.start(r)),n=e.end(r);t>0&&l(n,t)}function f(){O.abort(),M=[]}function d(e){switch(e.action){case lu.ACTION_COMPLETE:b.push(e),m(e,_u),I.debug("executeRequest trigger STREAM_COMPLETED"),N.trigger(uu.STREAM_COMPLETED,{request:e,fragmentModel:this});break;case lu.ACTION_DOWNLOAD:m(e,mu),M.push(e),h(e);break;default:I.warn("Unknown request action.")}}function h(e){N.trigger(uu.FRAGMENT_LOADING_STARTED,{sender:R,request:e}),O.load(e)}function g(e,t,n){for(var r=e.length-1,i=r;i>=0;i--){var a=e[i],s=a.startTime,u=s+a.duration;if(n=isNaN(n)?o(a):n,!isNaN(s)&&!isNaN(u)&&t+n>=s&&t-n<u||isNaN(s)&&isNaN(t))return a}return null}function p(e,t){return t.hasOwnProperty("time")?[g(e,t.time,t.threshold)]:e.filter(function(e){for(var n in t)if("state"!==n&&t.hasOwnProperty(n)&&e[n]!=t[n])return!1;return!0})}function E(e){var t;switch(e){case mu:t=M;break;case _u:t=b;break;default:t=[]}return t}function m(e,t){w.addSchedulingInfo(e.mediaType,new Date,e.type,e.startTime,e.availabilityStartTime,e.duration,e.quality,e.range,t),w.addRequestsQueue(e.mediaType,M,b)}function _(e){e.sender===O&&(M.splice(M.indexOf(e.request),1),e.response&&!e.error&&b.push(e.request),m(e.request,e.error?yu:_u),N.trigger(uu.FRAGMENT_LOADING_COMPLETED,{request:e.request,response:e.response,error:e.error,sender:this}))}function y(e){e.sender===O&&N.trigger(uu.FRAGMENT_LOADING_PROGRESS,{request:e.request,response:e.response,error:e.error,sender:this})}function T(e){e.sender===O&&N.trigger(uu.FRAGMENT_LOADING_ABANDONED,{streamProcessor:this.getStreamProcessor(),request:e.request,mediaType:e.mediaType})}function v(){b=[],M=[]}function S(){N.off(uu.LOADING_COMPLETED,_,this),N.off(uu.LOADING_DATA_PROGRESS,y,this),N.off(uu.LOADING_ABANDONED,T,this),O&&O.reset(),v()}function A(e){b.push(e)}e=e||{};var R,I,D,b,M,C=this.context,N=iu(C).getInstance(),w=e.metricsModel,O=e.fragmentLoader;return R={setStreamProcessor:t,getStreamProcessor:n,getRequests:a,isFragmentLoaded:r,isFragmentLoadedOrPending:i,removeExecutedRequestsBeforeTime:s,removeExecutedRequestsAfterTime:u,syncExecutedRequestsWithBufferedRange:c,abortRequests:f,executeRequest:d,reset:S,addExecutedRequest:A},function(){I=Eu(C).getInstance().getLogger(R),v(),N.on(uu.LOADING_COMPLETED,_,R),N.on(uu.LOADING_DATA_PROGRESS,y,R),N.on(uu.LOADING_ABANDONED,T,R)}(),R}function R(){function e(e){return e&&a&&a.boxes&&0!==a.boxes.length&&"function"==typeof a.fetch?i(a.fetch(e)):null}function t(e){var t=[];if(!e||!a||"function"!=typeof a.fetchAll)return t;for(var n,r=a.fetchAll(e),o=0,s=r.length;o<s;o++)(n=i(r[o]))&&t.push(n);return t}function n(e){a=e}function r(){if(!a||!a.boxes||!a.boxes.length)return null;var e=a.boxes[a.boxes.length-1].type,n=t(e);return n.length>0?n[n.length-1]:null}function i(e){if(!e)return null;var t=new Vl(e);return e.hasOwnProperty("_incomplete")&&(t.isComplete=!e._incomplete),t}var a;return{getBox:e,getBoxes:t,setData:n,getLastBox:r}}function I(){function e(e){if(!e)return null;void 0===e.fileStart&&(e.fileStart=0);var t=ql.parseBuffer(e),n=Hl(l).create();return n.setData(t),n}function t(e,t,n){if(void 0===n&&(n=0),!t||n+8>=t.byteLength)return new jl(0,!1);for(var r,o=t instanceof ArrayBuffer?new Uint8Array(t):t,s=0;n<o.byteLength;){var u=i(o,n),l=a(o,n+4);if(0===u)break;n+u<=o.byteLength&&(e.indexOf(l)>=0?r=new jl(n,!0,u):s=n+u),n+=u}return r||new jl(s,!1)}function n(t){if(!t||0===t.byteLength)return{sampleList:[],lastSequenceNumber:NaN,totalDuration:NaN,numSequences:NaN};var n,r,i,a,o,s,u,l,c,f,d,h,g,p,E,m,_,y=e(t),T=y.getBoxes("moof"),v=y.getBoxes("mfhd");m=y.getBoxes("moof").length,E=v[v.length-1].sequence_number,i=0,s=[];var S=-1,A=-1;for(d=0;d<T.length;d++){var R=T[d],I=R.getChildBoxes("traf");for(c=0;c<I.length;c++){var D=I[c],b=D.getChildBox("tfhd"),M=D.getChildBox("tfdt");o=M.baseMediaDecodeTime;var C=D.getChildBoxes("trun"),N=D.getChildBoxes("subs");for(f=0;f<C.length;f++){var w=C[f];for(i=w.sample_count,p=(b.base_data_offset||0)+(w.data_offset||0),l=0;l<i;l++){u=w.samples[l],n=void 0!==u.sample_duration?u.sample_duration:b.default_sample_duration,a=void 0!==u.sample_size?u.sample_size:b.default_sample_size,r=void 0!==u.sample_composition_time_offset?u.sample_composition_time_offset:0;var O={dts:o,cts:o+r,duration:n,offset:R.offset+p,size:a,subSizes:[a]};if(N)for(h=0;h<N.length;h++){var L=N[h];if(S<L.entry_count-1&&l>A&&(S++,A+=L.entries[S].sample_delta),l==A){O.subSizes=[];var P=L.entries[S];for(g=0;g<P.subsample_count;g++)O.subSizes.push(P.subsamples[g].subsample_size)}}s.push(O),p+=a,o+=n}}_=o-M.baseMediaDecodeTime}}return{sampleList:s,lastSequenceNumber:E,totalDuration:_,numSequences:m}}function r(t){var n=e(t),r=n?n.getBox("mdhd"):void 0;return r?r.timescale:NaN}function i(e,t){return e[t+3]>>>0|e[t+2]<<8>>>0|e[t+1]<<16>>>0|e[t]<<24>>>0}function a(e,t){return String.fromCharCode(e[t++])+String.fromCharCode(e[t++])+String.fromCharCode(e[t++])+String.fromCharCode(e[t])}function o(t){var n,r,i=null,a=e(t);if(!a)return i;var o=a.getBox("ftyp"),u=a.getBox("moov");return s.debug("Searching for initialization."),u&&u.isComplete&&(n=o?o.offset:u.offset,r=u.offset+u.size-1,i=n+"-"+r,s.debug("Found the initialization.  Range: "+i)),i}var s,u,l=this.context;return u={parse:e,findLastTopIsoBoxCompleted:t,getMediaTimescaleFromMoov:r,getSamplesInfo:n,findInitRange:o},function(){s=Eu(l).getInstance().getLogger(u)}(),u}function D(e,t){if(f(e)!==t)throw Ys.BAD_ARGUMENT_ERROR}function b(e){if(null===e||isNaN(e)||e%1!=0)throw Ys.BAD_ARGUMENT_ERROR+" : argument is not an integer"}function M(e,t,n){if(e<t||e>n)throw Ys.BAD_ARGUMENT_ERROR+" : argument out of range"}function C(e){if("string"!=typeof e||e!==Ys.AUDIO&&e!==Ys.VIDEO)throw Ys.BAD_ARGUMENT_ERROR}function N(){function e(e,t){var n=0;for(n=0;n<this.customTimeRangeArray.length&&e>this.customTimeRangeArray[n].start;n++);for(this.customTimeRangeArray.splice(n,0,{start:e,end:t}),n=0;n<this.customTimeRangeArray.length-1;n++)this.mergeRanges(n,n+1)&&n--;this.length=this.customTimeRangeArray.length}function t(){this.customTimeRangeArray=[],this.length=0}function n(e,t){for(var n=0;n<this.customTimeRangeArray.length;n++)if(e<=this.customTimeRangeArray[n].start&&t>=this.customTimeRangeArray[n].end)this.customTimeRangeArray.splice(n,1),n--;else{if(e>this.customTimeRangeArray[n].start&&t<this.customTimeRangeArray[n].end){this.customTimeRangeArray.splice(n+1,0,{start:t,end:this.customTimeRangeArray[n].end}),this.customTimeRangeArray[n].end=e;break}e>this.customTimeRangeArray[n].start&&e<this.customTimeRangeArray[n].end?this.customTimeRangeArray[n].end=e:t>this.customTimeRangeArray[n].start&&t<this.customTimeRangeArray[n].end&&(this.customTimeRangeArray[n].start=t)}this.length=this.customTimeRangeArray.length}function r(e,t){var n=this.customTimeRangeArray[e],r=this.customTimeRangeArray[t];return n.start<=r.start&&r.start<=n.end&&n.end<=r.end?(n.end=r.end,this.customTimeRangeArray.splice(t,1),!0):r.start<=n.start&&n.start<=r.end&&r.end<=n.end?(n.start=r.start,this.customTimeRangeArray.splice(t,1),!0):r.start<=n.start&&n.start<=r.end&&n.end<=r.end?(this.customTimeRangeArray.splice(e,1),!0):n.start<=r.start&&r.start<=n.end&&r.end<=n.end&&(this.customTimeRangeArray.splice(t,1),!0)}function i(e){return b(e),e>=this.customTimeRangeArray.length||e<0?NaN:this.customTimeRangeArray[e].start}function a(e){return b(e),e>=this.customTimeRangeArray.length||e<0?NaN:this.customTimeRangeArray[e].end}return{customTimeRangeArray:[],length:0,add:e,clear:t,remove:n,mergeRanges:r,start:i,end:a}}function w(){uc=!0;for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0,n=e.length;t<n;++t)ac[t]=e[t],oc[e.charCodeAt(t)]=t;oc["-".charCodeAt(0)]=62,oc["_".charCodeAt(0)]=63}function O(e){uc||w();var t,n,r,i,a,o,s=e.length;if(s%4>0)throw new Error("Invalid string. Length must be a multiple of 4");a="="===e[s-2]?2:"="===e[s-1]?1:0,o=new sc(3*s/4-a),r=a>0?s-4:s;var u=0;for(t=0,n=0;t<r;t+=4,n+=3)i=oc[e.charCodeAt(t)]<<18|oc[e.charCodeAt(t+1)]<<12|oc[e.charCodeAt(t+2)]<<6|oc[e.charCodeAt(t+3)],o[u++]=i>>16&255,o[u++]=i>>8&255,o[u++]=255&i;return 2===a?(i=oc[e.charCodeAt(t)]<<2|oc[e.charCodeAt(t+1)]>>4,o[u++]=255&i):1===a&&(i=oc[e.charCodeAt(t)]<<10|oc[e.charCodeAt(t+1)]<<4|oc[e.charCodeAt(t+2)]>>2,o[u++]=i>>8&255,o[u++]=255&i),o}function L(e){return ac[e>>18&63]+ac[e>>12&63]+ac[e>>6&63]+ac[63&e]}function P(e,t,n){for(var r,i=[],a=t;a<n;a+=3)r=(e[a]<<16)+(e[a+1]<<8)+e[a+2],i.push(L(r));return i.join("")}function F(e){uc||w();for(var t,n=e.length,r=n%3,i="",a=[],o=0,s=n-r;o<s;o+=16383)a.push(P(e,o,o+16383>s?s:o+16383));return 1===r?(t=e[n-1],i+=ac[t>>2],i+=ac[t<<4&63],i+="=="):2===r&&(t=(e[n-2]<<8)+e[n-1],i+=ac[t>>10],i+=ac[t>>4&63],i+=ac[t<<2&63],i+="="),a.push(i),a.join("")}function x(e,t,n,r,i){var a,o,s=8*i-r-1,u=(1<<s)-1,l=u>>1,c=-7,f=n?i-1:0,d=n?-1:1,h=e[t+f];for(f+=d,a=h&(1<<-c)-1,h>>=-c,c+=s;c>0;a=256*a+e[t+f],f+=d,c-=8);for(o=a&(1<<-c)-1,a>>=-c,c+=r;c>0;o=256*o+e[t+f],f+=d,c-=8);if(0===a)a=1-l;else{if(a===u)return o?NaN:1/0*(h?-1:1);o+=Math.pow(2,r),a-=l}return(h?-1:1)*o*Math.pow(2,a-r)}function U(e,t,n,r,i,a){var o,s,u,l=8*a-i-1,c=(1<<l)-1,f=c>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:a-1,g=r?1:-1,p=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=c):(o=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-o))<1&&(o--,u*=2),t+=o+f>=1?d/u:d*Math.pow(2,1-f),t*u>=2&&(o++,u/=2),o+f>=c?(s=0,o=c):o+f>=1?(s=(t*u-1)*Math.pow(2,i),o+=f):(s=t*Math.pow(2,f-1)*Math.pow(2,i),o=0));i>=8;e[n+h]=255&s,h+=g,s/=256,i-=8);for(o=o<<i|s,l+=i;l>0;e[n+h]=255&o,h+=g,o/=256,l-=8);e[n+h-g]|=128*p}function B(){return G.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function k(e,t){if(B()<t)throw new RangeError("Invalid typed array length");return G.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t),e.__proto__=G.prototype):(null===e&&(e=new G(t)),e.length=t),e}function G(e,t,n){if(!(G.TYPED_ARRAY_SUPPORT||this instanceof G))return new G(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return H(this,e)}return Y(this,e,t,n)}function Y(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?z(e,t,n,r):"string"==typeof t?q(e,t,n):W(e,t)}function K(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function V(e,t,n,r){return K(t),t<=0?k(e,t):void 0!==n?"string"==typeof r?k(e,t).fill(n,r):k(e,t).fill(n):k(e,t)}function H(e,t){if(K(t),e=k(e,t<0?0:0|X(t)),!G.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function q(e,t,n){if("string"==typeof n&&""!==n||(n="utf8"),!G.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|Z(t,n);e=k(e,r);var i=e.write(t,n);return i!==r&&(e=e.slice(0,i)),e}function j(e,t){var n=t.length<0?0:0|X(t.length);e=k(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function z(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r),G.TYPED_ARRAY_SUPPORT?(e=t,e.__proto__=G.prototype):e=j(e,t),e}function W(e,t){if(Q(t)){var n=0|X(t.length);return e=k(e,n),0===e.length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||Ne(t.length)?k(e,0):j(e,t);if("Buffer"===t.type&&cc(t.data))return j(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function X(e){if(e>=B())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+B().toString(16)+" bytes");return 0|e}function Q(e){return!(null==e||!e._isBuffer)}function Z(e,t){if(Q(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return Ie(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return Me(e).length;default:if(r)return Ie(e).length;t=(""+t).toLowerCase(),r=!0}}function $(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if(n>>>=0,t>>>=0,n<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":return he(this,t,n);case"utf8":case"utf-8":return le(this,t,n);case"ascii":return fe(this,t,n);case"latin1":case"binary":return de(this,t,n);case"base64":return ue(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ge(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function J(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function ee(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=G.from(t,r)),Q(t))return 0===t.length?-1:te(e,t,n,r,i);if("number"==typeof t)return t&=255,G.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):te(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function te(e,t,n,r,i){function a(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}var o=1,s=e.length,u=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;o=2,s/=2,u/=2,n/=2}var l;if(i){var c=-1;for(l=n;l<s;l++)if(a(e,l)===a(t,-1===c?0:l-c)){if(-1===c&&(c=l),l-c+1===u)return c*o}else-1!==c&&(l-=l-c),c=-1}else for(n+u>s&&(n=s-u),l=n;l>=0;l--){for(var f=!0,d=0;d<u;d++)if(a(e,l+d)!==a(t,d)){f=!1;break}if(f)return l}return-1}function ne(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var a=t.length;if(a%2!=0)throw new TypeError("Invalid hex string");r>a/2&&(r=a/2);for(var o=0;o<r;++o){var s=parseInt(t.substr(2*o,2),16);if(isNaN(s))return o;e[n+o]=s}return o}function re(e,t,n,r){return Ce(Ie(t,e.length-n),e,n,r)}function ie(e,t,n,r){return Ce(De(t),e,n,r)}function ae(e,t,n,r){return ie(e,t,n,r)}function oe(e,t,n,r){return Ce(Me(t),e,n,r)}function se(e,t,n,r){return Ce(be(t,e.length-n),e,n,r)}function ue(e,t,n){return F(0===t&&n===e.length?e:e.slice(t,n))}function le(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var a=e[i],o=null,s=a>239?4:a>223?3:a>191?2:1;if(i+s<=n){var u,l,c,f;switch(s){case 1:a<128&&(o=a);break;case 2:u=e[i+1],128==(192&u)&&(f=(31&a)<<6|63&u)>127&&(o=f);break;case 3:u=e[i+1],l=e[i+2],128==(192&u)&&128==(192&l)&&(f=(15&a)<<12|(63&u)<<6|63&l)>2047&&(f<55296||f>57343)&&(o=f);break;case 4:u=e[i+1],l=e[i+2],c=e[i+3],128==(192&u)&&128==(192&l)&&128==(192&c)&&(f=(15&a)<<18|(63&u)<<12|(63&l)<<6|63&c)>65535&&f<1114112&&(o=f)}}null===o?(o=65533,s=1):o>65535&&(o-=65536,r.push(o>>>10&1023|55296),o=56320|1023&o),r.push(o),i+=s}return ce(r)}function ce(e){var t=e.length;if(t<=fc)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=fc));return n}function fe(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function de(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function he(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",a=t;a<n;++a)i+=Re(e[a]);return i}function ge(e,t,n){for(var r=e.slice(t,n),i="",a=0;a<r.length;a+=2)i+=String.fromCharCode(r[a]+256*r[a+1]);return i}function pe(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function Ee(e,t,n,r,i,a){if(!Q(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<a)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function me(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,a=Math.min(e.length-n,2);i<a;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function _e(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,a=Math.min(e.length-n,4);i<a;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function ye(e,t,n,r,i,a){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function Te(e,t,n,r,i){return i||ye(e,t,n,4,3.4028234663852886e38,-3.4028234663852886e38),U(e,t,n,r,23,4),n+4}function ve(e,t,n,r,i){return i||ye(e,t,n,8,1.7976931348623157e308,-1.7976931348623157e308),U(e,t,n,r,52,8),n+8}function Se(e){if(e=Ae(e).replace(dc,""),e.length<2)return"";for(;e.length%4!=0;)e+="=";return e}function Ae(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function Re(e){return e<16?"0"+e.toString(16):e.toString(16)}function Ie(e,t){t=t||1/0;for(var n,r=e.length,i=null,a=[],o=0;o<r;++o){if((n=e.charCodeAt(o))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&a.push(239,191,189);continue}if(o+1===r){(t-=3)>-1&&a.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&a.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&a.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;a.push(n)}else if(n<2048){if((t-=2)<0)break;a.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;a.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return a}function De(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}function be(e,t){for(var n,r,i,a=[],o=0;o<e.length&&!((t-=2)<0);++o)n=e.charCodeAt(o),r=n>>8,i=n%256,a.push(i),a.push(r);return a}function Me(e){return O(Se(e))}function Ce(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function Ne(e){return e!==e}function we(e){return null!=e&&(!!e._isBuffer||Oe(e)||Le(e))}function Oe(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function Le(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&Oe(e.slice(0,0))}function Pe(){}function Fe(){Fe.init.call(this)}function xe(e){return void 0===e._maxListeners?Fe.defaultMaxListeners:e._maxListeners}function Ue(e,t,n){if(t)e.call(n);else for(var r=e.length,i=ze(e,r),a=0;a<r;++a)i[a].call(n)}function Be(e,t,n,r){if(t)e.call(n,r);else for(var i=e.length,a=ze(e,i),o=0;o<i;++o)a[o].call(n,r)}function ke(e,t,n,r,i){if(t)e.call(n,r,i);else for(var a=e.length,o=ze(e,a),s=0;s<a;++s)o[s].call(n,r,i)}function Ge(e,t,n,r,i,a){if(t)e.call(n,r,i,a);else for(var o=e.length,s=ze(e,o),u=0;u<o;++u)s[u].call(n,r,i,a)}function Ye(e,t,n,r){if(t)e.apply(n,r);else for(var i=e.length,a=ze(e,i),o=0;o<i;++o)a[o].apply(n,r)}function Ke(e,t,n,r){var i,a,o;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if(a=e._events,a?(a.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),a=e._events),o=a[t]):(a=e._events=new Pe,e._eventsCount=0),o){if("function"==typeof o?o=a[t]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),!o.warned&&(i=xe(e))&&i>0&&o.length>i){o.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=e,s.type=t,s.count=o.length,Ve(s)}}else o=a[t]=n,++e._eventsCount;return e}function Ve(e){"function"==typeof console.warn?console.warn(e):console.log(e)}function He(e,t,n){function r(){e.removeListener(t,r),i||(i=!0,n.apply(e,arguments))}var i=!1;return r.listener=n,r}function qe(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function je(e,t){for(var n=t,r=n+1,i=e.length;r<i;n+=1,r+=1)e[n]=e[r];e.pop()}function ze(e,t){for(var n=new Array(t);t--;)n[t]=e[t];return n}function We(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}function Xe(){throw new Error("setTimeout has not been defined")}function Qe(){throw new Error("clearTimeout has not been defined")}function Ze(e){if(hc===setTimeout)return setTimeout(e,0);if((hc===Xe||!hc)&&setTimeout)return hc=setTimeout,setTimeout(e,0);try{return hc(e,0)}catch(t){try{return hc.call(null,e,0)}catch(t){return hc.call(this,e,0)}}}function $e(e){if(gc===clearTimeout)return clearTimeout(e);if((gc===Qe||!gc)&&clearTimeout)return gc=clearTimeout,clearTimeout(e);try{return gc(e)}catch(t){try{return gc.call(null,e)}catch(t){return gc.call(this,e)}}}function Je(){mc&&pc&&(mc=!1,pc.length?Ec=pc.concat(Ec):_c=-1,Ec.length&&et())}function et(){if(!mc){var e=Ze(Je);mc=!0;for(var t=Ec.length;t;){for(pc=Ec,Ec=[];++_c<t;)pc&&pc[_c].run();_c=-1,t=Ec.length}pc=null,mc=!1,$e(e)}}function tt(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];Ec.push(new nt(e,t)),1!==Ec.length||mc||Ze(et)}function nt(e,t){this.fun=e,this.array=t}function rt(){}function it(e){throw new Error("process.binding is not supported")}function at(){return"/"}function ot(e){throw new Error("process.chdir is not supported")}function st(){return 0}function ut(e){var t=.001*Lc.call(Oc),n=Math.floor(t),r=Math.floor(t%1*1e9);return e&&(n-=e[0],(r-=e[1])<0&&(n--,r+=1e9)),[n,r]}function lt(){return(new Date-Pc)/1e3}function ct(e){if(!Dt(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(dt(arguments[n]));return t.join(" ")}for(var n=1,r=arguments,i=r.length,a=String(e).replace(Bc,function(e){if("%%"===e)return"%";if(n>=i)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}}),o=r[n];n<i;o=r[++n])Rt(o)||!Ct(o)?a+=" "+o:a+=" "+dt(o);return a}function ft(e,t){function n(){if(!r){if(Fc.throwDeprecation)throw new Error(t);Fc.traceDeprecation?console.trace(t):console.error(t),r=!0}return e.apply(this,arguments)}if(bt(Pa.process))return function(){return ft(e,t).apply(this,arguments)};if(!0===Fc.noDeprecation)return e;var r=!1;return n}function dt(e,t){var n={seen:[],stylize:gt};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),At(t)?n.showHidden=t:t&&Pt(n,t),bt(n.showHidden)&&(n.showHidden=!1),bt(n.depth)&&(n.depth=2),bt(n.colors)&&(n.colors=!1),bt(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=ht),Et(n,e,n.depth)}function ht(e,t){var n=dt.styles[t];return n?"["+dt.colors[n][0]+"m"+e+"["+dt.colors[n][1]+"m":e}function gt(e,t){return e}function pt(e){var t={};return e.forEach(function(e,n){t[e]=!0}),t}function Et(e,t,n){if(e.customInspect&&t&&Ot(t.inspect)&&t.inspect!==dt&&(!t.constructor||t.constructor.prototype!==t)){var r=t.inspect(n,e);return Dt(r)||(r=Et(e,r,n)),r}var i=mt(e,t);if(i)return i;var a=Object.keys(t),o=pt(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(t)),wt(t)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return _t(t);if(0===a.length){if(Ot(t)){var s=t.name?": "+t.name:"";return e.stylize("[Function"+s+"]","special")}if(Mt(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(Nt(t))return e.stylize(Date.prototype.toString.call(t),"date");if(wt(t))return _t(t)}var u="",l=!1,c=["{","}"];if(St(t)&&(l=!0,c=["[","]"]),Ot(t)){u=" [Function"+(t.name?": "+t.name:"")+"]"}if(Mt(t)&&(u=" "+RegExp.prototype.toString.call(t)),Nt(t)&&(u=" "+Date.prototype.toUTCString.call(t)),wt(t)&&(u=" "+_t(t)),0===a.length&&(!l||0==t.length))return c[0]+u+c[1];if(n<0)return Mt(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special");e.seen.push(t);var f;return f=l?yt(e,t,n,o,a):a.map(function(r){return Tt(e,t,n,o,r,l)}),e.seen.pop(),vt(f,u,c)}function mt(e,t){if(bt(t))return e.stylize("undefined","undefined");if(Dt(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return It(t)?e.stylize(""+t,"number"):At(t)?e.stylize(""+t,"boolean"):Rt(t)?e.stylize("null","null"):void 0}function _t(e){return"["+Error.prototype.toString.call(e)+"]"}function yt(e,t,n,r,i){for(var a=[],o=0,s=t.length;o<s;++o)Ft(t,String(o))?a.push(Tt(e,t,n,r,String(o),!0)):a.push("");return i.forEach(function(i){i.match(/^\d+$/)||a.push(Tt(e,t,n,r,i,!0))}),a}function Tt(e,t,n,r,i,a){var o,s,u;if(u=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]},
u.get?s=u.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):u.set&&(s=e.stylize("[Setter]","special")),Ft(r,i)||(o="["+i+"]"),s||(e.seen.indexOf(u.value)<0?(s=Rt(n)?Et(e,u.value,null):Et(e,u.value,n-1),s.indexOf("\n")>-1&&(s=a?s.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+s.split("\n").map(function(e){return"   "+e}).join("\n"))):s=e.stylize("[Circular]","special")),bt(o)){if(a&&i.match(/^\d+$/))return s;o=JSON.stringify(""+i),o.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=e.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=e.stylize(o,"string"))}return o+": "+s}function vt(e,t,n){var r=0;return e.reduce(function(e,t){return r++,t.indexOf("\n")>=0&&r++,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}function St(e){return Array.isArray(e)}function At(e){return"boolean"==typeof e}function Rt(e){return null===e}function It(e){return"number"==typeof e}function Dt(e){return"string"==typeof e}function bt(e){return void 0===e}function Mt(e){return Ct(e)&&"[object RegExp]"===Lt(e)}function Ct(e){return"object"==typeof e&&null!==e}function Nt(e){return Ct(e)&&"[object Date]"===Lt(e)}function wt(e){return Ct(e)&&("[object Error]"===Lt(e)||e instanceof Error)}function Ot(e){return"function"==typeof e}function Lt(e){return Object.prototype.toString.call(e)}function Pt(e,t){if(!t||!Ct(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}function Ft(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function xt(){this.head=null,this.tail=null,this.length=0}function Ut(e){if(e&&!Gc(e))throw new Error("Unknown encoding: "+e)}function Bt(e){switch(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),Ut(e),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=Gt;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=Yt;break;default:return void(this.write=kt)}this.charBuffer=new G(6),this.charReceived=0,this.charLength=0}function kt(e){return e.toString(this.encoding)}function Gt(e){this.charReceived=e.length%2,this.charLength=this.charReceived?2:0}function Yt(e){this.charReceived=e.length%3,this.charLength=this.charReceived?3:0}function Kt(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}function Vt(e,t){return e.listeners(t).length}function Ht(e,t){e=e||{},this.objectMode=!!e.objectMode,t instanceof xn&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var n=e.highWaterMark,r=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:r,this.highWaterMark=~~this.highWaterMark,this.buffer=new xt,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(this.decoder=new Bt(e.encoding),this.encoding=e.encoding)}function qt(e){if(!(this instanceof qt))return new qt(e);this._readableState=new Ht(e,this),this.readable=!0,e&&"function"==typeof e.read&&(this._read=e.read),Fe.call(this)}function jt(e,t,n,r,i){var a=Qt(t,n);if(a)e.emit("error",a);else if(null===n)t.reading=!1,Zt(e,t);else if(t.objectMode||n&&n.length>0)if(t.ended&&!i){var o=new Error("stream.push() after EOF");e.emit("error",o)}else if(t.endEmitted&&i){var s=new Error("stream.unshift() after end event");e.emit("error",s)}else{var u;!t.decoder||i||r||(n=t.decoder.write(n),u=!t.objectMode&&0===n.length),i||(t.reading=!1),u||(t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,i?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&$t(e))),en(e,t)}else i||(t.reading=!1);return zt(t)}function zt(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}function Wt(e){return e>=Vc?e=Vc:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}function Xt(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!==e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=Wt(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function Qt(e,t){var n=null;return we(t)||"string"==typeof t||null===t||void 0===t||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}function Zt(e,t){if(!t.ended){if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,$t(e)}}function $t(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(Kc("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?tt(Jt,e):Jt(e))}function Jt(e){Kc("emit readable"),e.emit("readable"),sn(e)}function en(e,t){t.readingMore||(t.readingMore=!0,tt(tn,e,t))}function tn(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(Kc("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function nn(e){return function(){var t=e._readableState;Kc("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&e.listeners("data").length&&(t.flowing=!0,sn(e))}}function rn(e){Kc("readable nexttick read 0"),e.read(0)}function an(e,t){t.resumeScheduled||(t.resumeScheduled=!0,tt(on,e,t))}function on(e,t){t.reading||(Kc("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),sn(e),t.flowing&&!t.reading&&e.read(0)}function sn(e){var t=e._readableState;for(Kc("flow",t.flowing);t.flowing&&null!==e.read(););}function un(e,t){if(0===t.length)return null;var n;return t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):n=ln(e,t.buffer,t.decoder),n}function ln(e,t,n){var r;return e<t.head.data.length?(r=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):r=e===t.head.data.length?t.shift():n?cn(e,t):fn(e,t),r}function cn(e,t){var n=t.head,r=1,i=n.data;for(e-=i.length;n=n.next;){var a=n.data,o=e>a.length?a.length:e;if(o===a.length?i+=a:i+=a.slice(0,e),0===(e-=o)){o===a.length?(++r,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=a.slice(o));break}++r}return t.length-=r,i}function fn(e,t){var n=G.allocUnsafe(e),r=t.head,i=1;for(r.data.copy(n),e-=r.data.length;r=r.next;){var a=r.data,o=e>a.length?a.length:e;if(a.copy(n,n.length-e,0,o),0===(e-=o)){o===a.length?(++i,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=a.slice(o));break}++i}return t.length-=i,n}function dn(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,tt(hn,t,e))}function hn(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function gn(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)}function pn(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}function En(){}function mn(e,t,n){this.chunk=e,this.encoding=t,this.callback=n,this.next=null}function _n(e,t){Object.defineProperty(this,"buffer",{get:ft(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")}),e=e||{},this.objectMode=!!e.objectMode,t instanceof xn&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var n=e.highWaterMark,r=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:r,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var i=!1===e.decodeStrings;this.decodeStrings=!i,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){bn(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new Fn(this)}function yn(e){if(!(this instanceof yn||this instanceof xn))return new yn(e);this._writableState=new _n(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev)),Fe.call(this)}function Tn(e,t){var n=new Error("write after end");e.emit("error",n),tt(t,n)}function vn(e,t,n,r){var i=!0,a=!1;return null===n?a=new TypeError("May not write null values to stream"):G.isBuffer(n)||"string"==typeof n||void 0===n||t.objectMode||(a=new TypeError("Invalid non-string/buffer chunk")),a&&(e.emit("error",a),tt(r,a),i=!1),i}function Sn(e,t,n){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=G.from(t,n)),t}function An(e,t,n,r,i){n=Sn(t,n,r),G.isBuffer(n)&&(r="buffer");var a=t.objectMode?1:n.length;t.length+=a;var o=t.length<t.highWaterMark;if(o||(t.needDrain=!0),t.writing||t.corked){var s=t.lastBufferedRequest;t.lastBufferedRequest=new mn(n,r,i),s?s.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else Rn(e,t,!1,a,n,r,i);return o}function Rn(e,t,n,r,i,a,o){t.writelen=r,t.writecb=o,t.writing=!0,t.sync=!0,n?e._writev(i,t.onwrite):e._write(i,a,t.onwrite),t.sync=!1}function In(e,t,n,r,i){--t.pendingcb,n?tt(i,r):i(r),e._writableState.errorEmitted=!0,e.emit("error",r)}function Dn(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function bn(e,t){var n=e._writableState,r=n.sync,i=n.writecb;if(Dn(n),t)In(e,n,r,t,i);else{var a=wn(n);a||n.corked||n.bufferProcessing||!n.bufferedRequest||Nn(e,n),r?tt(Mn,e,n,a,i):Mn(e,n,a,i)}}function Mn(e,t,n,r){n||Cn(e,t),t.pendingcb--,r(),Ln(e,t)}function Cn(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function Nn(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var r=t.bufferedRequestCount,i=new Array(r),a=t.corkedRequestsFree;a.entry=n;for(var o=0;n;)i[o]=n,n=n.next,o+=1;Rn(e,t,!0,t.length,i,"",a.finish),t.pendingcb++,t.lastBufferedRequest=null,a.next?(t.corkedRequestsFree=a.next,a.next=null):t.corkedRequestsFree=new Fn(t)}else{for(;n;){var s=n.chunk,u=n.encoding,l=n.callback;if(Rn(e,t,!1,t.objectMode?1:s.length,s,u,l),n=n.next,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequestCount=0,t.bufferedRequest=n,t.bufferProcessing=!1}function wn(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function On(e,t){t.prefinished||(t.prefinished=!0,e.emit("prefinish"))}function Ln(e,t){var n=wn(t);return n&&(0===t.pendingcb?(On(e,t),t.finished=!0,e.emit("finish")):On(e,t)),n}function Pn(e,t,n){t.ending=!0,Ln(e,t),n&&(t.finished?tt(n):e.once("finish",n)),t.ended=!0,e.writable=!1}function Fn(e){var t=this;this.next=null,this.entry=null,this.finish=function(n){var r=t.entry;for(t.entry=null;r;){var i=r.callback;e.pendingcb--,i(n),r=r.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}}function xn(e){if(!(this instanceof xn))return new xn(e);qt.call(this,e),yn.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",Un)}function Un(){this.allowHalfOpen||this._writableState.ended||tt(Bn,this)}function Bn(e){e.end()}function kn(e){this.afterTransform=function(t,n){return Gn(e,t,n)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function Gn(e,t,n){var r=e._transformState;r.transforming=!1;var i=r.writecb;if(!i)return e.emit("error",new Error("no writecb in Transform class"));r.writechunk=null,r.writecb=null,null!==n&&void 0!==n&&e.push(n),i(t);var a=e._readableState;a.reading=!1,(a.needReadable||a.length<a.highWaterMark)&&e._read(a.highWaterMark)}function Yn(e){if(!(this instanceof Yn))return new Yn(e);xn.call(this,e),this._transformState=new kn(this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.once("prefinish",function(){"function"==typeof this._flush?this._flush(function(e){Kn(t,e)}):Kn(t)})}function Kn(e,t){if(t)return e.emit("error",t);var n=e._writableState,r=e._transformState;if(n.length)throw new Error("Calling transform done when ws.length != 0");if(r.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}function Vn(e){if(!(this instanceof Vn))return new Vn(e);Yn.call(this,e)}function Hn(){Fe.call(this)}function qn(){function e(){"undefined"!=typeof window&&"undefined"!=typeof navigator&&(D=window.VTTCue||window.TextTrackCue,M=[],C=[],N=-1,w=0,O=0,L=0,P=0,F=null,x=null,B=!1,G=2147483647,k=null,void 0!==document.fullscreenElement?U="fullscreenElement":void 0!==document.webkitIsFullScreen?U="webkitIsFullScreen":document.msFullscreenElement?U="msFullscreenElement":document.mozFullScreen&&(U="mozFullScreen"))}function t(e){var t=M[e].kind,n=void 0!==M[e].id?M[e].id:M[e].lang,r=M[e].lang,i=M[e].isTTML,a=M[e].isEmbedded,o=b.addTextTrack(t,n,r);return o.isEmbedded=a,o.isTTML=i,o}function n(e){B=e,F&&!document[U]&&(F.style.zIndex=e?G:null)}function r(e,n){if(M.length===n)return void I.error("Trying to add too many tracks.");if(M.push(e),M.length===n){M.sort(function(e,t){return e.index-t.index}),F=b.getTTMLRenderingDiv();for(var r=-1,i=0;i<M.length;i++){var a=t.call(this,i);C.push(a),M[i].defaultTrack&&(a.default=!0,r=i);var o=l(i);o&&(o.mode=Ys.TEXT_SHOWING,F&&(M[i].isTTML||M[i].isEmbedded)?o.renderingType="html":o.renderingType="default"),this.addCaptions(i,0,M[i].captionData),K.trigger(uu.TEXT_TRACK_ADDED)}if(d.call(this,r),r>=0)for(var s=0;s<M.length;s++){var u=l(s);u&&(u.mode=s===r?Ys.TEXT_SHOWING:Ys.TEXT_HIDDEN)}K.trigger(uu.TEXT_TRACKS_QUEUE_INITIALIZED,{index:N,tracks:M})}}function i(e,t,n,r,i,a){var o=e/t,s=n/r,u=0,l=0;o>s?(l=t,u=l/r*n):(u=e,l=u/n*r);var c=0,f=0,d=0,h=0;return u/l>i?(h=l,d=l*i):(d=u,h=u/i),c=(e-d)/2,f=(t-h)/2,a?{x:c+.1*d,y:f+.1*h,w:.8*d,h:.8*h}:{x:c,y:f,w:d,h:h}}function a(e,t){var n=b.getClientWidth(),r=b.getClientHeight(),a=b.getVideoWidth(),o=b.getVideoHeight(),s=b.getVideoRelativeOffsetTop(),u=b.getVideoRelativeOffsetLeft(),l=a/o,c=!1;e.isFromCEA608&&(l=3.5/3,c=!0);var f=i.call(this,n,r,a,o,l,c),d=f.w,h=f.h,g=f.x,p=f.y;if(d!=L||h!=P||g!=w||p!=O||t){if(w=g+u,O=p+s,L=d,P=h,F){var E=F.style;E.left=w+"px",E.top=O+"px",E.width=L+"px",E.height=P+"px",E.zIndex=U&&document[U]||B?G:null,K.trigger(uu.CAPTION_CONTAINER_RESIZE,{})}var m=e.activeCues;if(m)for(var _=m.length,y=0;y<_;++y){var T=m[y];T.scaleCue(T)}}}function o(e){var t,n,r,i,a,o=L,u=P;if(e.cellResolution){var l=[o/e.cellResolution[0],u/e.cellResolution[1]];if(e.linePadding)for(t in e.linePadding)if(e.linePadding.hasOwnProperty(t)){var c=e.linePadding[t];n=(c*l[0]).toString();for(var f=document.getElementsByClassName("spanPadding"),d=0;d<f.length;d++)f[d].style.cssText=f[d].style.cssText.replace(/(padding-left\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+n),f[d].style.cssText=f[d].style.cssText.replace(/(padding-right\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+n)}if(e.fontSize){for(t in e.fontSize)if(e.fontSize.hasOwnProperty(t)){"%"===e.fontSize[t][0]?r=e.fontSize[t][1]/100:"c"===e.fontSize[t][0]&&(r=e.fontSize[t][1]),n=(r*l[1]).toString(),a="defaultFontSize"!==t?document.getElementsByClassName(t):document.getElementsByClassName("paragraph");for(var h=0;h<a.length;h++)a[h].style.cssText=a[h].style.cssText.replace(/(font-size\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+n)}if(e.lineHeight)for(t in e.lineHeight)if(e.lineHeight.hasOwnProperty(t)){"%"===e.lineHeight[t][0]?i=e.lineHeight[t][1]/100:"c"===e.fontSize[t][0]&&(i=e.lineHeight[t][1]),n=(i*l[1]).toString(),a=document.getElementsByClassName(t);for(var g=0;g<a.length;g++)a[g].style.cssText=a[g].style.cssText.replace(/(line-height\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+n)}}}if(e.isd){var p=document.getElementById(e.cueID);p&&F.removeChild(p),s(e)}}function s(e){if(F){var t=document.createElement("div");F.appendChild(t),k=ef(e.isd,t,function(t){var n=/^(urn:)(mpeg:[a-z0-9][a-z0-9-]{0,31}:)(subs:)([0-9]+)$/,r=/^#(.*)$/;if(n.test(t)){var i=n.exec(t),a=parseInt(i[4],10)-1;return"data:image/png;base64,"+btoa(e.images[a])}if(r.test(t)){var o=r.exec(t),s=o[1];return"data:image/png;base64,"+e.embeddedImages[s]}return null},F.clientHeight,F.clientWidth,!1,function(e){I.info("renderCaption :",e)},k,!0),t.id=e.cueID,K.trigger(uu.CAPTION_RENDERED,{captionDiv:t,currentTrackIdx:N})}}function u(e,t,n){var r=l(e),i=this;if(r&&n&&0!==n.length)for(var a=0;a<n.length;a++){var u=void 0,c=n[a];r.cellResolution=c.cellResolution,r.isFromCEA608=c.isFromCEA608,"html"===c.type&&F?(u=new D(c.start-t,c.end-t,""),u.cueHTMLElement=c.cueHTMLElement,u.isd=c.isd,u.images=c.images,u.embeddedImages=c.embeddedImages,u.cueID=c.cueID,u.scaleCue=o.bind(i),u.cellResolution=c.cellResolution,u.lineHeight=c.lineHeight,u.linePadding=c.linePadding,u.fontSize=c.fontSize,F.style.left=w+"px",F.style.top=O+"px",F.style.width=L+"px",F.style.height=P+"px",u.onenter=function(){r.mode===Ys.TEXT_SHOWING&&(this.isd?(s(this),I.debug("Cue enter id:"+this.cueID)):(F.appendChild(this.cueHTMLElement),o.call(i,this),K.trigger(uu.CAPTION_RENDERED,{captionDiv:this.cueHTMLElement,currentTrackIdx:N})))},u.onexit=function(){if(F)for(var e=F.childNodes,t=0;t<e.length;++t)e[t].id===this.cueID&&(I.debug("Cue exit id:"+e[t].id),F.removeChild(e[t]))}):c.data&&(u=new D(c.start-t,c.end-t,c.data),c.styles&&(void 0!==c.styles.align&&"align"in u&&(u.align=c.styles.align),void 0!==c.styles.line&&"line"in u&&(u.line=c.styles.line),void 0!==c.styles.position&&"position"in u&&(u.position=c.styles.position),void 0!==c.styles.size&&"size"in u&&(u.size=c.styles.size)),u.onenter=function(){r.mode===Ys.TEXT_SHOWING&&K.trigger(uu.CAPTION_RENDERED,{currentTrackIdx:N})});try{u?r.addCue(u):I.error("impossible to display subtitles.")}catch(e){throw g(r),r.addCue(u),e}}}function l(e){return e>=0&&M[e]?b.getTextTrack(M[e].kind,M[e].id,M[e].lang,M[e].isTTML,M[e].isEmbedded):null}function c(){return N}function f(e){for(var t=-1,n=0;n<M.length;n++)if(M[n].id===e){t=n;break}return t}function d(e){if(e!==N){N=e;var t=l(N);h.call(this,t),x&&(clearInterval(x),x=null),t&&"html"===t.renderingType&&(a.call(this,t,!0),x=setInterval(a.bind(this,t),500))}}function h(e){T.call(this),e&&"html"===e.renderingType?_.call(this):y.call(this)}function g(e){if(e.cues)for(var t=e.cues,n=t.length-1,r=n;r>=0;r--)e.removeCue(t[r])}function p(e){var t=l(e);t&&g(t)}function E(){for(var e=C?C.length:0,t=0;t<e;t++){var n=l(t);n&&(g.call(this,n),n.mode="disabled")}C=[],M=[],x&&(clearInterval(x),x=null),N=-1,T.call(this)}function m(e){b.removeChild(C[e]),C.splice(e,1)}function _(){var e=document.getElementById("native-cue-style");if(!e){e=document.createElement("style"),e.id="native-cue-style",document.head.appendChild(e);var t=e.sheet,n=b.getElement();try{n&&(n.id?t.insertRule("#"+n.id+"::cue {background: transparent}",0):0!==n.classList.length?t.insertRule("."+n.className+"::cue {background: transparent}",0):t.insertRule("video::cue {background: transparent}",0))}catch(e){I.info(""+e.message)}}}function y(){var e=document.getElementById("native-cue-style");e&&document.head.removeChild(e)}function T(){if(F)for(;F.firstChild;)F.removeChild(F.firstChild)}function v(e){e&&e.videoModel&&(b=e.videoModel)}function S(e,t){var n=l(e);n&&n.mode!==t&&(n.mode=t)}function A(){return M[N]}var R,I,D,b,M,C,N,w,O,L,P,F,x,U,B,k,G,Y=this.context,K=iu(Y).getInstance();return R={initialize:e,displayCConTop:n,addTextTrack:r,addCaptions:u,getCurrentTrackIdx:c,setCurrentTrackIdx:d,getTrackIdxForId:f,getCurrentTrackInfo:A,setModeForTrackIdx:S,deleteCuesFromTrackIdx:p,deleteAllTextTracks:E,deleteTextTrack:m,setConfig:v},function(){I=Eu(Y).getInstance().getLogger(R)}(),R}function jn(){function e(e){for(var t="",n=0;n<e.length;++n){t+=e[n].uchar}return t.length-t.replace(/^\s+/,"").length}function t(e){return"left: "+3.125*e.x+"%; top: "+6.66*e.y1+"%; width: "+(100-3.125*e.x)+"%; height: "+6.66*Math.max(e.y2-1-e.y1,1)+"%; align-items: flex-start; overflow: visible; -webkit-writing-mode: horizontal-tb;"}function n(e){return"red"===e?"rgb(255, 0, 0)":"green"===e?"rgb(0, 255, 0)":"blue"===e?"rgb(0, 0, 255)":"cyan"===e?"rgb(0, 255, 255)":"magenta"===e?"rgb(255, 0, 255)":"yellow"===e?"rgb(255, 255, 0)":"white"===e?"rgb(255, 255, 255)":"black"===e?"rgb(0, 0, 0)":e}function r(e,t){var r=e.videoHeight/15;return t?"font-size: "+r+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; color: "+(t.foreground?n(t.foreground):"rgb(255, 255, 255)")+"; font-style: "+(t.italics?"italic":"normal")+"; text-decoration: "+(t.underline?"underline":"none")+"; white-space: pre; background-color: "+(t.background?n(t.background):"transparent")+";":"font-size: "+r+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; justify-content: flex-start; text-align: left; color: rgb(255, 255, 255); font-style: normal; white-space: pre; line-height: normal; font-weight: normal; text-decoration: none; width: 100%; display: flex;"}function i(e){return e.replace(/^\s+/g,"")}function a(e){return e.replace(/\s+$/g,"")}function o(n,o,u,l){var c,f,d=null,h=null,g=!1,p=-1,E={start:o,end:u,spans:[]},m="style_cea608_white_black",_={},y={},T=[];for(c=0;c<15;++c){var v=l.rows[c],S="",A=null;if(!1===v.isEmpty()){var R=e(v.chars);null===d&&(d={x:R,y1:c,y2:c+1,p:[]}),R!==p&&g&&(d.p.push(E),E={start:o,end:u,spans:[]},d.y2=c,d.name="region_"+d.x+"_"+d.y1+"_"+d.y2,!1===_.hasOwnProperty(d.name)?(T.push(d),_[d.name]=d):(h=_[d.name],h.p.contat(d.p)),d={x:R,y1:c,y2:c+1,p:[]});for(var I=0;I<v.chars.length;++I){var D=v.chars[I],b=D.penState;if(null===A||!b.equals(A)){S.trim().length>0&&(E.spans.push({name:m,line:S,row:c}),S="");var M="style_cea608_"+b.foreground+"_"+b.background;b.underline&&(M+="_underline"),b.italics&&(M+="_italics"),y.hasOwnProperty(M)||(y[M]=JSON.parse(JSON.stringify(b))),A=b,m=M}S+=D.uchar}S.trim().length>0&&E.spans.push({name:m,line:S,row:c}),g=!0,p=R}else g=!1,p=-1,d&&(d.p.push(E),E={start:o,end:u,spans:[]},d.y2=c,d.name="region_"+d.x+"_"+d.y1+"_"+d.y2,!1===_.hasOwnProperty(d.name)?(T.push(d),_[d.name]=d):(h=_[d.name],h.p.contat(d.p)),d=null)}d&&(d.p.push(E),d.y2=c+1,d.name="region_"+d.x+"_"+d.y1+"_"+d.y2,!1===_.hasOwnProperty(d.name)?(T.push(d),_[d.name]=d):(h=_[d.name],h.p.contat(d.p)),d=null);var C=[];for(c=0;c<T.length;++c){var N=T[c],w="sub_cea608_"+s++,O=document.createElement("div");O.id=w;var L=t(N);O.style.cssText="position: absolute; margin: 0; display: flex; box-sizing: border-box; pointer-events: none;"+L;var P=document.createElement("div");P.className="paragraph bodyStyle",P.style.cssText=r(n);var F=document.createElement("div");F.className="cueUniWrapper",F.style.cssText="unicode-bidi: normal; direction: ltr;";for(var x=0;x<N.p.length;++x){var U=N.p[x],B=0;for(f=0;f<U.spans.length;++f){var k=U.spans[f];if(k.line.length>0){if(0!==f&&B!=k.row){var G=document.createElement("br");G.className="lineBreak",F.appendChild(G)}var Y=!1;B===k.row&&(Y=!0),B=k.row;var K=y[k.name],V=document.createElement("span");V.className="spanPadding "+k.name+" customSpanColor",V.style.cssText=r(n,K),0!==f&&Y?f===U.spans.length-1?V.textContent=a(k.line):V.textContent=k.line:U.spans.length>1&&f<U.spans.length-1&&k.row===U.spans[f+1].row?V.textContent=i(k.line):V.textContent=k.line.trim(),F.appendChild(V)}}}P.appendChild(F),O.appendChild(P);var H={bodyStyle:["%",90]};for(var q in y)y.hasOwnProperty(q)&&(H[q]=["%",90]);C.push({type:"html",start:o,end:u,cueHTMLElement:O,cueID:w,cellResolution:[32,15],isFromCEA608:!0,fontSize:H,lineHeight:{},linePadding:{}})}return C}var s=0;return{createHTMLCaptionsFromScreen:o}}function zn(){function e(){w=null,L=NaN,P=[],U=null,O=!1}function t(){e(),C=[],D=null}function n(e,t){W||s(),N.setConfig({videoModel:F}),N.initialize(),v||(v=zl(j).getInstance()),r(e,t)}function r(e,t){var n=!A.getIsTextTrack(e);if(t){if(C=C.concat(t.getMediaInfoArr()),n){w=t.getFragmentModel(),y.buffered=Wl(j).create(),P=I.getTracksFor(Ys.FRAGMENTED_TEXT,x.getActiveStreamInfo());for(var r=I.getCurrentTrackFor(Ys.FRAGMENTED_TEXT,x.getActiveStreamInfo()),i=0;i<P.length;i++)if(P[i]===r){d(i);break}}for(var a=0;a<C.length;a++)h(null,C[a])}}function i(){N.deleteAllTextTracks(),v=null,C=[],w=null,O=!1,P=[]}function a(){t(),x=null,F=null,N=null}function o(e){var t=e.chunk;t.mediaInfo.embeddedCaptions&&g(t.bytes,t)}function s(){k=[],N=tf(j).getInstance(),N.setConfig({videoModel:F}),N.initialize(),v=zl(j).getInstance(),B=null,G=0,V=[],K=[],Y=null,W=!0,H=af(j).getInstance();var e=x.getActiveStreamProcessors();for(var t in e)if("video"===e[t].getType()){q=e[t].getRepresentationInfo().MSETimeOffset;break}z.on(uu.VIDEO_CHUNK_RECEIVED,o,this)}function u(){z.off(uu.VIDEO_CHUNK_RECEIVED,o,this),N&&N.deleteAllTextTracks(),W=!1,k=[],V=[null,null],K=[],Y=null}function l(e){if(W||s(),e)if(e.id===Ys.CC1||e.id===Ys.CC3){for(var t=0;t<k.length;t++)if(k[t].id===e.id)return;k.push(e)}else T.warn("Embedded track "+e.id+" not supported!")}function c(e){e&&(e.errHandler&&(S=e.errHandler),e.dashManifestModel&&(A=e.dashManifestModel),e.manifestModel&&(R=e.manifestModel),e.mediaController&&(I=e.mediaController),e.videoModel&&(F=e.videoModel),e.streamController&&(x=e.streamController),e.textTracks&&(N=e.textTracks),e.vttParser&&(b=e.vttParser),e.ttmlParser&&(M=e.ttmlParser))}function f(){return{fragmentModel:w,fragmentedTracks:P,videoModel:F}}function d(e){B=e}function h(e,t){var n=new wl,r={subtitle:"subtitles",caption:"captions"};n.captionData=e,n.lang=t.lang,n.labels=t.labels,n.id=t.id?t.id:t.index,n.index=t.index,n.isTTML=function(){var e=!1;return t.codec&&t.codec.search(Ys.STPP)>=0&&(e=!0),t.mimeType&&t.mimeType.search(Ys.TTML)>=0&&(e=!0),e}(),n.defaultTrack=E(t),n.isFragmented=!A.getIsTextTrack(t.mimeType),n.isEmbedded=!!t.isEmbedded,n.kind=function(){var e=t.roles.length>0?r[t.roles[0]]:r.caption;return e=e===r.caption||e===r.subtitle?e:r.caption}(),n.roles=t.roles,n.accessibility=t.accessibility;var i=(C?C.length:0)+k.length;N.addTextTrack(n,i)}function g(e,t){var n,r,i,a,o,s,u,l=t.mediaInfo,c=l.type,f=l.mimeType,d=l.codec||f;if(!d)return void T.error("No text type defined");if(c===Ys.FRAGMENTED_TEXT)if(O)if(s=v.getSamplesInfo(e),r=s.sampleList,null===U&&r.length>0&&(U=r[0].cts-t.start*L),d.search(Ys.STPP)>=0)for(D=null!==D?D:m(d),i=0;i<r.length;i++){var g=r[i],E=g.cts,_=E-U;this.buffered.add(_/L,(_+g.duration)/L);var y=new DataView(e,g.offset,g.subSizes[0]);u=ql.Utils.dataViewToString(y,Ys.UTF8);var A=[],I=g.offset+g.subSizes[0];for(a=1;a<g.subSizes.length;a++){var b=new Uint8Array(e,I,g.subSizes[a]),M=String.fromCharCode.apply(null,b);A.push(M),I+=g.subSizes[a]}try{var C=R.getValue(),P=C.ttmlTimeIsRelative?E/L:0;n=D.parse(u,P,E/L,(E+g.duration)/L,A),N.addCaptions(B,U/L,n)}catch(e){w.removeExecutedRequestsBeforeTime(),this.remove(),T.error("TTML parser error: "+e.message)}}else{var x=[];for(i=0;i<r.length;i++){var q=r[i];q.cts-=U,this.buffered.add(q.cts/L,(q.cts+q.duration)/L);var j=e.slice(q.offset,q.offset+q.size),z=ql.parseBuffer(j);for(a=0;a<z.boxes.length;a++){var W=z.boxes[a];if(T.debug("VTT box1: "+W.type),"vtte"!==W.type&&"vttc"===W.type)for(T.debug("VTT vttc boxes.length = "+W.boxes.length),o=0;o<W.boxes.length;o++){var X=W.boxes[o];if(T.debug("VTT box2: "+X.type),"payl"===X.type){var Q=X.cue_text;T.debug("VTT cue_text = "+Q);var Z=q.cts/L,$=(q.cts+q.duration)/L;x.push({start:Z,end:$,data:Q,styles:{}}),T.debug("VTT "+Z+"-"+$+" : "+Q)}}}}x.length>0&&N.addCaptions(B,0,x)}else O=!0,L=v.getMediaTimescaleFromMoov(e);else if(c===Ys.TEXT){var J=new DataView(e,0,e.byteLength);u=ql.Utils.dataViewToString(J,Ys.UTF8);try{n=m(d).parse(u,0),N.addCaptions(N.getCurrentTrackIdx(),0,n)}catch(e){S.timedTextError(e,"parse",u),S.error(new Fu(lf.TIMED_TEXT_ERROR_ID_PARSE_CODE,lf.TIMED_TEXT_ERROR_MESSAGE_PARSE+e.message,u))}}else if(c===Ys.VIDEO)if(t.segmentType===Cl.INIT_SEGMENT_TYPE){if(0===G)for(G=v.getMediaTimescaleFromMoov(e),i=0;i<k.length;i++)h(null,k[i])}else{if(0===G)return void T.warn("CEA-608: No timescale for embeddedTextTrack yet");s=v.getSamplesInfo(e);var ee=s.lastSequenceNumber;if(!V[0]&&!V[1]){var te,ne;for(i=0;i<k.length;i++){if(k[i].id===Ys.CC1?ne=N.getTrackIdxForId(Ys.CC1):k[i].id===Ys.CC3&&(ne=N.getTrackIdxForId(Ys.CC3)),-1===ne)return void T.warn("CEA-608: data before track is ready.");te=function(e,t){function n(e,n,r){var i=null;if(F.getTTMLRenderingDiv())i=H.createHTMLCaptionsFromScreen(F.getElement(),e,n,r);else{i=[{start:e,end:n,data:r.getDisplayText(),styles:{}}]}i&&N.addCaptions(t,0,i)}return n}(0,ne),V[i]=new of.Cea608Parser(i+1,{newCue:te},null)}}if(G&&-1==K.indexOf(ee)){if(null!==Y&&ee!==Y+s.numSequences)for(i=0;i<V.length;i++)V[i]&&V[i].reset();for(var re=p(e,s.sampleList),ie=0;ie<V.length;ie++){var ae=re.fields[ie],oe=V[ie];if(oe)for(i=0;i<ae.length;i++)oe.addData(ae[i][0]/G,ae[i][1])}Y=ee,K.push(ee)}}}function p(e,t){if(0===t.length)return null;for(var n={splits:[],fields:[[],[]]},r=new DataView(e),i=0;i<t.length;i++)for(var a=t[i],o=of.findCea608Nalus(r,a.offset,a.size),s=null,u=0,l=0;l<o.length;l++)for(var c=of.extractCea608DataFromRange(r,o[l]),f=0;f<2;f++)c[f].length>0&&(a.cts!==s?u=0:u+=1,n.fields[f].push([a.cts+q*G,c[f],u]),s=a.cts);return n.fields.forEach(function(e){e.sort(function(e,t){return e[0]===t[0]?e[2]-t[2]:e[0]-t[0]})}),n}function E(e){var t=!1;return k.length>1&&e.isEmbedded?t=e.id&&e.id===Ys.CC1:1===k.length?e.id&&"string"==typeof e.id&&"CC"===e.id.substring(0,2)&&(t=!0):0===k.length&&(t=e.index===C[0].index),t}function m(e){var t;return e.search(Ys.VTT)>=0?t=b:(e.search(Ys.TTML)>=0||e.search(Ys.STPP)>=0)&&(t=M),t}function _(e,t){void 0===e&&e===t&&(e=this.buffered.start(0),t=this.buffered.end(this.buffered.length-1)),this.buffered.remove(e,t)}var y,T,v,S,A,R,I,D,b,M,C,N,w,O,L,P,F,x,U,B,k,G,Y,K,V,H,q,j=this.context,z=iu(j).getInstance(),W=!1;return y={initialize:n,append:g,abort:i,addEmbeddedTrack:l,resetEmbedded:u,setConfig:c,getConfig:f,setCurrentFragmentedTrackIdx:d,remove:_,reset:a},function(){T=Eu(j).getInstance().getLogger(y),t()}(),y}function Wn(){function e(e){var r,a,c=[];if(!e)return c;e=e.split(s),r=e.length,a=-1;for(var f=0;f<r;f++){var d=e[f];if(d.length>0&&d!==mf&&d.match(u)){var h=n(d),g=h.cuePoints,p=h.styles,E=i(e,f+1),m=t(g[0].replace(l,"")),_=t(g[1].replace(l,""));!isNaN(m)&&!isNaN(_)&&m>=a&&_>m?""!==E?(a=m,c.push({start:m,end:_,data:E,styles:p})):o.error("Skipping cue due to empty/malformed cue text"):o.error("Skipping cue due to incorrect cue timing")}}return c}function t(e){var t=e.split(":"),n=t.length-1;return e=60*parseInt(t[n-1],10)+parseFloat(t[n]),2===n&&(e+=3600*parseInt(t[0],10)),e}function n(e){var t=e.split(u),n=t[1].split(c);return n.shift(),t[1]=n[0],n.shift(),{cuePoints:t,styles:r(n)}}function r(e){var t={};return e.forEach(function(e){if(e.split(/:/).length>1){var n=e.split(/:/)[1];n&&-1!=n.search(/%/)&&(n=parseInt(n.replace(/%/,""),10)),(e.match(/align/)||e.match(/A/))&&(t.align=n),(e.match(/line/)||e.match(/L/))&&(t.line=n),(e.match(/position/)||e.match(/P/))&&(t.position=n),(e.match(/size/)||e.match(/S/))&&(t.size=n)}}),t}function i(e,t){for(var n,r=t,i="",a="";""!==e[r]&&r<e.length;)r++;if((n=r-t)>1)for(var o=0;o<n;o++){if(a=e[t+o],a.match(u)){i="";break}i+=a,o!==n-1&&(i+="\n")}else a=e[t],a.match(u)||(i=a);return i}var a,o,s,u,l,c,f=this.context;return a={parse:e},function(){o=Eu(f).getInstance().getLogger(a),s=/(?:\r\n|\r|\n)/gm,u=/-->/,l=/(^[\s]+|[\s]+$)/g,c=/\s\b/g}(),a}function Xn(){function e(){var e="cue_TTML_"+o;return o++,e}function t(t,n,i,o,s){var u,l,c,f="",d=[],h={},g={},p="",E="",m={onOpenTag:function(e,t,n){if("image"===t&&"http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt"===e){if(!n[" imagetype"]||"PNG"!==n[" imagetype"].value)return void r.warn("smpte-tt imagetype != PNG. Discarded");p=n["http://www.w3.org/XML/1998/namespace id"].value}},
onCloseTag:function(){p&&(g[p]=E.trim()),E="",p=""},onText:function(e){p&&(E+=e)}};if(!t)throw f="no ttml data to parse",new Error(f);h.data=t,a.trigger(uu.TTML_TO_PARSE,h);var _=Jc(h.data,function(e){f=e},m);a.trigger(uu.TTML_PARSED,{ttmlString:h.data,ttmlDoc:_});var y=_.getMediaTimeEvents();for(c=0;c<y.length;c++){var T=$c(_,y[c],function(e){f=e});T.contents.some(function(e){return e.contents.length})&&(u=y[c]+n<i?i:y[c]+n,l=y[c+1]+n>o?o:y[c+1]+n,u<l&&d.push({start:u,end:l,type:"html",cueID:e(),isd:T,images:s,embeddedImages:g}))}if(""!==f)throw r.error(f),new Error(f);return d}var n,r,i=this.context,a=iu(i).getInstance(),o=0;return n={parse:t},function(){r=Eu(i).getInstance().getLogger(n)}(),n}function Qn(){function e(e){e&&(e.errHandler&&(_=e.errHandler),e.dashManifestModel&&(y=e.dashManifestModel),e.manifestModel&&(T=e.manifestModel),e.mediaController&&(v=e.mediaController),e.videoModel&&(S=e.videoModel),e.streamController&&(A=e.streamController),e.textTracks&&(R=e.textTracks),e.vttParser&&(I=e.vttParser),e.ttmlParser&&(b=e.ttmlParser),m.setConfig({errHandler:_,dashManifestModel:y,manifestModel:T,mediaController:v,videoModel:S,streamController:A,textTracks:R,vttParser:I,ttmlParser:b}))}function t(){return m}function n(){return O}function r(e){m.addEmbeddedTrack(e)}function i(e){D(e,"string"),C=e}function a(){return C}function o(e){var t=this,n=e.tracks,r=e.index;n.some(function(e,n){if(e.lang===C)return t.setTextTrack(n),r=n,!0}),w||this.setTextTrack(-1),N=r,M.trigger(uu.TEXT_TRACKS_ADDED,{enabled:c(),index:r,tracks:n})}function s(e){D(e,"boolean"),(w=e)||this.setTextTrack(-1)}function u(){return w}function l(e){D(e,"boolean"),c()!==e&&(e&&this.setTextTrack(N),e||(N=this.getCurrentTrackIdx(),this.setTextTrack(-1)))}function c(){var e=!0;return O&&!L&&(e=!1),e}function f(e){D(e,"boolean"),L=e}function d(e){var t,n,r=m.getConfig(),i=r.fragmentModel,a=r.fragmentedTracks,o=r.videoModel;O=-1===e;var s=R.getCurrentTrackIdx();if(s!==e){R.setModeForTrackIdx(s,Ys.TEXT_HIDDEN),R.setCurrentTrackIdx(e),R.setModeForTrackIdx(e,Ys.TEXT_SHOWING);var u=R.getCurrentTrackInfo();if(u&&u.isFragmented&&!u.isEmbedded)for(var l=0;l<a.length;l++){var c=a[l];if(u.lang===c.lang&&u.index===c.index&&(c.id?u.id===c.id:u.id===c.index)){var f=v.getCurrentTrackFor(Ys.FRAGMENTED_TEXT,A.getActiveStreamInfo());if(c!==f)i.abortRequests(),i.removeExecutedRequestsBeforeTime(),m.remove(),R.deleteCuesFromTrackIdx(s),v.setTrack(c),m.setCurrentFragmentedTrackIdx(l);else if(-1===s){for(var d=A.getActiveStreamProcessors(),h=0;h<d.length;h++)if(d[h].getType()===Ys.FRAGMENTED_TEXT){n=d[h];break}n.getIndexHandler().setCurrentTime(o.getTime()),n.getScheduleController().start()}}}else if(u&&!u.isFragmented){for(var g=A.getActiveStreamProcessors(),p=0;p<g.length;p++)if(g[p].getType()===Ys.TEXT){n=g[p],t=n.getMediaInfoArr();break}if(n&&t)for(var E=0;E<t.length;E++)if(t[E].index===u.index&&t[E].lang===u.lang){n.selectMediaInfo(t[E]);break}}}}function h(){return R.getCurrentTrackIdx()}function g(){O=!1}function p(){g(),m.resetEmbedded(),m.reset()}var E,m,_,y,T,v,S,A,R,I,b,M,C,N,w,O,L,P=this.context;return E={setConfig:e,getTextSourceBuffer:t,getAllTracksAreDisabled:n,addEmbeddedTrack:r,getTextDefaultLanguage:a,setTextDefaultLanguage:i,setTextDefaultEnabled:s,getTextDefaultEnabled:u,enableText:l,isTextEnabled:c,setTextTrack:d,getCurrentTrackIdx:h,enableForcedTextStreaming:f,reset:p},function(){C="",N=-1,w=!0,L=!1,R=tf(P).getInstance(),I=_f(P).getInstance(),b=yf(P).getInstance(),m=cf(P).getInstance(),M=iu(P).getInstance(),R.initialize(),M.on(uu.TEXT_TRACKS_QUEUE_INITIALIZED,o,E),g()}(),E}function Zn(e,t,n,r){function i(t){if(S){if("function"==typeof S.removeEventListener&&(S.removeEventListener("updateend",m,!1),S.removeEventListener("error",_,!1),S.removeEventListener("abort",_,!1)),clearInterval(R),!t){try{S.getClassName&&"TextSourceBuffer"===S.getClassName()||e.removeSourceBuffer(S)}catch(e){v.error("Failed to remove source buffer from media source.")}S=null}A=!1}M=[],C=null}function a(){return S}function o(){try{return S.buffered}catch(e){return v.error("getAllBufferRanges exception: "+e.message),null}}function s(e){try{var t=o();if(t&&t.length>1)for(var n=0,r=t.length;n<r;n++)if(n>0&&e<t.start(n)&&t.start(n)>t.end(n-1)+vf)return!0}catch(e){v.error("hasDiscontinuities exception: "+e.message)}return!1}function u(e){if(!e)return void C({chunk:e,error:new Fu(lf.APPEND_ERROR_CODE,lf.APPEND_ERROR_MESSAGE)});M.push(e),A||y(S,f.bind(this))}function l(e){S.timestampOffset===e||isNaN(e)||y(S,function(){S.timestampOffset=e})}function c(t,n,r){var i=this;y(S,function(){try{t>=0&&n>t&&(r||"ended"!==e.readyState)&&S.remove(t,n),y(S,function(){D.trigger(uu.SOURCEBUFFER_REMOVE_COMPLETED,{buffer:i,from:t,to:n,unintended:!1})})}catch(e){D.trigger(uu.SOURCEBUFFER_REMOVE_COMPLETED,{buffer:i,from:t,to:n,unintended:!1,error:new Fu(e.code,e.message)})}})}function f(){var e=this;if(M.length>0){A=!0;var t=M[0];M.splice(0,1);var n=[],r=function(){var r=o();d(e,n,r,t),M.length>0?f.call(this):(A=!1,C&&C({chunk:t}))};try{0===t.bytes.length?r.call(this):(n=o(),S.appendBuffer?S.appendBuffer(t.bytes):S.append(t.bytes,t),y(S,r.bind(this)))}catch(e){v.fatal('SourceBuffer append failed "'+e+'"'),M.length>0?f():A=!1,C&&C({chunk:t,error:new Fu(e.code,e.message)})}}}function d(e,t,n,r){t&&t.length>0&&t.length<n.length&&h(t,r)&&D.trigger(uu.SOURCEBUFFER_REMOVE_COMPLETED,{buffer:e,from:n.end(n.length-2),to:n.start(n.length-1),unintended:!0})}function h(e,t){for(var n=0;n<e.length;n++){var r=Math.round(e.start(n)),i=Math.round(e.end(n));if(i===t.start||r===t.end||t.start>=r&&t.end<=i)return!0}return!1}function g(){try{"open"===e.readyState?S.abort():S.setTextTrack&&"ended"===e.readyState&&S.abort()}catch(e){v.error('SourceBuffer append abort failed: "'+e+'"')}M=[]}function p(){if(b.length>0){var e=b.shift();S.updating?y(S,e):(e(),p())}}function E(){S.updating||p()}function m(){S.updating||p()}function _(){v.error("SourceBufferSink error",t.type)}function y(e,t){b.push(t),e.updating||p()}var T,v,S,A,R,I=this.context,D=iu(I).getInstance(),b=[],M=[],C=n;return T={getAllBufferRanges:o,getBuffer:a,append:u,remove:c,abort:g,reset:i,updateTimestampOffset:l,hasDiscontinuitiesAfter:s},function(){v=Eu(I).getInstance().getLogger(T),A=!1;var n=t.codec;try{if(n.match(/application\/mp4;\s*codecs="(stpp|wvtt).*"/i))throw new Error("not really supported");if(S=r||e.addSourceBuffer(n),S.changeType&&r&&(v.debug("Doing period transition with changeType"),S.changeType(n)),"function"==typeof S.addEventListener)try{S.addEventListener("updateend",m,!1),S.addEventListener("error",_,!1),S.addEventListener("abort",_,!1)}catch(e){R=setInterval(E,50)}else R=setInterval(E,50)}catch(e){if(!t.isText&&-1===n.indexOf('codecs="stpp')&&-1===n.indexOf('codecs="wvtt'))throw e;var i=Tf(I).getInstance();S=i.getTextSourceBuffer()}}(),T}function $n(e){function t(){g=[],d=null,p=null}function n(e){"InitializationSegment"!==e.segmentType?(g.push(e),g.sort(function(e,t){return e.start-t.start}),d=null):d=e,f.debug("PreBufferSink appended chunk s: "+e.start+"; e: "+e.end),p&&p({chunk:e})}function r(e,t){g=g.filter(function(n){return!((isNaN(t)||n.start<t)&&(isNaN(e)||n.end>e))})}function i(){}function a(){for(var e=[],t=0;t<g.length;t++){var n=g[t];0===e.length||n.start>e[e.length-1].end?e.push({start:n.start,end:n.end}):e[e.length-1].end=n.end}var r={start:function(t){return e[t].start},end:function(t){return e[t].end}};return Object.defineProperty(r,"length",{get:function(){return e.length}}),r}function o(){return!1}function s(){}function u(e,t){var n=l(e,t);return d&&(n.push(d),d=null),r(e,t),n}function l(e,t){return g.filter(function(n){return(isNaN(t)||n.start<t)&&(isNaN(e)||n.end>e)})}var c,f,d,h=this.context,g=[],p=e;return c={getAllBufferRanges:a,append:n,remove:r,abort:i,discharge:u,reset:t,updateTimestampOffset:s,hasDiscontinuitiesAfter:o},function(){f=Eu(h).getInstance().getLogger(c)}(),c}function Jn(e,t,n){var r,i,a;return r=void 0===e?Rf:e,i=function(e){var t=If.DEFAULT;return e!==If.DEFAULT&&e!==If.STRONG&&e!==If.WEAK||(t=e),t}(n),a=void 0===t?null:t,{quality:r,reason:a,priority:i}}function er(e){function t(){if(!s||!s.hasOwnProperty("getReadOnlyMetricsFor"))throw new Error(Ys.MISSING_CONFIG_ERROR)}function n(e){var n=Df(o).create();if(!(e&&e.hasOwnProperty("getMediaInfo")&&e.hasOwnProperty("getMediaType")&&e.hasOwnProperty("useBufferOccupancyABR")&&e.hasOwnProperty("getAbrController")&&e.hasOwnProperty("getScheduleController")))return n;t();var r=e.getMediaInfo(),i=e.getMediaType(),u=s.getReadOnlyMetricsFor(i),l=e.getScheduleController(),c=e.getAbrController(),f=e.getStreamInfo(),d=f&&f.manifestInfo?f.manifestInfo.isDynamic:null,h=c.getThroughputHistory(),g=h.getSafeAverageThroughput(i,d),p=h.getAverageLatency(i),E=u.BufferState.length>0?u.BufferState[u.BufferState.length-1]:null,m=e.useBufferOccupancyABR();return!u||isNaN(g)||!E||m?n:(c.getAbandonmentStateFor(i)!==Jf.ABANDON_LOAD&&(E.state===gd.BUFFER_LOADED||d)&&(n.quality=c.getQualityForBitrate(r,g,p),l.setTimeToLoadDelay(0),a.debug("requesting switch to index: ",n.quality,"type: ",i,"Average throughput",Math.round(g),"kbps"),n.reason={throughput:g,latency:p}),n)}function r(){}e=e||{};var i,a,o=this.context,s=e.metricsModel;return i={getMaxIndex:n,reset:r},function(){a=Eu(o).getInstance().getLogger(i)}(),i}function tr(e){function t(){if(!(h&&h.hasOwnProperty("getReadOnlyMetricsFor")&&g&&g.hasOwnProperty("getCurrentBufferLevel")))throw new Error(Ys.MISSING_CONFIG_ERROR)}function n(e){var n=Df(f).create();if(!e||!e.hasOwnProperty("getMediaType"))return n;t();var i=e.getMediaType(),a=h.getReadOnlyMetricsFor(i),o=a.BufferState.length>0?a.BufferState[a.BufferState.length-1]:null,s=e.getRepresentationInfo(),l=s.fragmentDuration;if(!o||!r(i,o)||!l)return n;if(o.state===gd.BUFFER_EMPTY)u.debug("Switch to index 0; buffer is empty."),n.quality=0,n.reason="InsufficientBufferRule: Buffer is empty";else{var d=e.getMediaInfo(),p=e.getAbrController(),E=p.getThroughputHistory(),m=g.getCurrentBufferLevel(a),_=E.getAverageThroughput(i),y=E.getAverageLatency(i),T=_*(m/l)*c;n.quality=p.getQualityForBitrate(d,T,y),n.reason="InsufficientBufferRule: being conservative to avoid immediate rebuffering"}return n}function r(e,t){l[e]=l[e]||{};var n=!1;return l[e].firstBufferLoadedEvent?n=!0:t&&t.state===gd.BUFFER_LOADED&&(l[e].firstBufferLoadedEvent=!0,n=!0),n}function i(){l={}}function a(){i()}function o(){i(),d.off(uu.PLAYBACK_SEEKING,a,s)}e=e||{};var s,u,l,c=.5,f=this.context,d=iu(f).getInstance(),h=e.metricsModel,g=e.dashMetrics;return s={getMaxIndex:n,reset:o},function(){u=Eu(f).getInstance().getLogger(s),i(),d.on(uu.PLAYBACK_SEEKING,a,s)}(),s}function nr(e){function t(e,t){s[e]=s[e]||{},s[e][t]=s[e][t]||{}}function n(e,t){l[e]=l[e]||[],l[e].push(t)}function r(e){var r=Df(h).create(Df.NO_CHANGE,{name:nr.__dashjs_factory_name});if(!(e&&e.hasOwnProperty("getMediaInfo")&&e.hasOwnProperty("getMediaType")&&e.hasOwnProperty("getCurrentRequest")&&e.hasOwnProperty("getRepresentationInfo")&&e.hasOwnProperty("getAbrController")))return r;var i=e.getMediaInfo(),a=e.getMediaType(),m=e.getCurrentRequest();if(!isNaN(m.index)){t(a,m.index);var _=g.getStableBufferTime();if(E.getCurrentBufferLevel(p.getReadOnlyMetricsFor(a))>_)return r;var y=s[a][m.index];if(null===y||null===m.firstByteDate||u.hasOwnProperty(y.id))return r;if(void 0===y.firstByteTime&&(l[a]=[],y.firstByteTime=m.firstByteDate.getTime(),y.segmentDuration=m.duration,y.bytesTotal=m.bytesTotal,y.id=m.index),y.bytesLoaded=m.bytesLoaded,y.elapsedTime=(new Date).getTime()-y.firstByteTime,y.bytesLoaded>0&&y.elapsedTime>0&&n(a,Math.round(8*y.bytesLoaded/y.elapsedTime)),l[a].length>=d&&y.elapsedTime>f&&y.bytesLoaded<y.bytesTotal){var T=l[a].reduce(function(e,t){return e+t},0);if(y.measuredBandwidthInKbps=Math.round(T/l[a].length),y.estimatedTimeOfDownload=+(8*y.bytesTotal/y.measuredBandwidthInKbps/1e3).toFixed(2),y.estimatedTimeOfDownload<y.segmentDuration*c||0===e.getRepresentationInfo().quality)return r;if(!u.hasOwnProperty(y.id)){var v=e.getAbrController(),S=y.bytesTotal-y.bytesLoaded,A=v.getBitrateList(i),R=v.getQualityForBitrate(i,y.measuredBandwidthInKbps*g.getBandwidthSafetyFactor());S>y.bytesTotal*A[R].bitrate/A[v.getQualityFor(a,i.streamInfo)].bitrate&&(r.quality=R,r.reason.throughput=y.measuredBandwidthInKbps,r.reason.fragmentID=y.id,u[y.id]=y,o.debug("( ",a,"frag id",y.id,") is asking to abandon and switch to quality to ",R," measured bandwidth was",y.measuredBandwidthInKbps),delete s[a][y.id])}}else y.bytesLoaded===y.bytesTotal&&delete s[a][y.id]}return r}function i(){s={},u={},l=[]}e=e||{};var a,o,s,u,l,c=1.8,f=500,d=5,h=this.context,g=e.mediaPlayerModel,p=e.metricsModel,E=e.dashMetrics;return a={shouldAbandon:r,reset:i},function(){o=Eu(h).getInstance().getLogger(a),i()}(),a}function rr(){function e(e){var t=e.getDroppedFramesHistory();if(t){for(var o=t.getFrameHistory(),s=0,u=0,l=Df.NO_CHANGE,c=1;c<o.length;c++)if(o[c]&&(s=o[c].droppedVideoFrames,(u=o[c].totalVideoFrames)>a&&s/u>i)){l=c-1,n.debug("index: "+l+" Dropped Frames: "+s+" Total Frames: "+u);break}return Df(r).create(l,{droppedFrames:s})}return Df(r).create()}var t,n,r=this.context,i=.15,a=375;return t={getMaxIndex:e},function(){n=Eu(r).getInstance().getLogger(t)}(),t}function ir(){function e(e){for(var t=e?e.getSwitchHistory():null,o=t?t.getSwitchRequests():[],s=0,u=0,l=0,c=Df(r).create(),f=0;f<o.length;f++)if(void 0!==o[f]&&(s+=o[f].drops,u+=o[f].noDrops,l+=o[f].dropSize,s+u>=a&&s/u>i)){c.quality=f>0&&o[f].drops>0?f-1:f,c.reason={index:c.quality,drops:s,noDrops:u,dropSize:l},n.debug("Switch history rule index: "+c.quality+" samples: "+(s+u)+" drops: "+s);break}return c}var t,n,r=this.context,i=.075,a=6;return t={getMaxIndex:e},function(){n=Eu(r).getInstance().getLogger(t)}(),t}function ar(e){function t(e){return e.map(function(e){return Math.log(e)})}function n(e,t,n){var r=n.reduce(function(e,t,r){return t>n[e]?r:e},0);if(0===r)return null;var i=Math.max(e,Ff+xf*t.length),a=(n[r]-1)/(i/Ff-1);return{gp:a,Vp:Ff/a}}function r(e){var r={},a=e.getMediaInfo(),o=a.bitrateList.map(function(e){return e.bandwidth}),s=t(o);s=s.map(function(e){return e-s[0]+1});var u=M.getStableBufferTime(),l=n(u,o,s);return l?(r.state=Lf,r.bitrates=o,r.utilities=s,r.stableBufferTime=u,r.Vp=l.Vp,r.gp=l.gp,r.lastQuality=0,i(r)):r.state=Of,r}function i(e){e.placeholderBuffer=0,e.mostAdvancedSegmentStart=NaN,e.lastSegmentWasReplacement=!1,e.lastSegmentStart=NaN,e.lastSegmentDurationS=NaN,e.lastSegmentRequestTimeMs=NaN,e.lastSegmentFinishTimeMs=NaN}function a(e,t){var r=M.getStableBufferTime();if(e.stableBufferTime!==r){var i=n(r,e.bitrates,e.utilities);if(i.Vp!==e.Vp||i.gp!==e.gp){var a=D.getCurrentBufferLevel(b.getReadOnlyMetricsFor(t)),o=a+e.placeholderBuffer;o-=Ff,o*=i.Vp/e.Vp,o+=Ff,e.stableBufferTime=r,e.Vp=i.Vp,e.gp=i.gp,e.placeholderBuffer=Math.max(0,o-a)}}}function o(e){var t=e.getMediaType(),n=R[t];return n?n.state!==Of&&a(n,t):(n=r(e),R[t]=n),n}function s(e,t){for(var n=e.bitrates.length,r=NaN,i=NaN,a=0;a<n;++a){var o=(e.Vp*(e.utilities[a]+e.gp)-t)/e.bitrates[a];(isNaN(i)||o>=i)&&(i=o,r=a)}return r}function u(e,t){return e.Vp*(e.utilities[t]+e.gp)}function l(e,t){for(var n=e.bitrates[t],r=e.utilities[t],i=0,a=t-1;a>=0;--a)if(e.utilities[a]<e.utilities[t]){var o=e.bitrates[a],s=e.utilities[a],u=e.Vp*(e.gp+(n*s-o*r)/(n-o));i=Math.max(i,u)}return i}function c(e,t){var n=Date.now();if(isNaN(e.lastSegmentFinishTimeMs)){if(!isNaN(e.lastCallTimeMs)){var r=.001*(n-e.lastCallTimeMs);e.placeholderBuffer+=Math.max(0,r)}}else{var i=.001*(n-e.lastSegmentFinishTimeMs);e.placeholderBuffer+=Math.max(0,i)}e.lastCallTimeMs=n,e.lastSegmentStart=NaN,e.lastSegmentRequestTimeMs=NaN,e.lastSegmentFinishTimeMs=NaN,a(e,t)}function f(){for(var e in R)R.hasOwnProperty(e)&&R[e].state===Pf&&(R[e].placeholderBuffer=0)}function d(){for(var e in R)if(R.hasOwnProperty(e)){var t=R[e];t.state!==Of&&(t.state=Lf,i(t))}}function h(){}function g(e){if(e&&e.chunk&&e.chunk.mediaInfo){var t=R[e.chunk.mediaInfo.type];if(t&&t.state!==Of){var n=e.chunk.start;isNaN(t.mostAdvancedSegmentStart)||n>t.mostAdvancedSegmentStart?(t.mostAdvancedSegmentStart=n,t.lastSegmentWasReplacement=!1):t.lastSegmentWasReplacement=!0,t.lastSegmentStart=n,t.lastSegmentDurationS=e.chunk.duration,t.lastQuality=e.chunk.quality,E(t,e.chunk.mediaInfo.type)}}}function p(e){if(e&&e.metric===Vs.HTTP_REQUEST&&e.value&&e.value.type===Cl.MEDIA_SEGMENT_TYPE&&e.value.trace&&e.value.trace.length){var t=R[e.mediaType];t&&t.state!==Of&&(t.lastSegmentRequestTimeMs=e.value.trequest.getTime(),t.lastSegmentFinishTimeMs=e.value._tfinish.getTime(),E(t,e.mediaType))}}function E(e,t){if(!isNaN(e.lastSegmentStart)&&!isNaN(e.lastSegmentRequestTimeMs)&&!isNaN(e.placeholderBuffer)){if(e.placeholderBuffer*=Uf,!isNaN(e.lastSegmentFinishTimeMs)){var n=D.getCurrentBufferLevel(b.getReadOnlyMetricsFor(t)),r=n+.001*(e.lastSegmentFinishTimeMs-e.lastSegmentRequestTimeMs),i=u(e,e.lastQuality),a=Math.max(0,i-r);e.placeholderBuffer=Math.min(a,e.placeholderBuffer)}e.lastSegmentWasReplacement&&!isNaN(e.lastSegmentDurationS)&&(e.placeholderBuffer+=e.lastSegmentDurationS),e.lastSegmentStart=NaN,e.lastSegmentRequestTimeMs=NaN}}function m(e){if(e){var t=R[e.mediaType];t&&t.state!==Of&&(t.abrQuality=e.newQuality)}}function _(e){if(e){var t=R[e.mediaType];if(t&&t.state!==Of){var n,r=D.getCurrentBufferLevel(b.getReadOnlyMetricsFor(e.mediaType));n=t.abrQuality>0?l(t,t.abrQuality):Ff;var i=Math.max(0,n-r);t.placeholderBuffer=Math.min(t.placeholderBuffer,i)}}}function y(e){var t=e.getMediaInfo(),n=e.getMediaType(),r=b.getReadOnlyMetricsFor(n),a=e.getScheduleController(),f=e.getStreamInfo(),d=e.getAbrController(),h=d.getThroughputHistory(),g=f?f.id:null,p=f&&f.manifestInfo&&f.manifestInfo.isDynamic,E=e.useBufferOccupancyABR(),m=Df(I).create();if(m.reason=m.reason||{},!E)return m;a.setTimeToLoadDelay(0);var _=o(e);if(_.state===Of)return m;var y,T=D.getCurrentBufferLevel(r),v=h.getAverageThroughput(n,p),S=h.getSafeAverageThroughput(n,p),R=h.getAverageLatency(n);if(m.reason.state=_.state,m.reason.throughput=v,m.reason.latency=R,isNaN(v))return m;switch(_.state){case Lf:y=d.getQualityForBitrate(t,S,R),m.quality=y,m.reason.throughput=S,_.placeholderBuffer=Math.max(0,l(_,y)-T),_.lastQuality=y,!isNaN(_.lastSegmentDurationS)&&T>=_.lastSegmentDurationS&&(_.state=Pf);break;case Pf:c(_,n),y=s(_,T+_.placeholderBuffer);var M=d.getQualityForBitrate(t,S,R);y>_.lastQuality&&y>M&&(y=Math.max(M,_.lastQuality));var C=Math.max(0,T+_.placeholderBuffer-u(_,y));C<=_.placeholderBuffer?(_.placeholderBuffer-=C,C=0):(C-=_.placeholderBuffer,_.placeholderBuffer=0,y<d.getTopQualityIndexFor(n,g)?a.setTimeToLoadDelay(1e3*C):C=0),m.quality=y,m.reason.throughput=v,m.reason.latency=R,m.reason.bufferLevel=T,m.reason.placeholderBuffer=_.placeholderBuffer,m.reason.delay=C,_.lastQuality=y;break;default:A.debug("BOLA ABR rule invoked in bad state."),m.quality=d.getQualityForBitrate(t,S,R),m.reason.state=_.state,m.reason.throughput=S,m.reason.latency=R,_.state=Lf,i(_)}return m}function T(){R={}}function v(){T(),C.off(uu.BUFFER_EMPTY,f,S),C.off(uu.PLAYBACK_SEEKING,d,S),C.off(uu.PERIOD_SWITCH_STARTED,h,S),C.off(uu.MEDIA_FRAGMENT_LOADED,g,S),C.off(uu.METRIC_ADDED,p,S),C.off(uu.QUALITY_CHANGE_REQUESTED,m,S),C.off(uu.FRAGMENT_LOADING_ABANDONED,_,S)}e=e||{};var S,A,R,I=this.context,D=e.dashMetrics,b=e.metricsModel,M=e.mediaPlayerModel,C=iu(I).getInstance();return S={getMaxIndex:y,reset:v},function(){A=Eu(I).getInstance().getLogger(S),T(),C.on(uu.BUFFER_EMPTY,f,S),C.on(uu.PLAYBACK_SEEKING,d,S),C.on(uu.PERIOD_SWITCH_STARTED,h,S),C.on(uu.MEDIA_FRAGMENT_LOADED,g,S),C.on(uu.METRIC_ADDED,p,S),C.on(uu.QUALITY_CHANGE_REQUESTED,m,S),C.on(uu.FRAGMENT_LOADING_ABANDONED,_,S)}(),S}function or(e){function t(){s=[],u=[],c.getUseDefaultABRRules()&&(s.push(Bf(l).create({metricsModel:f,dashMetrics:d,mediaPlayerModel:c})),s.push(bf(l).create({metricsModel:f,dashMetrics:d})),s.push(Mf(l).create({metricsModel:f,dashMetrics:d})),s.push(wf(l).create()),s.push(Nf(l).create()),u.push(Cf(l).create({metricsModel:f,dashMetrics:d,mediaPlayerModel:c}))),c.getABRCustomRules().forEach(function(e){e.type===kf&&s.push(e.rule(l).create()),e.type===Gf&&u.push(e.rule(l).create())})}function n(e){return e.filter(function(e){return e.quality>Df.NO_CHANGE})}function r(e){var t,n,r,i,a,o={};if(0!==e.length){for(o[Df.PRIORITY.STRONG]=Df.NO_CHANGE,o[Df.PRIORITY.WEAK]=Df.NO_CHANGE,o[Df.PRIORITY.DEFAULT]=Df.NO_CHANGE,t=0,n=e.length;t<n;t+=1)r=e[t],r.quality!==Df.NO_CHANGE&&(o[r.priority]=o[r.priority]>Df.NO_CHANGE?Math.min(o[r.priority],r.quality):r.quality);return o[Df.PRIORITY.WEAK]!==Df.NO_CHANGE&&(i=o[Df.PRIORITY.WEAK]),o[Df.PRIORITY.DEFAULT]!==Df.NO_CHANGE&&(i=o[Df.PRIORITY.DEFAULT]),o[Df.PRIORITY.STRONG]!==Df.NO_CHANGE&&(i=o[Df.PRIORITY.STRONG]),i!==Df.NO_CHANGE&&(a=i),Df(l).create(a)}}function i(e){return r(n(s.map(function(t){return t.getMaxIndex(e)})))||Df(l).create()}function a(e){return r(n(u.map(function(t){return t.shouldAbandon(e)})))||Df(l).create()}function o(){[s,u].forEach(function(e){e&&e.length&&e.forEach(function(e){return e.reset&&e.reset()})}),s=[],u=[]}e=e||{};var s,u,l=this.context,c=e.mediaPlayerModel,f=e.metricsModel,d=e.dashMetrics;return{initialize:t,reset:o,getMaxQuality:i,shouldAbandonFragment:a}}function sr(e){function t(){var e=r();return e?e.type:null}function n(){var e=r();return e?e.streamInfo:null}function r(){return m?m.mediaInfo:null}function i(){return m}function a(){return E}function o(){return f}function s(){return d}function u(){return h}function l(){return g}function c(){return p}e=e||{};var f=e.abrController,d=e.switchHistory,h=e.droppedFramesHistory,g=e.currentRequest,p=e.useBufferOccupancyABR,E=e.streamProcessor?e.streamProcessor.getScheduleController():null,m=e.streamProcessor?e.streamProcessor.getRepresentationInfo():null;return{getMediaType:t,getMediaInfo:r,getDroppedFramesHistory:u,getCurrentRequest:l,getSwitchHistory:s,getStreamInfo:n,getScheduleController:a,getAbrController:o,getRepresentationInfo:i,useBufferOccupancyABR:c}}function ur(){function e(e){e.newValue===Df.NO_CHANGE&&(e.newValue=e.oldValue),r[e.oldValue]||(r[e.oldValue]={noDrops:0,drops:0,dropSize:0});var t=e.newValue-e.oldValue,n=t<0?1:0,a=n?-t:0,o=n?0:1;if(r[e.oldValue].drops+=n,r[e.oldValue].dropSize+=a,r[e.oldValue].noDrops+=o,i.push({idx:e.oldValue,noDrop:o,drop:n,dropSize:a}),i.length>Hf){var s=i.shift();r[s.idx].drops-=s.drop,r[s.idx].dropSize-=s.dropSize,r[s.idx].noDrops-=s.noDrop}}function t(){return r}function n(){r=[],i=[]}var r=[],i=[];return{push:e,getSwitchRequests:t,reset:n}}function lr(){function e(e,t){var n=t&&t.droppedVideoFrames?t.droppedVideoFrames:0,o=t&&t.totalVideoFrames?t.totalVideoFrames:0,s=n-i;i=n;var u=o-a;a=o,isNaN(e)||(r[e]?(r[e].droppedVideoFrames+=s,r[e].totalVideoFrames+=u):r[e]={droppedVideoFrames:s,totalVideoFrames:u})}function t(){return r}function n(e){r=[],i=e.droppedVideoFrames,a=e.totalVideoFrames}var r=[],i=0,a=0;return{push:e,getFrameHistory:t,reset:n}}function cr(e){function t(e,t,n){return e===Ys.VIDEO?n<C.getCacheLoadThresholdForType(Ys.VIDEO):e===Ys.AUDIO?n<C.getCacheLoadThresholdForType(Ys.AUDIO):void 0}function n(e,n,i){if(n.trace&&n.trace.length){var a,o=n.tresponse.getTime()-n.trequest.getTime()||1,s=n._tfinish.getTime()-n.tresponse.getTime()||1,u=n.trace.reduce(function(e,t){return e+t.b[0]},0);a=C.getLowLatencyEnabled()?n.trace.reduce(function(e,t){return e+t.d},0):i?s:o+s;var l=Math.round(8*u/a);if(f(e),t(e,o,s)){if(g[e].length>0&&!g[e].hasCachedEntries)return;g[e].hasCachedEntries=!0}else g[e]&&g[e].hasCachedEntries&&d(e);g[e].push(l),g[e].length>y&&g[e].shift(),p[e].push(o),p[e].length>y&&p[e].shift(),r(E[e],l,.001*s,_.throughputHalfLife),r(m[e],o,1,_.latencyHalfLife)}}function r(e,t,n,r){var i=Math.pow(.5,n/r.fast);e.fastEstimate=(1-i)*t+i*e.fastEstimate;var a=Math.pow(.5,n/r.slow);e.slowEstimate=(1-a)*t+a*e.slowEstimate,e.totalWeight+=n}function i(e,t,n){var r,i;if(e?(r=g[t],i=n?T:v):(r=p[t],i=S),r){if(i>=r.length)i=r.length;else if(e)for(var a=1;a<i;++a){var o=r[a]/r[a-1];if((o>=R||o<=1/A)&&(i+=1)===r.length)break}}else i=0;return i}function a(e,t,n){return C.getMovingAverageMethod()!==Ys.MOVING_AVERAGE_SLIDING_WINDOW?s(e,t):o(e,t,n)}function o(e,t,n){var r=i(e,t,n),a=e?g:p,o=a[t];return 0!==r&&o&&0!==o.length?(o=o.slice(-r),o.reduce(function(e,t){return e+t})/o.length):NaN}function s(e,t){var n=e?_.throughputHalfLife:_.latencyHalfLife,r=e?E[t]:m[t];if(!r||r.totalWeight<=0)return NaN;var i=r.fastEstimate/(1-Math.pow(.5,r.totalWeight/n.fast)),a=r.slowEstimate/(1-Math.pow(.5,r.totalWeight/n.slow));return e?Math.min(i,a):Math.max(i,a)}function u(e,t){return a(!0,e,t)}function l(e,t){var n=u(e,t);return isNaN(n)||(n*=C.getBandwidthSafetyFactor()),n}function c(e){return a(!1,e)}function f(e){g[e]=g[e]||[],p[e]=p[e]||[],E[e]=E[e]||{fastEstimate:0,slowEstimate:0,totalWeight:0},m[e]=m[e]||{fastEstimate:0,slowEstimate:0,totalWeight:0}}function d(e){delete g[e],delete p[e],delete E[e],delete m[e],f(e)}function h(){g={},p={},E={},m={}}e=e||{};var g,p,E,m,_,y=20,T=3,v=4,S=4,A=1.3,R=1.3,I=8,D=3,b=2,M=1,C=e.mediaPlayerModel,N={push:n,getAverageThroughput:u,getSafeAverageThroughput:l,getAverageLatency:c,reset:h};return function(){_={throughputHalfLife:{fast:D,slow:I},latencyHalfLife:{fast:M,slow:b}},h()}(),N}function fr(){function e(e,t){Re[e]=qf(we).create(),ce[e]=t,fe[e]=fe[e]||{},fe[e].state=Xf,be[e]=!1,Le.on(uu.LOADING_PROGRESS,ee,this),e==Ys.VIDEO&&(Le.on(uu.QUALITY_CHANGE_RENDERED,s,this),Ie=jf(we).create(),$()),Le.on(uu.METRIC_ADDED,u,this),Le.on(uu.PERIOD_SWITCH_COMPLETED,n,this),De=zf(we).create({mediaPlayerModel:ve})}function t(e){delete ce[e]}function n(){re=Yf(we).create({metricsModel:Me,dashMetrics:Ce,mediaPlayerModel:ve,adapter:ye}),re.initialize()}function r(){ae={video:!0,audio:!0},oe={},se={},ue={},le={},fe={},ce={},Re={},be={},he=!1,Ne=!0,ge=!1,void 0===pe&&(pe=!1),Ae=void 0,Ie=void 0,De=void 0,clearTimeout(de),de=null}function i(){r(),Le.off(uu.LOADING_PROGRESS,ee,this),Le.off(uu.QUALITY_CHANGE_RENDERED,s,this),Le.off(uu.METRIC_ADDED,u,this),Le.off(uu.PERIOD_SWITCH_COMPLETED,n,this),re&&re.reset()}function a(e){e&&(e.streamController&&(ie=e.streamController),e.domStorage&&(Se=e.domStorage),e.mediaPlayerModel&&(ve=e.mediaPlayerModel),e.metricsModel&&(Me=e.metricsModel),e.dashMetrics&&(Ce=e.dashMetrics),e.adapter&&(ye=e.adapter),e.manifestModel&&(_e=e.manifestModel),e.videoModel&&(Te=e.videoModel))}function o(){if(!Se||!Se.hasOwnProperty("getSavedBitrateSettings"))throw new Error(Ys.MISSING_CONFIG_ERROR)}function s(e){e.mediaType===Ys.VIDEO&&(Ae=e.oldQuality,Ie.push(Ae,Te.getPlaybackQuality()))}function u(e){e.metric!==Vs.HTTP_REQUEST||!e.value||e.value.type!==Cl.MEDIA_SEGMENT_TYPE||e.mediaType!==Ys.AUDIO&&e.mediaType!==Ys.VIDEO||De.push(e.mediaType,e.value,Ne),e.metric!==Vs.BUFFER_LEVEL||e.mediaType!==Ys.AUDIO&&e.mediaType!==Ys.VIDEO||Y(e.mediaType,.001*e.value.level)}function l(e,t){var n;return oe[t]=oe[t]||{},oe[t].hasOwnProperty(e)||(oe[t][e]=0),n=X(oe[t][e],e),n=Q(n,e,oe[t][e]),n=J(n,e)}function c(e){if(e&&ce&&ce[e]){var t=ce[e].getStreamInfo();if(t&&t.id){var n=l(e,t.id),r=G(ce[e].getMediaInfo());return r[n]?r[n]:null}}return null}function f(e){o();var t=Se.getSavedBitrateSettings(e);if(!ue.hasOwnProperty(e))if(le.hasOwnProperty(e)){var n=_e.getValue(),r=ye.getAdaptationForType(n,0,e).Representation;if(Array.isArray(r)){var i=Math.max(Math.round(r.length*le[e])-1,0);ue[e]=r[i].bandwidth}else ue[e]=0}else isNaN(t)?ue[e]=e===Ys.VIDEO?Qf:Zf:ue[e]=t;return ue[e]}function d(e,t){C(e),D(t,"number"),ue[e]=t}function h(e){return le.hasOwnProperty(e)?le[e]:null}function g(e,t){le[e]=t}function p(e){return ue.hasOwnProperty("max")&&ue.max.hasOwnProperty(e)?ue.max[e]:NaN}function E(e){return ue.hasOwnProperty("min")&&ue.min.hasOwnProperty(e)?ue.min[e]:NaN}function m(e,t){D(t,"number"),C(e),ue.max=ue.max||{},ue.max[e]=t}function _(e,t){D(t,"number"),C(e),ue.min=ue.min||{},ue.min[e]=t}function y(e){var t=p(e);return t?k(ce[e].getMediaInfo(),t):void 0}function T(e){var t=E(e);if(t){var n=ce[e].getMediaInfo(),r=G(n),i=k(n,t);return r[i]&&i<r.length-1&&r[i].bitrate<1e3*t&&i++,i}}function v(e){return le.hasOwnProperty("max")&&le.max.hasOwnProperty(e)?le.max[e]:1}function S(e,t){le.max=le.max||{},le.max[e]=t}function A(e){return ae[e]}function R(e,t){D(t,"boolean"),C(e),ae[e]=t}function I(){return he}function M(e){D(e,"boolean"),he=e}function N(){return ge}function w(e){D(e,"boolean"),ge=e}function O(){return Ne}function L(e){D(e,"boolean"),Ne=e}function P(e){if(e&&ce&&ce[e]){var t=ce[e].getStreamInfo(),n=t?t.id:null,r=j(e),i=Vf(we).create({abrController:te,streamProcessor:ce[e],currentValue:r,switchHistory:Re[e],droppedFramesHistory:Ie,useBufferOccupancyABR:K(e)});if(Ie){var a=Te.getPlaybackQuality();a&&Ie.push(Ae,a)}if(A(e)){var o=T(e),s=l(e,n),u=re.getMaxQuality(i),c=u.quality;if(void 0!==o&&c<o&&(c=o),c>s&&(c=s),Re[e].push({oldValue:r,newValue:c}),c>Df.NO_CHANGE&&c!=r)(fe[e].state===Xf||c>r)&&x(e,r,c,s,u.reason);else if(Oe.getLogToBrowserConsole()){var f=Ce.getCurrentBufferLevel(Me.getReadOnlyMetricsFor(e));ne.debug("AbrController ("+e+") stay on "+r+"/"+s+" (buffer: "+f+")")}}}}function F(e,t,n,r){var i=t.id,a=j(e);b(n);var o=l(e,i);n!==a&&n>=0&&n<=o&&x(e,a,n,o,r)}function x(e,t,n,r,i){if(e&&ce[e]){var a=ce[e].getStreamInfo(),o=a?a.id:null;if(Oe.getLogToBrowserConsole()){var s=Ce.getCurrentBufferLevel(Me.getReadOnlyMetricsFor(e));ne.info("AbrController ("+e+") switch from "+t+" to "+n+"/"+r+" (buffer: "+s+") "+(i?JSON.stringify(i):"."))}z(e,o,n),Le.trigger(uu.QUALITY_CHANGE_REQUESTED,{mediaType:e,streamInfo:a,oldQuality:t,newQuality:n,reason:i})}}function U(e,t){fe[e].state=t}function B(e){return fe[e]?fe[e].state:null}function k(e,t,n){var r=e&&e.type?ce[e.type].getRepresentationInfo():null;if(Ne&&n&&r&&r.fragmentDuration){n/=1e3;var i=r.fragmentDuration;if(n>i)return 0;t*=1-n/i}for(var a=G(e),o=a.length-1;o>=0;o--){if(1e3*t>=a[o].bitrate)return o}return $f}function G(e){var t=[];if(!e||!e.bitrateList)return t;for(var n,r=e.bitrateList,i=e.type,a=0,o=r.length;a<o;a++)n=new Kf,n.mediaType=i,n.qualityIndex=a,n.bitrate=r[a].bandwidth,n.width=r[a].width,n.height=r[a].height,n.scanType=r[a].scanType,t.push(n);return t}function Y(e,t){var n=ve.getABRStrategy();if(n===Ys.ABR_STRATEGY_BOLA)return void(be[e]=!0);if(n===Ys.ABR_STRATEGY_THROUGHPUT)return void(be[e]=!1);var r=ve.getStableBufferTime(),i=r,a=.5*r,o=be[e],s=t>(o?a:i);be[e]=s,s!==o&&(s?ne.info("AbrController ("+e+") switching from throughput to buffer occupancy ABR rule (buffer: "+t.toFixed(3)+")."):ne.info("AbrController ("+e+") switching from buffer occupancy to throughput ABR rule (buffer: "+t.toFixed(3)+")."))}function K(e){return be[e]}function V(){return De}function H(e){var t=e.type,n=e.streamInfo.id,r=e.representationCount-1;return W(t,n,r),r}function q(e){var t=e?e.id:null,n=j(Ys.AUDIO),r=j(Ys.VIDEO);return n===l(Ys.AUDIO,t)&&r===l(Ys.VIDEO,t)}function j(e){if(e&&ce[e]){var t=ce[e].getStreamInfo(),n=t?t.id:null;if(n)return se[n]=se[n]||{},se[n].hasOwnProperty(e)||(se[n][e]=$f),se[n][e]}return $f}function z(e,t,n){se[t]=se[t]||{},se[t][e]=n}function W(e,t,n){oe[t]=oe[t]||{},oe[t][e]=n}function X(e,t){var n=e;if(!ce[t])return n;var r=T(t);void 0!==r&&(n=Math.max(e,r));var i=y(t);return void 0!==i&&(n=Math.min(n,i)),n}function Q(e,t,n){var r=v(t);return isNaN(r)||r>=1||r<0?e:Math.min(e,Math.round(n*r))}function Z(e){pe=e}function $(){if(Te){var e=ge&&window.hasOwnProperty("devicePixelRatio"),t=e?window.devicePixelRatio:1;Ee=Te.getClientWidth()*t,me=Te.getClientHeight()*t}}function J(e,t){if(t!==Ys.VIDEO||!he||!ce[t])return e;pe||$();var n=_e.getValue(),r=ye.getAdaptationForType(n,0,t).Representation,i=e;if(Ee>0&&me>0){for(;i>0&&r[i]&&Ee<r[i].width&&Ee-r[i-1].width<r[i].width-Ee;)i-=1;r.length-2>=i&&r[i].width===r[i+1].width&&(i=Math.min(e,i+1))}return i}function ee(e){var t=e.request.mediaType;if(A(t)){var n=ce[t];if(!n)return;var r=Vf(we).create({abrController:te,streamProcessor:n,currentRequest:e.request,useBufferOccupancyABR:K(t)
}),i=re.shouldAbandonFragment(r);if(i.quality>Df.NO_CHANGE){var a=n.getFragmentModel();a.getRequests({state:Tu.FRAGMENT_MODEL_LOADING,index:e.request.index})[0]&&(a.abortRequests(),U(t,Wf),Re[t].reset(),Re[t].push({oldValue:j(t,ie.getActiveStreamInfo()),newValue:i.quality,confidence:1,reason:i.reason}),F(t,ie.getActiveStreamInfo(),i.quality,i.reason),clearTimeout(de),de=setTimeout(function(){U(t,Xf),de=null},ve.getAbandonLoadTimeout()))}}}var te,ne,re,ie,ae,oe,se,ue,le,ce,fe,de,he,ge,pe,Ee,me,_e,ye,Te,ve,Se,Ae,Re,Ie,De,be,Me,Ce,Ne,we=this.context,Oe=Eu(we).getInstance(),Le=iu(we).getInstance();return te={isPlayingAtTopQuality:q,updateTopQualityIndex:H,getThroughputHistory:V,getBitrateList:G,getQualityForBitrate:k,getMaxAllowedBitrateFor:p,getTopBitrateInfoFor:c,getMinAllowedBitrateFor:E,setMaxAllowedBitrateFor:m,setMinAllowedBitrateFor:_,getMaxAllowedIndexFor:y,getMinAllowedIndexFor:T,getMaxAllowedRepresentationRatioFor:v,setMaxAllowedRepresentationRatioFor:S,getInitialBitrateFor:f,setInitialBitrateFor:d,getInitialRepresentationRatioFor:h,setInitialRepresentationRatioFor:g,setAutoSwitchBitrateFor:R,getAutoSwitchBitrateFor:A,getUseDeadTimeLatency:O,setUseDeadTimeLatency:L,setLimitBitrateByPortal:M,getLimitBitrateByPortal:I,getUsePixelRatioInLimitBitrateByPortal:N,setUsePixelRatioInLimitBitrateByPortal:w,getQualityFor:j,getAbandonmentStateFor:B,setPlaybackQuality:F,checkPlaybackQuality:P,getTopQualityIndexFor:l,setElementSize:$,setWindowResizeEventCalled:Z,createAbrRulesCollection:n,registerStreamType:e,unRegisterStreamType:t,setConfig:a,reset:i},function(){ne=Oe.getLogger(te),r()}(),te}function dr(){function e(e,t){var r=s(e),i=n(e,t),u=[];if(e===Ys.FRAGMENTED_TEXT)return void a(i[0]);r||(r=M.getSavedMediaSettings(e),o(e,r)),i&&0!==i.length&&(r&&i.forEach(function(e){m(r,e)&&u.push(e)}),a(0===u.length?T(i):u.length>1?T(u):u[0]))}function t(e){if(e){var t=e.type;if(d(t)){var n=e.streamInfo.id;R[n]||(R[n]=v());for(var i=R[n][t].list,o=0,u=i.length;o<u;++o)if(h(i[o],e))return;i.push(e);var l=s(t);l&&m(l,e)&&!r(t,e.streamInfo)&&a(e)}}}function n(e,t){if(!e||!t)return[];var n=t.id;return R[n]&&R[n][e]?R[n][e].list:[]}function r(e,t){return!e||!t||t&&!R[t.id]?null:R[t.id][e].current}function i(e){if(!e)return!1;var t=e.type,n=e.streamInfo.id;return R[n]&&R[n][t]&&h(R[n][t].current,e)}function a(e){if(e&&e.streamInfo){var t=e.type,n=e.streamInfo,i=n.id,a=r(t,n);if(R[i]&&R[i][t]&&!h(e,a)){R[i][t].current=e,R[i][t].current&&N.trigger(uu.CURRENT_TRACK_CHANGED,{oldMediaInfo:a,newMediaInfo:e,switchMode:b[t]});var o=E(e);o&&R[i][t].storeLastSettings&&(o.roles&&(o.role=o.roles[0],delete o.roles),o.accessibility&&(o.accessibility=o.accessibility[0]),o.audioChannelConfiguration&&(o.audioChannelConfiguration=o.audioChannelConfiguration[0]),M.setSavedMediaSettings(t,o))}}}function o(e,t){e&&t&&(I[e]=t)}function s(e){return e?I[e]:null}function u(e,t){if(-1===w.indexOf(t))return void A.warn("Track switch mode is not supported: "+t);b[e]=t}function l(e){return b[e]}function c(e){if(-1===O.indexOf(e))return void A.warn("Track selection mode is not supported: "+e);D=e}function f(){return D||id}function d(e){return e===Ys.AUDIO||e===Ys.VIDEO||e===Ys.TEXT||e===Ys.FRAGMENTED_TEXT||e===Ys.IMAGE}function h(e,t){if(!e&&!t)return!0;if(!e||!t)return!1;var n=e.id===t.id,r=e.viewpoint===t.viewpoint,i=e.lang===t.lang,a=e.roles.toString()===t.roles.toString(),o=e.accessibility.toString()===t.accessibility.toString(),s=e.audioChannelConfiguration.toString()===t.audioChannelConfiguration.toString();return n&&r&&i&&a&&o&&s}function g(e){e&&e.domStorage&&(M=e.domStorage)}function p(){R={},y(),_()}function E(e){var t={lang:e.lang,viewpoint:e.viewpoint,roles:e.roles,accessibility:e.accessibility,audioChannelConfiguration:e.audioChannelConfiguration};return t.lang||t.viewpoint||t.role&&t.role.length>0||t.accessibility&&t.accessibility.length>0||t.audioChannelConfiguration&&t.audioChannelConfiguration.length>0?t:null}function m(e,t){var n=!e.lang||e.lang===t.lang,r=!e.viewpoint||e.viewpoint===t.viewpoint,i=!e.role||!!t.roles.filter(function(t){return t===e.role})[0],a=!e.accessibility||!!t.accessibility.filter(function(t){return t===e.accessibility})[0],o=!e.audioChannelConfiguration||!!t.audioChannelConfiguration.filter(function(t){return t===e.audioChannelConfiguration})[0];return n&&r&&i&&a&&o}function _(){b={audio:td,video:ed}}function y(){I={audio:null,video:null}}function T(e){var t=f(),n=[],r=function(e){var t,n=0,r=[];return e.forEach(function(e){t=Math.max.apply(Math,e.bitrateList.map(function(e){return e.bandwidth})),t>n?(n=t,r=[e]):t===n&&r.push(e)}),r},i=function(e){var t,n=0,r=[];return e.forEach(function(e){t=e.representationCount,t>n?(n=t,r=[e]):t===n&&r.push(e)}),r};switch(t){case nd:n=r(e),n.length>1&&(n=i(n));break;case rd:n=i(e),n.length>1&&(n=r(e));break;default:A.warn("Track selection mode is not supported: "+t)}return n[0]}function v(){return{audio:{list:[],storeLastSettings:!0,current:null},video:{list:[],storeLastSettings:!0,current:null},text:{list:[],storeLastSettings:!0,current:null},fragmentedText:{list:[],storeLastSettings:!0,current:null},image:{list:[],storeLastSettings:!0,current:null}}}var S,A,R,I,D,b,M,C=this.context,N=iu(C).getInstance(),w=[td,ed],O=[nd,rd];return S={checkInitialMediaSettingsForType:e,addTrack:t,getTracksFor:n,getCurrentTrackFor:r,isCurrentTrack:i,setTrack:a,setInitialSettings:o,getInitialSettings:s,setSwitchMode:u,getSwitchMode:l,setSelectionModeForInitialTrack:c,getSelectionModeForInitialTrack:f,isMultiTrackSupportedByType:d,isTracksEqual:h,setConfig:g,reset:p},function(){A=Eu(C).getInstance().getLogger(S),p()}(),S}function hr(){function e(e){var t=e.streamId,n=e.representationId;r[t]=r[t]||{},r[t][n]=e}function t(e,t){return r&&r[e]&&r[e][t]?r[e][t]:null}function n(){r={}}var r={};return{save:e,extract:t,reset:n}}function gr(e){function t(){return hd}function n(e){j(e),ne=Ne.getQualityFor(Oe,Le.getStreamInfo()),Se.on(uu.DATA_UPDATE_COMPLETED,F,this),Se.on(uu.INIT_FRAGMENT_LOADED,o,this),Se.on(uu.MEDIA_FRAGMENT_LOADED,u,this),Se.on(uu.QUALITY_CHANGE_REQUESTED,d,this),Se.on(uu.STREAM_COMPLETED,x,this),Se.on(uu.PLAYBACK_PLAYING,T,this),Se.on(uu.PLAYBACK_PROGRESS,_,this),Se.on(uu.PLAYBACK_TIME_UPDATED,_,this),Se.on(uu.PLAYBACK_RATE_CHANGED,k,this),Se.on(uu.PLAYBACK_SEEKING,h,this),Se.on(uu.PLAYBACK_SEEKED,g,this),Se.on(uu.PLAYBACK_STALLED,y,this),Se.on(uu.WALLCLOCK_TIME_UPDATED,B,this),Se.on(uu.CURRENT_TRACK_CHANGED,U,this,iu.EVENT_PRIORITY_HIGH),Se.on(uu.SOURCEBUFFER_REMOVE_COMPLETED,L,this)}function r(e,t){if(!pe||!e||!Le)return null;if(oe)try{le=t&&t[Oe]?Sf(ve).create(oe,e,f.bind(this),t[Oe]):Sf(ve).create(oe,e,f.bind(this)),"function"==typeof le.getBuffer().initialize&&le.getBuffer().initialize(Oe,Le)}catch(e){te.fatal("Caught error on create SourceBuffer: "+e),Ie.mediaSourceError("Error creating "+Oe+" source buffer."),Ie.error(new Fu(lf.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,lf.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+Oe))}else le=Af(ve).create(f.bind(this));return P(Le.getRepresentationInfo(ne).MSETimeOffset),le}function i(){if(le&&ce&&"function"==typeof ce.discharge){var e=ce.getAllBufferRanges();if(e.length>0){for(var t="Beginning "+Oe+"PreBuffer discharge, adding buffer for:",n=0;n<e.length;n++)t+=" start: "+e.start(n)+", end: "+e.end(n)+";";te.debug(t)}else te.debug("PreBuffer discharge requested, but there were no media segments in the PreBuffer.");for(var r=ce.discharge(),i=null,a=0;a<r.length;a++){var o=r[a],s=pe.extract(o.streamId,o.representationId);s&&(i!==s&&(le.append(s),i=s),le.append(o))}ce.reset(),ce=null}}function a(){return Le&&De&&Le.getStreamInfo()}function o(e){e.fragmentModel===Le.getFragmentModel()&&(te.info("Init fragment finished loading saving to",Oe+"'s init cache"),pe.save(e.chunk),te.debug("Append Init fragment",Oe," with representationId:",e.chunk.representationId," and quality:",e.chunk.quality,", data size:",e.chunk.bytes.byteLength),l(e.chunk))}function s(e,t,n){var r=pe.extract(e,t);ye=!0===n&&n,r?(te.info("Append Init fragment",Oe," with representationId:",r.representationId," and quality:",r.quality,", data size:",r.bytes.byteLength),l(r)):Se.trigger(uu.INIT_REQUESTED,{sender:ee})}function u(e){if(e.fragmentModel===Le.getFragmentModel()){var t=e.chunk,n=t.bytes,r=t.quality,i=Le.getRepresentationInfo(r),a=Me.getEventsFor(i.mediaInfo,Le),o=Me.getEventsFor(i,Le);if(a&&a.length>0||o&&o.length>0){var s=Le.getFragmentModel().getRequests({state:Tu.FRAGMENT_MODEL_EXECUTED,quality:r,index:t.index})[0],u=M(n,s,a,o);Le.addInbandEvents(u)}if(ye){Te=t;var c=le&&le.getAllBufferRanges();c&&c.length>0&&we.getTimeToStreamEnd()>ld&&(te.debug("Clearing buffer because track changed - "+(c.end(c.length-1)+cd)),w([{start:0,end:c.end(c.length-1)+cd,force:!0}]))}else l(t)}}function l(e){le.append(e),e.mediaInfo.type===Ys.VIDEO&&Se.trigger(uu.VIDEO_CHUNK_RECEIVED,{chunk:e})}function c(e){if(e&&e.length>0)for(var t=0,n=e.length;t<n;t++)te.debug("Buffered Range for type:",Oe,":",e.start(t)," - ",e.end(t)," currentTime = ",we.getTime())}function f(e){if(e.error){if(e.error.code===dd&&(ae=.8*Q(),te.warn("Quota exceeded for type: "+Oe+", Critical Buffer: "+ae),ae>0)){var t=Math.max(.2*ae,1),n=ae-t;Re.setBufferToKeep(parseFloat(t.toFixed(5))),Re.setBufferAheadToKeep(parseFloat(n.toFixed(5)))}return void(e.error.code!==dd&&Z()||(te.warn("Clearing playback buffer to overcome quota exceed situation for type: "+Oe),Se.trigger(uu.QUOTA_EXCEEDED,{sender:ee,criticalBufferLevel:ae}),p()))}(de=e.chunk)&&!isNaN(de.index)&&(se=Math.max(de.index,se),I());var r=le.getAllBufferRanges();if(de.segmentType===Cl.MEDIA_SEGMENT_TYPE)c(r),_();else if(ye){var i=we.getTime();te.debug("AppendToBuffer seek target should be "+i),Le.getScheduleController().setSeekTarget(i),Me.setIndexHandlerTime(Le,i)}var a={sender:ee,quality:de.quality,startTime:de.start,index:de.index,bufferedRanges:r};de&&!de.endFragment?Se.trigger(uu.BYTES_APPENDED,a):de&&Se.trigger(uu.BYTES_APPENDED_END_FRAGMENT,a)}function d(e){ne!==e.newQuality&&Oe===e.mediaType&&Le.getStreamInfo().id===e.streamInfo.id&&(P(Le.getRepresentationInfo(e.newQuality).MSETimeOffset),ne=e.newQuality)}function h(){re&&(me=!0,re=!1,ue=Number.POSITIVE_INFINITY),Oe!==Ys.FRAGMENTED_TEXT?p():_()}function g(){Ee=void 0}function p(){var e=E();e&&0!==e.length||_(),w(e)}function E(){var e=[],t=le.getAllBufferRanges();if(!t||0===t.length)return e;var n=we.getTime(),r=t.end(t.length-1)+cd,i=Le.getFragmentModel().getRequests({state:Tu.FRAGMENT_MODEL_EXECUTED,time:n,threshold:fd})[0];if(i){var a={start:0,end:i.startTime-ld},o=Le.getFragmentModel().getRequests({state:Tu.FRAGMENT_MODEL_EXECUTED,time:i.startTime-i.duration/2,threshold:fd})[0];o&&o.startTime!=i.startTime&&(a.end=o.startTime),a.start<a.end&&a.end>t.start(0)&&e.push(a);var s={start:i.startTime+i.duration+ld,end:r},u=Le.getFragmentModel().getRequests({state:Tu.FRAGMENT_MODEL_EXECUTED,time:i.startTime+i.duration+ld,threshold:fd})[0];u&&u.startTime!==i.startTime&&(s.start=u.startTime+u.duration+ld),s.start<s.end&&s.start<r&&e.push(s)}else te.debug("getAllRangesWithSafetyFactor for",Oe,"- No request found in current time position, removing full buffer 0 -",r),e.push({start:0,end:r});return e}function m(){var e=we.getTime();if(Ee){var t=le.getAllBufferRanges();t&&t.length&&(e=Math.max(t.start(0),Ee))}return e}function _(){(!ye||Oe===Ys.FRAGMENTED_TEXT&&Ce.isTextEnabled())&&(A(),R())}function y(){D()}function T(){D()}function v(e,t){var n,r,i=le.getAllBufferRanges(),a=0,o=0,s=null,u=null,l=0,c=t||.15;if(null!==i&&void 0!==i){for(r=0,n=i.length;r<n;r++)if(a=i.start(r),o=i.end(r),null===s)l=Math.abs(a-e),e>=a&&e<o?(s=a,u=o):l<=c&&(s=a,u=o);else{if(!((l=a-u)<=c))break;u=o}if(null!==s)return{start:s,end:u}}return null}function S(e,t){var n;return n=v(e,t),null===n?0:n.end-e}function A(){we&&(ie=S(m()||0),Se.trigger(uu.BUFFER_LEVEL_UPDATED,{sender:ee,bufferLevel:ie}),D())}function R(){a()&&(Ae.addBufferState(Oe,fe,Le.getScheduleController().getBufferTarget()),Ae.addBufferLevel(Oe,new Date,1e3*ie))}function I(){se>=ue-1&&!re&&void 0===le.discharge&&(re=!0,te.debug("checkIfBufferingCompleted trigger BUFFERING_COMPLETED"),Se.trigger(uu.BUFFERING_COMPLETED,{sender:ee,streamInfo:Le.getStreamInfo()}))}function D(){"audio"!==Oe&&"video"!==Oe||(me&&!re&&we&&we.getTimeToStreamEnd()-ie<ld&&(me=!1,re=!0,te.debug("checkIfSufficientBuffer trigger BUFFERING_COMPLETED"),Se.trigger(uu.BUFFERING_COMPLETED,{sender:ee,streamInfo:Le.getStreamInfo()})),(!Re.getLowLatencyEnabled()&&ie<ld||0===ie)&&!re?b(ud):(re||ie>=Re.getStableBufferTime())&&b(sd))}function b(e){fe===e||e===ud&&0===we.getTime()||Oe===Ys.FRAGMENTED_TEXT&&!Ce.isTextEnabled()||(fe=e,R(),Se.trigger(uu.BUFFER_LEVEL_STATE_CHANGED,{sender:ee,state:e,mediaType:Oe,streamInfo:Le.getStreamInfo()}),Se.trigger(e===sd?uu.BUFFER_LOADED:uu.BUFFER_EMPTY,{mediaType:Oe}),te.debug(e===sd?"Got enough buffer to start for "+Oe:"Waiting for more buffer before starting playback for "+Oe))}function M(e,t,n,r){for(var i=Math.max(!t||isNaN(t.startTime)?0:t.startTime,0),a=[],o=[],s=n.concat(r),u=0,l=s.length;u<l;u++)a[s[u].schemeIdUri+"/"+s[u].value]=s[u];for(var c=zl(ve).getInstance().parse(e),f=c.getBoxes("emsg"),d=0,h=f.length;d<h;d++){var g=Me.getEvent(f[d],a,i);g&&o.push(g)}return o}function C(){le&&Oe!==Ys.FRAGMENTED_TEXT&&(re||w(N()))}function N(){var e=[],t=le.getAllBufferRanges();if(!t||0===t.length)return e;var n=we.getTime(),r={start:Math.max(0,n-Re.getBufferToKeep()),end:n+Re.getBufferAheadToKeep()},i=Le.getFragmentModel().getRequests({state:Tu.FRAGMENT_MODEL_EXECUTED,time:n,threshold:fd})[0];if(i)r.start=Math.min(i.startTime,r.start),r.end=Math.max(i.startTime+i.duration,r.end);else if(0===n&&we.getIsDynamic())return[];if(t.start(0)<=r.start){for(var a={start:0,end:r.start},o=0;o<t.length&&t.end(o)<=r.start;o++)a.end=t.end(o);a.start<a.end&&e.push(a)}if(t.end(t.length-1)>=r.end){var s={start:r.end,end:t.end(t.length-1)+fd};s.start<s.end&&e.push(s)}return e}function w(e){e&&le&&0!==e.length&&(_e.push.apply(_e,e),ge||O())}function O(){if(0===_e.length||!le)return te.debug("Nothing to prune, halt pruning"),_e=[],void(ge=!1);var e=le.getBuffer();if(!e||!e.buffered||0===e.buffered.length)return te.debug("SourceBuffer is empty (or does not exist), halt pruning"),_e=[],void(ge=!1);var t=_e.shift();te.debug("Removing",Oe,"buffer from:",t.start,"to",t.end),ge=!0;var n=we.getTime();n<t.end&&(re=!1,se=0,ye||(Le.getScheduleController().setSeekTarget(n),Me.setIndexHandlerTime(Le,n))),le.remove(t.start,t.end,t.force)}function L(e){if(le===e.buffer){te.debug("onRemoved buffer from:",e.from,"to",e.to);c(le.getAllBufferRanges()),0===_e.length&&(ge=!1),e.unintended&&(te.warn("Detected unintended removal from:",e.from,"to",e.to,"setting index handler time to",e.from),Me.setIndexHandlerTime(Le,e.from)),ge?O():(ye?(ye=!1,Te&&l(Te)):(te.debug("onRemoved : call updateBufferLevel"),A()),Se.trigger(uu.BUFFER_CLEARED,{sender:ee,from:e.from,to:e.to,unintended:e.unintended,hasEnoughSpaceToAppend:Z()}))}}function P(e){le&&le.updateTimestampOffset&&le.updateTimestampOffset(e)}function F(e){e.sender.getStreamProcessor()!==Le||e.error||P(e.currentRepresentation.MSETimeOffset)}function x(e){e.fragmentModel===Le.getFragmentModel()&&(ue=e.request.index,I())}function U(e){var t=le&&le.getAllBufferRanges();t&&e.newMediaInfo.type===Oe&&e.newMediaInfo.streamInfo.id===Le.getStreamInfo().id&&(te.info("Track change asked"),be.getSwitchMode(Oe)===ad.TRACK_SWITCH_MODE_ALWAYS_REPLACE&&t&&t.length>0&&we.getTimeToStreamEnd()>ld&&(re=!1,ue=Number.POSITIVE_INFINITY))}function B(){++he*(Re.getWallclockTimeUpdateInterval()/1e3)>=Re.getBufferPruningInterval()&&(he=0,C())}function k(){D()}function G(){return Oe}function Y(){return Le}function K(e){Ee=e}function V(){return le}function H(e){le=e}function q(){return ie}function j(e,t){oe=e,le&&t&&"function"==typeof le.discharge&&(ce=le,r(t))}function z(){return oe}function W(){return re}function X(){return ge}function Q(){var e,t,n=le.getAllBufferRanges(),r=0;if(!n)return r;for(t=0,e=n.length;t<e;t++)r+=n.end(t)-n.start(t);return r}function Z(){return Q()<ae}function $(e,t){ae=Number.POSITIVE_INFINITY,fe=void 0,ne=Jf.QUALITY_DEFAULT,ue=Number.POSITIVE_INFINITY,se=0,de=null,re=!1,ge=!1,me=!1,ie=0,he=0,_e=[],le&&(e||le.abort(),le.reset(t),le=null),ye=!1}function J(e,t){Se.off(uu.DATA_UPDATE_COMPLETED,F,this),Se.off(uu.QUALITY_CHANGE_REQUESTED,d,this),Se.off(uu.INIT_FRAGMENT_LOADED,o,this),Se.off(uu.MEDIA_FRAGMENT_LOADED,u,this),Se.off(uu.STREAM_COMPLETED,x,this),Se.off(uu.CURRENT_TRACK_CHANGED,U,this),Se.off(uu.PLAYBACK_PLAYING,T,this),Se.off(uu.PLAYBACK_PROGRESS,_,this),Se.off(uu.PLAYBACK_TIME_UPDATED,_,this),Se.off(uu.PLAYBACK_RATE_CHANGED,k,this),Se.off(uu.PLAYBACK_SEEKING,h,this),Se.off(uu.PLAYBACK_SEEKED,g,this),Se.off(uu.PLAYBACK_STALLED,y,this),Se.off(uu.WALLCLOCK_TIME_UPDATED,B,this),Se.off(uu.SOURCEBUFFER_REMOVE_COMPLETED,L,this),$(e,t)}e=e||{};var ee,te,ne,re,ie,ae,oe,se,ue,le,ce,fe,de,he,ge,pe,Ee,me,_e,ye,Te,ve=this.context,Se=iu(ve).getInstance(),Ae=e.metricsModel,Re=e.mediaPlayerModel,Ie=e.errHandler,De=e.streamController,be=e.mediaController,Me=e.adapter,Ce=e.textController,Ne=e.abrController,we=e.playbackController,Oe=e.type,Le=e.streamProcessor;return ee={getBufferControllerType:t,initialize:n,createBuffer:r,dischargePreBuffer:i,getType:G,getStreamProcessor:Y,setSeekStartTime:K,getBuffer:V,setBuffer:H,getBufferLevel:q,getRangeAt:v,setMediaSource:j,getMediaSource:z,getIsBufferingCompleted:W,switchInitData:s,getIsPruningInProgress:X,reset:J},function(){te=Eu(ve).getInstance().getLogger(ee),pe=od(ve).getInstance(),$()}(),ee}function pr(){function e(e,n){Te=e,re(),ve=Te.manifestInfo.isDynamic,be=!1,Me=!1,pe=Te.start,De=n;var r="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"",a=/safari/.test(r)&&!/chrome/.test(r);Ce=a?.25:.02,Oe.on(uu.DATA_UPDATE_COMPLETED,N,this),Oe.on(uu.BYTES_APPENDED_END_FRAGMENT,J,this),Oe.on(uu.LOADING_PROGRESS,ee,this),Oe.on(uu.BUFFER_LEVEL_STATE_CHANGED,te,this),Oe.on(uu.PERIOD_SWITCH_STARTED,t,this),Oe.on(uu.PLAYBACK_PROGRESS,W,this),Oe.on(uu.PLAYBACK_TIME_UPDATED,W,this),Oe.on(uu.PLAYBACK_ENDED,H,this),Ae&&(Ae=!1,i())}function t(e){!ve&&e.fromStreamInfo&&void 0!==me[e.fromStreamInfo.id]&&(delete ye[e.fromStreamInfo.id],delete me[e.fromStreamInfo.id])}function n(){return parseFloat((r()-c()).toFixed(5))}function r(){var e=I(!0),t=ve&&Te?e-Te.start:0;return e+(Te?Te.duration-t:t)}function i(){Te&&he&&he.getElement()?he.play():Ae=!0}function a(){return Te&&he?he.isPaused():null}function o(){Te&&he&&he.pause()}function s(){return Te&&he?he.isSeeking():null}function u(e,t,n){Te&&he&&(!0===n?e!==he.getTime()&&(he.removeEventListener("seeking",x),oe.info("Requesting seek to time: "+e),he.setCurrentTime(e,t)):(Oe.trigger(uu.PLAYBACK_SEEK_ASKED),oe.info("Requesting seek to time: "+e),he.setCurrentTime(e,t)))}function l(){var e=ue.getReadOnlyMetricsFor(Ys.VIDEO)||ue.getReadOnlyMetricsFor(Ys.AUDIO),t=le.getCurrentDVRInfo(e);u((t?t.range:null).end-Se.getLiveDelay(),!0,!1)}function c(){return Te&&he?he.getTime():null}function f(){var e=c();if(ve&&!isNaN(Ie)){var t=Ie/1e3;e>t&&(e-=t)}return e}function d(){return Te&&he?he.getPlaybackRate():null}function h(){return Te&&he?he.getPlayedRanges():null}function g(){return Te&&he?he.getEnded():null}function p(){return ve}function E(){return se}function m(e){pe=e}function _(){return pe}function y(e,t){var n,r,i=fe.getMpd(ce.getValue());if(n=Se.getUseSuggestedPresentationDelay()&&i.hasOwnProperty(Ys.SUGGESTED_PRESENTATION_DELAY)?i.suggestedPresentationDelay:Se.getLowLatencyEnabled()?0:Se.getLiveDelay()?Se.getLiveDelay():isNaN(e)?2*Te.manifestInfo.minBufferTime:e*Se.getLiveDelayFragmentCount(),i.availabilityStartTime&&(Ie=i.availabilityStartTime.getTime()),t>0){var a=Math.max(t-10,t/2);r=Math.min(n,a)}else r=n;return _e=r,r}function T(){return _e}function v(){if(!ve||isNaN(Ie))return NaN;var e=f();if(isNaN(e)||0===e)return 0;var t=(new Date).getTime()+1e3*ge.getClientTimeOffset();return Math.max(((t-Ie-1e3*e)/1e3).toFixed(3),0)}function S(){pe=NaN,Ae=!1,me={},_e=0,Ie=0,ye={},he&&(Oe.off(uu.DATA_UPDATE_COMPLETED,N,this),Oe.off(uu.BUFFER_LEVEL_STATE_CHANGED,te,this),Oe.off(uu.BYTES_APPENDED_END_FRAGMENT,J,this),Oe.off(uu.LOADING_PROGRESS,ee,this),Oe.off(uu.PERIOD_SWITCH_STARTED,t,this),Oe.off(uu.PLAYBACK_PROGRESS,W,this),Oe.off(uu.PLAYBACK_TIME_UPDATED,W,this),Oe.off(uu.PLAYBACK_ENDED,H,this),M(),ie()),Ee=null,he=null,Te=null,ve=null}function A(e){e&&(e.streamController&&(se=e.streamController),e.metricsModel&&(ue=e.metricsModel),e.dashMetrics&&(le=e.dashMetrics),e.manifestModel&&(ce=e.manifestModel),e.dashManifestModel&&(fe=e.dashManifestModel),e.mediaPlayerModel&&(Se=e.mediaPlayerModel),e.adapter&&(de=e.adapter),e.videoModel&&(he=e.videoModel),e.timelineConverter&&(ge=e.timelineConverter),e.uriFragmentModel&&(Ne=e.uriFragmentModel))}function R(){var e,t=Ne.getURIFragmentData();if(t){e={};var n=parseInt(t.r,10);n>=0&&Te&&n<Te.manifestInfo.DVRWindowSize&&null===t.t&&(t.t=Math.max(Math.floor(Date.now()/1e3)-Te.manifestInfo.DVRWindowSize,Te.manifestInfo.availableFrom.getTime()/1e3+Te.start)+n),e.fragS=parseFloat(t.s),e.fragT=parseFloat(t.t)}return e}function I(e,t){var n,r=NaN;if(e)r=Te?Te.start:r;else{var i=R();r=i?isNaN(i.fragS)?i.fragT:i.fragS:0}if(ve)!isNaN(r)&&Te&&((n=r-Te.manifestInfo.availableFrom.getTime()/1e3)>pe||n<(isNaN(t)?NaN:t-Te.manifestInfo.DVRWindowSize))&&(n=null),n=n||pe;else if(Te)if(!isNaN(r)&&r<Math.max(Te.manifestInfo.duration,Te.duration)&&r>=0)n=r;else{var a=me[Te.id];n=void 0!==a?Math.max(void 0!==a.audio?a.audio:0,void 0!==a.video?a.video:0,Te.start):Te.start}return n}function D(e){var t,n=ue.getReadOnlyMetricsFor(Ys.VIDEO)||ue.getReadOnlyMetricsFor(Ys.AUDIO),r=le.getCurrentDVRInfo(n),i=r?r.range:null;if(!i)return NaN;if(e>i.end)t=Math.max(i.end-2*Te.manifestInfo.minBufferTime,i.start);else{if(!(e+.25<i.start))return e;t=i.start}return t}function b(){if(null===Ee){var e=function(){j()};Ee=setInterval(e,Se.getWallclockTimeUpdateInterval())}}function M(){clearInterval(Ee),Ee=null}function C(){if(!a()&&ve&&0!==he.getReadyState()){var e=f(),t=D(e);!isNaN(t)&&t!==e&&u(t)}}function N(e){if(!e.error){var t=de.convertDataToRepresentationInfo(e.currentRepresentation),n=t.mediaInfo.streamInfo;Te.id===n.id&&(Te=n,C())}}function w(){Oe.trigger(uu.CAN_PLAY)}function O(){oe.info("Native video element event: play"),C(),b(),Oe.trigger(uu.PLAYBACK_STARTED,{startTime:c()})}function L(){oe.info("Native video element event: waiting"),Oe.trigger(uu.PLAYBACK_WAITING,{playingTime:c()})}function P(){oe.info("Native video element event: playing"),Oe.trigger(uu.PLAYBACK_PLAYING,{playingTime:c()})}function F(){oe.info("Native video element event: pause"),Oe.trigger(uu.PLAYBACK_PAUSED,{ended:g()})}function x(){var e=c();oe.info("Seeking to: "+e),b(),Oe.trigger(uu.PLAYBACK_SEEKING,{seekTime:e})}function U(){oe.info("Native video element event: seeked"),Oe.trigger(uu.PLAYBACK_SEEKED),he.addEventListener("seeking",x)}function B(){Te&&Oe.trigger(uu.PLAYBACK_TIME_UPDATED,{timeToEnd:n(),time:c()})}function k(){var e=Date.now();(!Re||e>Re+pd)&&(Re=e,B())}function G(){Oe.trigger(uu.PLAYBACK_PROGRESS)}function Y(){var e=d();oe.info("Native video element event: ratechange: ",e),Oe.trigger(uu.PLAYBACK_RATE_CHANGED,{playbackRate:e})}function K(){oe.info("Native video element event: loadedmetadata"),Oe.trigger(uu.PLAYBACK_METADATA_LOADED),b()}function V(){oe.info("Native video element event: ended"),o(),M(),Oe.trigger(uu.PLAYBACK_ENDED,{isLast:se.getActiveStreamInfo().isLast})}function H(e){Ee&&e.isLast&&(oe.info("onPlaybackEnded -- PLAYBACK_ENDED but native video element didn't fire ended"),he.setCurrentTime(r()),o(),M())}function q(e){var t=e.target||e.srcElement;Oe.trigger(uu.PLAYBACK_ERROR,{error:t.error})}function j(){Oe.trigger(uu.WALLCLOCK_TIME_UPDATED,{isDynamic:ve,time:new Date}),p()&&a()&&k()}function z(e,t){if(t&&t.length>0)for(var n=0,r=t.length;n<r;n++)if(e>=t.start(n)&&e<t.end(n))return!0;return!1}function W(){ve&&Se.getLowLatencyEnabled()&&Se.getCatchUpPlaybackRate()>0&&!a()&&!s()&&(Q()?Z():$())}function X(){var e=null;return se.getActiveStreamProcessors().forEach(function(t){var n=t.getBufferLevel();e=null===e?n:Math.min(e,n)}),e}function Q(){return Se.getCatchUpPlaybackRate()>0&&c()>0&&Math.abs(v()-Se.getLiveDelay())>Se.getLowLatencyMinDrift()}function Z(){if(he){var e=Se.getCatchUpPlaybackRate(),t=Se.getLiveDelay(),n=v()-t,r=5*n,i=2*e/(1+Math.pow(Math.E,-r)),a=1-e+i;if(Me){X()>t/2?Me=!1:n>0&&(a=1)}Math.abs(he.getPlaybackRate()-a)>Ce&&he.setPlaybackRate(a),Se.getLowLatencyMaxDriftBeforeSeeking()>0&&!be&&n>Se.getLowLatencyMaxDriftBeforeSeeking()?(oe.info("Low Latency catchup mechanism. Latency too high, doing a seek to live point"),be=!0,l()):be=!1}}function $(){he&&he.setPlaybackRate(1)}function J(e){var t,n,r=e.bufferedRanges;if(r&&r.length&&(!me[Te.id]||!0!==me[Te.id].started)){var i=e.sender.getType();void 0===ye[Te.id]&&(ye[Te.id]=[]),ye[Te.id][i]=r,void 0===me[Te.id]&&(me[Te.id]=[],me[Te.id].started=!1),void 0===me[Te.id][i]&&(me[Te.id][i]=Math.max(r.start(0),Te.start));var a=se.isTrackTypePresent(Ys.VIDEO),o=se.isTrackTypePresent(Ys.AUDIO);n=I(!1),o&&a?isNaN(me[Te.id].audio)||isNaN(me[Te.id].video)||(me[Te.id].audio<me[Te.id].video?(t=me[Te.id].video>n?me[Te.id].video:n,r=ye[Te.id].audio):(t=me[Te.id].audio>n?me[Te.id].audio:n,r=ye[Te.id].video),z(t,r)&&(s()||De||0===t||u(t,!0,!0),me[Te.id].started=!0)):me[Te.id][i]&&(t=me[Te.id][i]>n?me[Te.id][i]:n,s()||De||u(t,!1,!0),me[Te.id].started=!0)}}function ee(e){if(!1===e.stream&&Se.getLowLatencyEnabled()&&!isNaN(e.request.duration)){var t=1.2*e.request.duration;t>Se.getLiveDelay()&&(oe.warn("Browser does not support fetch API with StreamReader. Increasing live delay to be 20% higher than segment duration:",t.toFixed(2)),Se.setLiveDelay(t))}}function te(e){e.streamInfo.id===Te.id&&(Se.getLowLatencyEnabled()?e.state!==gd.BUFFER_EMPTY||s()||Me||(Me=!0,$()):he.setStallState(e.mediaType,e.state===gd.BUFFER_EMPTY))}function ne(e){Oe.trigger(uu.PLAYBACK_STALLED,{e:e})}function re(){he.addEventListener("canplay",w),he.addEventListener("play",O),he.addEventListener("waiting",L),he.addEventListener("playing",P),he.addEventListener("pause",F),he.addEventListener("error",q),he.addEventListener("seeking",x),he.addEventListener("seeked",U),he.addEventListener("timeupdate",B),he.addEventListener("progress",G),he.addEventListener("ratechange",Y),he.addEventListener("loadedmetadata",K),he.addEventListener("stalled",ne),he.addEventListener("ended",V)}function ie(){he.removeEventListener("canplay",w),he.removeEventListener("play",O),he.removeEventListener("waiting",L),he.removeEventListener("playing",P),he.removeEventListener("pause",F),he.removeEventListener("error",q),he.removeEventListener("seeking",x),he.removeEventListener("seeked",U),he.removeEventListener("timeupdate",B),he.removeEventListener("progress",G),he.removeEventListener("ratechange",Y),he.removeEventListener("loadedmetadata",K),he.removeEventListener("stalled",ne),he.removeEventListener("ended",V)}var ae,oe,se,ue,le,ce,fe,de,he,ge,pe,Ee,me,_e,ye,Te,ve,Se,Ae,Re,Ie,De,be,Me,Ce,Ne,we=this.context,Oe=iu(we).getInstance();return ae={initialize:e,setConfig:A,getStartTimeFromUriParameters:R,getStreamStartTime:I,getTimeToStreamEnd:n,getTime:c,getNormalizedTime:f,getPlaybackRate:d,getPlayedRanges:h,getEnded:g,getIsDynamic:p,getStreamController:E,setLiveStartTime:m,getLiveStartTime:_,computeLiveDelay:y,getLiveDelay:T,getCurrentLiveLatency:v,play:i,isPaused:a,pause:o,isSeeking:s,seek:u,reset:S},function(){oe=Eu(we).getInstance().getLogger(ae),S()}(),ae}function Er(e){function t(){if(!(i&&i.hasOwnProperty("getExpectedLiveEdge")&&a&&a.hasOwnProperty("getRepresentationInfo")))throw new Error(Ys.MISSING_CONFIG_ERROR)}function n(){t();var e=a.getRepresentationInfo(),n=e.DVRWindow?e.DVRWindow.end:0,r=n;return e.useCalculatedLiveEdgeTime&&(r=i.getExpectedLiveEdge(),i.setClientTimeOffset(r-n)),r}function r(){i=null,a=null}e=e||{};var i=e.timelineConverter,a=e.streamProcessor;return{getLiveEdge:n,reset:r}}function mr(e){function t(){return Cd}function n(e){o(e),I=od(D).getInstance()}function r(e){try{if(R=Sf(D).create(A,e),!S){var t=R.getBuffer();t.hasOwnProperty(Ys.INITIALIZE)&&t.initialize(w,O),S=!0}return R}catch(t){if(e.isText||-1!==e.codec.indexOf('codecs="stpp')||-1!==e.codec.indexOf('codecs="wvtt'))try{R=M.getTextSourceBuffer()}catch(e){C.mediaSourceError("Error creating "+N+" source buffer."),C.error(new Fu(lf.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,lf.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+N+" : "+e.message))}else C.mediaSourceError("Error creating "+N+" source buffer."),C.error(new Fu(lf.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,lf.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+N))}}function i(){return N}function a(){return R}function o(e){A=e}function s(){return A}function u(){return O}function l(){return!1}function c(){}function f(){}function d(){return 0}function h(){return v}function g(e){b.off(uu.DATA_UPDATE_COMPLETED,p,T),b.off(uu.INIT_FRAGMENT_LOADED,E,T),!e&&R&&(R.abort(),R.reset(),R=null)}function p(e){if(e.sender.getStreamProcessor()===O){I.extract(O.getStreamInfo().id,e.sender.getCurrentRepresentation().id)||b.trigger(uu.TIMED_TEXT_REQUESTED,{index:0,sender:e.sender})}}function E(e){e.fragmentModel===O.getFragmentModel()&&e.chunk.bytes&&(I.save(e.chunk),R.append(e.chunk),b.trigger(uu.STREAM_COMPLETED,{request:e.request,fragmentModel:e.fragmentModel}))}function m(e,t){I.extract(e,t)||b.trigger(uu.TIMED_TEXT_REQUESTED,{index:0,sender:T})}function _(){return null}function y(e){R.timestampOffset===e||isNaN(e)||(R.timestampOffset=e)}e=e||{};var T,v,S,A,R,I,D=this.context,b=iu(D).getInstance(),M=Tf(D).getInstance(),C=e.errHandler,N=e.type,w=e.mimeType,O=e.streamProcessor;return T={getBufferControllerType:t,initialize:n,createBuffer:r,getType:i,getStreamProcessor:u,setSeekStartTime:f,getBuffer:a,getBufferLevel:d,setMediaSource:o,getMediaSource:s,getIsBufferingCompleted:h,getIsPruningInProgress:l,dischargePreBuffer:c,switchInitData:m,getRangeAt:_,reset:g,updateTimestampOffset:y},function(){S=!1,A=null,v=!1,b.on(uu.DATA_UPDATE_COMPLETED,p,T),b.on(uu.INIT_FRAGMENT_LOADED,E,T)}(),T}function _r(e){function t(){return y.getBufferControllerType()}function n(e,t){return y.initialize(e,t)}function r(e){return y.createBuffer(e)}function i(){return y.getType()}function a(){return y.getBuffer()}function o(e){y.setBuffer(e)}function s(){return y.getMediaSource()}function u(e){y.setMediaSource(e)}function l(){y.getStreamProcessor()}function c(e){y.setSeekStartTime(e)}function f(){return y.getBufferLevel()}function d(e){y.reset(e)}function h(){return y.getIsBufferingCompleted()}function g(e,t){y.switchInitData(e,t)}function p(){return y.getIsPruningInProgress()}function E(){return y.dischargePreBuffer()}function m(e){return y.getRangeAt(e)}function _(e){var t=a();t.timestampOffset===e||isNaN(e)||(t.timestampOffset=e)}e=e||{};var y,T,v=this.context;return T={getBufferControllerType:t,initialize:n,createBuffer:r,getType:i,getStreamProcessor:l,setSeekStartTime:c,getBuffer:a,setBuffer:o,getBufferLevel:f,setMediaSource:u,getMediaSource:s,getIsBufferingCompleted:h,getIsPruningInProgress:p,dischargePreBuffer:E,switchInitData:g,getRangeAt:m,reset:d,updateTimestampOffset:_},function(){y=e.type===Ys.FRAGMENTED_TEXT?gd(v).create({type:e.type,metricsModel:e.metricsModel,mediaPlayerModel:e.mediaPlayerModel,manifestModel:e.manifestModel,errHandler:e.errHandler,streamController:e.streamController,mediaController:e.mediaController,adapter:e.adapter,textController:e.textController,abrController:e.abrController,playbackController:e.playbackController,streamProcessor:e.streamProcessor}):Nd(v).create({type:e.type,mimeType:e.mimeType,errHandler:e.errHandler,streamProcessor:e.streamProcessor})}(),T}function yr(e){function t(e,t){return!e||r.getCurrentBufferLevel(i.getReadOnlyMetricsFor(e.getType()))<n(e,t)}function n(e,t){var n=NaN;if(!e)return n;var u=e.getType(),l=e.getRepresentationInfo()
;if(u===Ys.FRAGMENTED_TEXT)n=o.isTextEnabled()?l.fragmentDuration:0;else if(u===Ys.AUDIO&&t){var c=r.getCurrentBufferLevel(i.getReadOnlyMetricsFor(Ys.VIDEO));n=isNaN(l.fragmentDuration)?c:Math.max(c,l.fragmentDuration)}else{var f=l.mediaInfo.streamInfo;if(s.isPlayingAtTopQuality(f)){var d=f.manifestInfo.duration>=a.getLongFormContentDurationThreshold();n=d?a.getBufferTimeAtTopQualityLongForm():a.getBufferTimeAtTopQuality()}else n=a.getStableBufferTime()}return n}e=e||{};var r=e.dashMetrics,i=e.metricsModel,a=e.mediaPlayerModel,o=e.textController,s=e.abrController;return{execute:t,getBufferTarget:n}}function Tr(e){function t(e,t,n){if(!e)return null;var i,u=e.getRepresentationInfo(),l=e.getType(),c=!isNaN(t),f=e.getBufferController(),d=s.getNormalizedTime(),h=c?t:a.getIndexHandlerTime(e),g=!1;if(isNaN(h)||l===Ys.FRAGMENTED_TEXT&&!o.isTextEnabled())return null;if(f){var p=f.getRangeAt(h),E=f.getRangeAt(d),m=f.getBuffer().hasDiscontinuitiesAfter(d);null===p&&null===E||c||((!p||E&&E.start!=p.start&&E.end!=p.end)&&(m&&l!==Ys.FRAGMENTED_TEXT&&(e.getFragmentModel().removeExecutedRequestsAfterTime(E.end),g=!0),p=E),h!==p.end&&(r.debug("Prior to making a request for time, NextFragmentRequestRule is aligning index handler's currentTime with bufferedRange.end for",l,".",h,"was changed to",p.end),h=p.end))}if(n)h=n.startTime+n.duration/2,i=a.getFragmentRequest(e,u,h,{timeThreshold:0,ignoreIsFinished:!0});else for(i=a.getFragmentRequest(e,u,h,{keepIdx:!c&&!g});i&&i.action!==lu.ACTION_COMPLETE&&e.getFragmentModel().isFragmentLoaded(i);)i=a.getFragmentRequest(e,u);return i}e=e||{};var n,r,i=this.context,a=e.adapter,o=e.textController,s=e.playbackController;return n={execute:t},function(){r=Eu(i).getInstance().getLogger(n)}(),n}function vr(e,t){for(;e.length<t;)e="0"+e;return e}function Sr(e,t){return e.representation.startNumber+t}function Ar(e){return e?e.split("$$").join("$"):e}function Rr(e,t){if(!t||!e||-1===e.indexOf("$RepresentationID$"))return e;var n=t.toString();return e.split("$RepresentationID$").join(n)}function Ir(e,t,n){var r,i,a,o,s,u,l=t.length,c="%0".length;if(!e)return e;for(;;){if((r=e.indexOf("$"+t))<0)return e;if((i=e.indexOf("$",r+l))<0)return e;if((a=e.indexOf("%0",r+l))>r&&a<i)switch(o=e.charAt(i-1),s=parseInt(e.substring(a+c,i-1),10),o){case"d":case"i":case"u":u=vr(n.toString(),s);break;case"x":u=vr(n.toString(16),s);break;case"X":u=vr(n.toString(16),s).toUpperCase();break;case"o":u=vr(n.toString(8),s);break;default:return e}else u=n;e=e.substring(0,r)+u+e.substring(i+1)}}function Dr(e,t,n,r){var i,a,o,s;return a=n.segmentDuration,isNaN(a)&&(a=n.adaptation.period.duration),o=parseFloat((n.adaptation.period.start+r*a).toFixed(5)),s=parseFloat((o+a).toFixed(5)),i=new xd,i.representation=n,i.duration=a,i.presentationStartTime=o,i.mediaStartTime=e.calcMediaTimeFromPresentationTime(i.presentationStartTime,n),i.availabilityStartTime=e.calcAvailabilityStartTimeFromPresentationTime(i.presentationStartTime,n.adaptation.period.mpd,t),i.availabilityEndTime=e.calcAvailabilityEndTimeFromPresentationTime(s,n.adaptation.period.mpd,t),i.wallStartTime=e.calcWallTimeForSegment(i,t),i.replacementNumber=Sr(i,r),i.availabilityIdx=r,i}function br(e,t,n,r,i,a,o,s,u,l){var c,f,d,h=r/a,g=Math.min(i/a,n.adaptation.period.mpd.maxSegmentDuration);return c=e.calcPresentationTimeFromMediaTime(h,n),f=c+g,d=new xd,d.representation=n,d.duration=g,d.mediaStartTime=h,d.presentationStartTime=c,d.availabilityStartTime=n.adaptation.period.mpd.manifest.loadedTime,d.availabilityEndTime=e.calcAvailabilityEndTimeFromPresentationTime(f,n.adaptation.period.mpd,t),d.wallStartTime=e.calcWallTimeForSegment(d,t),d.replacementTime=l||r,d.replacementNumber=Sr(d,u),o=Ir(o,"Number",d.replacementNumber),o=Ir(o,"Time",d.replacementTime),d.media=o,d.mediaRange=s,d.availabilityIdx=u,d}function Mr(e,t){if(!t||!t.segments)return null;var n,r,i=t.segments.length;if(e<i&&(n=t.segments[e])&&n.availabilityIdx===e)return n;for(r=0;r<i;r++)if((n=t.segments[r])&&n.availabilityIdx===e)return n;return null}function Cr(e,t,n,r,i,a){var o,s,u=n.segmentDuration,l=n.adaptation.period.mpd.manifest.minBufferTime,c=n.segmentAvailabilityRange,f={start:e.calcPeriodRelativeTimeFromMpdRelativeTime(n,c?c.start:NaN),end:e.calcPeriodRelativeTimeFromMpdRelativeTime(n,c?c.end:NaN)},d=n.segments,h=2*u,g=a||Math.max(2*l,10*u),p=NaN,E=null;return f.start=Math.max(f.start,0),t&&!e.isTimeSyncCompleted()?(o=Math.floor(f.start/u),s=Math.floor(f.end/u),{start:o,end:s}):(d&&d.length>0?(E=Mr(i,n),p=E?e.calcPeriodRelativeTimeFromMpdRelativeTime(n,E.presentationStartTime):i>0?i*u:e.calcPeriodRelativeTimeFromMpdRelativeTime(n,r)):p=i>0?i*u:t?f.end:f.start,o=Math.floor(Math.max(p-h,f.start)/u),s=Math.floor(Math.min(o+g/u,f.end/u)),{start:o,end:s})}function Nr(e){function t(){q=Ie.getFragmentModel(),ne=Pd(de).create({abrController:Te,dashMetrics:Ee,metricsModel:ge,mediaPlayerModel:ye,textController:Ae}),re=Fd(de).create({adapter:pe,textController:Ae,playbackController:ve}),me.getIsTextTrack(e.mimeType)&&he.on(uu.TIMED_TEXT_REQUESTED,C,this),he.on(uu.QUALITY_CHANGE_REQUESTED,g,this),he.on(uu.DATA_UPDATE_STARTED,R,this),he.on(uu.DATA_UPDATE_COMPLETED,E,this),he.on(uu.FRAGMENT_LOADING_COMPLETED,T,this),he.on(uu.STREAM_COMPLETED,y,this),he.on(uu.STREAM_INITIALIZED,m,this),he.on(uu.BUFFER_LEVEL_STATE_CHANGED,D,this),he.on(uu.BUFFER_CLEARED,I,this),he.on(uu.BYTES_APPENDED_END_FRAGMENT,S,this),he.on(uu.INIT_REQUESTED,l,this),he.on(uu.QUOTA_EXCEEDED,b,this),he.on(uu.PLAYBACK_SEEKING,w,this),he.on(uu.PLAYBACK_STARTED,N,this),he.on(uu.PLAYBACK_RATE_CHANGED,O,this),he.on(uu.PLAYBACK_TIME_UPDATED,v,this),he.on(uu.URL_RESOLUTION_FAILED,M,this),he.on(uu.FRAGMENT_LOADING_ABANDONED,A,this)}function n(){return!1===W}function r(){if(!j||Ie.isBufferingCompleted())return void H.warn("Start denied to Schedule Controller");H.debug("Schedule Controller starts"),G(),W=!1,z&&(z=!1),u(0)}function i(){W||(H.debug("Schedule Controller stops"),W=!0,clearTimeout(ee))}function a(e,t){ae[t]=ae[t]||{};var n=Te.getTopQualityIndexFor(e,t);return ae[t][e]!=n&&(H.info("Top quality "+e+" index has changed from "+ae[t][e]+" to "+n),ae[t][e]=n,!0)}function o(){var e=Ie.getBufferController();if(W||$||!e||ve.isPaused()&&!ye.getScheduleWhilePaused()||(Re===Ys.FRAGMENTED_TEXT||Re===Ys.TEXT)&&!Ae.isTextEnabled())return void H.debug("Schedule stop!");if(e.getIsBufferingCompleted())return void H.debug("Schedule stop because buffering is completed!");s();var t=se.length>0,n=Ie.getStreamInfo();if(le||isNaN(oe)||ue||t||a(j.mediaInfo.type,n.id)||ne.execute(Ie,Se.isTrackTypePresent(Ys.VIDEO))){c(!0),t||ue||Te.checkPlaybackQuality(Re),function(){var e=Ie.getFragmentController();if(j.quality===oe&&!ue||le){var t=se.shift();if(e.isInitializationRequest(t))Ie.switchInitData(t.representationId);else{var r;Ie.getBufferController().getIsPruningInProgress()||(r=re.execute(Ie,te,t),L(NaN),r&&!t&&(isNaN(r.startTime+r.duration)||pe.setIndexHandlerTime(Ie,r.startTime+r.duration),r.delayLoadingTime=(new Date).getTime()+J,P(0)),!r&&n.manifestInfo&&n.manifestInfo.isDynamic&&H.debug("Next fragment seems to be at the bleeding live edge and is not available yet. Rescheduling.")),r?(H.debug("Next fragment request url is "+r.url),q.executeRequest(r)):(c(!1),u(ye.getLowLatencyEnabled()?100:500))}}else H.debug("Quality has changed, get init request for representationid = "+j.id),ue?(le=De.getSwitchMode(Re)===ad.TRACK_SWITCH_MODE_ALWAYS_REPLACE,H.debug("Switch track has been asked, get init request for "+Re+" with representationid = "+j.id+"bufferResetInProgress = "+le),Ie.switchInitData(j.id,le),ue=!1):Ie.switchInitData(j.id),oe=j.quality}()}else u(500)}function s(){var e=ve.getTime(),t=1.5*j.fragmentDuration,n=q.getRequests({state:Tu.FRAGMENT_MODEL_EXECUTED,time:e+t,threshold:0})[0];if(n&&-1===se.indexOf(n)&&!me.getIsTextTrack(Re)){var r=ye.getFastSwitchEnabled(),i=Ie.getBufferLevel(),a=Te.getAbandonmentStateFor(Re),o=!De.isCurrentTrack(n.mediaInfo)&&De.getSwitchMode(n.mediaInfo.type)===ad.TRACK_SWITCH_MODE_NEVER_REPLACE,s=n.quality<j.quality;r&&(o||s)&&i>=t&&a!==Jf.ABANDON_LOAD?(h(n),fe=!0,H.debug("Reloading outdated fragment at index: ",n.index)):n.quality>j.quality&&!le&&L(ve.getTime()+Ie.getBufferLevel())}}function u(e){clearTimeout(ee),ee=setTimeout(o,e)}function l(e){e.sender&&e.sender.getStreamProcessor()===Ie&&f(j.quality)}function c(e){$!==e?$=e:H.debug("isFragmentProcessingInProgress is already equal to",e)}function f(e){var t=pe.getInitRequest(Ie,e);t&&(c(!0),t.url=Ir(t.url,"Bandwidth",j?j.bandwidth:null),q.executeRequest(t))}function d(){ue=!0}function h(e){se.push(e)}function g(e){if(Re===e.mediaType&&Ie.getStreamInfo().id===e.streamInfo.id){if(null===(j=Ie.getRepresentationInfo(e.newQuality))||void 0===j)throw new Error("Unexpected error! - currentRepresentationInfo is null or undefined");k(new Date,Ld.REPRESENTATION_SWITCH_STOP_REASON),G()}}function p(e){if(ve&&q){var t=q.getRequests({state:Tu.FRAGMENT_MODEL_EXECUTED,time:ve.getTime(),threshold:0})[0];t&&ve.getTime()>=t.startTime&&((!ie.mediaInfo||t.mediaInfo.type===ie.mediaInfo.type&&t.mediaInfo.id!==ie.mediaInfo.id)&&e&&he.trigger(uu.TRACK_CHANGE_RENDERED,{mediaType:Re,oldMediaInfo:ie.mediaInfo,newMediaInfo:t.mediaInfo}),t.quality===ie.quality&&t.adaptationIndex===ie.adaptationIndex||!e||he.trigger(uu.QUALITY_CHANGE_RENDERED,{mediaType:Re,oldQuality:ie.quality,newQuality:t.quality}),ie={mediaInfo:t.mediaInfo,quality:t.quality,adaptationIndex:t.adaptationIndex})}}function E(e){e.error||e.sender.getStreamProcessor()!==Ie||(j=pe.convertDataToRepresentationInfo(e.currentRepresentation))}function m(e){e.error||Ie.getStreamInfo().id!==e.streamInfo.id||(j=Ie.getRepresentationInfo(),z&&(ve.getIsDynamic()?(_e.setTimeSyncCompleted(!0),_()):(te=ve.getStreamStartTime(!1),Ie.getBufferController().setSeekStartTime(te))),W&&r())}function _(){var e=Ie.getLiveEdgeFinder();if(e){var t=e.getLiveEdge(),n=j.mediaInfo.streamInfo.manifestInfo.DVRWindowSize/2,r=t-ve.computeLiveDelay(j.fragmentDuration,n),i=pe.getFragmentRequest(Ie,j,r,{ignoreIsFinished:!0});if(i)if(ye.getLowLatencyEnabled()){var a=i.duration<ye.getLiveDelay()?i.startTime:i.startTime+i.duration-ye.getLiveDelay();ve.setLiveStartTime(a)}else ve.setLiveStartTime(i.startTime);else H.debug("setLiveEdgeSeekTarget : getFragmentRequest returned undefined request object");te=ve.getStreamStartTime(!1,t),Ie.getBufferController().setSeekStartTime(te),te>j.mediaInfo.streamInfo.start+j.mediaInfo.streamInfo.duration&&ve.seek(te);var o=Ee.getCurrentManifestUpdate(ge.getMetricsFor(Ys.STREAM));ge.updateManifestUpdateInfo(o,{currentTime:te,presentationStartTime:t,latency:t-te,clientTimeOffset:_e.getClientTimeOffset()})}}function y(e){e.fragmentModel===q&&(i(),c(!1),H.info("Stream is complete"))}function T(e){e.sender===q&&(H.info("OnFragmentLoadingCompleted - Url:",e.request?e.request.url:"undefined",", Range:",e.request.range?e.request.range:"undefined"),me.getIsTextTrack(Re)&&c(!1),e.error&&e.request.serviceLocation&&!W&&(h(e.request),c(!1),u(0)),le&&(ce=e.request))}function v(){p(!0)}function S(e){if(e.sender.getStreamProcessor()===Ie)if(le&&!isNaN(e.startTime)&&(le=!1,q.addExecutedRequest(ce)),c(!1),fe&&!isNaN(e.startTime)){var t=ve.getTime(),n=e.startTime+j.fragmentDuration,r=1.5*j.fragmentDuration;u(t+r>=n?0:1e3*(n-(t+r))),fe=!1}else u(0)}function A(e){e.streamProcessor===Ie&&(H.info("onFragmentLoadingAbandoned for "+Re+", request: "+e.request.url+" has been aborted"),ve.isSeeking()||ue||(H.info("onFragmentLoadingAbandoned for "+Re+", request: "+e.request.url+" has to be downloaded again, origin is not seeking process or switch track call"),h(e.request)),c(!1),u(0))}function R(e){e.sender.getStreamProcessor()===Ie&&i()}function I(e){if(e.sender.getStreamProcessor()===Ie){var t=Ie.getStreamInfo();t&&(e.unintended?q.removeExecutedRequestsAfterTime(e.from,t.duration):q.syncExecutedRequestsWithBufferedRange(Ie.getBufferController().getBuffer().getAllBufferRanges(),t.duration)),e.hasEnoughSpaceToAppend&&W&&r()}}function D(e){e.sender.getStreamProcessor()!==Ie||e.state!==gd.BUFFER_EMPTY||ve.isSeeking()||(H.info("Buffer is empty! Stalling!"),k(new Date,Ld.REBUFFERING_REASON))}function b(e){e.sender.getStreamProcessor()===Ie&&(i(),c(!1))}function M(){q.abortRequests(),i()}function C(e){e.sender.getStreamProcessor()===Ie&&Ae.isTextEnabled()&&f(e.index)}function N(){!W&&ye.getScheduleWhilePaused()||r()}function w(e){te=e.seekTime,P(0),W&&r();var t=Ee.getCurrentManifestUpdate(ge.getMetricsFor(Ys.STREAM)),n=j.DVRWindow&&ve?j.DVRWindow.end-ve.getTime():NaN;ge.updateManifestUpdateInfo(t,{latency:n}),$?(H.debug("onPlaybackSeeking for "+Re+", call fragmentModel.abortRequests in order to seek quicker"),q.abortRequests()):u(0)}function O(e){Q&&(Q.playbackspeed=e.playbackRate.toString())}function L(e){te=e}function P(e){J=e}function F(){return ne.getBufferTarget(Ie,Se.isTrackTypePresent(Ys.VIDEO))}function x(){return Re}function U(e){X=e}function B(e,t){k(e,t),X=null}function k(e,t){if(X&&!1===Z){var n=Q.start,r=e.getTime()-n.getTime();Q.duration=r,Q.stopreason=t,X.trace.push(Q),Z=!0}}function G(){X&&!0===Z&&j&&(Z=!1,Q=new Ld,Q.representationid=j.id,Q.start=new Date,Q.mstart=1e3*ve.getTime(),Q.playbackspeed=ve.getPlaybackRate().toString())}function Y(){$=!1,J=0,te=NaN,X=null,Q=null,Z=!0,z=!0,oe=NaN,ie={mediaInfo:void 0,quality:NaN,adaptationIndex:NaN},ae={},se=[],W=!0,ue=!1,le=!1,ce=null,fe=!1}function K(){he.off(uu.DATA_UPDATE_STARTED,R,this),he.off(uu.DATA_UPDATE_COMPLETED,E,this),he.off(uu.BUFFER_LEVEL_STATE_CHANGED,D,this),he.off(uu.QUALITY_CHANGE_REQUESTED,g,this),he.off(uu.FRAGMENT_LOADING_COMPLETED,T,this),he.off(uu.STREAM_COMPLETED,y,this),he.off(uu.STREAM_INITIALIZED,m,this),he.off(uu.QUOTA_EXCEEDED,b,this),he.off(uu.BYTES_APPENDED_END_FRAGMENT,S,this),he.off(uu.BUFFER_CLEARED,I,this),he.off(uu.INIT_REQUESTED,l,this),he.off(uu.PLAYBACK_RATE_CHANGED,O,this),he.off(uu.PLAYBACK_SEEKING,w,this),he.off(uu.PLAYBACK_STARTED,N,this),he.off(uu.PLAYBACK_TIME_UPDATED,v,this),he.off(uu.URL_RESOLUTION_FAILED,M,this),he.off(uu.FRAGMENT_LOADING_ABANDONED,A,this),me.getIsTextTrack(Re)&&he.off(uu.TIMED_TEXT_REQUESTED,C,this),i(),p(!1),Y()}e=e||{};var V,H,q,j,z,W,X,Q,Z,$,J,ee,te,ne,re,ie,ae,oe,se,ue,le,ce,fe,de=this.context,he=iu(de).getInstance(),ge=e.metricsModel,pe=e.adapter,Ee=e.dashMetrics,me=e.dashManifestModel,_e=e.timelineConverter,ye=e.mediaPlayerModel,Te=e.abrController,ve=e.playbackController,Se=e.streamController,Ae=e.textController,Re=e.type,Ie=e.streamProcessor,De=e.mediaController;return V={initialize:t,getType:x,setSeekTarget:L,setTimeToLoadDelay:P,replaceRequest:h,switchTrackAsked:d,isStarted:n,start:r,stop:i,reset:K,setPlayList:U,getBufferTarget:F,finalisePlayList:B},function(){H=Eu(de).getInstance().getLogger(V),Y()}(),V}function wr(){function e(e){e.abrController&&(N=e.abrController),e.domStorage&&(P=e.domStorage),e.metricsModel&&(L=e.metricsModel),e.dashMetrics&&(U=e.dashMetrics),e.dashManifestModel&&(x=e.dashManifestModel),e.playbackController&&(O=e.playbackController),e.timelineConverter&&(F=e.timelineConverter),e.manifestModel&&(k=e.manifestModel),e.streamProcessor&&(B=e.streamProcessor)}function t(){w=B.getIndexHandler()}function n(){return B}function r(){return I}function i(){return D}function a(){return b}function o(){return C}function s(){I=null,D=-1,b=!0,M=[],N=null,O=null,L=null,P=null,F=null,x=null,U=null}function u(){Y.off(uu.QUALITY_CHANGE_REQUESTED,S,R),Y.off(uu.REPRESENTATION_UPDATED,y,R),Y.off(uu.WALLCLOCK_TIME_UPDATED,T,R),Y.off(uu.BUFFER_LEVEL_UPDATED,v,R),Y.off(uu.MANIFEST_VALIDITY_CHANGED,A,R),s()}function l(e,t,n){var r,i,a=B.getStreamInfo(),o=N.getTopQualityIndexFor(n,a.id),s=N.getMinAllowedIndexFor(n),u=null;if(b=!0,Y.trigger(uu.DATA_UPDATE_STARTED,{sender:this}),M=p(t),null!==I&&I.id==e.id||n===Ys.FRAGMENTED_TEXT?r=N.getQualityFor(n,a):(i=N.getThroughputHistory().getAverageThroughput(n),u=i||N.getInitialBitrateFor(n,a),r=N.getQualityForBitrate(B.getMediaInfo(),u)),void 0!==s&&r<s&&(r=s),r>o&&(r=o),C=d(r),I=e,n!==Ys.VIDEO&&n!==Ys.AUDIO&&n!==Ys.FRAGMENTED_TEXT)return b=!1,void Y.trigger(uu.DATA_UPDATE_COMPLETED,{sender:this,data:I,currentRepresentation:C});for(var l=0;l<M.length;l++)w.updateRepresentation(M[l],!0)}function c(){var e=new Date,t=o(),n=1e3*O.getTime();L.addRepresentationSwitch(t.adaptation.type,e,n,t.id)}function f(){var e=B.getStreamInfo(),t=e?e.manifestInfo:null,n=t?t.isDynamic:null,r=F.calcSegmentAvailabilityRange(C,n);L.addDVRInfo(B.getType(),O.getTime(),t,r)}function d(e){return null===e||void 0===e||e>=M.length?null:M[e]}function h(e){return M.indexOf(e)}function g(){for(var e=0,t=M.length;e<t;e++){var n=M[e].segmentInfoType;if(null===M[e].segmentAvailabilityRange||!Gd.hasInitialization(M[e])||(n===kd.SEGMENT_BASE||n===kd.BASE_URL)&&!M[e].segments)return!1}return!0}function p(e){return D=x.getIndexForAdaptation(I,e.period.mpd.manifest,e.period.index),x.getRepresentationsForAdaptation(e)}function E(e){for(var t,n=0,r=M.length;n<r;n++)t=M[n],t.segmentAvailabilityRange=F.calcSegmentAvailabilityRange(t,e)}function m(){M.forEach(function(e){e.segmentAvailabilityRange=null})}function _(e){var t=e,n=function(){if(!a()){b=!0,Y.trigger(uu.DATA_UPDATE_STARTED,{sender:R}),m();for(var e=0;e<M.length;e++)w.updateRepresentation(M[e],!0)}};b=!1,Y.trigger(uu.AST_IN_FUTURE,{delay:t}),setTimeout(n,t)}function y(e){if(e.sender.getStreamProcessor()===B&&a()){var t,n,r,i=e.representation,s=L.getMetricsFor(Ys.STREAM),u=L.getMetricsFor(o().adaptation.type),l=U.getCurrentManifestUpdate(s),d=!1,p=0;if(i.adaptation.period.mpd.manifest.type===kd.DYNAMIC&&!i.adaptation.period.mpd.manifest.ignorePostponeTimePeriod){var E=i.segmentAvailabilityRange.end-i.segmentAvailabilityRange.start;p=1e3*(O.computeLiveDelay(C.segmentDuration,B.getStreamInfo().manifestInfo.DVRWindowSize)-E)}if(p>0)return f(),_(p),n=new Fu(lf.SEGMENTS_UPDATE_FAILED_ERROR_CODE,lf.SEGMENTS_UPDATE_FAILED_ERROR_MESSAGE),void Y.trigger(uu.DATA_UPDATE_COMPLETED,{sender:this,data:I,currentRepresentation:C,error:n});if(l){for(var m=0;m<l.representationInfo.length;m++)if(t=l.representationInfo[m],t.index===i.index&&t.mediaType===B.getType()){d=!0;break}d||L.addManifestUpdateRepresentationInfo(l,i.id,i.index,i.adaptation.period.index,B.getType(),i.presentationTimeOffset,i.startNumber,i.segmentInfoType)}g()&&(b=!1,N.setPlaybackQuality(B.getType(),B.getStreamInfo(),h(C)),L.updateManifestUpdateInfo(l,{latency:C.segmentAvailabilityRange.end-O.getTime()}),r=U.getCurrentRepresentationSwitch(u),r||c(),Y.trigger(uu.DATA_UPDATE_COMPLETED,{sender:this,data:I,currentRepresentation:C}))}}function T(e){e.isDynamic&&E(e.isDynamic)}function v(e){if(e.sender.getStreamProcessor()===B){k.getValue().doNotUpdateDVRWindowOnBufferUpdated||f()}}function S(e){if(e.mediaType===B.getType()&&B.getStreamInfo().id===e.streamInfo.id&&e.oldQuality!==e.newQuality){C=d(e.newQuality);var t=N.getThroughputHistory().getAverageThroughput(e.mediaType);isNaN(t)||P.setSavedBitrateSettings(e.mediaType,t),c()}}function A(e){if(e.newDuration){var t=o();if(t&&t.adaptation.period){t.adaptation.period.duration=e.newDuration}}}var R,I,D,b,M,C,N,w,O,L,P,F,x,U,B,k,G=this.context,Y=iu(G).getInstance();return R={initialize:t,setConfig:e,getData:r,getDataIndex:i,isUpdating:a,updateData:l,getStreamProcessor:n,getCurrentRepresentation:o,getRepresentationForQuality:d,reset:u},function(){s(),Y.on(uu.QUALITY_CHANGE_REQUESTED,S,R),Y.on(uu.REPRESENTATION_UPDATED,y,R),Y.on(uu.WALLCLOCK_TIME_UPDATED,T,R),Y.on(uu.BUFFER_LEVEL_UPDATED,v,R),Y.on(uu.MANIFEST_VALIDITY_CHANGED,A,R)}(),R}function Or(){function e(e){var t=e.indexOf("/"),n=e.lastIndexOf("/");return-1!==t?n===t+1?e:(-1!==e.indexOf("?")&&(e=e.substring(0,e.indexOf("?"))),e.substring(0,n+1)):""}function t(e){var t=e.match(h);return t?t[1]:""}function n(e){var t=e.match(c);return t?t[0]:""}function r(e){return!c.test(e)}function i(e){return r(e)&&"/"===e.charAt(0)}function a(e){return 0===e.indexOf("//")}function o(e){return f.test(e)}function s(e){return d.test(e)}function u(e,t){return l(e,t)}var l,c=/^[a-z][a-z0-9+\-.]*:/i,f=/^https?:\/\//i,d=/^https:\/\//i,h=/^([a-z][a-z0-9+\-.]*:\/\/[^\/]+)\/?/i,g=function(e,t){try{return new window.URL(e,t).toString()}catch(t){return e}},p=function(o,s){var u=e;if(!s)return o;if(!r(o))return o;i(o)&&(u=t),a(o)&&(u=n);var l=u(s);return[l,o].join("/"!==l.charAt(l.length-1)&&"/"!==o.charAt(0)?"/":"")};return function(){try{new window.URL("x","http://y"),l=g}catch(e){}finally{l=l||p}}(),{parseBaseUrl:e,parseOrigin:t,parseScheme:n,isRelative:r,isPathAbsolute:i,isSchemeRelative:a,isHTTPURL:o,isHTTPS:s,resolve:u}}function Lr(e,t){function n(){if(!i||!i.hasOwnProperty("calcMediaTimeFromPresentationTime")||!i.hasOwnProperty("calcSegmentAvailabilityRange"))throw new Error(Ys.MISSING_CONFIG_ERROR)}function r(e,r,a,o){if(n(),!e)throw new Error("no representation");void 0===r&&(r=null);var s,u=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate||e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList,l=u.SegmentTimeline,c=u.SegmentURL_asArray,f=e.availableSegmentsNumber>0;s=o||(a>-1||null!==r?10:1/0);var d,h,g,p,E,m,_,y,T,v,S,A=0,R=0,I=-1,D=[],b=null,M=function(n,r){var a=u.media,o=n.mediaRange;return c&&(a=c[r].media||"",o=c[r].mediaRange),br(i,t,e,A,n.d,S,a,o,I,n.tManifest)};for(S=e.timescale,d=l.S_asArray,v=a,null!==r&&(b=i.calcMediaTimeFromPresentationTime(r,e)),g=0,p=d.length;g<p;g++){if(h=d[g],m=0,h.hasOwnProperty("r")&&(m=h.r),h.hasOwnProperty("t")&&(A=h.t,R=A/S),m<0){if((y=d[g+1])&&y.hasOwnProperty("t"))_=y.t/S;else{var C=e.segmentAvailabilityRange?e.segmentAvailabilityRange.end:i.calcSegmentAvailabilityRange(e,t).end;_=i.calcMediaTimeFromPresentationTime(C,e),e.segmentDuration=h.d/S}m=Math.ceil((_-R)/(h.d/S))-1}if(T){if(f)break;I+=m+1}else for(E=0;E<=m;E++)if(I++,D.length>s){if(T=!0,f)break}else null!==b?R>=b-h.d/S*1.5&&D.push(M(h,I)):I>=v&&D.push(M(h,I)),A+=h.d,R=A/S}return f||(e.availableSegmentsNumber=I+1),D}e=e||{};var i=e.timelineConverter;return{getSegments:r}}function Pr(e,t){function n(e,n,i,a){var o,s,u,l,c,f=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate,d=e.segmentDuration,h=e.segmentAvailabilityRange,g=[],p=null,E=null;for(c=e.startNumber,o=isNaN(d)&&!t?{start:c,end:c}:Cr(r,t,e,n,i,a),u=o.start,l=o.end,s=u;s<=l;s++)E=Dr(r,t,e,s),E.replacementTime=(c+s-1)*e.segmentDuration,p=f.media,p=Ir(p,"Number",E.replacementNumber),p=Ir(p,"Time",E.replacementTime),E.media=p,g.push(E),E=null;return isNaN(d)?e.availableSegmentsNumber=1:e.availableSegmentsNumber=Math.ceil((h.end-h.start)/d),g}var r=e.timelineConverter;return{getSegments:n}}function Fr(e,t){function n(e,n,i,a){var o,s,u,l,c,f,d,h=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList,g=h.SegmentURL_asArray.length,p=[];for(d=e.startNumber,l=Cr(r,t,e,n,i,a),c=Math.max(l.start,0),f=Math.min(l.end,h.SegmentURL_asArray.length-1),o=c;o<=f;o++)u=h.SegmentURL_asArray[o],s=Dr(r,t,e,o),s.replacementTime=(d+o-1)*e.segmentDuration,s.media=u.media?u.media:"",s.mediaRange=u.mediaRange,s.index=u.index,s.indexRange=u.indexRange,p.push(s),s=null;return e.availableSegmentsNumber=g,p}e=e||{};var r=e.timelineConverter;return{getSegments:n}}function xr(e,t){function n(e,t,n,i,u){var l,c=e.segmentInfoType;c!==kd.SEGMENT_BASE&&c!==kd.BASE_URL&&r(e,n)?(c===kd.SEGMENT_TIMELINE?l=a.getSegments(e,t,n,u):c===kd.SEGMENT_TEMPLATE?l=o.getSegments(e,t,n,u):c===kd.SEGMENT_LIST&&(l=s.getSegments(e,t,n,u)),i&&i(e,l)):l=e.segments}function r(e,t){var n,r,i=e.segments,a=!1;return i&&0!==i.length?(r=i[0].availabilityIdx,n=i[i.length-1].availabilityIdx,a=t<r||t>n):a=!0,a}var i,a,o,s,u=this.context;return i={getSegments:n},function(){a=qd(u).create(e,t),o=jd(u).create(e,t),s=zd(u).create(e,t)}(),i}function Ur(){function e(e){return e}function t(e){return e}return{modifyRequestURL:e,modifyRequestHeader:t}}function Br(e){function t(e){var t=new Date,n=e.request,i=new XMLHttpRequest;i.open(e.method,e.url,!0),n.responseType&&(i.responseType=n.responseType),n.range&&i.setRequestHeader("Range","bytes="+n.range),n.requestStartDate||(n.requestStartDate=t),r&&(i=r.modifyRequestHeader(i)),i.withCredentials=e.withCredentials,i.onload=e.onload,i.onloadend=e.onend,i.onerror=e.onerror,i.onprogress=e.progress,i.onabort=e.onabort,i.send(),e.response=i}function n(e){var t=e.response;t.onloadend=t.onerror=t.onprogress=void 0,t.abort()}e=e||{};var r=e.requestModifier;return{load:t,abort:n}}function kr(e){function t(e){var t=new Date,i=e.request,u=new Headers;i.range&&u.append("Range","bytes="+i.range),i.requestStartDate||(i.requestStartDate=t),o&&o.modifyRequestHeader({setRequestHeader:function(e,t){u.append(e,t)}});var l;"function"==typeof window.AbortController&&(l=new AbortController,e.abortController=l);var c={method:e.method,headers:u,credentials:e.withCredentials?"include":void 0,signal:l?l.signal:void 0};fetch(e.url,c).then(function(t){e.response||(e.response={}),e.response.status=t.status,e.response.statusText=t.statusText,e.response.responseURL=t.url,t.ok||e.onerror();var i="",o=!0,u=!1,l=void 0;try{for(var c,f=t.headers.keys()[Symbol.iterator]();!(o=(c=f.next()).done);o=!0){var d=c.value;i+=d+": "+t.headers.get(d)+"\n"}}catch(e){u=!0,l=e}finally{try{o||null==f.return||f.return()}finally{if(u)throw l}}if(e.response.responseHeaders=i,!t.body)return t.arrayBuffer().then(function(t){e.response.response=t;var n={loaded:t.byteLength,total:t.byteLength,stream:!1};e.progress(n),e.onload(),e.onend()});var h=parseInt(t.headers.get("Content-Length"),10),g=0,p=!1,E=new Uint8Array,m=0;e.reader=t.body.getReader();var _=[];n(e,function t(i){var o=i.value;if(i.done)return E&&(e.progress({loaded:g,total:isNaN(h)?g:h,lengthComputable:!0,time:a(_,g),stream:!0}),e.response.response=E.buffer),e.onload(),void e.onend();if(o&&o.length>0){E=r(E,o),g+=o.length,_.push({ts:Date.now(),bytes:o.length});var u=s.findLastTopIsoBoxCompleted(["moov","mdat"],E,m);if(u.found){var l,c=u.lastCompletedOffset+u.size;c===E.length?(l=E,E=new Uint8Array):(l=new Uint8Array(E.subarray(0,c)),E=E.subarray(c)),e.progress({data:l.buffer,lengthComputable:!1,noTrace:!0}),m=0}else m=u.lastCompletedOffset,p||(e.progress({lengthComputable:!1,noTrace:!0}),p=!0)}n(e,t)})}).catch(function(t){e.onerror&&e.onerror(t)})}function n(e,t){e.reader.read().then(t).catch(function(t){e.onerror&&200===e.response.status&&e.onerror(t)})}function r(e,t){if(0===e.length)return t;var n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}function i(e){if(e.abortController)e.abortController.abort();else if(e.reader)try{e.reader.cancel()}catch(e){}}function a(e,t){if(e=e.filter(function(n){return n.bytes>t/4/e.length}),e.length>1){var n=0,r=(e[e.length-1].ts-e[0].ts)/e.length;return e.forEach(function(t,i){var a=e[i+1];if(a){var o=a.ts-t.ts;n+=o<r?o:0}}),n}return null}e=e||{};var o=e.requestModifier,s=e.boxParser;return{load:t,abort:i,calculateDownloadedTime:a}}function Gr(e){function t(e,n){var r,i=e.request,p=[],_=!0,y=!0,T=new Date,v=T,S=0;if(!g||!d||!f)throw new Error("config object is not correct or missing");var A,R=function(e){y=!1,i.requestStartDate=T,i.requestEndDate=new Date,i.firstByteDate=i.firstByteDate||T,i.checkExistenceOnly||(d.addHttpRequest(i.mediaType,null,i.type,i.url,r.response?r.response.responseURL:null,i.serviceLocation||null,i.range||null,i.requestStartDate,i.firstByteDate,i.requestEndDate,r.response?r.response.status:null,i.duration,r.response&&r.response.getAllResponseHeaders?r.response.getAllResponseHeaders():r.response?r.response.responseHeaders:[],e?p:null),i.type===Cl.MPD_TYPE&&d.addManifestUpdate("stream",i.type,i.requestStartDate,i.requestEndDate))},I=function(){if(-1!==a.indexOf(r)&&(a.splice(a.indexOf(r),1),y))if(R(!1),n>0){n--;var o={config:e};s.push(o),o.timeout=setTimeout(function(){-1!==s.indexOf(o)&&(s.splice(s.indexOf(o),1),t(e,n))},h.getRetryIntervalForType(i.type))}else f.downloadError(u[i.type],i.url,i),f.error(new Fu(l[i.type],i.url+" is not available",{request:i,response:r.response})),e.error&&e.error(i,"error",r.response.statusText),e.complete&&e.complete(i,r.response.statusText)},D=function(t){var n=new Date;_&&(_=!1,(!t.lengthComputable||t.lengthComputable&&t.total!==t.loaded)&&(i.firstByteDate=n)),t.lengthComputable&&(i.bytesLoaded=t.loaded,i.bytesTotal=t.total),t.noTrace||(p.push({s:v,d:t.time?t.time:n.getTime()-v.getTime(),b:[t.loaded?t.loaded-S:0]}),v=n,S=t.loaded),e.progress&&t&&e.progress(t)},b=function(){r.response.status>=200&&r.response.status<=299&&(R(!0),e.success&&e.success(r.response.response,r.response.statusText,r.response.responseURL),e.complete&&e.complete(i,r.response.statusText))},M=function(){e.abort&&e.abort(i)};A=m&&window.fetch&&"arraybuffer"===i.responseType&&i.type===Cl.MEDIA_SEGMENT_TYPE?Kh(c).create({requestModifier:g,boxParser:E}):Qd(c).create({requestModifier:g,boxParser:E});var C=g.modifyRequestURL(i.url),N=i.checkExistenceOnly?Cl.HEAD:Cl.GET,w=h.getXHRWithCredentialsForType(i.type);r={url:C,method:N,withCredentials:w,request:i,onload:b,onend:I,onerror:I,progress:D,onabort:M,loader:A};var O=(new Date).getTime();if(isNaN(i.delayLoadingTime)||O>=i.delayLoadingTime)a.push(r),A.load(r);else{var L={httpRequest:r};o.push(L),L.delayTimeout=setTimeout(function(){if(-1!==o.indexOf(L)){o.splice(o.indexOf(L),1);try{T=new Date,v=T,a.push(L.httpRequest),A.load(L.httpRequest)}catch(e){L.httpRequest.onerror()}}},i.delayLoadingTime-O)}}function n(e){e.request&&t(e,h.getRetryAttemptsForType(e.request.type))}function r(){s.forEach(function(e){clearTimeout(e.timeout),e.config.request&&e.config.abort&&e.config.abort(e.config.request)}),s=[],o.forEach(function(e){return clearTimeout(e.delayTimeout)}),o=[],a.forEach(function(e){e.onloadend=e.onerror=e.onprogress=void 0,e.loader.abort(e),e.onabort()}),a=[]}e=e||{};var i,a,o,s,u,l,c=this.context,f=e.errHandler,d=e.metricsModel,h=e.mediaPlayerModel,g=e.requestModifier,E=e.boxParser,m=e.useFetch||!1;return i={load:n,abort:r},function(){var e,t;a=[],o=[],s=[],e={},p(e,Cl.MPD_TYPE,lf.DOWNLOAD_ERROR_ID_MANIFEST),p(e,Cl.XLINK_EXPANSION_TYPE,lf.DOWNLOAD_ERROR_ID_XLINK),p(e,Cl.INIT_SEGMENT_TYPE,lf.DOWNLOAD_ERROR_ID_INITIALIZATION),p(e,Cl.MEDIA_SEGMENT_TYPE,lf.DOWNLOAD_ERROR_ID_CONTENT),p(e,Cl.INDEX_SEGMENT_TYPE,lf.DOWNLOAD_ERROR_ID_CONTENT),p(e,Cl.BITSTREAM_SWITCHING_SEGMENT_TYPE,lf.DOWNLOAD_ERROR_ID_CONTENT),p(e,Cl.OTHER_TYPE,lf.DOWNLOAD_ERROR_ID_CONTENT),u=e,t={},p(t,Cl.MPD_TYPE,lf.DOWNLOAD_ERROR_ID_MANIFEST_CODE),p(t,Cl.XLINK_EXPANSION_TYPE,lf.DOWNLOAD_ERROR_ID_XLINK_CODE),p(t,Cl.INIT_SEGMENT_TYPE,lf.DOWNLOAD_ERROR_ID_INITIALIZATION_CODE),p(t,Cl.MEDIA_SEGMENT_TYPE,lf.DOWNLOAD_ERROR_ID_CONTENT_CODE),p(t,Cl.INDEX_SEGMENT_TYPE,lf.DOWNLOAD_ERROR_ID_CONTENT_CODE),p(t,Cl.BITSTREAM_SWITCHING_SEGMENT_TYPE,lf.DOWNLOAD_ERROR_ID_CONTENT_CODE),p(t,Cl.OTHER_TYPE,lf.DOWNLOAD_ERROR_ID_CONTENT_CODE),l=t}(),i}function Yr(){function e(){d=zl(_).getInstance(),h=Xd(_).getInstance(),E=Vh(_).create({errHandler:f,metricsModel:g,mediaPlayerModel:p,requestModifier:h})}function t(e){e.baseURLController&&(m=e.baseURLController),e.metricsModel&&(g=e.metricsModel),e.mediaPlayerModel&&(p=e.mediaPlayerModel),e.errHandler&&(f=e.errHandler)}function n(){if(!m||!m.hasOwnProperty("resolve"))throw new Error("setConfig function has to be called previously")}function r(e,t){n();var i=null,a=m.resolve(e.path),o=t||{init:!0,url:a?a.url:void 0,range:{start:0,end:1500},searching:!1,bytesLoaded:0,bytesToLoad:1500};c.debug("Start searching for initialization.");var u=s(o),l=function(t){o.bytesLoaded=o.range.end,i=d.findInitRange(t),i?(e.range=i,y.trigger(uu.INITIALIZATION_LOADED,{representation:e})):(o.range.end=o.bytesLoaded+o.bytesToLoad,r(e,o))},f=function(){y.trigger(uu.INITIALIZATION_LOADED,{
representation:e})};E.load({request:u,success:l,error:f}),c.debug("Perform init search: "+o.url)}function i(e,t,r,a,l){if(n(),r&&(void 0===r.start||void 0===r.end)){var f=r?r.toString().split("-"):null;r=f?{start:parseFloat(f[0]),end:parseFloat(f[1])}:null}l=l||u;var h=null,g=null,p=!!r,_=m.resolve(e.path),y={init:!1,url:_?_.url:void 0,range:p?r:{start:0,end:1500},searching:!p,bytesLoaded:a?a.bytesLoaded:0,bytesToLoad:1500},T=s(y),v=function(n){var r=y.bytesToLoad,a=n.byteLength;if(y.bytesLoaded=y.range.end-y.range.start,h=d.parse(n),(g=h.getBox("sidx"))&&g.isComplete){var s,u,f=g.references;if(null!==f&&void 0!==f&&f.length>0&&(s=1===f[0].reference_type),s){c.debug("Initiate multiple SIDX load."),y.range.end=y.range.start+g.size;var p,E,m,_,T,v=[],S=0,A=(g.offset||y.range.start)+g.size,R=function(n){n?(v=v.concat(n),++S>=E&&l(v,e,t)):l(null,e,t)};for(p=0,E=f.length;p<E;p++)m=A,_=A+f[p].referenced_size-1,A+=f[p].referenced_size,T={start:m,end:_},i(e,null,T,y,R)}else c.debug("Parsing segments from SIDX."),u=o(g,y),l(u,e,t)}else{if(g)y.range.start=g.offset||y.range.start,y.range.end=y.range.start+(g.size||r);else{if(a<y.bytesLoaded)return void l(null,e,t);var I=h.getLastBox();I&&I.size?(y.range.start=I.offset+I.size,y.range.end=y.range.start+r):y.range.end+=r}i(e,t,y.range,y,l)}},S=function(){l(null,e,t)};E.load({request:T,success:v,error:S}),c.debug("Perform SIDX load: "+y.url)}function a(){E.abort(),E=null,f=null,d=null,h=null}function o(e,t){for(var n,r,i,a,o=e.references,s=o.length,u=e.timescale,l=e.earliest_presentation_time,c=t.range.start+e.offset+e.first_offset+e.size,f=[],d=0;d<s;d++)i=o[d].subsegment_duration,a=o[d].referenced_size,n=new xd,n.duration=i,n.startTime=l,n.timescale=u,r=c+a-1,n.mediaRange=c+"-"+r,f.push(n),l+=i,c+=a;return f}function s(e){if(e.url){var t=new lu;return t.type=e.init?Cl.INIT_SEGMENT_TYPE:Cl.MEDIA_SEGMENT_TYPE,t.url=e.url,t.range=e.range.start+"-"+e.range.end,t}}function u(e,t,n){e?y.trigger(uu.SEGMENTS_LOADED,{segments:e,representation:t,mediaType:n}):y.trigger(uu.SEGMENTS_LOADED,{segments:null,representation:t,mediaType:n,error:new Fu(lf.SEGMENT_BASE_LOADER_ERROR_CODE,lf.SEGMENT_BASE_LOADER_ERROR_MESSAGE)})}var l,c,f,d,h,g,p,E,m,_=this.context,y=iu(_).getInstance();return l={setConfig:t,initialize:e,loadInitialization:r,loadSegments:i,reset:a},function(){c=Eu(_).getInstance().getLogger(l)}(),l}function Kr(e){function t(){return h}function n(e){h=e}function r(e,t){var n,r,i=!0,a=0;if(void 0===t&&(t=!1),e.tag>16777215?(d.getUint32(h)!==e.tag&&(i=!1),a=4):e.tag>65535?(n=d.getUint16(h),r=d.getUint8(h+2),256*n+r!==e.tag&&(i=!1),a=3):e.tag>255?(d.getUint16(h)!==e.tag&&(i=!1),a=2):(d.getUint8(h)!==e.tag&&(i=!1),a=1),!i&&e.required&&!t)throw new Error("required tag not found");return i&&(h+=a),i}function i(e,t){var n=r(e,t);return n&&s(),n}function a(e){var t;return r(e),t=s(),f[e.parse](t)}function o(e,t){var n,i=r(e,t);return i&&(n=s(),h+=n),i}function s(e){var t=1,n=128,r=-1,i=0,a=d.getUint8(h),o=0;for(o=0;o<8;o+=1){if((a&n)===n){i=void 0===e?a&~n:a,r=o;break}n>>=1}for(o=0;o<r;o+=1,t+=1)i=i<<8|255&d.getUint8(h+t);return h+=t,i}function u(e){var t;switch(e){case 4:t=d.getFloat32(h),h+=4;break;case 8:t=d.getFloat64(h),h+=8}return t}function l(e){for(var t=0,n=0;n<e;n+=1)t<<=8,t|=255&d.getUint8(h+n);return h+=e,t}function c(){return h<d.byteLength}e=e||{};var f,d=new DataView(e.data),h=0;return f={getPos:t,setPos:n,consumeTag:r,consumeTagAndSize:i,parseTag:a,skipOverElement:o,getMatroskaCodedNum:s,getMatroskaFloat:u,getMatroskaUint:l,moreData:c}}function Vr(){function e(){p=Xd(T).getInstance(),_=Vh(T).create({errHandler:g,metricsModel:E,mediaPlayerModel:m,requestModifier:p})}function t(e){if(!(e.baseURLController&&e.metricsModel&&e.mediaPlayerModel&&e.errHandler))throw new Error(Ys.MISSING_CONFIG_ERROR);y=e.baseURLController,E=e.metricsModel,m=e.mediaPlayerModel,g=e.errHandler}function n(e){var t,n,r=[],i=qh(T).create({data:e});for(i.consumeTagAndSize(h.Segment.Cues);i.moreData()&&i.consumeTagAndSize(h.Segment.Cues.CuePoint,!0);){for(t={},t.CueTime=i.parseTag(h.Segment.Cues.CuePoint.CueTime),t.CueTracks=[];i.moreData()&&i.consumeTag(h.Segment.Cues.CuePoint.CueTrackPositions,!0);){var a=i.getMatroskaCodedNum(),o=i.getPos();if(n={},n.Track=i.parseTag(h.Segment.Cues.CuePoint.CueTrackPositions.CueTrack),0===n.Track)throw new Error("Cue track cannot be 0");n.ClusterPosition=i.parseTag(h.Segment.Cues.CuePoint.CueTrackPositions.CueClusterPosition),t.CueTracks.push(n),i.setPos(o+a)}if(0===t.CueTracks.length)throw new Error("Mandatory cuetrack not found");r.push(t)}if(0===r.length)throw new Error("mandatory cuepoint not found");return r}function r(e,t,r,i){var a,o,s,u,l,c,f,h;for(o=n(e),s=[],l=0,c=o.length;l<c;l+=1)u=new xd,a=0,a=l<o.length-1?o[l+1].CueTime-o[l].CueTime:i-o[l].CueTime,u.duration=a,u.startTime=o[l].CueTime,u.timescale=1e3,f=o[l].CueTracks[0].ClusterPosition+t,h=l<o.length-1?o[l+1].CueTracks[0].ClusterPosition+t-1:r-1,u.mediaRange=f+"-"+h,s.push(u);return d.debug("Parsed cues: "+s.length+" cues."),s}function i(e,t,n,i){var a,o,s,u,c=qh(T).create({data:e}),f=n.split("-"),g=null,p={url:t,range:{start:parseFloat(f[0]),end:parseFloat(f[1])},request:g};for(d.debug("Parse EBML header: "+p.url),c.skipOverElement(h.EBML),c.consumeTag(h.Segment),s=c.getMatroskaCodedNum(),s+=c.getPos(),u=c.getPos();c.moreData()&&!c.consumeTagAndSize(h.Segment.Info,!0);)if(!(c.skipOverElement(h.Segment.SeekHead,!0)||c.skipOverElement(h.Segment.Tracks,!0)||c.skipOverElement(h.Segment.Cues,!0)||c.skipOverElement(h.Void,!0)))throw new Error("no valid top level element found");for(;void 0===a;){var E=c.getMatroskaCodedNum(!0),m=c.getMatroskaCodedNum();switch(E){case h.Segment.Info.Duration.tag:a=c[h.Segment.Info.Duration.parse](m);break;default:c.setPos(c.getPos()+m)}}g=l(p);var y=function(e){o=r(e,u,s,a),i(o)},v=function(){d.error("Download Error: Cues "+p.url),i(null)};_.load({request:g,success:y,error:v}),d.debug("Perform cues load: "+p.url+" bytes="+p.range.start+"-"+p.range.end)}function a(){if(!y||!y.hasOwnProperty("resolve"))throw new Error("setConfig function has to be called previously")}function o(e,t){a();var n=null,r=y.resolve(e.path),i=r?r.url:void 0,o=e.range.split("-"),s=t||{range:{start:parseFloat(o[0]),end:parseFloat(o[1])},request:n,url:i,init:!0};d.info("Start loading initialization."),n=l(s);var u=function(){v.trigger(uu.INITIALIZATION_LOADED,{representation:e})},c=function(){v.trigger(uu.INITIALIZATION_LOADED,{representation:e})};_.load({request:n,success:u,error:c}),d.debug("Perform init load: "+s.url)}function s(e,t,n,r){a();var o=null,s=y.resolve(e.path),c=s?s.url:void 0,f={bytesLoaded:0,bytesToLoad:8192,range:{start:0,end:8192},request:o,url:c,init:!1};r=r||u,o=l(f),d.debug("Parsing ebml header");var h=function(a){i(a,c,n,function(n){r(n,e,t)})},g=function(){r(null,e,t)};_.load({request:o,success:h,error:g})}function u(e,t,n){e?v.trigger(uu.SEGMENTS_LOADED,{segments:e,representation:t,mediaType:n}):v.trigger(uu.SEGMENTS_LOADED,{segments:null,representation:t,mediaType:n,error:new Fu(lf.SEGMENT_BASE_LOADER_ERROR_CODE,lf.SEGMENT_BASE_LOADER_ERROR_MESSAGE)})}function l(e){var t=new lu;return t.type=e.init?Cl.INIT_SEGMENT_TYPE:Cl.MEDIA_SEGMENT_TYPE,t.url=e.url,t.range=e.range.start+"-"+e.range.end,t}function c(){g=null,p=null}var f,d,h,g,p,E,m,_,y,T=this.context,v=iu(T).getInstance();return f={setConfig:t,initialize:e,loadInitialization:o,loadSegments:s,reset:c},function(){d=Eu(T).getInstance().getLogger(f),h={EBML:{tag:440786851,required:!0},Segment:{tag:408125543,required:!0,SeekHead:{tag:290298740,required:!0},Info:{tag:357149030,required:!0,TimecodeScale:{tag:2807729,required:!0,parse:"getMatroskaUint"},Duration:{tag:17545,required:!0,parse:"getMatroskaFloat"}},Tracks:{tag:374648427,required:!0},Cues:{tag:475249515,required:!0,CuePoint:{tag:187,required:!0,CueTime:{tag:179,required:!0,parse:"getMatroskaUint"},CueTrackPositions:{tag:183,required:!0,CueTrack:{tag:247,required:!0,parse:"getMatroskaUint"},CueClusterPosition:{tag:241,required:!0,parse:"getMatroskaUint"}}}}},Void:{tag:236,required:!0}}}(),f}function Hr(e){function t(e){return"webm"===e.split("/")[1].toLowerCase()}function n(t){O=t,D.initialize(),L=Wd(P).create(e,i())}function r(){return O?O.getType():null}function i(){var e=O?O.getStreamInfo():null;return e?e.manifestInfo.isDynamic:null}function a(){return O?O.getMediaInfo():null}function o(){return O}function s(e){w=e}function u(){return w}function l(){C=-1}function c(){l(),w=0,N=null,O=null,L=null}function f(){c(),F.off(uu.INITIALIZATION_LOADED,R,b),F.off(uu.SEGMENTS_LOADED,I,b)}function d(e,t,n){var r,i,a=K.resolve(n.path);return a&&t!==a.url&&x.isRelative(t)?(r=a.url,i=a.serviceLocation,t&&(r=x.resolve(t,r))):r=t,!x.isRelative(r)&&(e.url=r,e.serviceLocation=i,!0)}function h(e,t){var n=new lu,r=e.adaptation.period,o=r.start,s=i();if(n.mediaType=t,n.type=Cl.INIT_SEGMENT_TYPE,n.range=e.range,n.availabilityStartTime=U.calcAvailabilityStartTimeFromPresentationTime(o,r.mpd,s),n.availabilityEndTime=U.calcAvailabilityEndTimeFromPresentationTime(o+r.duration,r.mpd,s),n.quality=e.index,n.mediaInfo=a(),n.representationId=e.id,d(n,e.initialization,e))return n}function g(e){return e?h(e,r()):null}function p(e){var t=!1,n=i();if(n||C!==e.availableSegmentsNumber){var r=Mr(C,e);if(r){var a=parseFloat((r.presentationStartTime-e.adaptation.period.start).toFixed(5)),o=e.adaptation.period.duration;M.debug(e.segmentInfoType+": "+a+" / "+o),t=(e.segmentInfoType!==kd.SEGMENT_TIMELINE||!n)&&a>=o}else M.debug("isMediaFinished - no segment found")}else t=!0;return t}function E(e){L.getSegments(e,N,C,m)}function m(e,t){if(e.segments=t,t&&t.length>0&&i()){var n=t[t.length-1],r=n.presentationStartTime,a=k.getMetricsFor(Ys.STREAM);U.setExpectedLiveEdge(r),k.updateManifestUpdateInfo(B.getCurrentManifestUpdate(a),{presentationStartTime:r})}}function _(e){if(!e)throw new Error("no representation");e.segments=null,E(e)}function y(e,t){var n,a=Gd.hasInitialization(e),o=Gd.hasSegments(e);if(e.segmentDuration||e.segments||_(e),e.segmentAvailabilityRange=U.calcSegmentAvailabilityRange(e,i()),e.segmentAvailabilityRange.end<e.segmentAvailabilityRange.start&&!e.useCalculatedLiveEdgeTime)return n=new Fu(lf.SEGMENTS_UNAVAILABLE_ERROR_CODE,lf.SEGMENTS_UNAVAILABLE_ERROR_MESSAGE,{availabilityDelay:e.segmentAvailabilityRange.start-e.segmentAvailabilityRange.end}),void F.trigger(uu.REPRESENTATION_UPDATED,{sender:this,representation:e,error:n});t||l(),e.segmentDuration&&_(e),a||D.loadInitialization(e),o||D.loadSegments(e,r(),e.indexRange),a&&o&&F.trigger(uu.REPRESENTATION_UPDATED,{sender:this,representation:e})}function T(e,t,n){var r,i,a,o,s,u=t.segments,l=u?u.length:null,c=-1;if(u&&l>0)for(n=void 0===n||null===n?G.getSegmentOverlapToleranceTime():n,s=0;s<l;s++)if(i=u[s],a=i.presentationStartTime,o=i.duration,r=void 0===n||null===n?o/2:n,e+r>=a&&e-r<a+o){c=i.availabilityIdx;break}return c}function v(e){if(null===e||void 0===e)return null;var t=new lu,n=e.representation,i=n.adaptation.period.mpd.manifest.Period_asArray[n.adaptation.period.index].AdaptationSet_asArray[n.adaptation.index].Representation_asArray[n.index].bandwidth,o=e.media;return o=Ir(o,"Number",e.replacementNumber),o=Ir(o,"Time",e.replacementTime),o=Ir(o,"Bandwidth",i),o=Rr(o,n.id),o=Ar(o),t.mediaType=r(),t.type=Cl.MEDIA_SEGMENT_TYPE,t.range=e.mediaRange,t.startTime=e.presentationStartTime,t.duration=e.duration,t.timescale=n.timescale,t.availabilityStartTime=e.availabilityStartTime,t.availabilityEndTime=e.availabilityEndTime,t.wallStartTime=e.wallStartTime,t.quality=n.index,t.index=e.availabilityIdx,t.mediaInfo=a(),t.adaptationIndex=n.adaptation.index,t.representationId=n.id,d(t,o,n)?t:void 0}function S(e,t,n){var o,s,u;if(!e)return null;var l=r(),c=C,f=!!n&&n.keepIdx,d=n?n.timeThreshold:null,h=!(!n||!n.ignoreIsFinished);return N!==t&&(N=t,M.debug("Getting the request for "+l+" time : "+t)),E(e),C=T(t,e,d),C<0&&(E(e),C=T(t,e,d)),C>=0&&M.debug("Index for "+l+" time "+t+" is "+C),u=!h&&p(e),u?(o=new lu,o.action=lu.ACTION_COMPLETE,o.index=C,o.mediaType=l,o.mediaInfo=a(),M.debug("Signal complete in getSegmentRequestForTime -",l)):(s=Mr(C,e),o=v(s)),f&&c>=0&&(C=e.segmentInfoType===kd.SEGMENT_TIMELINE&&i()?C:c),o}function A(e){var t,n,o;if(!e||-1===C)return null;var s=r(),u=i();return N=null,C++,M.debug("Getting the next request at index: "+C+", type: "+s),!Mr(C,e)&&u?(M.debug("No segment found at index: "+C+". Wait for next loop"),E(e),C--,null):(o=p(e),o?(t=new lu,t.action=lu.ACTION_COMPLETE,t.index=C,t.mediaType=s,t.mediaInfo=a(),M.debug("Signal complete -",s)):(E(e),n=Mr(C,e),t=v(n),!n&&u&&C--),t)}function R(e){var t=e.representation;t.segments&&F.trigger(uu.REPRESENTATION_UPDATED,{sender:this,representation:t})}function I(e){if(!e.error&&r()===e.mediaType){var t,n,a,o,s=e.segments,u=e.representation,l=[],c=0;for(t=0,n=s.length;t<n;t++)a=s[t],o=br(U,i(),u,a.startTime,a.duration,a.timescale,a.media,a.mediaRange,c),l.push(o),o=null,c++;u.segmentAvailabilityRange={start:l[0].presentationStartTime,end:l[n-1].presentationStartTime},u.availableSegmentsNumber=n,m(u,l),Gd.hasInitialization(u)&&F.trigger(uu.REPRESENTATION_UPDATED,{sender:this,representation:u})}}e=e||{};var D,b,M,C,N,w,O,L,P=this.context,F=iu(P).getInstance(),x=Hd(P).getInstance(),U=e.timelineConverter,B=e.dashMetrics,k=e.metricsModel,G=e.mediaPlayerModel,Y=e.errHandler,K=e.baseURLController;return b={initialize:n,getStreamProcessor:o,getInitRequest:g,getSegmentRequestForTime:S,getNextSegmentRequest:A,updateRepresentation:y,updateSegmentList:_,setCurrentTime:s,getCurrentTime:u,reset:f,resetIndex:l},function(){M=Eu(P).getInstance().getLogger(b),c(),D=t(e.mimeType)?jh(P).getInstance():Hh(P).getInstance(),D.setConfig({baseURLController:K,metricsModel:k,mediaPlayerModel:G,errHandler:Y}),F.on(uu.INITIALIZATION_LOADED,R,b),F.on(uu.SEGMENTS_LOADED,I,b)}(),b}function qr(e){function t(t){q=zh(j).create({mimeType:X,timelineConverter:Q,dashMetrics:ue,metricsModel:se,mediaPlayerModel:J,baseURLController:e.baseURLController,errHandler:W}),q.initialize(x),te.registerStreamType(z,x),V=ee.getFragmentController().getModel(z),V.setStreamProcessor(x),k=F(z),G=Ud(j).create({type:z,mimeType:X,metricsModel:se,adapter:Z,dashMetrics:ue,dashManifestModel:le,timelineConverter:Q,mediaPlayerModel:J,abrController:te,playbackController:ne,streamController:re,textController:ae,streamProcessor:x,mediaController:ie}),K=Yd(j).create(),K.setConfig({abrController:te,domStorage:oe,metricsModel:se,dashMetrics:ue,dashManifestModel:le,manifestModel:$,playbackController:ne,timelineConverter:Q,streamProcessor:x}),k.initialize(t),G.initialize(),K.initialize()}function n(e){H.push(e)}function r(e){var t=H.indexOf(e);-1!==t&&H.splice(t,1)}function i(){return H}function a(){H=[]}function o(){B=[],U=null,a()}function s(e,t){q.reset(),k&&(k.reset(e,t),k=null),G&&(G.reset(),G=null),K&&(K.reset(),K=null),te&&te.unRegisterStreamType(z),H.forEach(function(e){e.reset()}),o(),z=null,ee=null,Y&&(Y.reset(),Y=null)}function u(){return!!K&&K.isUpdating()}function l(){return z}function c(){return K}function f(){return q}function d(){return ee?ee.getFragmentController():null}function h(){return k.getBuffer()}function g(e){k.setBuffer(e)}function p(){return k}function E(){return V}function m(){return Y}function _(){return ee?ee.getStreamInfo():null}function y(e){ee&&ee.addInbandEvents(e)}function T(e){e===U||e&&U&&e.type!==U.type||(U=e),Z.updateData(this)}function v(e,t){-1===B.indexOf(e)&&B.push(e),t&&this.selectMediaInfo(e)}function S(){return B}function A(){return U}function R(){return k.getMediaSource()}function I(e){k.setMediaSource(e,A())}function D(){k.dischargePreBuffer()}function b(){return G}function M(e){return Z.getRepresentationInfo(K,e)}function C(){return!!k&&k.getIsBufferingCompleted()}function N(e){return!!k&&null!==k.getRangeAt(e,0)}function w(){return k.getBufferLevel()}function O(e,t){k&&k.switchInitData(_().id,e,t)}function L(e){return k.getBuffer()||k.createBuffer(U,e)}function P(){G.switchTrackAsked()}function F(e){return e===Ys.VIDEO||e===Ys.AUDIO?gd(j).create({type:e,metricsModel:se,mediaPlayerModel:J,manifestModel:$,errHandler:W,streamController:re,mediaController:ie,adapter:Z,textController:ae,abrController:te,playbackController:ne,streamProcessor:x}):wd(j).create({type:e,mimeType:X,metricsModel:se,mediaPlayerModel:J,manifestModel:$,errHandler:W,streamController:re,mediaController:ie,adapter:Z,textController:ae,abrController:te,playbackController:ne,streamProcessor:x})}e=e||{};var x,U,B,k,G,Y,K,V,H,q,j=this.context,z=e.type,W=e.errHandler,X=e.mimeType,Q=e.timelineConverter,Z=e.adapter,$=e.manifestModel,J=e.mediaPlayerModel,ee=e.stream,te=e.abrController,ne=e.playbackController,re=e.streamController,ie=e.mediaController,ae=e.textController,oe=e.domStorage,se=e.metricsModel,ue=e.dashMetrics,le=e.dashManifestModel;return x={initialize:t,isUpdating:u,getType:l,getBufferController:p,getFragmentModel:E,getScheduleController:b,getLiveEdgeFinder:m,getFragmentController:d,getRepresentationController:c,getIndexHandler:f,getRepresentationInfo:M,getBufferLevel:w,switchInitData:O,isBufferingCompleted:C,timeIsBuffered:N,createBuffer:L,getStreamInfo:_,selectMediaInfo:T,addMediaInfo:v,switchTrackAsked:P,getMediaInfoArr:S,getMediaInfo:A,getMediaSource:R,setMediaSource:I,dischargePreBuffer:D,getBuffer:h,setBuffer:g,registerExternalController:n,unregisterExternalController:r,getExternalControllers:i,unregisterAllExternalController:a,addInbandEvents:y,reset:s},function(){ne&&ne.getIsDynamic()&&(Y=Md(j).create({timelineConverter:Q,streamProcessor:x})),o()}(),x}function jr(){function e(){R=!1,E={},m={},_={},y=null,T=100,v=Date.now()/1e3}function t(){if(!S||!A)throw new Error("setConfig function has to be called previously")}function n(){null!==y&&R&&(clearInterval(y),y=null,R=!1)}function r(){t(),p.debug("Start Event Controller"),R||isNaN(T)||(R=!0,y=setInterval(u,T))}function i(e){if(t(),E={},e)for(var n=0;n<e.length;n++){var r=e[n];E[r.id]=r,p.debug("Add inline event with id "+r.id)}p.debug("Added "+e.length+" inline events")}function a(e){t();for(var n=0;n<e.length;n++){var r=e[n];r.id in m?p.debug("Repeated event with id "+r.id):(r.eventStream.schemeIdUri===I&&void 0===m[r.id]&&o(r),m[r.id]=r,p.debug("Add inband event with id "+r.id))}}function o(e){if(e.eventStream.value==D){var t,n=e.eventStream.timescale||1,r=e.presentationTime/n;t=4294967295==e.presentationTime?NaN:(e.presentationTime+e.duration)/n,p.info("Manifest validity changed: Valid until: "+r+"; remaining duration: "+t),N.trigger(uu.MANIFEST_VALIDITY_CHANGED,{id:e.id,validUntil:r,newDuration:t,newManifestValidAfter:NaN})}}function s(){if(_)for(var e=A.getTime(),t=Object.keys(_),n=0;n<t.length;n++){var r=t[n],i=_[r];null!==i&&(i.duration+i.presentationTime)/i.eventStream.timescale<e&&(p.debug("Remove Event "+r+" at time "+e),i=null,delete _[r])}}function u(){var e=A.getTime(),t=e-v;v=e,f(m,t,e),f(E,t,e),s()}function l(){t(),S.refreshManifest()}function c(e){Qd(C).create({}).load({method:"get",url:e,request:{responseType:"arraybuffer"}})}function f(e,t,n){var r;if(e)for(var i=Object.keys(e),a=0;a<i.length;a++){var o=i[a],s=e[o];void 0!==s&&(0===(r=s.presentationTime/s.eventStream.timescale)||r<=n&&r+t>n)&&(p.debug("Start Event "+o+" at "+n),s.duration>0&&(_[o]=s),s.eventStream.schemeIdUri==I&&s.eventStream.value==D?0===s.duration&&0===s.presentationTimeDelta||l():s.eventStream.schemeIdUri==b&&s.eventStream.value==M?c(s.messageData):N.trigger(s.eventStream.schemeIdUri,{event:s}),delete e[o])}}function d(e){e&&(e.manifestUpdater&&(S=e.manifestUpdater),e.playbackController&&(A=e.playbackController))}function h(){n(),e()}var g,p,E,m,_,y,T,v,S,A,R,I="urn:mpeg:dash:event:2012",D=1,b="urn:mpeg:dash:event:callback:2015",M=1,C=this.context,N=iu(C).getInstance();return g={addInlineEvents:i,addInbandEvents:a,stop:n,start:r,setConfig:d,reset:h},function(){p=Eu(C).getInstance().getLogger(g),e()}(),g}function zr(e){function t(e){var t=function(t){u.trigger(uu.CHECK_FOR_EXISTENCE_COMPLETED,{request:e,exists:t})};if(e){var n=new Zh(e.url);o.load({request:n,success:function(){t(!0)},error:function(){t(!1)}})}else t(!1)}function n(e){var t=function(t,n){u.trigger(uu.LOADING_COMPLETED,{request:e,response:t||null,error:n||null,sender:a})};e?o.load({request:e,progress:function(t){u.trigger(uu.LOADING_PROGRESS,{request:e,stream:t.stream}),t.data&&u.trigger(uu.LOADING_DATA_PROGRESS,{request:e,response:t.data||null,error:null,sender:a})},success:function(e){t(e)},error:function(e,n,r){t(void 0,new Fu(lf.FRAGMENT_LOADER_LOADING_FAILURE_ERROR_CODE,r,n))},abort:function(e){e&&u.trigger(uu.LOADING_ABANDONED,{request:e,mediaType:e.mediaType,sender:a})}}):t(void 0,new Fu(lf.FRAGMENT_LOADER_NULL_REQUEST_ERROR_CODE,lf.FRAGMENT_LOADER_NULL_REQUEST_ERROR_MESSAGE))}function r(){o&&o.abort()}function i(){o&&(o.abort(),o=null)}e=e||{};var a,o,s=this.context,u=iu(s).getInstance();return a={checkForExistence:t,load:n,abort:r,reset:i},function(){var t=zl(s).getInstance();o=Vh(s).create({errHandler:e.errHandler,metricsModel:e.metricsModel,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,boxParser:t,useFetch:e.mediaPlayerModel.getLowLatencyEnabled()})}(),a}function Wr(e){function t(e){var t=l[e];return t||(t=Tu(c).create({metricsModel:g,fragmentLoader:$h(c).create({metricsModel:g,mediaPlayerModel:h,errHandler:d,requestModifier:Xd(c).getInstance()})}),l[e]=t),t}function n(e){return e&&e.type&&e.type===Cl.INIT_SEGMENT_TYPE}function r(){for(var e in l)l[e].reset();l={}}function i(){f.off(uu.FRAGMENT_LOADING_COMPLETED,o,this),f.off(uu.FRAGMENT_LOADING_PROGRESS,o,this),r()}function a(e,t,n,r){var i=new Qh;return i.streamId=n,i.mediaInfo=t.mediaInfo,i.segmentType=t.type,i.start=t.startTime,i.duration=t.duration,i.end=i.start+i.duration,i.bytes=e,i.index=t.index,i.quality=t.quality,i.representationId=t.representationId,i.endFragment=r,i}function o(e){if(l[e.request.mediaType]===e.sender){var t=e.request,r=e.response,i=n(t),o=t.mediaInfo.streamInfo;if(e.error&&(e.request.mediaType!==Ys.AUDIO&&e.request.mediaType!==Ys.VIDEO&&e.request.mediaType!==Ys.FRAGMENTED_TEXT||f.trigger(uu.SERVICE_LOCATION_BLACKLIST_ADD,{entry:e.request.serviceLocation})),!r||!o)return void u.warn("No "+t.mediaType+" bytes to push or stream is inactive.");var s=a(r,t,o.id,e.type!==uu.FRAGMENT_LOADING_PROGRESS);f.trigger(i?uu.INIT_FRAGMENT_LOADED:uu.MEDIA_FRAGMENT_LOADED,{chunk:s,fragmentModel:e.sender})}}e=e||{};var s,u,l,c=this.context,f=iu(c).getInstance(),d=e.errHandler,h=e.mediaPlayerModel,g=e.metricsModel;return s={getModel:t,isInitializationRequest:n,reset:i},function(){u=Eu(c).getInstance().getLogger(s),r(),f.on(uu.FRAGMENT_LOADING_COMPLETED,o,s),f.on(uu.FRAGMENT_LOADING_PROGRESS,o,s)}(),s}function Xr(e){function t(){c(),g=Qd(m).create({}),E=zl(m).getInstance(),p=Hh(m).getInstance(),p.setConfig({baseURLController:T,metricsModel:A,mediaPlayerModel:R,errHandler:I}),r()}function n(e,t){var n,r,i,a,o=[],s=0;for(n=0,r=e.length;n<r;n++)i=e[n],a=br(S,_.getIsDynamic(),t,i.startTime,i.duration,i.timescale,i.media,i.mediaRange,s),o.push(a),a=null,s++;return o}function r(){if(v&&_&&y){var e=v.getStreamInfo();if(e){var t=y.getMediaInfoForType(e,Ys.IMAGE);if(t){var n=y.getDataForMedia(t);if(n){var r=_.getRepresentationsForAdaptation(n);r&&r.length>0&&r.forEach(function(e){e.segmentInfoType===kd.SEGMENT_TEMPLATE&&e.segmentDuration>0&&e.media&&i(e),e.segmentInfoType===kd.SEGMENT_BASE&&i(e,!0)}),d.length>0&&(d.sort(function(e,t){return e.bitrate-t.bitrate}),h=d.length-1)}}}}}function i(e,t){var r=new tg;r.id=e.id,r.bitrate=e.bandwidth,r.width=e.width,r.height=e.height,r.tilesHor=1,r.tilesVert=1,e.essentialProperties&&e.essentialProperties.forEach(function(e){if(ng.indexOf(e.schemeIdUri)>=0&&e.value){var t=e.value.split("x");2!==t.length||isNaN(t[0])||isNaN(t[1])||(r.tilesHor=parseInt(t[0],10),r.tilesVert=parseInt(t[1],10))}}),t?p.loadSegments(e,Ys.IMAGE,e.indexRange,{},function(e,t){var i=[];e=n(e,t),r.segmentDuration=e[0].duration,r.readThumbnail=function(n,r){var a=null;i.some(function(e){if(e.start<=n&&e.end>n)return a=e.url,!0}),a?r(a):e.some(function(e){if(e.mediaStartTime<=n&&e.mediaStartTime+e.duration>n){var a=T.resolve(t.path);return g.load({method:"get",url:a.url,request:{range:e.mediaRange,responseType:"arraybuffer"},onload:function(t){var n=E.getSamplesInfo(t.target.response),a=new Blob([t.target.response.slice(n.sampleList[0].offset,n.sampleList[0].offset+n.sampleList[0].size)],{type:"image/jpeg"}),o=window.URL.createObjectURL(a);i.push({start:e.mediaStartTime,end:e.mediaStartTime+e.duration,url:o}),r&&r(o)}}),!0}})}}):(r.startNumber=e.startNumber,r.segmentDuration=e.segmentDuration,r.timescale=e.timescale,r.templateUrl=a(e)),r.tilesHor>0&&r.tilesVert>0&&(r.widthPerTile=r.width/r.tilesHor,r.heightPerTile=r.height/r.tilesVert,d.push(r))}function a(e){var t=D.isRelative(e.media)?D.resolve(e.media,T.resolve(e.path).url):e.media;return t?Rr(t,e.id):""}function o(){return d}function s(){return h}function u(){return h<0?null:d[h]}function l(e){d&&0!==d.length&&(e>=d.length&&(e=d.length-1),h=e)}function c(){d=[],h=-1}var f,d,h,g,p,E,m=this.context,_=e.dashManifestModel,y=e.adapter,T=e.baseURLController,v=e.stream,S=e.timelineConverter,A=e.metricsModel,R=e.mediaPlayerModel,I=e.errHandler,D=Hd(m).getInstance();return f={initialize:t,getTracks:o,reset:c,setTrackByIndex:l,getCurrentTrack:u,getCurrentTrackIndex:s},t(),f}function Qr(e){function t(e,t){var r=u.getCurrentTrack();if(!r||r.segmentDuration<=0||void 0===e||null===e)return null;var i=Math.floor(e/r.segmentDuration),a=e%r.segmentDuration,o=Math.floor(a*r.tilesHor*r.tilesVert/r.segmentDuration),s=new eg;return s.width=Math.floor(r.widthPerTile),s.height=Math.floor(r.heightPerTile),s.x=Math.floor(o%r.tilesHor)*r.widthPerTile,s.y=Math.floor(o/r.tilesHor)*r.heightPerTile,"readThumbnail"in r?r.readThumbnail(e,function(e){s.url=e,t&&t(s)}):(s.url=n(r,i),t&&t(s),s)}function n(e,t){var n=t+e.startNumber,r=Ir(e.templateUrl,"Number",n);return r=Ir(r,"Time",(n-1)*e.segmentDuration),r=Ir(r,"Bandwidth",e.bandwidth),Ar(r)}function r(e){u.setTrackByIndex(e)}function i(){return u.getCurrentTrackIndex()}function a(){var e=0;return u.getTracks().map(function(t){var n=new Kf;return n.mediaType=Ys.IMAGE,n.qualityIndex=e++,n.bitrate=t.bitrate,n.width=t.width,n.height=t.height,n})}function o(){u&&u.reset()}var s,u,l=this.context;return s={get:t,setTrackByIndex:r,getCurrentTrackIndex:i,getBitrateList:a,reset:o},function(){o(),u=rg(l).create({dashManifestModel:e.dashManifestModel,adapter:e.adapter,baseURLController:e.baseURLController,stream:e.stream,timelineConverter:e.timelineConverter})}(),s}function Zr(e){function t(){ce.on(uu.BUFFERING_COMPLETED,x,X),ce.on(uu.DATA_UPDATE_COMPLETED,U,X)}function n(){ce.off(uu.DATA_UPDATE_COMPLETED,U,X),ce.off(uu.BUFFERING_COMPLETED,x,X)}function r(){re&&(ce.on(uu.KEY_ERROR,S,X),ce.on(uu.SERVER_CERTIFICATE_UPDATED,S,X),ce.on(uu.LICENSE_REQUEST_COMPLETE,S,X),ce.on(uu.KEY_SYSTEM_SELECTED,S,X),ce.on(uu.KEY_SESSION_CREATED,S,X),ce.on(uu.KEY_STATUSES_CHANGED,S,X))}function i(){re&&(ce.off(uu.KEY_ERROR,S,X),ce.off(uu.SERVER_CERTIFICATE_UPDATED,S,X),ce.off(uu.LICENSE_REQUEST_COMPLETE,S,X),ce.off(uu.KEY_SYSTEM_SELECTED,S,X),ce.off(uu.KEY_SESSION_CREATED,S,X),ce.off(uu.KEY_STATUSES_CHANGED,S,X))}function a(e,t){ee=e,re=t,r()}function o(e,t){if(!$){var n;return ce.on(uu.CURRENT_TRACK_CHANGED,R,X),z()?(w(),n=t):n=N(e,t),$=!0,n}return t}function s(e){for(var t=Z?Z.length:0,n=0;n<t;n++){Z[n].getFragmentModel().removeExecutedRequestsBeforeTime(h()+d()),Z[n].reset(!1,e)}Z=[],$=!1,J=!1,j(!1),ce.off(uu.CURRENT_TRACK_CHANGED,R,X)}function u(){return $}function l(e){for(var t=0;t<Z.length;)A(Z[t].getMediaInfo())?(Z[t].setMediaSource(e),t++):(Z[t].reset(),Z.splice(t,1));for(var n=0;n<Z.length;n++)Z[n].dischargePreBuffer();if(0===Z.length){var r="No streams to play.";me.manifestError(r,"nostreams",fe.getValue()),me.error(new Fu(lf.MANIFEST_ERROR_ID_NOSTREAMS_CODE,r+"nostreams",fe.getValue())),Q.fatal(r)}}function c(){s(),ee=null,te={},ne=!1}function f(){ve&&ve.pause(),ie&&(ie.reset(),ie=null),c(),n(),i(),j(!1)}function d(){return ee?ee.duration:NaN}function h(){return ee?ee.start:NaN}function g(){return ee?ee.id:null}function p(){return ee}function E(){return ie}function m(){return ae}function _(){if(!(Te&&Te.hasOwnProperty("getBitrateList")&&pe&&pe.hasOwnProperty("getAllMediaInfoForType")&&pe.hasOwnProperty("getEventsFor")))throw new Error(Ys.MISSING_CONFIG_ERROR)}function y(e){if(_(),e===Ys.IMAGE)return ae?ae.getBitrateList():[];var t=P(e);return Te.getBitrateList(t)}function T(){oe&&oe.start()}function v(){oe&&oe.stop()}function S(e){e.error&&(me.mediaKeySessionError(e.error.message),me.error(e.error),Q.fatal(e.error.message),f())}function A(e){var t,n,r=e.type;if(r===Ys.MUXED&&e)return n="Multiplexed representations are intentionally not supported, as they are not compliant with the DASH-AVC/264 guidelines",Q.fatal(n),me.manifestError(n,"multiplexedrep",fe.getValue()),me.error(new Fu(lf.MANIFEST_ERROR_ID_MULTIPLEXED_CODE,n,fe.getValue())),!1;if(r===Ys.TEXT||r===Ys.FRAGMENTED_TEXT||r===Ys.EMBEDDED_TEXT||r===Ys.IMAGE)return!0;if(t=e.codec,Q.debug(r+" codec: "+t),e.contentProtection&&!Ee.supportsEncryptedMedia())me.capabilityError("encryptedmedia"),me.error(new Fu(lf.CAPABILITY_MEDIAKEYS_ERROR_CODE,lf.CAPABILITY_MEDIAKEYS_ERROR_MESSAGE));else if(!Ee.supportsCodec(t))return n=r+"Codec ("+t+") is not supported.",Q.error(n),!1;return!0}function R(e){if(e.newMediaInfo.streamInfo.id===ee.id){var t=B(e.newMediaInfo);if(t){var n=ve.getTime();Q.info("Stream -  Process track changed at current time "+n);var r=e.newMediaInfo,i=fe.getValue();pe.setCurrentMediaInfo(ee.id,r.type,r),Q.debug("Stream -  Update stream controller"),i.refreshManifestOnSwitchTrack?(Q.debug("Stream -  Refreshing manifest for switch track"),ue=e,ge.refreshManifest()):(t.selectMediaInfo(r),r.type!==Ys.FRAGMENTED_TEXT?(Te.updateTopQualityIndex(r),t.switchTrackAsked(),t.getFragmentModel().abortRequests()):(t.getScheduleController().setSeekTarget(NaN),pe.setIndexHandlerTime(t,n),pe.resetIndexHandler(t)))}}}function I(t,n,r,i){var a=Wh(le).create({type:t.type,mimeType:t.mimeType,timelineConverter:_e,adapter:pe,manifestModel:fe,dashManifestModel:de,mediaPlayerModel:he,metricsModel:ye,dashMetrics:e.dashMetrics,baseURLController:e.baseURLController,stream:X,abrController:Te,domStorage:e.domStorage,playbackController:ve,mediaController:Se,streamController:e.streamController,textController:Ae,errHandler:me});if(a.initialize(r),Te.updateTopQualityIndex(t),i?(a.setBuffer(i.buffer),a.getIndexHandler().setCurrentTime(i.currentTime),Z[i.replaceIdx]=a):Z.push(a),!i||!i.ignoreMediaInfo)if(t.type===Ys.TEXT||t.type===Ys.FRAGMENTED_TEXT){for(var o,s=0;s<n.length;s++)n[s].index===t.index&&(o=s),a.addMediaInfo(n[s]);a.selectMediaInfo(n[o])}else a.addMediaInfo(t,!0)}function D(t,n){var r,i=pe.getAllMediaInfoForType(ee,t),a=null;if(!i||0===i.length)return void Q.info("No "+t+" data.");for(var o=0,s=i.length;o<s;o++)if(a=i[o],t===Ys.EMBEDDED_TEXT)Ae.addEmbeddedTrack(a);else{if(!A(a))continue;Se.addTrack(a)}if(t!==Ys.EMBEDDED_TEXT&&0!==Se.getTracksFor(t,ee).length){if(t===Ys.IMAGE)return void(ae=ig(le).create({dashManifestModel:de,adapter:pe,baseURLController:e.baseURLController,stream:X,timelineConverter:e.timelineConverter}));(t!==Ys.FRAGMENTED_TEXT||t===Ys.FRAGMENTED_TEXT&&Ae.getTextDefaultEnabled())&&(Se.checkInitialMediaSettingsForType(t,ee),r=Se.getCurrentTrackFor(t,ee)),t!==Ys.FRAGMENTED_TEXT||Ae.getTextDefaultEnabled()||(r=Se.getTracksFor(t,ee)[0]),I(r,i,n)}}function b(){oe||(oe=Xh(le).create(),oe.setConfig({manifestUpdater:ge,playbackController:ve}),M())}function M(){var e=pe.getEventsFor(ee);oe.addInlineEvents(e)}function C(e){oe&&oe.addInbandEvents(e)}function N(e,t){_();var n=Re.getElement();b(),ne=!0,O(Ys.VIDEO),O(Ys.AUDIO),(null===n||n&&/^VIDEO$/i.test(n.nodeName))&&D(Ys.VIDEO,e),D(Ys.AUDIO,e),D(Ys.TEXT,e),D(Ys.FRAGMENTED_TEXT,e),D(Ys.EMBEDDED_TEXT,e),D(Ys.MUXED,e),D(Ys.IMAGE,e);var r=F(t);if(J=!0,ne=!1,0===Z.length){
var i="No streams to play.";me.manifestError(i,"nostreams",fe.getValue()),me.error(new Fu(lf.MANIFEST_ERROR_ID_NOSTREAMS_CODE,i,fe.getValue())),Q.fatal(i)}else L();return r}function w(){if(ne=!0,_(),O(Ys.VIDEO),O(Ys.AUDIO),J=!0,ne=!1,0===Z.length){var e="No streams to play.";me.manifestError(e,"nostreams",fe.getValue()),Q.debug(e)}else L()}function O(e){var t=pe.getAdaptationForType(fe.getValue(),ee.index,e,ee);t&&Array.isArray(t.Representation_asArray)&&(t.Representation_asArray=t.Representation_asArray.filter(function(e,n){if(0===n)return!0;var r=de.getCodec(t,n,!0);return!!Ee.supportsCodec(r)||(Q.error("[Stream] codec not supported: "+r),!1)}))}function L(){for(var e=Z.length,t=!!te.audio||!!te.video,n=t?new Fu(lf.DATA_UPDATE_FAILED_ERROR_CODE,lf.DATA_UPDATE_FAILED_ERROR_MESSAGE):null,r=0;r<e;r++)if(Z[r].isUpdating()||ne)return;if(J){if(re)for(var i=0;i<e&&Z[i];i++)Z[i].getType()!==Ys.AUDIO&&Z[i].getType()!==Ys.VIDEO&&Z[i].getType()!==Ys.FRAGMENTED_TEXT||re.initializeForMedia(Z[i].getMediaInfo());ce.trigger(uu.STREAM_INITIALIZED,{streamInfo:ee,error:n})}}function P(e){for(var t=Z.length,n=null,r=0;r<t;r++)if(n=Z[r],n.getType()===e)return n.getMediaInfo();return null}function F(e){for(var t={},n=0,r=Z.length;n<r;n++)t[Z[n].getType()]=Z[n].createBuffer(e).getBuffer();return t}function x(e){if(e.streamInfo===ee){var t=k(),n=t.length;if(0===n)return void Q.warn("onBufferingCompleted - can't trigger STREAM_BUFFERING_COMPLETED because no streamProcessor is defined");for(var r=0;r<n;r++)if(!t[r].isBufferingCompleted()&&(t[r].getType()===Ys.AUDIO||t[r].getType()===Ys.VIDEO))return void Q.warn("onBufferingCompleted - One streamProcessor has finished but",t[r].getType(),"one is not buffering completed");Q.debug("onBufferingCompleted - trigger STREAM_BUFFERING_COMPLETED"),ce.trigger(uu.STREAM_BUFFERING_COMPLETED,{streamInfo:ee})}}function U(e){var t=e.sender.getStreamProcessor();t.getStreamInfo()===ee&&(te[t.getType()]=e.error,L())}function B(e){return e?k().filter(function(t){return t.getType()===e.type})[0]:null}function k(){for(var e,t,n=Z.length,r=[],i=0;i<n;i++)t=Z[i],(e=t.getType())!==Ys.AUDIO&&e!==Ys.VIDEO&&e!==Ys.FRAGMENTED_TEXT&&e!==Ys.TEXT||r.push(t);return r}function G(e){Q.info("Manifest updated... updating data system wide."),$=!1,ne=!0,ee=e,oe&&M(),O(Ys.VIDEO),O(Ys.AUDIO);for(var t=0,n=Z.length;t<n;t++){var r=Z[t],i=pe.getMediaInfoForType(ee,r.getType());Te.updateTopQualityIndex(i),r.addMediaInfo(i,!0)}if(ue){if("fragmentedText"!==ue.newMediaInfo.type){var a=B(ue.oldMediaInfo);if(!a)return;a.switchTrackAsked(),ue=void 0}}ne=!1,L()}function Y(e){return H(e,Ys.VIDEO)&&H(e,Ys.AUDIO)}function K(e){return V(e,Ys.VIDEO)&&V(e,Ys.AUDIO)}function V(e,t){if(!e)return!1;var n=e.getStreamInfo(),r=p();if(!n||!r)return!1;var i=pe.getAdaptationForType(fe.getValue(),n.index,t,n),a=pe.getAdaptationForType(fe.getValue(),r.index,t,r);return i&&a?!i.ContentProtection&&!a.ContentProtection:!i&&!a}function H(e,t){if(!e)return!1;var n=e.getStreamInfo(),r=p();if(!n||!r)return!1;var i=pe.getAdaptationForType(fe.getValue(),n.index,t,n),a=pe.getAdaptationForType(fe.getValue(),r.index,t,r);if(!i||!a)return!i&&!a;var o=i&&a&&i.mimeType===a.mimeType,s=a.Representation_asArray.map(function(e){return e.codecs}),u=i.Representation_asArray.map(function(e){return e.codecs}),l=u.some(function(e){return s.indexOf(e)>-1}),c=u.some(function(e){return s.some(function(t){return q(t,e)})});return l||c&&o}function q(e,t){for(var n,r=e.split(".")[0],i=0===t.indexOf(r),a=0;a<Ie.length;a++)if(Ie[a].codec===r){n=Ie[a];break}return n?i||n.compatibleCodecs.some(function(e){return 0===t.indexOf(e)}):i}function j(e){se=e}function z(){return se}function W(e,t){b(),D(Ys.VIDEO,e),D(Ys.AUDIO,e),D(Ys.TEXT,e),D(Ys.FRAGMENTED_TEXT,e),D(Ys.EMBEDDED_TEXT,e),D(Ys.MUXED,e),D(Ys.IMAGE,e),F(t),ce.on(uu.CURRENT_TRACK_CHANGED,R,X);for(var n=0;n<Z.length&&Z[n];n++)Z[n].getScheduleController().start();j(!0)}e=e||{};var X,Q,Z,$,J,ee,te,ne,re,ie,ae,oe,se,ue,le=this.context,ce=iu(le).getInstance(),fe=e.manifestModel,de=e.dashManifestModel,he=e.mediaPlayerModel,ge=e.manifestUpdater,pe=e.adapter,Ee=e.capabilities,me=e.errHandler,_e=e.timelineConverter,ye=e.metricsModel,Te=e.abrController,ve=e.playbackController,Se=e.mediaController,Ae=e.textController,Re=e.videoModel,Ie=[{codec:"avc1",compatibleCodecs:["avc3"]},{codec:"avc3",compatibleCodecs:["avc1"]}];return X={initialize:a,activate:o,deactivate:s,isActive:u,getDuration:d,getStartTime:h,getId:g,getStreamInfo:p,preload:W,getFragmentController:E,getThumbnailController:m,getBitrateListFor:y,startEventController:T,stopEventController:v,updateData:G,reset:f,getProcessors:k,setMediaSource:l,isMediaCodecCompatible:Y,isProtectionCompatible:K,getPreloaded:z,addInbandEvents:C},function(){Q=Eu(le).getInstance().getLogger(X),c(),ie=Jh(le).create({mediaPlayerModel:he,metricsModel:ye,errHandler:me}),t()}(),X}function $r(){function e(e){e&&(e.manifestModel&&(v=e.manifestModel),e.dashManifestModel&&(S=e.dashManifestModel),e.mediaPlayerModel&&(R=e.mediaPlayerModel),e.manifestLoader&&(T=e.manifestLoader),e.errHandler&&(A=e.errHandler))}function t(){r(),D.on(uu.STREAMS_COMPOSED,h,this),D.on(uu.PLAYBACK_STARTED,f,this),D.on(uu.PLAYBACK_PAUSED,d,this),D.on(uu.INTERNAL_MANIFEST_LOADED,c,this)}function n(e){u(e)}function r(){E=NaN,y=!1,_=!0,a()}function i(){D.off(uu.PLAYBACK_STARTED,f,this),D.off(uu.PLAYBACK_PAUSED,d,this),D.off(uu.STREAMS_COMPOSED,h,this),D.off(uu.INTERNAL_MANIFEST_LOADED,c,this),r()}function a(){null!==m&&(clearInterval(m),m=null)}function o(e){a(),isNaN(e)&&!isNaN(E)&&(e=1e3*E),isNaN(e)||(p.debug("Refresh manifest in "+e+" milliseconds."),m=setTimeout(l,e))}function s(){y=!0;var e=v.getValue(),t=e.url,n=S.getLocation(e);n&&(t=n),T.load(t)}function u(e){v.setValue(e);var t=new Date,n=(t.getTime()-e.loadedTime.getTime())/1e3;E=S.getManifestUpdatePeriod(e,n),1e3*E>2147483647&&(E=2147483.647),D.trigger(uu.MANIFEST_UPDATED,{manifest:e}),p.info("Manifest has been refreshed at "+t+"["+t.getTime()/1e3+"] "),_||o()}function l(){if(!_||R.getScheduleWhilePaused())return y?void o(R.getManifestUpdateRetryInterval()):void s()}function c(e){e.error?e.error.code===lf.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE&&A.error(e.error):u(e.manifest)}function f(){_=!1,o()}function d(){_=!0,a()}function h(){y=!1}var g,p,E,m,_,y,T,v,S,A,R,I=this.context,D=iu(I).getInstance();return g={initialize:t,setManifest:n,refreshManifest:s,setConfig:e,reset:i},function(){p=Eu(I).getInstance().getLogger(g)}(),g}function Jr(){function e(e,t){R=t,S=0,A=!1,I={"urn:mpeg:dash:utc:http-head:2014":g,"urn:mpeg:dash:utc:http-xsdate:2014":h.bind(null,u),"urn:mpeg:dash:utc:http-iso:2014":h.bind(null,l),"urn:mpeg:dash:utc:direct:2014":d,"urn:mpeg:dash:utc:http-head:2012":g,"urn:mpeg:dash:utc:http-xsdate:2012":h.bind(null,u),"urn:mpeg:dash:utc:http-iso:2012":h.bind(null,l),"urn:mpeg:dash:utc:direct:2012":d,"urn:mpeg:dash:utc:http-ntp:2014":f,"urn:mpeg:dash:utc:ntp:2014":f,"urn:mpeg:dash:utc:sntp:2014":f},i()||_(e)}function t(e){e&&(e.metricsModel&&(D=e.metricsModel),e.dashMetrics&&(b=e.dashMetrics),e.baseURLController&&(M=e.baseURLController))}function n(){return o()}function r(e){A=e}function i(){return A}function a(e){S=e}function o(){return S}function s(e){var t,n,r=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+\-])([0-9]{2})([0-9]{2}))?/,i=r.exec(e);return t=Date.UTC(parseInt(i[1],10),parseInt(i[2],10)-1,parseInt(i[3],10),parseInt(i[4],10),parseInt(i[5],10),i[6]&&(parseInt(i[6],10)||0),i[7]&&1e3*parseFloat(i[7])||0),i[9]&&i[10]&&(n=60*parseInt(i[9],10)+parseInt(i[10],10),t+=("+"===i[8]?-1:1)*n*60*1e3),new Date(t).getTime()}function u(e){var t=Date.parse(e);return isNaN(t)&&(t=s(e)),t}function l(e){return Date.parse(e)}function c(e){return Date.parse(e)}function f(e,t,n){n()}function d(e,t,n){var r=u(e);if(!isNaN(r))return void t(r);n()}function h(e,t,n,r,i){var a,o,s=!1,u=new XMLHttpRequest,l=i?Cl.HEAD:Cl.GET,c=t.match(/\S+/g);if(t=c.shift(),a=function(){s||(s=!0,c.length?h(e,c.join(" "),n,r,i):r())},o=function(){var t,r;200===u.status&&(t=i?u.getResponseHeader("Date"):u.response,r=e(t),isNaN(r)||(n(r),s=!0))},w.isRelative(t)){var f=M.resolve();f&&(t=w.resolve(t,f.url))}u.open(l,t),u.timeout=lg||0,u.onload=o,u.onloadend=a,u.send()}function g(e,t,n){h(c,e,t,n,!0)}function p(){var e=D.getReadOnlyMetricsFor(Ys.STREAM),t=b.getLatestMPDRequestHeaderValueByID(e,"Date"),n=null!==t?new Date(t).getTime():Number.NaN;isNaN(n)?E(!0):(a(n-(new Date).getTime()),E(!1,n/1e3,S))}function E(e,t,n){r(!1),N.trigger(uu.TIME_SYNCHRONIZATION_COMPLETED,{time:t,offset:n,error:e?new Fu(lf.TIME_SYNC_FAILED_ERROR_CODE,lf.TIME_SYNC_FAILED_ERROR_MESSAGE):null})}function m(e,t){return e-t}function _(e,t){var n=t||0,i=e[n],o=function(e,t){var n=!e||!t;n&&R?p():E(n,e,t)};r(!0),i?I.hasOwnProperty(i.schemeIdUri)?I[i.schemeIdUri](i.value,function(e){var t=(new Date).getTime(),n=m(e,t);a(n),v.info("Local time: "+new Date(t)),v.info("Server time: "+new Date(e)),v.info("Server Time - Local Time (ms): "+n),o(e,n)},function(){_(e,n+1)}):_(e,n+1):(a(0),o())}function y(){r(!1)}var T,v,S,A,R,I,D,b,M,C=this.context,N=iu(C).getInstance(),w=Hd(C).getInstance();return T={initialize:e,getOffsetToDeviceTimeMs:n,setConfig:t,reset:y},function(){v=Eu(C).getInstance().getLogger(T)}(),T}function ei(){function e(e,t){return gg(e,t)}return{areEqual:e}}function ti(){function e(e){e.dashManifestModel&&(f=e.dashManifestModel)}function t(){if(!f||!f.hasOwnProperty("getBaseURLsFromElement")||!f.hasOwnProperty("getRepresentationSortFunction"))throw new Error("setConfig function has to be called previously")}function n(e,t,n){var r=f.getBaseURLsFromElement(n);e[t]?h.areEqual(r,e[t].data.baseUrls)||(e[t].data.baseUrls=r,e[t].data.selectedIdx=Eg):e[t]=new mg(r)}function r(e){t();var r=f.getBaseURLsFromElement(e);h.areEqual(r,c.data.baseUrls)||(c.data.baseUrls=r,c.data.selectedIdx=Eg),e&&e.Period_asArray&&e.Period_asArray.forEach(function(e,t){n(c.children,t,e),e.AdaptationSet_asArray&&e.AdaptationSet_asArray.forEach(function(e,r){n(c.children[t].children,r,e),e.Representation_asArray&&e.Representation_asArray.sort(f.getRepresentationSortFunction()).forEach(function(e,i){n(c.children[t].children[r].children,i,e)})})})}function i(e,t){var n=t||c;e(n.data),n.children&&n.children.forEach(function(t){return i(e,t)})}function a(e){i(function(t){isNaN(t.selectedIdx)||e===t.baseUrls[t.selectedIdx].serviceLocation&&(t.selectedIdx=Eg)})}function o(e){r(e)}function s(){c=new mg}function u(e){var t=c,n=[t.data];return e&&e.forEach(function(e){(t=t.children[e])&&n.push(t.data)}),n.filter(function(e){return e.baseUrls.length})}var l,c,f,d=this.context,h=pg(d).getInstance();return l={reset:s,update:o,getForPath:u,invalidateSelectedIndexes:a,setConfig:e},function(){s()}(),l}function ni(e){function t(e){return!!(a.length&&e&&e.length)&&-1!==a.indexOf(e)}function n(e){-1===a.indexOf(e)&&(a.push(e),o.trigger(s,{entry:e}))}function r(e){n(e.entry)}function i(){a=[]}e=e||{};var a=[],o=iu(this.context).getInstance(),s=e.updateEventName,u=e.addBlacklistEventName;return function(){u&&o.on(u,r,this)}(),{add:n,contains:t,reset:i}}function ri(e){function t(e){var t=[],n=function(e){return!t.length||!e.dvb_priority||-1===t.indexOf(e.dvb_priority)},r=function(e){return!i.contains(e.serviceLocation)||(e.dvb_priority&&t.push(e.dvb_priority),!1)};return e.filter(r).filter(n)}function n(e){var t,n,r=function(e,t){var n=e.dvb_priority-t.dvb_priority;return isNaN(n)?0:n},i=function(e,t,n){return!t||n[0].dvb_priority&&e.dvb_priority&&n[0].dvb_priority===e.dvb_priority},a=0,o=[],s=0;if(n=e.sort(r).filter(i),n.length)return n.length>1&&(n.forEach(function(e){a+=e.dvb_weight,o.push(a)}),t=Math.floor(Math.random()*(a-1)),o.every(function(e,n){return s=n,!(t<e)})),n[s]}function r(e){return e&&n(t(e))}e=e||{};var i=e.blacklistController;return{select:r}}function ii(e){function t(e){var t,r=0;return e&&e.some(function(e,t){return r=t,!n.contains(e.serviceLocation)})&&(t=e[r]),t}e=e||{};var n=e.blacklistController;return{select:t}}function ai(){function e(e){e.selector&&(c=e.selector),e.dashManifestModel&&(a=e.dashManifestModel)}function t(){if(!a||!a.hasOwnProperty("getIsDVB"))throw new Error(Ys.MISSING_CONFIG_ERROR)}function n(e){t(),c=a.getIsDVB(e)?l:u}function r(e){if(e){var t=e.baseUrls,n=e.selectedIdx;if(!isNaN(n))return t[n];var r=c.select(t);return r?(e.selectedIdx=t.indexOf(r),r):(d.trigger(uu.URL_RESOLUTION_FAILED,{error:new Fu(lf.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE,lf.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE)}),void(c===u&&i()))}}function i(){s.reset()}var a,o,s,u,l,c,f=this.context,d=iu(f).getInstance();return o={chooseSelectorFromManifest:n,select:r,reset:i,setConfig:e},function(){s=yg(f).create({updateEventName:uu.SERVICE_LOCATION_BLACKLIST_CHANGED,addBlacklistEventName:uu.SERVICE_LOCATION_BLACKLIST_ADD}),u=vg(f).create({blacklistController:s}),l=Tg(f).create({blacklistController:s}),c=u}(),o}function oi(){function e(e){u.invalidateSelectedIndexes(e.entry)}function t(e){e.baseURLTreeModel&&(u=e.baseURLTreeModel),e.baseURLSelector&&(l=e.baseURLSelector),e.dashManifestModel&&(s=e.dashManifestModel)}function n(e){u.update(e),l.chooseSelectorFromManifest(e)}function r(e){var t=u.getForPath(e),n=t.reduce(function(e,t){var n=l.select(t);return n?(d.isRelative(n.url)?e.url=d.resolve(n.url,e.url):(e.url=n.url,e.serviceLocation=n.serviceLocation),e.availabilityTimeOffset=n.availabilityTimeOffset,e.availabilityTimeComplete=n.availabilityTimeComplete,e):new Ag},new Ag);if(!d.isRelative(n.url))return n}function i(){u.reset(),l.reset()}function a(e){u.setConfig({dashManifestModel:s}),l.setConfig({dashManifestModel:s}),n(e)}var o,s,u,l,c=this.context,f=iu(c).getInstance(),d=Hd(c).getInstance();return o={reset:i,initialize:a,resolve:r,setConfig:t},function(){u=_g(c).create(),l=Sg(c).create(),f.on(uu.SERVICE_LOCATION_BLACKLIST_CHANGED,e,o)}(),o}function si(){function e(){var e="WebKitMediaSource"in window;return"MediaSource"in window?new MediaSource:e?new WebKitMediaSource:null}function t(e,t){var n=window.URL.createObjectURL(e);return t.setSource(n),n}function n(e){e.setSource(null)}function r(e,t){return e.duration!=t&&(e.duration=t),e.duration}function i(e,t,n){e&&"function"==typeof e.setLiveSeekableRange&&"function"==typeof e.clearLiveSeekableRange&&"open"===e.readyState&&t>=0&&t<n&&(e.clearLiveSeekableRange(),e.setLiveSeekableRange(t,n))}function a(e){var t=e.sourceBuffers,n=t.length;if("open"===e.readyState){for(var r=0;r<n;r++){if(t[r].updating)return;if(0===t[r].buffered.length)return}s.info("call to mediaSource endOfStream"),e.endOfStream()}}var o,s,u=this.context;return o={createMediaSource:e,attachMediaSource:t,detachMediaSource:n,setDuration:r,setSeekable:i,signalEndOfStream:a},function(){s=Eu(u).getInstance().getLogger(o)}(),o}function ui(){function e(e,n){U(),_e=e,me=n,he.initialize(),Q=og(Ye).create(),Q.setConfig({manifestModel:$,dashManifestModel:J,mediaPlayerModel:Ie,manifestLoader:Z,errHandler:de}),Q.initialize(),ae.setConfig({dashManifestModel:J}),t()}function t(){Ke.on(uu.PLAYBACK_TIME_UPDATED,r,this),Ke.on(uu.PLAYBACK_SEEKING,o,this),Ke.on(uu.PLAYBACK_ERROR,P,this),Ke.on(uu.PLAYBACK_STARTED,s,this),Ke.on(uu.PLAYBACK_PAUSED,u,this),Ke.on(uu.PLAYBACK_ENDED,_,this),Ke.on(uu.MANIFEST_UPDATED,C,this),Ke.on(uu.BUFFERING_COMPLETED,d,this),Ke.on(uu.STREAM_BUFFERING_COMPLETED,h,this),Ke.on(uu.MANIFEST_VALIDITY_CHANGED,Y,this),Ke.on(uu.TIME_SYNCHRONIZATION_COMPLETED,M,this),Ke.on(uu.WALLCLOCK_TIME_UPDATED,i,this),Ke.on(ug.METRIC_ADDED,j,this)}function n(){Ke.off(uu.PLAYBACK_TIME_UPDATED,r,this),Ke.off(uu.PLAYBACK_SEEKING,o,this),Ke.off(uu.PLAYBACK_ERROR,P,this),Ke.off(uu.PLAYBACK_STARTED,s,this),Ke.off(uu.PLAYBACK_PAUSED,u,this),Ke.off(uu.PLAYBACK_ENDED,_,this),Ke.off(uu.MANIFEST_UPDATED,C,this),Ke.off(uu.BUFFERING_COMPLETED,d,this),Ke.off(uu.STREAM_BUFFERING_COMPLETED,h,this),Ke.off(uu.MANIFEST_VALIDITY_CHANGED,Y,this),Ke.off(uu.TIME_SYNCHRONIZATION_COMPLETED,M,this),Ke.off(uu.WALLCLOCK_TIME_UPDATED,i,this),Ke.off(ug.METRIC_ADDED,j,this)}function r(){if(N(Ys.VIDEO)){var e=Ae.getPlaybackQuality();e&&te.addDroppedFrames(Ys.VIDEO,e)}}function i(){if(!(!Ie.getJumpGaps()||0===m()||Re.isSeeking()||De||ye||Te||ve)&&++Pe>=Ge){var e=Re.getTime();Be===e?a(e):Be=e,Pe=0}}function a(e){for(var t,n=m(),r=Ie.getSmallGapLimit(),i=0;i<n.length;i++){var a=n[i].getBuffer(),o=a.getAllBufferRanges(),s=void 0;if(o&&!(o.length<=1)){for(var u=0;u<o.length;u++)if(e<o.start(u)){s=o.start(u);break}if(s>0){var l=s-e;l>0&&l<=r&&(void 0===t||s>t)&&(t=s)}}}var c=Re.getTimeToStreamEnd();void 0===t&&!isNaN(c)&&c<r&&(t=e+c),t>0&&(!isNaN(c)&&t>=e+c?(W.info("Jumping media gap (discontinuity) at time ",e,". Jumping to end of the stream"),Ke.trigger(uu.PLAYBACK_ENDED,{isLast:F().isLast})):(W.info("Jumping media gap (discontinuity) at time ",e,". Jumping to time position",t),Re.seek(t,!0,!0)))}function o(e){var t=p(e.seekTime);Oe&&(l(),we=!1),Le&&c(),t===pe&&Ue&&Ue.deactivate(!0),t&&(t!==pe||Ue&&!pe.isActive())?(O(Ld.END_OF_PERIOD_STOP_REASON),T(pe,t,e.seekTime)):O(Ld.USER_REQUEST_STOP_REASON),L(Od.SEEK_START_REASON)}function s(){W.debug("[onPlaybackStarted]"),be?(be=!1,L(Od.INITIAL_PLAYOUT_START_REASON)):De&&(De=!1,L(Od.RESUME_FROM_PAUSE_START_REASON),f())}function u(e){W.debug("[onPlaybackPaused]"),e.ended||(De=!0,O(Ld.USER_REQUEST_STOP_REASON),f())}function l(){W.debug("[toggleEndPeriodTimer] stop end period timer."),clearTimeout(Oe),Oe=void 0}function c(){W.debug("[PreloadTimer] stop period preload timer."),clearTimeout(Le),Le=void 0}function f(){if(we)if(Oe)l();else{var e=Re.getTimeToStreamEnd(),t=e>0?1e3*e:0,n=t<2e3?t/4:t-2e3;W.debug("[toggleEndPeriodTimer] Going to fire preload in",n,"milliseconds"),Le=setTimeout(g,n),W.debug("[toggleEndPeriodTimer] start-up of timer to notify PLAYBACK_ENDED event. It will be triggered in",t,"milliseconds"),Oe=setTimeout(function(){Ke.trigger(uu.PLAYBACK_ENDED,{isLast:F().isLast})},t)}}function d(e){if(e.sender&&(e.sender.getType()===Ys.AUDIO||e.sender.getType()===Ys.VIDEO)){var t=F().isLast;Se&&!t&&void 0===Oe&&(W.info("[onTrackBufferingCompleted] end of period detected. Track",e.sender.getType(),"has finished"),we=!0,!1===De&&f())}}function h(){var e=F().isLast;Se&&e&&(W.info("[onStreamBufferingCompleted] calls signalEndOfStream of mediaSourceController."),re.signalEndOfStream(Se))}function g(){var e=F().isLast;if(Se&&!e){var t=y();xe=pe.isProtectionCompatible(t)&&(ke||pe.isMediaCodecCompatible(t)),xe&&(W.info("[onStreamCanLoadNext] Preloading next stream"),pe.stopEventController(),pe.deactivate(!0),t.preload(Se,Fe),Ue=t,t.getProcessors().forEach(function(e){ee.setIndexHandlerTime(e,t.getStartTime())}))}}function p(e){var t=0,n=null,r=ge.length;r>0&&(t+=ge[0].getStartTime());for(var i=0;i<r;i++)if(n=ge[i],t=parseFloat((t+n.getDuration()).toFixed(5)),e<t)return n;return null}function E(e,t){for(var n=null,r=0,i=0,a=null,o=ge.length,s=0;s<o;s++){if(n=ge[s],i=n.getStartTime(),a=n.getDuration(),Number.isFinite(i)&&(r=i),n.getId()===t)return e-r;Number.isFinite(a)&&(r+=a)}return null}function m(){return pe?pe.getProcessors():[]}function _(){var e=y();e?(Ne=void 0,Ce=void 0,T(pe,e,NaN)):W.debug("StreamController no next stream found"),O(e?Ld.END_OF_PERIOD_STOP_REASON:Ld.END_OF_CONTENT_STOP_REASON),Oe=void 0,we=!1}function y(){if(pe){var e=F().start,t=F().duration;return ge.filter(function(n){return n.getStreamInfo().start===parseFloat((e+t).toFixed(5))})[0]}}function T(e,t,n){ye||!t||e===t&&t.isActive()||(ye=!0,Ke.trigger(uu.PERIOD_SWITCH_STARTED,{fromStreamInfo:e?e.getStreamInfo():null,toStreamInfo:t.getStreamInfo()}),xe=!1,e&&(e.stopEventController(),xe=pe.isProtectionCompatible(t)&&(ke||pe.isMediaCodecCompatible(t))&&!n||t.getPreloaded(),e.deactivate(xe)),pe=t,Ue=!1,Re.initialize(F(),xe),Ae.getElement()?A(n,e,!1,xe):v(n))}function v(e){R(e,xe)}function S(e){pe&&(Re.initialize(F()),A(e,null,!0,!1))}function A(e,t,n,r){function i(){Se&&(W.debug("MediaSource is open!"),window.URL.revokeObjectURL(a),Se.removeEventListener("sourceopen",i),Se.removeEventListener("webkitsourceopen",i),I(),t||Ke.trigger(uu.SOURCE_INITIALIZED),n?pe.setMediaSource(Se):R(e,r))}var a;Se?r?(R(e,r),t||Ke.trigger(uu.SOURCE_INITIALIZED)):(re.detachMediaSource(Ae),Se.addEventListener("sourceopen",i,!1),Se.addEventListener("webkitsourceopen",i,!1),a=re.attachMediaSource(Se,Ae),W.debug("MediaSource attached to element.  Waiting on open...")):(Se=re.createMediaSource(),Se.addEventListener("sourceopen",i,!1),Se.addEventListener("webkitsourceopen",i,!1),a=re.attachMediaSource(Se,Ae),W.debug("MediaSource attached to element.  Waiting on open..."))}function R(e,t){if(Fe=pe.activate(Se,t?Fe:void 0),Ne=w(Ys.AUDIO),Ce=w(Ys.VIDEO),Fe){var n=Object.keys(Fe);n.length>0&&Fe[n[0]].changeType&&(W.debug("SourceBuffer changeType method supported. Use it to switch codecs in periods transitions"),ke=!0)}if(!be)if(isNaN(e)){var r=Re.getStreamStartTime(!0);t||m().forEach(function(e){ee.setIndexHandlerTime(e,r)})}else Re.seek(e);pe.startEventController(),!_e&&be||Re.play(),ye=!1,Ke.trigger(uu.PERIOD_SWITCH_COMPLETED,{toStreamInfo:F()})}function I(e){var t=e||F().manifestInfo.duration,n=re.setDuration(Se,t);W.debug("Duration successfully set to: "+n)}function D(e){for(var t=0,n=ge.length;t<n;t++)if(ge[t].getId()===e.id)return ge[t];return null}function b(){try{var e=ee.getStreamsInfo();if(0===e.length)throw new Error("There are no streams");var t=ne.getCurrentManifestUpdate(te.getMetricsFor(Ys.STREAM));te.updateManifestUpdateInfo(t,{currentTime:Re.getTime(),buffered:Ae.getBufferRange(),presentationStartTime:e[0].start,clientTimeOffset:he.getClientTimeOffset()});for(var n=0,r=e.length;n<r;n++){var i=e[n],a=D(i);a?a.updateData(i):(a=ag(Ye).create({manifestModel:$,dashManifestModel:J,mediaPlayerModel:Ie,metricsModel:te,dashMetrics:ne,manifestUpdater:Q,adapter:ee,timelineConverter:he,capabilities:X,errHandler:de,baseURLController:ae,domStorage:oe,abrController:se,playbackController:Re,mediaController:ue,textController:le,videoModel:Ae,streamController:z}),ge.push(a),a.initialize(i,Ee)),te.addManifestUpdateStreamInfo(t,i.id,i.index,i.start,i.duration)}if(!pe){var o=Re.getStartTimeFromUriParameters(),s=null;if(o){s=p(isNaN(o.fragS)?o.fragT:o.fragS)}T(null,null!==s?s:ge[0],NaN)}Ke.trigger(uu.STREAMS_COMPOSED)}catch(e){de.manifestError(e.message,"nostreamscomposed",$.getValue()),de.error(new Fu(lf.MANIFEST_ERROR_ID_NOSTREAMS_CODE,e.message+"nostreamscomposed",$.getValue())),ve=!0,q()}}function M(){var e=$.getValue();Ee&&(Ke.trigger(uu.PROTECTION_CREATED,{controller:Ee,manifest:e}),Ee.setMediaElement(Ae.getElement()),me&&Ee.setProtectionData(me)),b()}function C(e){if(e.error)ve=!0,q();else{var t=e.manifest;ee.updatePeriods(t);var n,r=ee.getStreamsInfo(void 0,1)[0],i=ee.getMediaInfoForType(r,Ys.VIDEO)||ee.getMediaInfoForType(r,Ys.AUDIO);i&&(n=J.getUseCalculatedLiveEdgeTimeForAdaptation(ee.getDataForMedia(i)))&&(W.debug("SegmentTimeline detected using calculated Live Edge Time"),Ie.setUseManifestDateHeaderTimeSource(!1));var a=J.getUTCTimingSources(e.manifest),o=!J.getIsDynamic(t)||n?a:a.concat(Ie.getUTCTimingSources()),s=fe.isHTTPS(e.manifest.url);o.forEach(function(e){e.value.replace(/.*?:\/\//g,"")===Ie.getDefaultUtcTimingSource().value.replace(/.*?:\/\//g,"")&&(e.value=e.value.replace(s?new RegExp(/^(http:)?\/\//i):new RegExp(/^(https:)?\/\//i),s?"https://":"http://"),W.debug("Matching default timing source protocol to manifest protocol: ",e.value))}),ae.initialize(t),ie.setConfig({metricsModel:te,dashMetrics:ne,baseURLController:ae}),ie.initialize(o,Ie.getUseManifestDateHeaderTimeSource())}}function N(e){var t;if(!e)return t;switch(e){case Ys.VIDEO:t=Ce;break;case Ys.AUDIO:t=Ne}return t}function w(e){var t=!1;return m().forEach(function(n){n.getMediaInfo().type===e&&(t=!0)}),t}function O(e,t){t=t||new Date,Me&&(m().forEach(function(n){var r=n.getScheduleController();r&&r.finalisePlayList(t,e)}),te.addPlayList(Me),Me=null)}function L(e){Me=new Od,Me.start=new Date,Me.mstart=1e3*Re.getTime(),Me.starttype=e,m().forEach(function(e){var t=e.getScheduleController();t&&t.setPlayList(Me)})}function P(e){if(e.error){var t="";switch(e.error.code){case 1:t="MEDIA_ERR_ABORTED";break;case 2:t="MEDIA_ERR_NETWORK";break;case 3:t="MEDIA_ERR_DECODE";break;case 4:t="MEDIA_ERR_SRC_NOT_SUPPORTED";break;case 5:t="MEDIA_ERR_ENCRYPTED";break;default:t="UNKNOWN"}Te=!0,e.error.message&&(t+=" ("+e.error.message+")"),e.error.msExtendedCode&&(t+=" (0x"+(e.error.msExtendedCode>>>0).toString(16).toUpperCase()+")"),W.fatal("Video Element Error: "+t),e.error&&W.fatal(e.error),de.mediaSourceError(t),de.error(new Fu(e.error.code,t)),q()}}function F(){return pe?pe.getStreamInfo():null}function x(e){return ge.filter(function(t){return t.getId()===e})[0]}function U(){if(!(Z&&Z.hasOwnProperty("load")&&he&&he.hasOwnProperty("initialize")&&he.hasOwnProperty("reset")&&he.hasOwnProperty("getClientTimeOffset")&&$&&de&&te&&Re))throw new Error("setConfig function has to be called previously")}function B(){if(!Q||!Q.hasOwnProperty("setManifest"))throw new Error("initialize function has to be called previously")}function k(e){U(),Z.load(e)}function G(e){B(),Q.setManifest(e)}function Y(e){isNaN(e.newDuration)||I(e.newDuration)}function K(e){e&&(e.capabilities&&(X=e.capabilities),e.manifestLoader&&(Z=e.manifestLoader),e.manifestModel&&($=e.manifestModel),e.dashManifestModel&&(J=e.dashManifestModel),e.mediaPlayerModel&&(Ie=e.mediaPlayerModel),e.protectionController&&(Ee=e.protectionController),e.adapter&&(ee=e.adapter),e.metricsModel&&(te=e.metricsModel),e.dashMetrics&&(ne=e.dashMetrics),e.errHandler&&(de=e.errHandler),e.timelineConverter&&(he=e.timelineConverter),e.videoModel&&(Ae=e.videoModel),e.playbackController&&(Re=e.playbackController),e.domStorage&&(oe=e.domStorage),e.abrController&&(se=e.abrController),e.mediaController&&(ue=e.mediaController),e.textController&&(le=e.textController))}function V(e){me=e}function H(){ge=[],Ee=null,ye=!1,pe=null,Te=!1,ve=!1,Ce=void 0,Ne=void 0,be=!0,De=!1,_e=!0,Me=null,Oe=void 0,we=!1,Pe=0}function q(){U(),ie.reset(),O(Te||ve?Ld.FAILURE_STOP_REASON:Ld.USER_REQUEST_STOP_REASON);for(var e=0,t=ge?ge.length:0;e<t;e++){ge[e].reset(Te)}n(),ae.reset(),Q.reset(),te.clearAllCurrentMetrics(),$.setValue(null),Z.reset(),he.reset(),ce.reset(),Se&&(re.detachMediaSource(Ae),Se=null),Ae=null,Ee&&(Ee.setMediaElement(null),Ee=null,me=null,$.getValue()&&Ke.trigger(uu.PROTECTION_DESTROYED,{data:$.getValue().url})),Ke.trigger(uu.STREAM_TEARDOWN_COMPLETE),H()}function j(e){e.metric===Vs.DVR_INFO&&e.mediaType===Ys.AUDIO&&re.setSeekable(Se,e.value.range.start,e.value.range.end)}var z,W,X,Q,Z,$,J,ee,te,ne,re,ie,ae,oe,se,ue,le,ce,fe,de,he,ge,pe,Ee,me,_e,ye,Te,ve,Se,Ae,Re,Ie,De,be,Me,Ce,Ne,we,Oe,Le,Pe,Fe,xe,Ue,Be,ke,Ge=40,Ye=this.context,Ke=iu(Ye).getInstance();return z={initialize:e,getActiveStreamInfo:F,isTrackTypePresent:N,switchToVideoElement:S,getStreamById:x,getStreamForTime:p,getTimeRelativeToStreamId:E,load:k,loadWithManifest:G,getActiveStreamProcessors:m,setConfig:K,setProtectionData:V,reset:q},function(){W=Eu(Ye).getInstance().getLogger(z),ie=cg(Ye).getInstance(),ae=Rg(Ye).getInstance(),re=Ig(Ye).getInstance(),ce=od(Ye).getInstance(),fe=Hd(Ye).getInstance(),H()}(),z}function li(e){function t(e,t,n){var i=function(r,i){t.resolved=!0,t.resolvedContent=r||null,a.trigger(uu.XLINK_ELEMENT_LOADED,{element:t,resolveObject:n,error:r||i?null:new Fu(lf.XLINK_LOADER_LOADING_FAILURE_ERROR_CODE,lf.XLINK_LOADER_LOADING_FAILURE_ERROR_MESSAGE+e)})};if(e===r)i(null,!0);else{var s=new bg(e,Cl.XLINK_EXPANSION_TYPE);o.load({request:s,success:function(e){i(e)},error:function(){i(null)}})}}function n(){o&&(o.abort(),o=null)}e=e||{};var r="urn:mpeg:dash:resolve-to-zero:2013",i=this.context,a=iu(i).getInstance(),o=Vh(i).create({errHandler:e.errHandler,metricsModel:e.metricsModel,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier});return{load:t,reset:n}}function ci(e){function t(e){var t=e.localName;return null==t&&(t=e.baseName),null!=t&&""!=t||(t=e.nodeName),t}function n(e){return e.prefix}function r(e){return"string"==typeof e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):e}function i(e,t,n,r){for(var i=0;i<e.length;i++){var a=e[i];if("string"==typeof a){if(a==r)break}else if(a instanceof RegExp){if(a.test(r))break}else if("function"==typeof a&&a(t,n,r))break}return i!=e.length}function a(t,n,r){switch(e.arrayAccessForm){case"property":t[n]instanceof Array?t[n+"_asArray"]=t[n]:t[n+"_asArray"]=[t[n]]}!(t[n]instanceof Array)&&e.arrayAccessFormPaths.length>0&&i(e.arrayAccessFormPaths,t,n,r)&&(t[n]=[t[n]])}function o(e){var t=e.split(/[-T:+Z]/g),n=new Date(t[0],t[1]-1,t[2]),r=t[5].split(".");if(n.setHours(t[3],t[4],r[0]),r.length>1&&n.setMilliseconds(r[1]),t[6]&&t[7]){var i=60*t[6]+Number(t[7]);i=0+("-"==(/\d\d-\d\d:\d\d$/.test(e)?"-":"+")?-1*i:i),n.setMinutes(n.getMinutes()-i-n.getTimezoneOffset())}else-1!==e.indexOf("Z",e.length-1)&&(n=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds())));return n}function s(t,n,r){if(e.datetimeAccessFormPaths.length>0){var a=r.split(".#")[0];return i(e.datetimeAccessFormPaths,t,n,a)?o(t):t}return t}function u(t,n,r,a){return!(n==S.ELEMENT_NODE&&e.xmlElementsFilter.length>0)||i(e.xmlElementsFilter,t,r,a)}function l(r,i){if(r.nodeType==S.DOCUMENT_NODE){for(var o=new Object,c=r.childNodes,f=0;f<c.length;f++){var d=c[f];if(d.nodeType==S.ELEMENT_NODE)if(e.ignoreRoot)o=l(d);else{o={};var h=t(d);o[h]=l(d)}}return o}if(r.nodeType==S.ELEMENT_NODE){var o=new Object;o.__cnt=0;for(var g=[],c=r.childNodes,f=0;f<c.length;f++){var d=c[f],h=t(d);if(d.nodeType!=S.COMMENT_NODE){var p=i+"."+h;if(u(o,d.nodeType,h,p))if(o.__cnt++,null==o[h]){var E=l(d,p);if("#text"!=h||/[^\s]/.test(E)){var m={};m[h]=E,g.push(m)}o[h]=E,a(o,h,p)}else{null!=o[h]&&(o[h]instanceof Array||(o[h]=[o[h]],a(o,h,p)));var E=l(d,p);if("#text"!=h||/[^\s]/.test(E)){var m={};m[h]=E,g.push(m)}o[h][o[h].length]=E}}}o.__children=g;for(var _=t(r),y=0;y<r.attributes.length;y++){var T=r.attributes[y];o.__cnt++;for(var v=T.value,A=0,R=e.matchers.length;A<R;A++){var I=e.matchers[A];I.test(T,_)&&(v=I.converter(T.value))}o[e.attributePrefix+T.name]=v}var D=n(r);return null!=D&&""!=D&&(o.__cnt++,o.__prefix=D),null!=o["#text"]&&(o.__text=o["#text"],o.__text instanceof Array&&(o.__text=o.__text.join("\n")),e.stripWhitespaces&&(o.__text=o.__text.trim()),delete o["#text"],"property"==e.arrayAccessForm&&delete o["#text_asArray"],o.__text=s(o.__text,h,i+"."+h)),null!=o["#cdata-section"]&&(o.__cdata=o["#cdata-section"],delete o["#cdata-section"],"property"==e.arrayAccessForm&&delete o["#cdata-section_asArray"]),0==o.__cnt&&"text"==e.emptyNodeForm?o="":1==o.__cnt&&null!=o.__text?o=o.__text:1!=o.__cnt||null==o.__cdata||e.keepCData?o.__cnt>1&&null!=o.__text&&e.skipEmptyTextNodesForObj&&(e.stripWhitespaces&&""==o.__text||""==o.__text.trim())&&delete o.__text:o=o.__cdata,delete o.__cnt,!e.enableToStringFunc||null==o.__text&&null==o.__cdata||(o.toString=function(){return(null!=this.__text?this.__text:"")+(null!=this.__cdata?this.__cdata:"")}),o}if(r.nodeType==S.TEXT_NODE||r.nodeType==S.CDATA_SECTION_NODE)return r.nodeValue}function c(t,n,i,a){var o="<"+(null!=t&&null!=t.__prefix?t.__prefix+":":"")+n;if(null!=i)for(var s=0;s<i.length;s++){var u=i[s],l=t[u];e.escapeMode&&(l=r(l)),o+=" "+u.substr(e.attributePrefix.length)+"=",e.useDoubleQuotes?o+='"'+l+'"':o+="'"+l+"'"}return o+=a?"/>":">"}function f(e,t){return"</"+(null!=e.__prefix?e.__prefix+":":"")+t+">"}function d(e,t){return-1!==e.indexOf(t,e.length-t.length)}function h(t,n){return!!("property"==e.arrayAccessForm&&d(n.toString(),"_asArray")||0==n.toString().indexOf(e.attributePrefix)||0==n.toString().indexOf("__")||t[n]instanceof Function)}function g(e){var t=0;if(e instanceof Object)for(var n in e)h(e,n)||t++;return t}function p(t,n,r){return 0==e.jsonPropertiesFilter.length||""==r||i(e.jsonPropertiesFilter,t,n,r)}function E(t){var n=[]
;if(t instanceof Object)for(var r in t)-1==r.toString().indexOf("__")&&0==r.toString().indexOf(e.attributePrefix)&&n.push(r);return n}function m(t){var n="";return null!=t.__cdata&&(n+="<![CDATA["+t.__cdata+"]]>"),null!=t.__text&&(e.escapeMode?n+=r(t.__text):n+=t.__text),n}function _(t){var n="";return t instanceof Object?n+=m(t):null!=t&&(e.escapeMode?n+=r(t):n+=t),n}function y(e,t){return""===e?t:e+"."+t}function T(e,t,n,r){var i="";if(0==e.length)i+=c(e,t,n,!0);else for(var a=0;a<e.length;a++)i+=c(e[a],t,E(e[a]),!1),i+=v(e[a],y(r,t)),i+=f(e[a],t);return i}function v(e,t){var n="";if(g(e)>0)for(var r in e)if(!h(e,r)&&(""==t||p(e,r,y(t,r)))){var i=e[r],a=E(i);if(null==i||void 0==i)n+=c(i,r,a,!0);else if(i instanceof Object)if(i instanceof Array)n+=T(i,r,a,t);else if(i instanceof Date)n+=c(i,r,a,!1),n+=i.toISOString(),n+=f(i,r);else{var o=g(i);o>0||null!=i.__text||null!=i.__cdata?(n+=c(i,r,a,!1),n+=v(i,y(t,r)),n+=f(i,r)):n+=c(i,r,a,!0)}else n+=c(i,r,a,!1),n+=_(i),n+=f(i,r)}return n+=_(e)}e=e||{},function(){void 0===e.escapeMode&&(e.escapeMode=!0),void 0===e.attributePrefix&&(e.attributePrefix="_"),e.arrayAccessForm=e.arrayAccessForm||"none",e.emptyNodeForm=e.emptyNodeForm||"text",void 0===e.enableToStringFunc&&(e.enableToStringFunc=!0),e.arrayAccessFormPaths=e.arrayAccessFormPaths||[],void 0===e.skipEmptyTextNodesForObj&&(e.skipEmptyTextNodesForObj=!0),void 0===e.stripWhitespaces&&(e.stripWhitespaces=!0),e.datetimeAccessFormPaths=e.datetimeAccessFormPaths||[],void 0===e.useDoubleQuotes&&(e.useDoubleQuotes=!1),e.xmlElementsFilter=e.xmlElementsFilter||[],e.jsonPropertiesFilter=e.jsonPropertiesFilter||[],void 0===e.keepCData&&(e.keepCData=!1),void 0===e.ignoreRoot&&(e.ignoreRoot=!1)}();var S={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,COMMENT_NODE:8,DOCUMENT_NODE:9};this.parseXmlString=function(e){window.ActiveXObject||window;if(void 0===e)return null;var t;if(window.DOMParser){var n=new window.DOMParser;try{t=n.parseFromString(e,"text/xml"),t.getElementsByTagNameNS("*","parsererror").length>0&&(t=null)}catch(e){t=null}}else 0==e.indexOf("<?")&&(e=e.substr(e.indexOf("?>")+2)),t=new ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(e);return t},this.asArray=function(e){return void 0===e||null==e?[]:e instanceof Array?e:[e]},this.toXmlDateTime=function(e){return e instanceof Date?e.toISOString():"number"==typeof e?new Date(e).toISOString():null},this.asDateTime=function(e){return"string"==typeof e?o(e):e},this.xml2json=function(e){return l(e)},this.xml_str2json=function(e){var t=this.parseXmlString(e);return null!=t?this.xml2json(t):null},this.json2xml_str=function(e){return v(e,"")},this.json2xml=function(e){var t=this.json2xml_str(e);return this.parseXmlString(t)},this.getVersion=function(){return"1.2.0"}}function fi(e){function t(e){e&&(h=e)}function n(e){e&&(g=e)}function r(e){var t;E=new ci({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!1,ignoreRoot:!0,matchers:h}),p=e,t=u(p.Period_asArray,p,kd.PERIOD,Lg),a(t,kd.PERIOD,Lg)}function i(){y.off(uu.XLINK_ELEMENT_LOADED,o,d),m&&(m.reset(),m=null)}function a(e,t,n){var r,i,a={};a.elements=e,a.type=t,a.resolveType=n,0===a.elements.length&&s(a);for(var o=0;o<a.elements.length;o++)r=a.elements[o],i=T.isHTTPURL(r.url)?r.url:r.originalContent.BaseURL+r.url,m.load(i,r,a)}function o(e){var t,n,r="";if(t=e.element,n=e.resolveObject,t.resolvedContent){var i=0;0===t.resolvedContent.indexOf("<?xml")&&(i=t.resolvedContent.indexOf("?>")+2),r=t.resolvedContent.substr(0,i)+"<response>"+t.resolvedContent.substr(i)+"</response>",t.resolvedContent=E.xml_str2json(r)}f(n)&&s(n)}function s(e){var t,n,r=[];if(l(e),e.resolveType===Pg&&y.trigger(uu.XLINK_READY,{manifest:p}),e.resolveType===Lg)switch(e.type){case kd.PERIOD:for(t=0;t<p[kd.PERIOD+"_asArray"].length;t++)n=p[kd.PERIOD+"_asArray"][t],n.hasOwnProperty(kd.ADAPTATION_SET+"_asArray")&&(r=r.concat(u(n[kd.ADAPTATION_SET+"_asArray"],n,kd.ADAPTATION_SET,Lg))),n.hasOwnProperty(kd.EVENT_STREAM+"_asArray")&&(r=r.concat(u(n[kd.EVENT_STREAM+"_asArray"],n,kd.EVENT_STREAM,Lg)));a(r,kd.ADAPTATION_SET,Lg);break;case kd.ADAPTATION_SET:y.trigger(uu.XLINK_READY,{manifest:p})}}function u(e,t,n,r){var i,a,o,s=[];for(a=e.length-1;a>=0;a--)i=e[a],i.hasOwnProperty("xlink:href")&&i["xlink:href"]===Fg&&e.splice(a,1);for(a=0;a<e.length;a++)i=e[a],i.hasOwnProperty("xlink:href")&&i.hasOwnProperty("xlink:actuate")&&i["xlink:actuate"]===r&&(o=c(i["xlink:href"],t,n,a,r,i),s.push(o));return s}function l(e){var t,n,r,i,a,o,s=[];for(i=e.elements.length-1;i>=0;i--){if(t=e.elements[i],n=t.type+"_asArray",t.resolvedContent){if(t.resolvedContent)for(a=0;a<t.resolvedContent[n].length;a++)r=t.resolvedContent[n][a],s.push(r)}else delete t.originalContent["xlink:actuate"],delete t.originalContent["xlink:href"],s.push(t.originalContent);for(t.parentElement[n].splice(t.index,1),o=0;o<s.length;o++)t.parentElement[n].splice(t.index+o,0,s[o]);s=[]}e.elements.length>0&&g.run(p)}function c(e,t,n,r,i,a){return{url:e,parentElement:t,type:n,index:r,resolveType:i,originalContent:a,resolvedContent:null,resolved:!1}}function f(e){var t,n;for(t=0;t<e.elements.length;t++)if(n=e.elements[t],!1===n.resolved)return!1;return!0}e=e||{};var d,h,g,p,E,m,_=this.context,y=iu(_).getInstance(),T=Hd(_).getInstance();return d={resolveManifestOnLoad:r,setMatchers:t,setIron:n,reset:i},function(){y.on(uu.XLINK_ELEMENT_LOADED,o,d),m=Mg(_).create({errHandler:e.errHandler,metricsModel:e.metricsModel,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier})}(),d}function di(e){function t(e,t){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}function n(e,n,r){for(var i=0,a=e.length;i<a;++i){var o=e[i];if(n[o.name])if(r[o.name]){if(o.merge){var s=n[o.name],u=r[o.name];"object"===f(s)&&"object"===f(u)?t(s,u):r[o.name]=s+u}}else r[o.name]=n[o.name]}}function r(e,t){for(var i=0,a=e.children.length;i<a;++i){var o=e.children[i],s=t[o.name+"_asArray"];if(s)for(var u=0,l=s.length;u<l;++u){var c=s[u];n(e.properties,t,c),r(o,c)}}}function i(t){if(null===t||"object"!==f(t))return t;if("period"in e)for(var n=e.period,i=t.Period_asArray,a=0,o=i.length;a<o;++a){var s=i[a];if(r(n,s),"adaptationset"in e){var u=s.AdaptationSet_asArray;if(u)for(var l=e.adaptationset,c=0,d=u.length;c<d;++c)r(l,u[c])}}return t}return{run:i}}function hi(){function e(){return a}function t(){return s}function n(e){var t,n=window.performance.now();if(!(t=o.xml_str2json(e)))throw new Error("parsing the manifest failed");var r=window.performance.now();s.run(t);var a=window.performance.now();return i.info("Parsing complete: ( xml2json: "+(r-n).toPrecision(3)+"ms, objectiron: "+(a-r).toPrecision(3)+"ms, total: "+((a-n)/1e3).toPrecision(3)+"s)"),t}var r,i,a,o,s,u=this.context;return r={parse:n,getMatchers:e,getIron:t},function(){i=Eu(u).getInstance().getLogger(r),a=[new jg,new Zg,new Jg,new kg],o=new ci({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!1,ignoreRoot:!0,matchers:a}),s=Ug(u).create({adaptationset:new np,period:new rp})}(),r}function gi(e){function t(e){f.trigger(uu.INTERNAL_MANIFEST_LOADED,{manifest:e.manifest})}function n(e){var t=null;return e.indexOf("SmoothStreamingMedia")>-1?(h&&(t=h.createMssParser(),h.registerEvents()),t):e.indexOf("MPD")>-1?ip(c).create():t}function r(e){var t=new bg(e,Cl.MPD_TYPE);s.load({request:t,success:function(t,r,i){if(u){var a,s,c;if(i&&i!==e?(s=d.parseBaseUrl(i),a=i):(d.isRelative(e)&&(e=d.resolve(e,window.location.href)),s=d.parseBaseUrl(e)),null===l&&(l=n(t)),null===l)return void f.trigger(uu.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new Fu(lf.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,lf.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+"".concat(e))});u.setMatchers(l.getMatchers()),u.setIron(l.getIron());try{c=l.parse(t)}catch(t){return void f.trigger(uu.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new Fu(lf.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,lf.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+"".concat(e))})}c?(c.url=a||e,c.originalUrl||(c.originalUrl=c.url),c.hasOwnProperty(Ys.LOCATION)&&(s=d.parseBaseUrl(c.Location_asArray[0]),o.debug("BaseURI set by Location to: "+s)),c.baseUri=s,c.loadedTime=new Date,u.resolveManifestOnLoad(c)):f.trigger(uu.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new Fu(lf.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,lf.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+"".concat(e))})}},error:function(t,n,r){f.trigger(uu.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new Fu(lf.MANIFEST_LOADER_LOADING_FAILURE_ERROR_CODE,lf.MANIFEST_LOADER_LOADING_FAILURE_ERROR_MESSAGE+"".concat(e,", ").concat(r))})}})}function i(){f.off(uu.XLINK_READY,t,a),u&&(u.reset(),u=null),s&&(s.abort(),s=null),h&&h.reset()}e=e||{};var a,o,s,u,l,c=this.context,f=iu(c).getInstance(),d=Hd(c).getInstance(),h=e.mssHandler,g=e.errHandler;return a={load:r,reset:i},function(){o=Eu(c).getInstance().getLogger(a),f.on(uu.XLINK_READY,t,a),s=Vh(c).create({errHandler:g,metricsModel:e.metricsModel,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier}),u=xg(c).create({errHandler:g,metricsModel:e.metricsModel,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier}),l=null}(),a}function pi(){function e(e){l.trigger(uu.ERROR,{error:"capability",event:e})}function t(e,t,n){l.trigger(uu.ERROR,{error:"download",event:{id:e,url:t,request:n}})}function n(e,t,n,r){l.trigger(uu.ERROR,{error:"manifestError",event:{message:e,id:t,manifest:n,event:r}})}function r(e,t,n){l.trigger(uu.ERROR,{error:"cc",event:{message:e,id:t,cc:n}})}function i(e){l.trigger(uu.ERROR,{error:"mediasource",event:e})}function a(e){l.trigger(uu.ERROR,{error:"key_session",event:e})}function o(e){l.trigger(uu.ERROR,{error:"key_message",event:e})}function s(e){l.trigger(uu.ERROR,{error:e})}var u=this.context,l=iu(u).getInstance();return{capabilityError:e,downloadError:t,manifestError:n,timedTextError:r,mediaSourceError:i,mediaKeySessionError:a,mediaKeyMessageError:o,error:s}}function Ei(){function e(){var e="WebKitMediaSource"in window,t="MediaSource"in window;return e||t}function t(){return a}function n(e){a=e}function r(e){return!!("MediaSource"in window&&MediaSource.isTypeSupported(e))||!!("WebKitMediaSource"in window&&WebKitMediaSource.isTypeSupported(e))}var i,a;return i={supportsMediaSource:e,supportsEncryptedMedia:t,supportsCodec:r,setEncryptedMediaSupported:n},function(){a=!1}(),i}function mi(){function e(e){if(n=new up,!e)return null;var t=e.indexOf("#");if(-1!==t)for(var r=e.substr(t+1).split("&"),i=0,a=r.length;i<a;++i){var o=r[i],s=o.indexOf("=");if(-1!==s){var u=o.substring(0,s);n.hasOwnProperty(u)&&(n[u]=o.substr(s+1))}}}function t(){return n}var n;return{initialize:e,getURIFragmentData:t}}function _i(){function e(){return n}function t(e){n=e,e&&i.trigger(uu.MANIFEST_LOADED,{data:e})}var n,r=this.context,i=iu(r).getInstance();return{getValue:e,setValue:t}}function yi(){function e(e){if(e!==Ys.ABR_STRATEGY_DYNAMIC&&e!==Ys.ABR_STRATEGY_BOLA&&e!==Ys.ABR_STRATEGY_THROUGHPUT)throw Ys.BAD_ARGUMENT_ERROR;Ze=e}function t(){return Ze}function n(e){D(e,"boolean"),$e=e}function r(){return $e}function i(e){var t;for(t=0;t<tt.length;t++)if(tt[t].rulename===e)return t;return-1}function a(){return tt}function o(e,t,n){if("string"!=typeof e||e!==Yf.ABANDON_FRAGMENT_RULES&&e!==Yf.QUALITY_SWITCH_RULES||"string"!=typeof t)throw Ys.BAD_ARGUMENT_ERROR;var r=i(t);-1===r?tt.push({type:e,rulename:t,rule:n}):(tt[r].type=e,tt[r].rule=n)}function s(e){if(e){var t=i(e);-1!==t&&tt.splice(t,1)}else tt=[]}function u(e){D(e,"number"),je=e}function l(){return je}function c(e){D(e,"number"),ze=e}function f(){return ze}function d(e){D(e,"number"),Ye=e}function h(){return pe()?.6*X():isNaN(Ye)?et?vp:Tp:Ye}function g(e){D(e,"number"),Ke=e}function E(){return Ke}function m(e){D(e,"number"),Ve=e}function _(){return Ve}function y(e){D(e,"number"),He=e}function T(){return He}function v(e){D(e,"number"),qe=e}function S(){return qe}function A(e,t){D(t,"number"),C(e),rt[e]=t}function R(e){return rt[e]}function I(e){D(e,"number"),xe=e}function b(){return xe}function N(e){D(e,"number"),Ue=e}function w(){return Ue}function O(e,t){if("boolean"!=typeof e||void 0!==t&&("number"!=typeof t||isNaN(t)))throw Ys.BAD_ARGUMENT_ERROR;ke.enabled=e,void 0!==t&&(ke.ttl=t)}function L(){return ke}function P(e,t){if("boolean"!=typeof e||void 0!==t&&("number"!=typeof t||isNaN(t)))throw Ys.BAD_ARGUMENT_ERROR;Ge.enabled=e,void 0!==t&&(Ge.ttl=t)}function F(){return Ge}function x(e){D(e,"number"),Be=e}function U(){return Be}function B(e,t){if("number"!=typeof t||"string"!=typeof e||e!==Cl.MPD_TYPE&&e!==Cl.MEDIA_SEGMENT_TYPE)throw Ys.BAD_ARGUMENT_ERROR;We[e]=t}function k(e){return pe()?We[e]*Bp:We[e]}function G(e,t){D(t,"number"),Xe[e]=t}function Y(e){return pe()?Xe[e]/Up:Xe[e]}function K(e){D(e,"number"),Qe=e}function V(){return Qe}function H(e){D(e,"boolean"),Fe=e}function q(){return Fe}function j(e){D(e,"number"),Le=e}function z(){return Le}function W(e){void 0!==e&&D(e,"number"),Pe=e}function X(){return ot?Pe||xp:Pe}function Q(e){D(e,"boolean"),Ne=e}function Z(){return Ne}function $(e){D(e,"boolean"),we=e}function J(){return we}function ee(e,t){ne(e,t);var n=new fp;n.schemeIdUri=e,n.value=t,Oe.push(n)}function te(){return Oe}function ne(e,t){D(e,"string"),D(t,"string"),Oe.forEach(function(n,r){n.schemeIdUri===e&&n.value===t&&Oe.splice(r,1)})}function re(){Oe=[]}function ie(){ee(dt.scheme,dt.value)}function ae(e,t){e?Je[e]=!!t:Object.keys(Je).forEach(function(e){ae(e,t)})}function oe(e){var t=Je[e];return void 0===t?Je.default:t}function se(){return et}function ue(e){D(e,"boolean"),et=e}function le(e){if(e!==Ys.MOVING_AVERAGE_SLIDING_WINDOW&&e!==Ys.MOVING_AVERAGE_EWMA)throw Ys.BAD_ARGUMENT_ERROR;nt=e}function ce(){return nt}function fe(e){D(e,"boolean"),it=e}function de(){return it}function he(e){D(e,"number"),at=e}function ge(){return at}function pe(){return ot}function Ee(e){D(e,"boolean"),ot=e}function me(e){D(e,"number"),M(e,0,.5),ft=e}function _e(){return ft}function ye(e){D(e,"number"),lt=e}function Te(){return lt}function ve(e){D(e,"number"),ct=e}function Se(){return ct}function Ae(e){D(e,"number"),st=e}function Re(){return st}function Ie(e){D(e,"boolean"),ut=e}function De(){return ut}function be(){return dt}function Me(){}var Ce,Ne,we,Oe,Le,Pe,Fe,xe,Ue,Be,ke,Ge,Ye,Ke,Ve,He,qe,je,ze,We,Xe,Qe,Ze,$e,Je,et,tt,nt,rt,it,at,ot,st,ut,lt,ct,ft,dt={scheme:"urn:mpeg:dash:utc:http-xsdate:2014",value:"http://time.akamai.com/?iso&ms"};return Ce={setABRStrategy:e,getABRStrategy:t,setUseDefaultABRRules:n,getUseDefaultABRRules:r,getABRCustomRules:a,addABRCustomRule:o,removeABRCustomRule:s,setBandwidthSafetyFactor:u,getBandwidthSafetyFactor:l,setAbandonLoadTimeout:c,getAbandonLoadTimeout:f,setLastBitrateCachingInfo:O,getLastBitrateCachingInfo:L,setLastMediaSettingsCachingInfo:P,getLastMediaSettingsCachingInfo:F,setStableBufferTime:d,getStableBufferTime:h,setBufferTimeAtTopQuality:g,getBufferTimeAtTopQuality:E,setBufferTimeAtTopQualityLongForm:m,getBufferTimeAtTopQualityLongForm:_,setLongFormContentDurationThreshold:y,getLongFormContentDurationThreshold:T,setSegmentOverlapToleranceTime:v,getSegmentOverlapToleranceTime:S,getCacheLoadThresholdForType:R,setCacheLoadThresholdForType:A,setBufferToKeep:I,getBufferToKeep:b,setBufferAheadToKeep:N,getBufferAheadToKeep:w,setBufferPruningInterval:x,getBufferPruningInterval:U,setRetryAttemptsForType:B,getRetryAttemptsForType:k,setRetryIntervalForType:G,getRetryIntervalForType:Y,setWallclockTimeUpdateInterval:K,getWallclockTimeUpdateInterval:V,setScheduleWhilePaused:H,getScheduleWhilePaused:q,getUseSuggestedPresentationDelay:J,setUseSuggestedPresentationDelay:$,setLiveDelayFragmentCount:j,getLiveDelayFragmentCount:z,getLiveDelay:X,setLiveDelay:W,setUseManifestDateHeaderTimeSource:Q,getUseManifestDateHeaderTimeSource:Z,addUTCTimingSource:ee,removeUTCTimingSource:ne,getUTCTimingSources:te,clearDefaultUTCTimingSources:re,restoreDefaultUTCTimingSources:ie,setXHRWithCredentialsForType:ae,getXHRWithCredentialsForType:oe,setFastSwitchEnabled:ue,getFastSwitchEnabled:se,setMovingAverageMethod:le,getMovingAverageMethod:ce,setJumpGaps:fe,getJumpGaps:de,setSmallGapLimit:he,getSmallGapLimit:ge,getLowLatencyEnabled:pe,setLowLatencyEnabled:Ee,setCatchUpPlaybackRate:me,getCatchUpPlaybackRate:_e,setLowLatencyMinDrift:ye,getLowLatencyMinDrift:Te,setLowLatencyMaxDriftBeforeSeeking:ve,getLowLatencyMaxDriftBeforeSeeking:Se,setManifestUpdateRetryInterval:Ae,getManifestUpdateRetryInterval:Re,setKeepProtectionMediaKeys:Ie,getKeepProtectionMediaKeys:De,getDefaultUtcTimingSource:be,reset:Me},function(){var e,t;Oe=[],we=!1,Ne=!0,Fe=!0,Ze=Ys.ABR_STRATEGY_DYNAMIC,$e=!0,et=!1,ke={enabled:!0,ttl:hp},Ge={enabled:!0,ttl:gp},Le=dp,Pe=void 0,xe=mp,Ue=_p,Be=yp,Ye=NaN,Ke=Sp,Ve=Ap,He=Rp,qe=Ip,je=pp,ze=Ep,Qe=Kp,it=!1,at=Dp,st=bp,Je={default:Vp},tt=[],nt=Ys.MOVING_AVERAGE_SLIDING_WINDOW,ot=!1,lt=kp,ct=Gp,ft=Yp,e={},p(e,Cl.MPD_TYPE,Op),p(e,Cl.XLINK_EXPANSION_TYPE,Pp),p(e,Cl.MEDIA_SEGMENT_TYPE,Np),p(e,Cl.INIT_SEGMENT_TYPE,Np),p(e,Cl.BITSTREAM_SWITCHING_SEGMENT_TYPE,Np),p(e,Cl.INDEX_SEGMENT_TYPE,Np),p(e,Cl.OTHER_TYPE,Np),We=e,t={},p(t,Cl.MPD_TYPE,Lp),p(t,Cl.XLINK_EXPANSION_TYPE,Fp),p(t,Cl.MEDIA_SEGMENT_TYPE,wp),p(t,Cl.INIT_SEGMENT_TYPE,wp),p(t,Cl.BITSTREAM_SWITCHING_SEGMENT_TYPE,wp),p(t,Cl.INDEX_SEGMENT_TYPE,wp),p(t,Cl.OTHER_TYPE,wp),Xe=t,rt={},rt[Ys.VIDEO]=Mp,rt[Ys.AUDIO]=Cp,ut=!1}(),Ce}function Ti(){function e(){C.trigger(uu.METRICS_CHANGED)}function t(t){C.trigger(uu.METRIC_CHANGED,{mediaType:t}),e()}function n(e,n,r){C.trigger(uu.METRIC_UPDATED,{mediaType:e,metric:n,value:r}),t(e)}function r(e,n,r){C.trigger(uu.METRIC_ADDED,{mediaType:e,metric:n,value:r}),t(e)}function i(e){delete D[e],t(e)}function a(){D={},e()}function o(e){return D.hasOwnProperty(e)?D[e]:null}function s(e){var t;return D.hasOwnProperty(e)?t=D[e]:(t=new qp,D[e]=t),t}function u(e,t,n){var r=s(e);r[t].push(n),r[t].length>b&&r[t].shift()}function l(e,t,n,r){var i=new Nl;return i.s=t,i.d=n,i.b=r,e.trace.push(i),e.interval||(e.interval=0),e.interval+=n,i}function c(e,t,n,r,i,a,o,s,u,f,h,g,p,E){var m=new Cl;i&&i!==r&&(c(e,null,n,r,null,null,o,s,null,null,null,g,null,null),m.actualurl=i),m.tcpid=t,m.type=n,m.url=r,m.range=o,m.trequest=s,m.tresponse=u,m.responsecode=h,m._tfinish=f,m._stream=e,m._mediaduration=g,m._responseHeaders=p,m._serviceLocation=a,E?E.forEach(function(e){l(m,e.s,e.d,e.b)}):(delete m.interval,delete m.trace),d(e,Vs.HTTP_REQUEST,m)}function f(e,t,n,r,i){var a=new jp;a.t=t,a.mt=n,a.to=r,i?a.lto=i:delete a.lto,d(e,Vs.TRACK_SWITCH,a)}function d(e,t,n){u(e,t,n),r(e,t,n)}function h(e,t,n){var r=new zp;r.t=t,r.level=n,d(e,Vs.BUFFER_LEVEL,r)}function g(e,t,n){var r=new Wp;r.target=n,r.state=t,d(e,Vs.BUFFER_STATE,r)}function p(e,t,n,r){var i=new Xp;i.time=t,i.range=r,i.manifestInfo=n,d(e,Vs.DVR_INFO,i)}function E(e,t){var n=new Qp,r=s(e).DroppedFrames;n.time=t.creationTime,n.droppedFrames=t.droppedVideoFrames,r.length>0&&r[r.length-1]==n||d(e,Vs.DROPPED_FRAMES,n)}function m(e,t,n,r,i,a,o,s,u){var l=new eE;l.mediaType=e,l.t=t,l.type=n,l.startTime=r,l.availabilityStartTime=i,l.duration=a,l.quality=o,l.range=s,l.state=u,d(e,Vs.SCHEDULING_INFO,l)}function _(e,t,n){var i=new tE;i.loadingRequests=t,i.executedRequests=n,s(e).RequestsQueue=i,r(e,Vs.REQUESTS_QUEUE,i)}function y(e,t,n,i,a,o,s,l,c,f){var d=new Zp;d.mediaType=e,d.type=t,d.requestTime=n,d.fetchTime=i,d.availabilityStartTime=a,d.presentationStartTime=o,d.clientTimeOffset=s,d.currentTime=l,d.buffered=c,d.latency=f,u(Ys.STREAM,Vs.MANIFEST_UPDATE,d),r(e,Vs.MANIFEST_UPDATE,d)}function T(e,t){if(e){for(var r in t)e[r]=t[r];n(e.mediaType,Vs.MANIFEST_UPDATE,e)}}function v(e,t,r,i,a){if(e){var o=new $p;o.id=t,o.index=r,o.start=i,o.duration=a,e.streamInfo.push(o),n(e.mediaType,Vs.MANIFEST_UPDATE_STREAM_INFO,e)}}function S(e,t,r,i,a,o,s,u){if(e){var l=new Jp;l.id=t,l.index=r,l.streamIndex=i,l.mediaType=a,l.startNumber=s,l.fragmentInfoType=u,l.presentationTimeOffset=o,e.representationInfo.push(l),n(e.mediaType,Vs.MANIFEST_UPDATE_TRACK_INFO,e)}}function A(e){var t=Ys.STREAM;e.trace&&Array.isArray(e.trace)?e.trace.forEach(function(e){e.hasOwnProperty("subreplevel")&&!e.subreplevel&&delete e.subreplevel}):delete e.trace,d(t,Vs.PLAY_LIST,e)}function R(e){d(Ys.STREAM,Vs.DVB_ERRORS,e)}var I,D,b=1e3,M=this.context,C=iu(M).getInstance();return I={clearCurrentMetricsForType:i,clearAllCurrentMetrics:a,getReadOnlyMetricsFor:o,getMetricsFor:s,addHttpRequest:c,addRepresentationSwitch:f,addBufferLevel:h,addBufferState:g,addDVRInfo:p,addDroppedFrames:E,addSchedulingInfo:m,addRequestsQueue:_,addManifestUpdate:y,updateManifestUpdateInfo:T,addManifestUpdateStreamInfo:v,addManifestUpdateRepresentationInfo:S,addPlayList:A,addDVBErrors:R},function(){D={}}(),I}function vi(e){var t,n;this.promise=new e(function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r}),this.resolve=yo(t),this.reject=yo(n)}function Si(){function e(){X.on(uu.PLAYBACK_PLAYING,m,this)}function t(){X.off(uu.PLAYBACK_PLAYING,m,this)}function n(){H&&(H.playbackRate=j||1,H.removeEventListener("canplay",n))}function r(e){H&&(H.readyState<=2&&e>0?H.addEventListener("canplay",n):H.playbackRate=e)}function i(e,t){if(H){if(H.currentTime==e)return;try{e=t?a(e):e,H.currentTime=e}catch(t){0===H.readyState&&t.code===t.INVALID_STATE_ERR&&setTimeout(function(){H.currentTime=e},400)}}}function a(e){var t=N(),n=e,r=9999999999;if(t)for(var i=0;i<t.length;i++){var a=t.start(i),o=t.end(i),s=Math.abs(a-e),u=Math.abs(o-e);if(e>=a&&e<=o)return e;s<r&&(r=s,n=a),u<r&&(r=u,n=o)}return n}function o(){return H}function s(e){if(!(null===e||void 0===e||e&&/^(VIDEO|AUDIO)$/i.test(e.nodeName)))throw z;(H=e)&&(H.preload="auto")}function u(e){H&&(e?H.src=e:(H.removeAttribute("src"),H.load()))}function l(){return H?H.src:null}function c(){return q}function f(e){q=e,q.style.position="absolute",q.style.display="flex",q.style.overflow="hidden",q.style.pointerEvents="none",q.style.top=0,q.style.left=0}function d(e,t){E(e,t)}function h(){return Q.length>0}function g(e){var t;null===e||H.seeking||-1!==Q.indexOf(e)||(Q.push(e),H&&1===Q.length&&(t=document.createEvent("Event"),t.initEvent("waiting",!0,!1),j=H.playbackRate,r(0),H.dispatchEvent(t)))}function p(e){var t,n=Q.indexOf(e);null!==e&&(-1!==n&&Q.splice(n,1),H&&!1===h()&&0===H.playbackRate&&(r(j||1),H.paused||(t=document.createEvent("Event"),t.initEvent("playing",!0,!1),H.dispatchEvent(t))))}function E(e,t){t?g(e):p(e)}function m(){if(H&&h()&&0===H.playbackRate){var e=document.createEvent("Event");e.initEvent("waiting",!0,!1),H.dispatchEvent(e)}}function _(){if(!H)return null;var e="webkitDroppedFrameCount"in H&&"webkitDecodedFrameCount"in H,t="getVideoPlaybackQuality"in H,n=null;return t?n=H.getVideoPlaybackQuality():e&&(n={droppedVideoFrames:H.webkitDroppedFrameCount,totalVideoFrames:H.webkitDroppedFrameCount+H.webkitDecodedFrameCount,creationTime:new Date}),n}function y(){if(H){H.autoplay=!0;var e=H.play();e&&e.catch&&"undefined"!=typeof Promise&&e.catch(function(e){"NotAllowedError"===e.name&&X.trigger(uu.PLAYBACK_NOT_ALLOWED),V.warn("Caught pending play exception - continuing (".concat(e,")"))})}}function T(){return H?H.paused:null}function v(){H&&(H.pause(),H.autoplay=!1)}function S(){return H?H.seeking:null}function A(){return H?H.currentTime:null}function R(){return H?H.playbackRate:null}function I(){return H?H.played:null}function D(){return H?H.ended:null}function b(e,t){H&&H.addEventListener(e,t)}function M(e,t){H&&H.removeEventListener(e,t)}function C(){return H?H.readyState:NaN}function N(){return H?H.buffered:null}function w(){return H?H.clientWidth:NaN}function O(){return H?H.clientHeight:NaN}function L(){return H?H.videoWidth:NaN}function P(){return H?H.videoHeight:NaN}function F(){return H&&H.parentNode?H.getBoundingClientRect().top-H.parentNode.getBoundingClientRect().top:NaN}function x(){return H&&H.parentNode?H.getBoundingClientRect().left-H.parentNode.getBoundingClientRect().left:NaN}function U(){return H?H.textTracks:[]}function B(e,t,n,r,i){if(H)for(var a=0;a<H.textTracks.length;a++)if(H.textTracks[a].kind===e&&(!t||H.textTracks[a].label==t)&&H.textTracks[a].language===n&&H.textTracks[a].isTTML===r&&H.textTracks[a].isEmbedded===i)return H.textTracks[a];return null}function k(e,t,n){return H?H.addTextTrack(e,t,n):null}function G(e){H&&(H.appendChild(e),void 0!==e.isTTML&&(H.textTracks[H.textTracks.length-1].isTTML=e.isTTML,H.textTracks[H.textTracks.length-1].isEmbedded=e.isEmbedded))}function Y(e){H&&H.removeChild(e)}var K,V,H,q,j,z="element is not video or audio DOM type!",W=this.context,X=iu(W).getInstance(),Q=[];return K={initialize:e,setCurrentTime:i,play:y,isPaused:T,pause:v,isSeeking:S,getTime:A,getPlaybackRate:R,setPlaybackRate:r,getPlayedRanges:I,getEnded:D,setStallState:d,getElement:o,setElement:s,setSource:u,getSource:l,getTTMLRenderingDiv:c,setTTMLRenderingDiv:f,getPlaybackQuality:_,addEventListener:b,removeEventListener:M,getReadyState:C,getBufferRange:N,getClientWidth:w,getClientHeight:O,getTextTracks:U,getTextTrack:B,addTextTrack:k,appendChild:G,removeChild:Y,getVideoWidth:L,getVideoHeight:P,getVideoRelativeOffsetTop:F,getVideoRelativeOffsetLeft:x,reset:t},function(){V=Eu(W).getInstance().getLogger(K)}(),K}function Ai(e){function t(e){if(void 0!==d)return d;d=!1;var t;try{"undefined"!=typeof window&&(t=window[e])}catch(e){return f.warn("DOMStorage access denied: "+e.message),d}if(!t||e!==tm&&e!==nm)return d;try{t.setItem("1","1"),t.removeItem("1"),d=!0}catch(e){f.warn("DOMStorage is supported, but cannot be used: "+e.message)}return d}function n(){t(tm)&&$E.forEach(function(e){var t=localStorage.getItem(e.oldKey);if(t){localStorage.removeItem(e.oldKey);try{localStorage.setItem(e.newKey,t)}catch(e){f.error(e.message)}}})}function r(){return 6e5*Math.round((new Date).getTime()/6e5)}function i(e,n){return t(e)&&g["get"+n+"CachingInfo"]().enabled}function a(){if(!g||!g.hasOwnProperty("getLastMediaSettingsCachingInfo"))throw new Error(Ys.MISSING_CONFIG_ERROR)}function o(e){if(a(),!i(tm,im))return null;var t=null,n=em.replace(/\?/,e);try{var r=JSON.parse(localStorage.getItem(n))||{},o=(new Date).getTime()-parseInt(r.timestamp,10)>=g.getLastMediaSettingsCachingInfo().ttl||!1;t=r.settings,o&&(localStorage.removeItem(n),t=null)}catch(e){return null}return t}function s(e){var t=NaN;if(a(),i(tm,rm)){var n=JE.replace(/\?/,e);try{var r=JSON.parse(localStorage.getItem(n))||{},o=(new Date).getTime()-parseInt(r.timestamp,10)>=g.getLastMediaSettingsCachingInfo().ttl||!1,s=parseFloat(r.bitrate);isNaN(s)||o?o&&localStorage.removeItem(n):(t=s,f.debug("Last saved bitrate for "+e+" was "+s))}catch(e){return null}}return t}function u(e,t){if(i(tm,im)){var n=em.replace(/\?/,e);try{localStorage.setItem(n,JSON.stringify({settings:t,timestamp:r()}))}catch(e){f.error(e.message)}}}function l(e,t){if(i(tm,rm)&&t){var n=JE.replace(/\?/,e);try{localStorage.setItem(n,JSON.stringify({bitrate:t.toFixed(3),timestamp:r()}))}catch(e){f.error(e.message)}}}e=e||{};var c,f,d,h=this.context,g=e.mediaPlayerModel;return c={getSavedBitrateSettings:s,setSavedBitrateSettings:l,getSavedMediaSettings:o,setSavedMediaSettings:u},function(){f=Eu(h).getInstance().getLogger(c),n()}(),c}function Ri(){return om}function Ii(){function e(e){e&&e.dashManifestModel&&(O=e.dashManifestModel)}function t(e,t){return t&&e?t.getRepresentationForQuality(e.quality):null}function n(e){return e&&e.streamInfo&&void 0!==e.streamInfo.id&&P[e.streamInfo.id]?P[e.streamInfo.id][e.index]:null}function r(e,t){for(var n=t.length,r=0;r<n;r++){var i=t[r];if(e.id===i.id)return i}return null}function i(e){var t=new sm,n=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index],r=O.getRepresentationFor(e.index,n);return t.id=e.id,t.quality=e.index,t.bandwidth=O.getBandwidth(r),t.DVRWindow=e.segmentAvailabilityRange,t.fragmentDuration=e.segmentDuration||(e.segments&&e.segments.length>0?e.segments[0].duration:NaN),t.MSETimeOffset=e.MSETimeOffset,t.useCalculatedLiveEdgeTime=e.useCalculatedLiveEdgeTime,t.mediaInfo=a(e.adaptation),t}function a(e){var t,n=new um,r=e.period.mpd.manifest.Period_asArray[e.period.index].AdaptationSet_asArray[e.index];return n.id=e.id,n.index=e.index,n.type=e.type,n.streamInfo=u(e.period),n.representationCount=O.getRepresentationCount(r),n.labels=O.getLabelsForAdaptation(r),n.lang=O.getLanguageForAdaptation(r),t=O.getViewpointForAdaptation(r),n.viewpoint=t?t.value:void 0,n.accessibility=O.getAccessibilityForAdaptation(r).map(function(e){var t=e.value,r=t;return e.schemeIdUri&&e.schemeIdUri.search("cea-608")>=0&&void 0!==of&&(r=t?"cea-608:"+t:"cea-608",n.embeddedCaptions=!0),r}),n.audioChannelConfiguration=O.getAudioChannelConfigurationForAdaptation(r).map(function(e){return e.value}),n.roles=O.getRolesForAdaptation(r).map(function(e){return e.value}),n.codec=O.getCodec(r),n.mimeType=O.getMimeType(r),n.contentProtection=O.getContentProtectionData(r),n.bitrateList=O.getBitrateListForAdaptation(r),n.contentProtection&&n.contentProtection.forEach(function(e){e.KID=O.getKID(e)}),n.isText=O.getIsTextTrack(n.mimeType),n}function o(e,t,n){e.id=t,e.index=100+parseInt(t.substring(2,3)),e.type=Ys.EMBEDDED_TEXT,e.codec="cea-608-in-SEI",e.isText=!0,e.isEmbedded=!0,e.lang=n,e.roles=["caption"]}function s(e){e.type=Ys.IMAGE}function u(e){var t=new lm;return t.id=e.id,t.index=e.index,t.start=e.start,t.duration=e.duration,t.manifestInfo=l(e.mpd),t.isLast=1===e.mpd.manifest.Period_asArray.length||Math.abs(t.start+t.duration-t.manifestInfo.duration)<1,t}function l(e){var t=new cm;return t.DVRWindowSize=e.timeShiftBufferDepth,t.loadedTime=e.manifest.loadedTime,t.availableFrom=e.availabilityStartTime,t.minBufferTime=e.manifest.minBufferTime,t.maxFragmentDuration=e.maxSegmentDuration,t.duration=O.getDuration(e.manifest),t.isDynamic=O.getIsDynamic(e.manifest),t}function c(e,t){if(0===L.length)return null;var n=L[0].mpd.manifest,i=d(n,e.index,t,e);if(!i)return null;var o=r(e,L),s=o.id,u=O.getIndexForAdaptation(i,n,e.index);return P[s]=P[s]||O.getAdaptationsForPeriod(o),a(P[s][u])}function f(e){return O.getRolesForAdaptation(e).filter(function(e){return e.value===kd.MAIN})[0]}function d(e,t,n,r){var i=O.getAdaptationsForType(e,t,n);if(!i||0===i.length)return null;if(i.length>1&&r){var a=h(r,n);if(F[r.id]&&F[r.id][n])for(var o=0,s=i.length;o<s;o++)if(F[r.id][n].isMediaInfoEqual(a[o]))return i[o];for(var u=0,l=i.length;u<l;u++)if(f(i[u]))return i[u]}return i[0]}function h(e,t,n){var i,u,l,c,f,d,h=L,p=n,E=[];if(p){g();var m=O.getMpd(p);h=O.getRegularPeriods(m)}else{if(!(L.length>0))return E;p=L[0].mpd.manifest}var _=r(e,h),y=_.id,T=O.getAdaptationsForType(p,e.index,t!==Ys.EMBEDDED_TEXT?t:Ys.VIDEO);if(!T)return E;for(P[y]=P[y]||O.getAdaptationsForPeriod(_),c=0,d=T.length;c<d;c++)if(i=T[c],l=O.getIndexForAdaptation(i,p,e.index),u=a(P[y][l]),t===Ys.EMBEDDED_TEXT){var v=u.accessibility.length;for(f=0;f<v;f++)if(u){var S=u.accessibility[f];if(0===S.indexOf("cea-608:")){var A=S.substring(8),R=A.split(";");if("CC"===R[0].substring(0,2))for(f=0;f<R.length;f++)u||(u=a.call(this,P[y][l])),o(u,R[f].substring(0,3),R[f].substring(4)),E.push(u),u=null;else for(f=0;f<R.length;f++)u||(u=a.call(this,P[y][l])),o(u,"CC"+(f+1),R[f]),E.push(u),u=null}else 0===S.indexOf("cea-608")&&(o(u,Ys.CC1,"eng"),E.push(u),u=null)}}else t===Ys.IMAGE?(s(u),E.push(u),u=null):u&&E.push(u);return E}function g(){if(!O||!O.hasOwnProperty("getMpd")||!O.hasOwnProperty("getRegularPeriods"))throw new Error("setConfig function has to be called previously")}function p(e){if(!e)return null;g();var t=O.getMpd(e);L=O.getRegularPeriods(t),P={}}function E(e,t){var n=[],r=L;if(e){g();var i=O.getMpd(e);r=O.getRegularPeriods(i)}t||(t=r.length);for(var a=0;a<t;a++)n.push(u(r[a]));return n}function m(e){
if(!(e&&e.hasOwnProperty("getRepresentationController")&&e.hasOwnProperty("getIndexHandler")&&e.hasOwnProperty("getMediaInfo")&&e.hasOwnProperty("getType")&&e.hasOwnProperty("getStreamInfo")))throw new Error("streamProcessor parameter is missing or malformed!")}function _(e){if(!e||!e.hasOwnProperty("getRepresentationForQuality")||!e.hasOwnProperty("getCurrentRepresentation"))throw new Error("representationController parameter is missing or malformed!")}function y(e,t){var n,r,i;return m(e),b(t),n=e.getRepresentationController(),i=e.getIndexHandler(),r=n?n.getRepresentationForQuality(t):null,i?i.getInitRequest(r):null}function T(e,n,r,i){var a,o,s,u=null;return m(e),a=e.getRepresentationController(),o=t(n,a),s=e.getIndexHandler(),s&&(u=void 0!==r&&void 0!==i?s.getSegmentRequestForTime(o,r,i):s.getNextSegmentRequest(o)),u}function v(e){m(e);var t=e.getIndexHandler();return t?t.getCurrentTime():NaN}function S(e,t){m(e);var n=e.getIndexHandler();n&&n.setCurrentTime(t)}function A(e){m(e);var t=e.getIndexHandler();t&&t.resetIndex()}function R(e){m(e);var t,i,a=r(e.getStreamInfo(),L),o=e.getMediaInfo(),s=n(o),u=e.getType();t=o?o.id:null,L.length>0&&(i=t?O.getAdaptationForId(t,L[0].mpd.manifest,a.index):O.getAdaptationForIndex(o.index,L[0].mpd.manifest,a.index),e.getRepresentationController().updateData(i,s,u))}function I(e,t){_(e);var n;return void 0!==t?(b(t),n=e.getRepresentationForQuality(t)):n=e.getCurrentRepresentation(),n?i(n):null}function D(e,t,n){if(!e||!t)return null;var r=new fm,i=e.scheme_id_uri,a=e.value,o=e.timescale,s=e.presentation_time_delta,u=e.event_duration,l=e.id,c=e.message_data,f=n*o+s;return t[i+"/"+a]?(r.eventStream=t[i+"/"+a],r.eventStream.value=a,r.eventStream.timescale=o,r.duration=u,r.id=l,r.presentationTime=f,r.messageData=c,r.presentationTimeDelta=s,r):null}function M(e,i){var a=[];if(0===L.length)return a;var o=L[0].mpd.manifest;return e instanceof lm?a=O.getEventsForPeriod(r(e,L)):e instanceof um?a=O.getEventStreamForAdaptationSet(o,n(e)):e instanceof sm&&(a=O.getEventStreamForRepresentation(o,t(e,i.getRepresentationController()))),a}function C(e,t,n){F[e]=F[e]||{},F[e][t]=F[e][t]||{},F[e][t]=n}function N(){L=[],P={},F={}}var w,O,L,P,F;return w={convertDataToRepresentationInfo:i,getDataForMedia:n,getStreamsInfo:E,getMediaInfoForType:c,getAllMediaInfoForType:h,getRepresentationInfo:I,getAdaptationForType:d,updateData:R,getInitRequest:y,getFragmentRequest:T,getIndexHandlerTime:v,setIndexHandlerTime:S,getEventsFor:M,getEvent:D,setConfig:e,updatePeriods:p,reset:N,resetIndexHandler:A,setCurrentMediaInfo:C},function(){N()}(),w}function Di(e){function t(e,t){var n,r,i,a,o,s,u=!1,l=!1;if(!e)throw new Error("adaptation is not defined");if(!t)throw new Error("type is not defined");if(e.hasOwnProperty("ContentComponent_asArray")&&(a=e.ContentComponent_asArray),o=t!==Ys.TEXT?new RegExp(t):new RegExp("(vtt|ttml)"),e.Representation_asArray&&e.Representation_asArray.length&&e.Representation_asArray.length>0){var c=L(e.Representation_asArray[0]);if(c&&c.length>0&&ng.indexOf(c[0].schemeIdUri)>=0)return t===Ys.IMAGE;if(e.Representation_asArray[0].hasOwnProperty(kd.CODECS)&&(s=e.Representation_asArray[0].codecs,0===s.search(Ys.STPP)||0===s.search(Ys.WVTT)))return t===Ys.FRAGMENTED_TEXT}if(a){if(a.length>1)return t===Ys.MUXED;a[0]&&a[0].contentType===t&&(u=!0,l=!0)}if(e.hasOwnProperty(kd.MIME_TYPE)&&(u=o.test(e.mimeType),l=!0),!l)for(n=0,r=e.Representation_asArray&&e.Representation_asArray.length?e.Representation_asArray.length:0;!l&&n<r;)i=e.Representation_asArray[n],i.hasOwnProperty(kd.MIME_TYPE)&&(u=o.test(i.mimeType),l=!0),n++;return u}function n(e){return t(e,Ys.AUDIO)}function r(e){return t(e,Ys.VIDEO)}function i(e){return t(e,Ys.FRAGMENTED_TEXT)}function a(e){return t(e,Ys.MUXED)}function o(e){return t(e,Ys.IMAGE)}function s(e){return"text/vtt"===e||"application/ttml+xml"===e}function u(e){var t="";return e&&e.hasOwnProperty(kd.LANG)&&(t=e.lang.replace(/[^A-Za-z0-9-]/g,"")),t}function l(e){return e&&e.hasOwnProperty(kd.VIEWPOINT)?e.Viewpoint:null}function c(e){return e&&e.hasOwnProperty(kd.ROLE_ASARRAY)?e.Role_asArray:[]}function f(e){return e&&e.hasOwnProperty(kd.ACCESSIBILITY_ASARRAY)?e.Accessibility_asArray:[]}function d(e){return e&&e.hasOwnProperty(kd.AUDIOCHANNELCONFIGURATION_ASARRAY)?e.AudioChannelConfiguration_asArray:[]}function h(){return function(e,t){return e.bandwidth-t.bandwidth}}function g(e){return e&&void 0!==e.Representation_asArray&&null!==e.Representation_asArray&&e.Representation_asArray.sort(h()),e}function p(e,t){return e&&e.Period_asArray&&ae(t)&&e.Period_asArray[t]?e.Period_asArray[t].AdaptationSet_asArray:[]}function E(e,t,n){var r,i,a=p(t,n);for(r=0,i=a.length;r<i;r++)if(a[r].hasOwnProperty(kd.ID)&&a[r].id===e)return a[r];return null}function m(e,t,n){var r=p(t,n);return r.length>0&&ae(e)?r[e]:null}function _(e,t,n){var r=p(t,n),i=r.length;if(e)for(var a=0;a<i;a++){var o=pg(J).getInstance();if(o.areEqual(r[a],e))return a}return-1}function y(e,n,r){var i,a,o=p(e,n),s=[];for(i=0,a=o.length;i<a;i++)t(o[i],r)&&s.push(g(o[i]));return s}function T(e,t,n){var r=null;if(e&&e.Representation_asArray&&e.Representation_asArray.length>0){var i=ae(t)&&t>=0&&t<e.Representation_asArray.length?e.Representation_asArray[t]:e.Representation_asArray[0];i&&(r=i.mimeType+';codecs="'+i.codecs+'"',n&&void 0!==i.width&&(r+=';width="'+i.width+'";height="'+i.height+'"'))}return r}function v(e){return e&&e.Representation_asArray&&e.Representation_asArray.length>0?e.Representation_asArray[0].mimeType:null}function S(e){return e&&e.hasOwnProperty(kd.CENC_DEFAULT_KID)?e[kd.CENC_DEFAULT_KID]:null}function A(e){if(!e.Label_asArray||!e.Label_asArray.length)return[];for(var t=[],n=0;n<e.Label_asArray.length;n++)t.push({lang:e.Label_asArray[n].lang,text:e.Label_asArray[n].__text||e.Label_asArray[n]});return t}function R(e){return e&&e.hasOwnProperty(kd.CONTENTPROTECTION_ASARRAY)&&0!==e.ContentProtection_asArray.length?e.ContentProtection_asArray:null}function I(e){var t=!1;return e&&e.hasOwnProperty("type")&&(t=e.type===kd.DYNAMIC),t}function D(e,t){var n=!1;return e&&e.profiles&&e.profiles.length>0&&(n=-1!==e.profiles.indexOf(t)),n}function b(e){return D(e,ie)}function M(e){return e&&e.hasOwnProperty(kd.MEDIA_PRESENTATION_DURATION)?e.mediaPresentationDuration:Number.MAX_SAFE_INTEGER||Number.MAX_VALUE}function C(e){return e&&e.bandwidth?e.bandwidth:NaN}function N(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=NaN;return e&&e.hasOwnProperty(kd.MINIMUM_UPDATE_PERIOD)&&(n=e.minimumUpdatePeriod),isNaN(n)?n:Math.max(n-t,1)}function w(e){return e&&e.Representation_asArray&&e.Representation_asArray.length?e.Representation_asArray.length:0}function O(e){return e&&e.Representation_asArray&&e.Representation_asArray.length?g(e).Representation_asArray.map(function(e){return{bandwidth:e.bandwidth,width:e.width||0,height:e.height||0,scanType:e.scanType||null}}):null}function L(e){return e&&e.EssentialProperty_asArray&&e.EssentialProperty_asArray.length?e.EssentialProperty_asArray.map(function(e){return{schemeIdUri:e.schemeIdUri,value:e.value}}):null}function P(e,t){return t&&t.Representation_asArray&&t.Representation_asArray.length>0&&ae(e)?t.Representation_asArray[e]:null}function F(e){if(e&&e.period&&ae(e.period.index)){var t=e.period.mpd.manifest.Period_asArray[e.period.index];if(t&&t.AdaptationSet_asArray&&ae(e.index))return g(t.AdaptationSet_asArray[e.index])}}function x(e){var t=e.S_asArray[e.S_asArray.length-1];return!t.hasOwnProperty("r")||t.r>=0}function U(e){var t,n=F(e).Representation_asArray[0];return n.hasOwnProperty(kd.SEGMENT_LIST)?(t=n.SegmentList,!t.hasOwnProperty(kd.SEGMENT_TIMELINE)||x(t.SegmentTimeline)):!(!n.hasOwnProperty(kd.SEGMENT_TEMPLATE)||(t=n.SegmentTemplate,!t.hasOwnProperty(kd.SEGMENT_TIMELINE)))&&x(t.SegmentTimeline)}function B(e){var t,n,r=[],i=F(e);if(e&&e.period&&ae(e.period.index)){var a=X(e.period.mpd.manifest);a&&(n=a[0])}if(i&&i.Representation_asArray)for(var o=0,u=i.Representation_asArray.length;o<u;++o){var l=i.Representation_asArray[o],c=new Gd;if(c.index=o,c.adaptation=e,l.hasOwnProperty(kd.ID)&&(c.id=l.id),l.hasOwnProperty(kd.CODECS)&&(c.codecs=l.codecs),l.hasOwnProperty(kd.CODEC_PRIVATE_DATA)&&(c.codecPrivateData=l.codecPrivateData),l.hasOwnProperty(kd.BANDWITH)&&(c.bandwidth=l.bandwidth),l.hasOwnProperty(kd.WIDTH)&&(c.width=l.width),l.hasOwnProperty(kd.HEIGHT)&&(c.height=l.height),l.hasOwnProperty(kd.SCAN_TYPE)&&(c.scanType=l.scanType),l.hasOwnProperty(kd.MAX_PLAYOUT_RATE)&&(c.maxPlayoutRate=l.maxPlayoutRate),l.hasOwnProperty(kd.SEGMENT_BASE)?(t=l.SegmentBase,c.segmentInfoType=kd.SEGMENT_BASE):l.hasOwnProperty(kd.SEGMENT_LIST)?(t=l.SegmentList,t.hasOwnProperty(kd.SEGMENT_TIMELINE)?(c.segmentInfoType=kd.SEGMENT_TIMELINE,c.useCalculatedLiveEdgeTime=x(t.SegmentTimeline)):(c.segmentInfoType=kd.SEGMENT_LIST,c.useCalculatedLiveEdgeTime=!0)):l.hasOwnProperty(kd.SEGMENT_TEMPLATE)?(t=l.SegmentTemplate,t.hasOwnProperty(kd.SEGMENT_TIMELINE)?(c.segmentInfoType=kd.SEGMENT_TIMELINE,c.useCalculatedLiveEdgeTime=x(t.SegmentTimeline)):c.segmentInfoType=kd.SEGMENT_TEMPLATE,t.hasOwnProperty(kd.INITIALIZATION_MINUS)&&(c.initialization=t.initialization.split("$Bandwidth$").join(l.bandwidth).split("$RepresentationID$").join(l.id))):c.segmentInfoType=kd.BASE_URL,c.essentialProperties=L(l),t){if(t.hasOwnProperty(kd.INITIALIZATION)){var f=t.Initialization;f.hasOwnProperty(kd.SOURCE_URL)?c.initialization=f.sourceURL:f.hasOwnProperty(kd.RANGE)&&(c.range=f.range)}else l.hasOwnProperty(kd.MIME_TYPE)&&s(l.mimeType)&&(c.range=0);t.hasOwnProperty(kd.TIMESCALE)&&(c.timescale=t.timescale),t.hasOwnProperty(kd.DURATION)&&(c.segmentDuration=t.duration/c.timescale),t.hasOwnProperty(kd.MEDIA)&&(c.media=t.media),t.hasOwnProperty(kd.START_NUMBER)&&(c.startNumber=t.startNumber),t.hasOwnProperty(kd.INDEX_RANGE)&&(c.indexRange=t.indexRange),t.hasOwnProperty(kd.PRESENTATION_TIME_OFFSET)&&(c.presentationTimeOffset=t.presentationTimeOffset/c.timescale),t.hasOwnProperty(kd.AVAILABILITY_TIME_OFFSET)?c.availabilityTimeOffset=t.availabilityTimeOffset:n&&void 0!==n.availabilityTimeOffset&&(c.availabilityTimeOffset=n.availabilityTimeOffset),t.hasOwnProperty(kd.AVAILABILITY_TIME_COMPLETE)?c.availabilityTimeComplete="false"!==t.availabilityTimeComplete:n&&void 0!==n.availabilityTimeComplete&&(c.availabilityTimeComplete=n.availabilityTimeComplete)}c.MSETimeOffset=te.calcMSETimeOffset(c),c.path=[e.period.index,e.index,o],r.push(c)}return r}function k(e){var t,s,u,l=e&&ae(e.index)?e.mpd.manifest.Period_asArray[e.index]:null,c=[];if(l&&l.AdaptationSet_asArray)for(u=0;u<l.AdaptationSet_asArray.length;u++)s=l.AdaptationSet_asArray[u],t=new pm,s.hasOwnProperty(kd.ID)&&(t.id=s.id),t.index=u,t.period=e,a(s)?t.type=Ys.MUXED:n(s)?t.type=Ys.AUDIO:r(s)?t.type=Ys.VIDEO:i(s)?t.type=Ys.FRAGMENTED_TEXT:o(s)?t.type=Ys.IMAGE:t.type=Ys.TEXT,c.push(t);return c}function G(e){var t,n,r=!!e&&I(e.manifest),i=[],a=null,o=null,s=null,u=null;for(n=0,t=e&&e.manifest&&e.manifest.Period_asArray?e.manifest.Period_asArray.length:0;n<t;n++)o=e.manifest.Period_asArray[n],o.hasOwnProperty(kd.START)?(u=new Em,u.start=o.start):null!==a&&a.hasOwnProperty(kd.DURATION)&&null!==s?(u=new Em,u.start=parseFloat((s.start+s.duration).toFixed(5))):0!==n||r||(u=new Em,u.start=0),null!==s&&isNaN(s.duration)&&(null!==u?s.duration=parseFloat((u.start-s.start).toFixed(5)):$.warn("First period duration could not be calculated because lack of start and duration period properties. This will cause timing issues during playback")),null!==u&&(u.id=Y(o,n),u.index=n,u.mpd=e,o.hasOwnProperty(kd.DURATION)&&(u.duration=o.duration),i.push(u),a=o,s=u),o=null,u=null;return 0===i.length?i:(null!==s&&isNaN(s.duration)&&(s.duration=parseFloat((V(s)-s.start).toFixed(5))),i)}function Y(e,t){if(!e)throw new Error("Period cannot be null or undefined");var n=Em.DEFAULT_ID+"_"+t;return e.hasOwnProperty(kd.ID)&&e.id.length>0&&"__proto__"!==e.id&&(n=e.id),n}function K(e){var t=new mm;return e&&(t.manifest=e,e.hasOwnProperty(kd.AVAILABILITY_START_TIME)?t.availabilityStartTime=new Date(e.availabilityStartTime.getTime()):t.availabilityStartTime=new Date(e.loadedTime.getTime()),e.hasOwnProperty(kd.AVAILABILITY_END_TIME)&&(t.availabilityEndTime=new Date(e.availabilityEndTime.getTime())),e.hasOwnProperty(kd.MINIMUM_UPDATE_PERIOD)&&(t.minimumUpdatePeriod=e.minimumUpdatePeriod),e.hasOwnProperty(kd.MEDIA_PRESENTATION_DURATION)&&(t.mediaPresentationDuration=e.mediaPresentationDuration),e.hasOwnProperty(Ys.SUGGESTED_PRESENTATION_DELAY)&&(t.suggestedPresentationDelay=e.suggestedPresentationDelay),e.hasOwnProperty(kd.TIMESHIFT_BUFFER_DEPTH)&&(t.timeShiftBufferDepth=e.timeShiftBufferDepth),e.hasOwnProperty(kd.MAX_SEGMENT_DURATION)&&(t.maxSegmentDuration=e.maxSegmentDuration)),t}function V(e){var t,n=I(e.mpd.manifest);return e.mpd.manifest.mediaPresentationDuration?t=e.mpd.manifest.mediaPresentationDuration:e.duration?t=e.duration:n?t=Number.POSITIVE_INFINITY:ne.error(new Fu(lf.MANIFEST_ERROR_ID_PARSE_CODE,"Must have @mediaPresentationDuration on MPD or an explicit @duration on the last period.",e)),t}function H(e){var t,n,r=e&&e.mpd&&e.mpd.manifest?e.mpd.manifest:null,i=r?r.Period_asArray:null,a=i&&e&&ae(e.index)?i[e.index].EventStream_asArray:null,o=[];if(a)for(t=0;t<a.length;t++){var s=new _m;if(s.period=e,s.timescale=1,!a[t].hasOwnProperty(Ys.SCHEME_ID_URI))throw new Error("Invalid EventStream. SchemeIdUri has to be set");for(s.schemeIdUri=a[t].schemeIdUri,a[t].hasOwnProperty(kd.TIMESCALE)&&(s.timescale=a[t].timescale),a[t].hasOwnProperty(kd.VALUE)&&(s.value=a[t].value),n=0;a[t].Event_asArray&&n<a[t].Event_asArray.length;n++){var u=new fm;u.presentationTime=0,u.eventStream=s,a[t].Event_asArray[n].hasOwnProperty(kd.PRESENTATION_TIME)&&(u.presentationTime=a[t].Event_asArray[n].presentationTime),a[t].Event_asArray[n].hasOwnProperty(kd.DURATION)&&(u.duration=a[t].Event_asArray[n].duration),a[t].Event_asArray[n].hasOwnProperty(kd.ID)&&(u.id=a[t].Event_asArray[n].id),a[t].Event_asArray[n].Signal&&a[t].Event_asArray[n].Signal.Binary?u.messageData=re.decodeArray(a[t].Event_asArray[n].Signal.Binary):u.messageData=a[t].Event_asArray[n].messageData||a[t].Event_asArray[n].__text,o.push(u)}}return o}function q(e,t){var n,r=[];if(!e)return r;for(n=0;n<e.length;n++){var i=new _m;if(i.timescale=1,i.representation=t,!e[n].hasOwnProperty(Ys.SCHEME_ID_URI))throw new Error("Invalid EventStream. SchemeIdUri has to be set");i.schemeIdUri=e[n].schemeIdUri,e[n].hasOwnProperty(kd.TIMESCALE)&&(i.timescale=e[n].timescale),e[n].hasOwnProperty(kd.VALUE)&&(i.value=e[n].value),r.push(i)}return r}function j(e,t){var n,r,i;return e&&e.Period_asArray&&t&&t.period&&ae(t.period.index)&&(r=e.Period_asArray[t.period.index])&&r.AdaptationSet_asArray&&ae(t.index)&&(i=r.AdaptationSet_asArray[t.index])&&(n=i.InbandEventStream_asArray),q(n,null)}function z(e,t){var n,r,i,a;return e&&e.Period_asArray&&t&&t.adaptation&&t.adaptation.period&&ae(t.adaptation.period.index)&&(r=e.Period_asArray[t.adaptation.period.index])&&r.AdaptationSet_asArray&&ae(t.adaptation.index)&&(i=r.AdaptationSet_asArray[t.adaptation.index])&&i.Representation_asArray&&ae(t.index)&&(a=i.Representation_asArray[t.index])&&(n=a.InbandEventStream_asArray),q(n,t)}function W(e){var t=I(e),n=!!e&&e.hasOwnProperty(kd.AVAILABILITY_START_TIME),r=e?e.UTCTiming_asArray:null,i=[];return(t||n)&&r&&r.forEach(function(e){var t=new fp;e.hasOwnProperty(Ys.SCHEME_ID_URI)&&(t.schemeIdUri=e.schemeIdUri,e.hasOwnProperty(kd.VALUE)&&(t.value=e.value.toString(),i.push(t)))}),i}function X(e){var t=[],n=e.BaseURL_asArray||[e.baseUri],r=!1;return n.some(function(n){if(n){var i=new Ag,a=n.__text||n;return ee.isRelative(a)&&(r=!0,e.baseUri&&(a=ee.resolve(a,e.baseUri))),i.url=a,n.hasOwnProperty(kd.SERVICE_LOCATION)&&n.serviceLocation.length?i.serviceLocation=n.serviceLocation:i.serviceLocation=a,n.hasOwnProperty(kd.DVB_PRIORITY)&&(i.dvb_priority=n[kd.DVB_PRIORITY]),n.hasOwnProperty(kd.DVB_WEIGHT)&&(i.dvb_weight=n[kd.DVB_WEIGHT]),n.hasOwnProperty(kd.AVAILABILITY_TIME_OFFSET)&&(i.availabilityTimeOffset=n[kd.AVAILABILITY_TIME_OFFSET]),n.hasOwnProperty(kd.AVAILABILITY_TIME_COMPLETE)&&(i.availabilityTimeComplete="false"!==n[kd.AVAILABILITY_TIME_COMPLETE]),t.push(i),r}}),t}function Q(e){if(e&&e.hasOwnProperty(Ys.LOCATION))return e.Location=e.Location_asArray[0],e.Location}e=e||{};var Z,$,J=this.context,ee=Hd(J).getInstance(),te=e.timelineConverter,ne=e.errHandler,re=e.BASE64,ie="urn:dvb:dash:profile:dvb-dash:2014",ae=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e};return Z={getIsTypeOf:t,getIsTextTrack:s,getLanguageForAdaptation:u,getViewpointForAdaptation:l,getRolesForAdaptation:c,getAccessibilityForAdaptation:f,getAudioChannelConfigurationForAdaptation:d,getAdaptationForIndex:m,getIndexForAdaptation:_,getAdaptationForId:E,getAdaptationsForType:y,getCodec:T,getMimeType:v,getKID:S,getLabelsForAdaptation:A,getContentProtectionData:R,getIsDynamic:I,getIsDVB:b,getDuration:M,getBandwidth:C,getManifestUpdatePeriod:N,getRepresentationCount:w,getBitrateListForAdaptation:O,getRepresentationFor:P,getRepresentationsForAdaptation:B,getAdaptationsForPeriod:k,getRegularPeriods:G,getMpd:K,getEventsForPeriod:H,getEventStreamForAdaptationSet:j,getEventStreamForRepresentation:z,getUTCTimingSources:W,getBaseURLsFromElement:X,getRepresentationSortFunction:h,getLocation:Q,getUseCalculatedLiveEdgeTimeForAdaptation:U},function(){$=Eu(J).getInstance().getLogger(Z)}(),Z}function bi(e,t,n){return void 0===n||0==+n?Math[e](t):(t=+t,n=+n,null===t||isNaN(t)||"number"!=typeof n||n%1!=0?NaN:(t=t.toString().split("e"),t=Math[e](+(t[0]+"e"+(t[1]?+t[1]-n:-n))),t=t.toString().split("e"),+(t[0]+"e"+(t[1]?+t[1]+n:n))))}function Mi(e){function t(e){var t=R.getValue();return t?t.Period_asArray[e]:-1}function n(e,n){var r;return r=T(t(n),e),null===r?null:r.bandwidth}function r(e,n){return y(t(n),e)}function i(e,n){return S(t(n),e)}function a(e){return f(e,Vs.TRACK_SWITCH)}function o(e){return f(e,Vs.BUFFER_LEVEL)}function s(e){var t=o(e);return t?Tm.round10(t.level/1e3,-3):0}function u(e){return e?e.RequestsQueue:null}function l(e){if(!e)return null;var t,n,r=e.HttpList,i=null;if(!r||r.length<=0)return null;for(t=r.length,n=t-1;n>=0;){if(r[n].responsecode){i=r[n];break}n--}return i}function c(e){return e&&e.HttpList?e.HttpList:[]}function f(e,t){if(!e)return null;var n=e[t];return!n||n.length<=0?null:n[n.length-1]}function d(e){return f(e,Vs.DROPPED_FRAMES)}function h(e){return f(e,Vs.SCHEDULING_INFO)}function g(e){return f(e,Vs.MANIFEST_UPDATE)}function p(e){return f(e,Vs.DVR_INFO)}function E(e,t){var n,r,i,a={};for(n=c(e),i=n.length-1;i>=0;i--)if(r=n[i],r.type===Cl.MPD_TYPE){a=_(r._responseHeaders);break}return void 0===a[t]?null:a[t]}function m(e,t){var n={},r=l(e);return r&&(n=_(r._responseHeaders)),void 0===n[t]?null:n[t]}function _(e){var t={};if(!e)return t;for(var n=e.trim().split("\r\n"),r=0,i=n.length;r<i;r++){var a=n[r],o=a.indexOf(": ");o>0&&(t[a.substring(0,o)]=a.substring(o+2))}return t}function y(e,t){var n=T(e,t,!0);return null!==n?n:-1}function T(e,t,n){var r,i,a,o,s,u;if(e)for(i=e.AdaptationSet_asArray,s=0;s<i.length;s+=1)for(r=i[s],o=r.Representation_asArray,u=0;u<o.length;u+=1)if(a=o[u],t===a.id)return n?u:a;return null}function v(e,t){return A.getIsTypeOf(e,t)}function S(e,t){var n,r,i,a;if(!e||!t)return-1;for(r=e.AdaptationSet_asArray,a=0;a<r.length;a+=1)if(n=r[a],i=n.Representation_asArray,v(n,t))return i.length;return-1}e=e||{};var A=e.dashManifestModel,R=e.manifestModel;return{getBandwidthForRepresentation:n,getIndexForRepresentation:r,getMaxIndexForBufferType:i,getCurrentRepresentationSwitch:a,getLatestBufferLevelVO:o,getCurrentBufferLevel:s,getCurrentHttpRequest:l,getHttpRequests:c,getCurrentDroppedFrames:d,getCurrentSchedulingInfo:h,getCurrentDVRInfo:p,getCurrentManifestUpdate:g,getLatestFragmentRequestHeaderValueByID:m,getLatestMPDRequestHeaderValueByID:E,getRequestsQueue:u}}function Ci(){function e(){_(),R.on(uu.TIME_SYNCHRONIZATION_COMPLETED,E,this)}function t(){return v}function n(e){v=e}function r(){return T}function i(e){T=e}function a(){return S}function o(e){S=e}function s(e,t,n,r){return r?n&&t.timeShiftBufferDepth!=Number.POSITIVE_INFINITY?new Date(t.availabilityStartTime.getTime()+1e3*(e+t.timeShiftBufferDepth)):t.availabilityEndTime:n?new Date(t.availabilityStartTime.getTime()+1e3*(e-T)):t.availabilityStartTime}function u(e,t,n){return s.call(this,e,t,n)}function l(e,t,n){return s.call(this,e,t,n,!0)}function c(e,t){return(e.getTime()-t.mpd.availabilityStartTime.getTime()+1e3*T)/1e3}function f(e,t){return e+(t.adaptation.period.start-t.presentationTimeOffset)}function d(e,t){return e-t.adaptation.period.start+t.presentationTimeOffset}function h(e,t){var n,r,i;return t&&(n=e.representation.adaptation.period.mpd.suggestedPresentationDelay,r=e.presentationStartTime+n,i=new Date(e.availabilityStartTime.getTime()+1e3*r)),i}function g(e,t){var n=e.adaptation.period,r={start:n.start,end:n.start+n.duration};if(!t)return r;if(!v&&e.segmentAvailabilityRange)return e.segmentAvailabilityRange;var i=e.segmentDuration||(e.segments&&e.segments.length?e.segments[e.segments.length-1].duration:0),a=c(new Date,n),o=n.start+n.duration;r.start=Math.max(a-n.mpd.timeShiftBufferDepth,n.start);var s=void 0!==e.availabilityTimeOffset&&e.availabilityTimeOffset<i?i-e.availabilityTimeOffset:i;return r.end=a>=o&&a-s<o?o:a-s,r}function p(e,t){return t-e.adaptation.period.start}function E(e){v||void 0!==e.offset&&(i(e.offset/1e3),v=!0)}function m(e){var t=e.presentationTimeOffset;return e.adaptation.period.start-t}function _(){T=0,v=!1,S=NaN}function y(){R.off(uu.TIME_SYNCHRONIZATION_COMPLETED,E,this),_()}var T,v,S,A=this.context,R=iu(A).getInstance();return{initialize:e,isTimeSyncCompleted:t,setTimeSyncCompleted:n,getClientTimeOffset:r,setClientTimeOffset:i,getExpectedLiveEdge:a,setExpectedLiveEdge:o,calcAvailabilityStartTimeFromPresentationTime:u,calcAvailabilityEndTimeFromPresentationTime:l,calcPresentationTimeFromWallTime:c,calcPresentationTimeFromMediaTime:f,calcPeriodRelativeTimeFromMpdRelativeTime:p,calcMediaTimeFromPresentationTime:d,calcSegmentAvailabilityRange:g,calcWallTimeForSegment:h,calcMSETimeOffset:m,reset:y}}function Ni(){function e(e){e&&(e.capabilities&&(Tn=e.capabilities),e.streamController&&(vn=e.streamController),e.playbackController&&(Sn=e.playbackController),e.mediaPlayerModel&&(_n=e.mediaPlayerModel),e.abrController&&(cn=e.abrController),e.mediaController&&(dn=e.mediaController))}function t(e,t,n){if(Tn||(Tn=sp(Un).getInstance()),yn=op(Un).getInstance(),!Tn.supportsMediaSource())return yn.capabilityError("mediasource"),void yn.error(new Fu(lf.CAPABILITY_MEDIASOURCE_ERROR_CODE,lf.CAPABILITY_MEDIASOURCE_ERROR_MESSAGE));on||(on=!0,fn=Sm(Un).getInstance(),cn||(cn=Jf(Un).getInstance()),Sn||(Sn=Ed(Un).getInstance()),dn||(dn=ad(Un).getInstance()),En=dm(Un).getInstance(),Rn=ym(Un).getInstance({timelineConverter:fn,errHandler:yn,BASE64:Am}),In=cp(Un).getInstance(),An=vm(Un).getInstance({manifestModel:In,dashManifestModel:Rn}),mn=aE(Un).getInstance(),bn=Tf(Un).getInstance(),Cn=am(Un).getInstance({mediaPlayerModel:_n}),En.setConfig({dashManifestModel:Rn}),Ce(),re(void 0===n||n),e&&yt(e),t&&Yt(t),nn.info("[dash.js "+o()+"] MediaPlayer has been initialized"))}function n(){Yt(null),yt(null),an=null,hn&&(hn.reset(),hn=null),gn&&(gn.reset(),gn=null)}function r(){return!!rn&&!!Dn.getElement()}function i(e,t,n){Bn.on(e,t,n)}function a(e,t,n){Bn.off(e,t,n)}function o(){return Ri()}function s(){return kn}function u(){if(Dn.getElement()||sn)return!1;if(!rn)throw Ln;en()}function l(){if(!un)throw wn;(!ln||f()&&un)&&Sn.play()}function c(){if(!un)throw wn;Sn.pause()}function f(){if(!un)throw wn;return Sn.isPaused()}function d(e){if(!un)throw wn;if(D(e,"number"),isNaN(e))throw Ys.BAD_ARGUMENT_ERROR;var t=Sn.getIsDynamic()?N(e):e;Sn.seek(t)}function h(){if(!un)throw wn;return Sn.isSeeking()}function g(){if(!un)throw wn;return Sn.getIsDynamic()}function p(e){mt().playbackRate=e}function E(){return mt().playbackRate}function m(e){_n.setCatchUpPlaybackRate(e)}function _(){return _n.getCatchUpPlaybackRate()}function y(e){if("number"!=typeof e||isNaN(e)||e<0||e>.5)throw Fn;_n.setLowLatencyMinDrift(e)}function T(){return _n.getLowLatencyMinDrift()}function v(e){if("number"!=typeof e||isNaN(e)||e<0)throw xn;_n.setLowLatencyMaxDriftBeforeSeeking(e)}function S(){return _n.getLowLatencyMaxDriftBeforeSeeking()}function A(e){D(e,"boolean"),mt().muted=e}function R(){return mt().muted}function I(e){if("number"!=typeof e||isNaN(e)||e<0||e>1)throw Ys.BAD_ARGUMENT_ERROR;mt().volume=e}function b(){return mt().volume}function M(e){var t=[Ys.VIDEO,Ys.AUDIO,Ys.FRAGMENTED_TEXT];if(e){if(-1!==t.indexOf(e)){var n=at().getCurrentBufferLevel(ot(e));return n||NaN}return nn.warn("getBufferLength requested for invalid type"),NaN}var r=t.map(function(e){return Rt(e).length>0?at().getCurrentBufferLevel(ot(e)):Number.MAX_VALUE}).reduce(function(e,t){return Math.min(e,t)});return r===Number.MAX_VALUE?NaN:r}function C(){var e=$t();return e?e.manifestInfo.DVRWindowSize:0}function N(e){var t=$t();if(!t)return 0;var n=Sn.getLiveDelay(),r=t.range.start+e;return r>t.range.end-n&&(r=t.range.end-n),r}function w(e){if(!un)throw wn;var t=mt().currentTime;if(void 0!==e)t=vn.getTimeRelativeToStreamId(t,e);else if(Sn.getIsDynamic()){var n=$t();t=null===n?0:O()-(n.range.end-n.time)}return t}function O(){if(!un)throw wn;var e=mt().duration;if(Sn.getIsDynamic()){var t,n=$t();if(!n)return 0;t=n.range.end-n.range.start,e=t<n.manifestInfo.DVRWindowSize?t:n.manifestInfo.DVRWindowSize}return e}function L(){if(!un)throw wn;return w()<0?NaN:Jt(w())}function P(){if(!un)throw wn;return Jt(O())}function F(e,t){cn.setMaxAllowedBitrateFor(e,t)}function x(e,t){cn.setMinAllowedBitrateFor(e,t)}function U(e){return cn.getMaxAllowedBitrateFor(e)}function B(e){if(!sn)throw Nn;return cn.getTopBitrateInfoFor(e)}function k(e){return cn.getMinAllowedBitrateFor(e)}function G(e,t){cn.setMaxAllowedRepresentationRatioFor(e,t)}function Y(e){return cn.getMaxAllowedRepresentationRatioFor(e)}function K(e){if(!sn)throw Nn;if(e===Ys.IMAGE){var t=qt();if(!t)return-1;var n=t.getThumbnailController();return n?n.getCurrentTrackIndex():-1}return cn.getQualityFor(e,vn.getActiveStreamInfo())}function V(e,t){if(!sn)throw Nn;if(e===Ys.IMAGE){var n=qt();if(!n)return;var r=n.getThumbnailController();r&&r.setTrackByIndex(t)}cn.setPlaybackQuality(e,vn.getActiveStreamInfo(),t)}function H(){cn.setElementSize(),cn.setWindowResizeEventCalled(!0)}function q(){return cn.getLimitBitrateByPortal()}function j(e){cn.setLimitBitrateByPortal(e)}function z(){return cn.getUsePixelRatioInLimitBitrateByPortal()}function W(e){cn.setUsePixelRatioInLimitBitrateByPortal(e)}function X(e,t){cn.setInitialBitrateFor(e,t)}function Q(e){if(!sn)throw Nn;return cn.getInitialBitrateFor(e)}function Z(e,t){cn.setInitialRepresentationRatioFor(e,t)}function $(e){return cn.getInitialRepresentationRatioFor(e)}function J(e){return cn.getAutoSwitchBitrateFor(e)}function ee(e,t){cn.setAutoSwitchBitrateFor(e,t)}function te(){return cn.getUseDeadTimeLatency()}function ne(e){cn.setUseDeadTimeLatency(e)}function re(e){D(e,"boolean"),ln=e}function ie(){return ln}function ae(e){_n.setLiveDelayFragmentCount(e)}function oe(e){_n.setLiveDelay(e)}function se(){return _n.getLiveDelay()}function ue(){if(!on)throw Pn;return un?Sn.getCurrentLiveLatency():NaN}function le(e){_n.setUseSuggestedPresentationDelay(e)}function ce(e,t){_n.setLastBitrateCachingInfo(e,t)}function fe(e,t){_n.setLastMediaSettingsCachingInfo(e,t)}function de(e){_n.setScheduleWhilePaused(e)}function he(){return _n.getScheduleWhilePaused()}function ge(e){_n.setFastSwitchEnabled(e)}function pe(){return _n.getFastSwitchEnabled()}function Ee(e){_n.setABRStrategy(e)}function me(){return _n.getABRStrategy()}function _e(e){_n.setUseDefaultABRRules(e)}function ye(e,t,n){_n.addABRCustomRule(e,t,n)}function Te(e){_n.removeABRCustomRule(e)}function ve(){_n.removeABRCustomRule()}function Se(e){_n.setMovingAverageMethod(e)}function Ae(){return _n.getMovingAverageMethod()}function Re(){return _n.getLowLatencyEnabled()}function Ie(e){_n.setLowLatencyEnabled(e)}function De(e,t){_n.addUTCTimingSource(e,t)}function be(e,t){_n.removeUTCTimingSource(e,t)}function Me(){_n.clearDefaultUTCTimingSources()}function Ce(){_n.restoreDefaultUTCTimingSources()}function Ne(e){_n.setUseManifestDateHeaderTimeSource(e)}function we(e){_n.setBufferToKeep(e)}function Oe(e){_n.setBufferAheadToKeep(e)}function Le(e){_n.setBufferPruningInterval(e)}function Pe(e){_n.setStableBufferTime(e)}function Fe(){return _n.getStableBufferTime()}function xe(e){_n.setBufferTimeAtTopQuality(e)}function Ue(){return _n.getBufferTimeAtTopQuality()}function Be(e){_n.setBufferTimeAtTopQualityLongForm(e)}function ke(){return _n.getBufferTimeAtTopQualityLongForm()}function Ge(e){_n.setLongFormContentDurationThreshold(e)}function Ye(e){_n.setSegmentOverlapToleranceTime(e)}function Ke(e,t){_n.setCacheLoadThresholdForType(e,t)}function Ve(e){_n.setBandwidthSafetyFactor(e)}function He(){return _n.getBandwidthSafetyFactor()}function qe(e){var t=cn.getThroughputHistory();return t?t.getAverageThroughput(e):0}function je(e){_n.setAbandonLoadTimeout(e)}function ze(e){_n.setRetryAttemptsForType(Cl.MEDIA_SEGMENT_TYPE,e)}function We(e){_n.setRetryIntervalForType(Cl.MEDIA_SEGMENT_TYPE,e)}function Xe(e){_n.setRetryAttemptsForType(Cl.MPD_TYPE,e)}function Qe(e){_n.setRetryIntervalForType(Cl.MPD_TYPE,e)}function Ze(e,t){_n.setXHRWithCredentialsForType(e,t)}function $e(e){return _n.getXHRWithCredentialsForType(e)}function Je(e){_n.setJumpGaps(e)}function et(){return _n.getJumpGaps()}function tt(e){_n.setSmallGapLimit(e)}function nt(){return _n.getSmallGapLimit()}function rt(e){_n.setManifestUpdateRetryInterval(e)}function it(){return _n.getManifestUpdateRetryInterval()}function at(){return An}function ot(e){return mn.getReadOnlyMetricsFor(e)}function st(e){void 0===bn&&(bn=Tf(Un).getInstance()),bn.setTextDefaultLanguage(e)}function ut(){return void 0===bn&&(bn=Tf(Un).getInstance()),bn.getTextDefaultLanguage()}function lt(e){void 0===bn&&(bn=Tf(Un).getInstance()),bn.setTextDefaultEnabled(e)}function ct(){return void 0===bn&&(bn=Tf(Un).getInstance()),bn.getTextDefaultEnabled()}function ft(e){void 0===bn&&(bn=Tf(Un).getInstance()),bn.enableText(e)}function dt(e){void 0===bn&&(bn=Tf(Un).getInstance()),bn.enableForcedTextStreaming(e)}function ht(){return void 0===bn&&(bn=Tf(Un).getInstance()),bn.isTextEnabled()}function gt(e){if(!un)throw wn;void 0===bn&&(bn=Tf(Un).getInstance()),bn.setTextTrack(e)}function pt(){var e=NaN;return bn&&(e=bn.getCurrentTrackIdx()),e}function Et(e){var t=tf(Un).getInstance();t.setConfig({videoModel:Dn}),t.initialize(),t.displayCConTop(e)}function mt(){if(!Dn.getElement())throw On;return Dn.getElement()}function _t(e){nn.warn("attachVideoContainer method has been deprecated and will be removed in dash.js v3.0.0")}function yt(e){if(!on)throw Pn;Dn.setElement(e),e&&(Xt(),Qt(),Zt(),vn&&vn.switchToVideoElement()),un&&jt(),en()}function Tt(){return Dn?Dn.getTTMLRenderingDiv():null}function vt(e){if(!Dn.getElement())throw On;Dn.setTTMLRenderingDiv(e)}function St(e){if(!sn)throw Nn;var t=qt();return t?t.getBitrateListFor(e):[]}function At(e){if(!sn)throw Nn;return En.getStreamsInfo(e)}function Rt(e){if(!sn)throw Nn;var t=vn.getActiveStreamInfo();return dn.getTracksFor(e,t)}function It(e,t,n){if(!sn)throw Nn;return n=n||En.getStreamsInfo(t,1)[0],n?En.getAllMediaInfoForType(n,e,t):[]}function Dt(e){if(!sn)throw Nn;var t=vn.getActiveStreamInfo();return dn.getCurrentTrackFor(e,t)}function bt(e,t){if(!on)throw Pn;dn.setInitialSettings(e,t)}function Mt(e){if(!on)throw Pn;return dn.getInitialSettings(e)}function Ct(e){if(!sn)throw Nn;dn.setTrack(e)}function Nt(e){if(!on)throw Pn;return dn.getSwitchMode(e)}function wt(e,t){if(!on)throw Pn;dn.setSwitchMode(e,t)}function Ot(e){if(!on)throw Pn;dn.setSelectionModeForInitialTrack(e)}function Lt(){if(!on)throw Pn;return dn.getSelectionModeForInitialTrack()}
function Pt(){return Xt()}function Ft(e){hn=e}function xt(e){an=e,vn&&vn.setProtectionData(an)}function Ut(e,t){if(e<0)return null;var n=Sn.getIsDynamic()?N(e):e,r=vn.getStreamForTime(n);if(null===r)return null;var i=r.getThumbnailController();if(!i)return null;var a=vn.getTimeRelativeToStreamId(n,r.getId());return i.get(a,t)}function Bt(e){_n.setKeepProtectionMediaKeys(e)}function kt(e,t){var n=Wt(),r=this,i=function e(i){i.error?t(null,i.error):t(i.manifest),Bn.off(uu.INTERNAL_MANIFEST_LOADED,e,r),n.reset()};Bn.on(uu.INTERNAL_MANIFEST_LOADED,i,r),Mn.initialize(e),n.load(e)}function Gt(){if(!rn)throw Ln;return rn}function Yt(e){if(!on)throw Pn;"string"==typeof e&&Mn.initialize(e),rn=e,(sn||un)&&jt(),r()&&en()}function Kt(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=new Date(1e3*e),a=i.toLocaleDateString(t),o=i.toLocaleTimeString(t,{hour12:n});return r?o+" "+a:o}function Vt(e){e=Math.max(e,0);var t=Math.floor(e/3600),n=Math.floor(e%3600/60),r=Math.floor(e%3600%60);return(0===t?"":t<10?"0"+t.toString()+":":t.toString()+":")+(n<10?"0"+n.toString():n.toString())+":"+(r<10?"0"+r.toString():r.toString())}function Ht(e,t,n){nu.extend(e,t,n,Un)}function qt(){if(!sn)throw Nn;var e=vn.getActiveStreamInfo();return e?vn.getStreamById(e.id):null}function jt(){un=!1,sn=!1,En.reset(),vn.reset(),Sn.reset(),cn.reset(),dn.reset(),bn.reset(),hn&&(_n.getKeepProtectionMediaKeys()?hn.stop():(hn.reset(),hn=null,Xt()))}function zt(){var e=Wt();vn||(vn=Dg(Un).getInstance()),dn.setConfig({domStorage:Cn}),vn.setConfig({capabilities:Tn,manifestLoader:e,manifestModel:In,dashManifestModel:Rn,mediaPlayerModel:_n,protectionController:hn,adapter:En,metricsModel:mn,dashMetrics:An,errHandler:yn,timelineConverter:fn,videoModel:Dn,playbackController:Sn,domStorage:Cn,abrController:cn,mediaController:dn,textController:bn}),Sn.setConfig({streamController:vn,metricsModel:mn,dashMetrics:An,manifestModel:In,mediaPlayerModel:_n,dashManifestModel:Rn,adapter:En,videoModel:Dn,timelineConverter:fn,uriFragmentModel:Mn}),cn.setConfig({streamController:vn,domStorage:Cn,mediaPlayerModel:_n,metricsModel:mn,dashMetrics:An,manifestModel:In,videoModel:Dn,adapter:En}),cn.createAbrRulesCollection(),bn.setConfig({errHandler:yn,manifestModel:In,dashManifestModel:Rn,mediaController:dn,streamController:vn,videoModel:Dn}),vn.initialize(ln,an)}function Wt(){return ap(Un).create({errHandler:yn,metricsModel:mn,mediaPlayerModel:_n,requestModifier:Xd(Un).getInstance(),mssHandler:pn})}function Xt(){if(hn)return hn;var e=dashjs.Protection;if("function"==typeof e){var t=e(Un).create();return uu.extend(e.events),ug.extend(e.events,{publicOnly:!0}),lf.extend(e.errors),Tn||(Tn=sp(Un).getInstance()),hn=t.createProtectionSystem({debug:kn,errHandler:yn,videoModel:Dn,capabilities:Tn,eventBus:Bn,events:uu,BASE64:Am,constants:Ys})}return null}function Qt(){if(!gn){var e=dashjs.MetricsReporting;if("function"==typeof e){var t=e(Un).create();gn=t.createMetricsReporting({debug:kn,eventBus:Bn,mediaElement:mt(),dashManifestModel:Rn,metricsModel:mn,events:uu,constants:Ys,metricsConstants:Vs})}}}function Zt(){if(!pn){var e=dashjs.MssHandler;"function"==typeof e&&(lf.extend(e.errors),pn=e(Un).create({eventBus:Bn,mediaPlayerModel:_n,metricsModel:mn,manifestModel:In,playbackController:Sn,protectionController:hn,baseURLController:Rg(Un).getInstance(),errHandler:yn,events:uu,constants:Ys,debug:kn,initSegmentType:Cl.INIT_SEGMENT_TYPE,BASE64:Am,ISOBoxer:ql}))}}function $t(){var e=mn.getReadOnlyMetricsFor(Ys.VIDEO)||mn.getReadOnlyMetricsFor(Ys.AUDIO);return An.getCurrentDVRInfo(e)}function Jt(e){var t,n=$t();return n?(t=n.manifestInfo.availableFrom.getTime()/1e3,e+(t+n.range.start)):0}function en(){!sn&&rn&&(sn=!0,nn.info("Streaming Initialized"),zt(),"string"==typeof rn?vn.load(rn):vn.loadWithManifest(rn)),!un&&r()&&(un=!0,nn.info("Playback Initialized"))}var tn,nn,rn,an,on,sn,un,ln,cn,fn,dn,hn,gn,pn,En,mn,_n,yn,Tn,vn,Sn,An,Rn,In,Dn,bn,Mn,Cn,Nn="You must first call initialize() and set a source before calling this method",wn="You must first call initialize() and set a valid source and view before calling this method",On="You must first call attachView() to set the video element before calling this method",Ln="You must first call attachSource() with a valid source before calling this method",Pn="MediaPlayer not initialized!",Fn="Playback minimum drift has an invalid value! Use a number from 0 to 0.5",xn="Playback maximum drift has an invalid value! Use a number greater or equal to 0",Un=this.context,Bn=iu(Un).getInstance(),kn=Eu(Un).getInstance();return tn={initialize:t,setConfig:e,on:i,off:a,extend:Ht,attachView:yt,attachSource:Yt,isReady:r,preload:u,play:l,isPaused:f,pause:c,isSeeking:h,isDynamic:g,seek:d,setPlaybackRate:p,getPlaybackRate:E,setMute:A,isMuted:R,setVolume:I,getVolume:b,time:w,duration:O,timeAsUTC:L,durationAsUTC:P,getActiveStream:qt,getDVRWindowSize:C,getDVRSeekOffset:N,convertToTimeCode:Vt,formatUTC:Kt,getVersion:o,getDebug:s,getBufferLength:M,getTTMLRenderingDiv:Tt,getVideoElement:mt,getSource:Gt,setLiveDelayFragmentCount:ae,setLiveDelay:oe,getLiveDelay:se,getCurrentLiveLatency:ue,useSuggestedPresentationDelay:le,enableLastBitrateCaching:ce,enableLastMediaSettingsCaching:fe,setMaxAllowedBitrateFor:F,getMaxAllowedBitrateFor:U,getTopBitrateInfoFor:B,setMinAllowedBitrateFor:x,getMinAllowedBitrateFor:k,setMaxAllowedRepresentationRatioFor:G,getMaxAllowedRepresentationRatioFor:Y,setAutoPlay:re,getAutoPlay:ie,setScheduleWhilePaused:de,getScheduleWhilePaused:he,getDashMetrics:at,getMetricsFor:ot,getQualityFor:K,setQualityFor:V,updatePortalSize:H,getLimitBitrateByPortal:q,setLimitBitrateByPortal:j,getUsePixelRatioInLimitBitrateByPortal:z,setUsePixelRatioInLimitBitrateByPortal:W,setTextDefaultLanguage:st,getTextDefaultLanguage:ut,setTextDefaultEnabled:lt,getTextDefaultEnabled:ct,enableText:ft,enableForcedTextStreaming:dt,isTextEnabled:ht,setTextTrack:gt,getBitrateInfoListFor:St,setInitialBitrateFor:X,getInitialBitrateFor:Q,setInitialRepresentationRatioFor:Z,getInitialRepresentationRatioFor:$,getStreamsFromManifest:At,getTracksFor:Rt,getTracksForTypeFromManifest:It,getCurrentTrackFor:Dt,setInitialMediaSettingsFor:bt,getInitialMediaSettingsFor:Mt,setCurrentTrack:Ct,getTrackSwitchModeFor:Nt,setTrackSwitchModeFor:wt,setSelectionModeForInitialTrack:Ot,getSelectionModeForInitialTrack:Lt,setFastSwitchEnabled:ge,getFastSwitchEnabled:pe,setMovingAverageMethod:Se,getMovingAverageMethod:Ae,getAutoSwitchQualityFor:J,setAutoSwitchQualityFor:ee,setABRStrategy:Ee,getABRStrategy:me,useDefaultABRRules:_e,addABRCustomRule:ye,removeABRCustomRule:Te,removeAllABRCustomRule:ve,setBandwidthSafetyFactor:Ve,getBandwidthSafetyFactor:He,getAverageThroughput:qe,setAbandonLoadTimeout:je,retrieveManifest:kt,addUTCTimingSource:De,removeUTCTimingSource:be,clearDefaultUTCTimingSources:Me,restoreDefaultUTCTimingSources:Ce,setBufferToKeep:we,setBufferAheadToKeep:Oe,setBufferPruningInterval:Le,setStableBufferTime:Pe,getStableBufferTime:Fe,setBufferTimeAtTopQuality:xe,getBufferTimeAtTopQuality:Ue,setBufferTimeAtTopQualityLongForm:Be,getBufferTimeAtTopQualityLongForm:ke,setFragmentLoaderRetryAttempts:ze,setFragmentLoaderRetryInterval:We,setManifestLoaderRetryAttempts:Xe,setManifestLoaderRetryInterval:Qe,setXHRWithCredentialsForType:Ze,getXHRWithCredentialsForType:$e,setJumpGaps:Je,getJumpGaps:et,setSmallGapLimit:tt,getSmallGapLimit:nt,setLowLatencyEnabled:Ie,getLowLatencyEnabled:Re,setCatchUpPlaybackRate:m,getCatchUpPlaybackRate:_,setLowLatencyMinDrift:y,getLowLatencyMinDrift:T,setLowLatencyMaxDriftBeforeSeeking:v,getLowLatencyMaxDriftBeforeSeeking:S,setManifestUpdateRetryInterval:rt,getManifestUpdateRetryInterval:it,setLongFormContentDurationThreshold:Ge,setSegmentOverlapToleranceTime:Ye,setCacheLoadThresholdForType:Ke,getProtectionController:Pt,attachProtectionController:Ft,setProtectionData:xt,enableManifestDateHeaderTimeSource:Ne,displayCaptionsOnTop:Et,attachVideoContainer:_t,attachTTMLRenderingDiv:vt,getCurrentTextTrackIndex:pt,getUseDeadTimeLatencyForAbr:te,setUseDeadTimeLatencyForAbr:ne,getThumbnail:Ut,keepProtectionMediaKeys:Bt,reset:n},function(){nn=kn.getLogger(tn),on=!1,un=!1,sn=!1,ln=!0,hn=null,an=null,En=null,uu.extend(ug),_n=Hp(Un).getInstance(),Dn=ZE(Un).getInstance(),Mn=lp(Un).getInstance()}(),tn}function wi(e){function t(e){var t=new bm;if(f){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.mpdurl||(t.mpdurl=f.originalUrl||f.url),t.terror||(t.terror=new Date),h.addDVBErrors(t)}}function n(e){e.error||(f=e.manifest)}function r(e){t({errorcode:bm.BASE_URL_CHANGED,servicelocation:e.entry})}function i(){t({errorcode:bm.BECAME_REPORTER})}function a(e){(0===e.responsecode||e.responsecode>=400||e.responsecode<100||e.responsecode>=600)&&t({errorcode:e.responsecode||bm.CONNECTION_ERROR,url:e.url,terror:e.tresponse,servicelocation:e._serviceLocation})}function o(e){switch(e.metric){case g.HTTP_REQUEST:a(e.value)}}function s(e){var n,r=e.error?e.error.code:0;switch(r){case MediaError.MEDIA_ERR_NETWORK:n=bm.CONNECTION_ERROR;break;case MediaError.MEDIA_ERR_DECODE:n=bm.CORRUPT_MEDIA_OTHER;break;default:return}t({errorcode:n})}function u(){d.on(p.MANIFEST_UPDATED,n,c),d.on(p.SERVICE_LOCATION_BLACKLIST_CHANGED,r,c),d.on(p.METRIC_ADDED,o,c),d.on(p.METRIC_UPDATED,o,c),d.on(p.PLAYBACK_ERROR,s,c),d.on(Cm.BECAME_REPORTING_PLAYER,i,c)}function l(){d.off(p.MANIFEST_UPDATED,n,c),d.off(p.SERVICE_LOCATION_BLACKLIST_CHANGED,r,c),d.off(p.METRIC_ADDED,o,c),d.off(p.METRIC_UPDATED,o,c),d.off(p.PLAYBACK_ERROR,s,c),d.off(Cm.BECAME_REPORTING_PLAYER,i,c)}e=e||{};var c,f,d=e.eventBus,h=e.metricsModel,g=e.metricsConstants,p=e.events;return c={initialise:u,reset:l},u(),c}function Oi(e){function t(e){e&&e.length&&(e.forEach(function(e){var t=e.starttime,n=t+e.duration;a.add(t,n)}),o=!!e[0]._useWallClockTime)}function n(){a.clear()}function r(){var e,t=a.length;if(!t)return!0;e=o?(new Date).getTime()/1e3:u.currentTime;for(var n=0;n<t;n+=1){var r=a.start(n),i=a.end(n);if(r<=e&&e<i)return!0}return!1}e=e||{};var i,a,o=!1,s=this.context,u=e.mediaElement;return i={initialize:t,reset:n,isEnabled:r},function(){a=Wl(s).create()}(),i}function Li(){function e(t){var n,r,i=[],a=[];for(n in t)if(t.hasOwnProperty(n)&&0!==n.indexOf("_")){if(r=t[n],void 0!==r&&null!==r||(r=""),Array.isArray(r)){if(!r.length)continue;a=[],r.forEach(function(t){var n="Object"!==Object.prototype.toString.call(t).slice(8,-1);a.push(n?t:e(t))}),r=a.map(encodeURIComponent).join(",")}else"string"==typeof r?r=encodeURIComponent(r):r instanceof Date?r=r.toISOString():"number"==typeof r&&(r=Math.round(r));i.push(n+"="+r)}return i.join("&")}return{serialise:e}}function Pi(){function e(){a&&(n||(n=new o(u)),a.getRandomValues(n),r=0)}function t(t,i){var o;return t||(t=0),i||(i=1),a?(r===n.length&&e(),o=n[r]/s,r+=1):o=Math.random(),o*(i-t)+t}var n,r,i,a=window.crypto||window.msCrypto,o=Uint32Array,s=Math.pow(2,8*o.BYTES_PER_ELEMENT)-1,u=10;return i={random:t},e(),i}function Fi(e){function t(e,t,n){var r=new XMLHttpRequest,i=function(){var e=E.indexOf(r);-1!==e&&(E.splice(e,1),r.status>=200&&r.status<300?t&&t():n&&n())};E.push(r);try{r.open("GET",e),r.onloadend=i,r.onerror=i,r.send()}catch(e){r.onerror()}}function n(e,n){Array.isArray(n)||(n=[n]),c&&d.isEnabled()&&n.forEach(function(n){var r=s.serialise(n);g&&e!==m.DVB_ERRORS&&(r="metricname=".concat(e,"&").concat(r)),r="".concat(f,"?").concat(r),t(r,null,function(){c=!1})})}function r(e,t){var n;if(d=t,!(f=e["dvb:reportingUrl"]))throw new Error("required parameter missing (dvb:reportingUrl)");l||(n=e["dvb:probability"]||e["dvb:priority"]||0,n&&(1e3===n||n/1e3>=u.random())&&(c=!0),l=!0)}function i(){l=!1,c=!1,f=null,d=null}function a(){p||(E.forEach(function(e){return e.abort()}),E=[]),i()}e=e||{};var o,s,u,l,c,f,d,h=this.context,g=!0,p=!0,E=[],m=e.metricsConstants;return o={report:n,initialize:r,reset:a},function(){s=Om(h).getInstance(),u=Lm(h).getInstance(),i()}(),o}function xi(e){function t(e,t){var n;try{n=i[e.schemeIdUri](a).create({metricsConstants:s}),n.initialize(e,t)}catch(t){n=null,o.error("ReportingFactory: could not create Reporting with schemeIdUri ".concat(e.schemeIdUri," (").concat(t.message,")"))}return n}function n(e,t){i[e]=t}function r(e){delete i[e]}e=e||{};var i={"urn:dvb:dash:reporting:2014":Pm},a=this.context,o=e.debug,s=e.metricsConstants;return{create:t,register:n,unregister:r}}function Ui(e){function t(e,t){e.some(function(e){var n=a.create(e,t);if(n)return i.push(n),!0})}function n(){i.forEach(function(e){return e.reset()}),i=[]}function r(e,t){i.forEach(function(n){return n.report(e,t)})}var i=[],a=Fm(this.context).getInstance(e);return{initialize:t,reset:n,report:r}}function Bi(){return{reconstructFullMetricName:function(e,t,n){var r=e;return t&&(r+="("+t,n&&n.length&&(r+=","+n),r+=")"),r},validateN:function(e){if(!e)throw new Error("missing n");if(isNaN(e))throw new Error("n is NaN");if(e<0)throw new Error("n must be positive");return e}}}function ki(e){function t(){try{return Object.keys(h).map(function(e){return h[e]}).reduce(function(e,t){return e.level<t.level?e:t})}catch(e){return}}function n(){var e=t();e&&c!==e.t&&(c=e.t,o.report(u,e))}function r(e,t,r){t&&(s=d.validateN(r),o=t,u=d.reconstructFullMetricName(e,r),l=setInterval(n,s))}function i(){clearInterval(l),l=null,s=0,o=null,c=null}function a(e,t,n){e===g.BUFFER_LEVEL&&(h[n]=t)}e=e||{};var o,s,u,l,c,f=this.context,d=Um(f).getInstance(),h=[],g=e.metricsConstants;return{initialize:r,reset:i,handleNewMetric:a}}function Gi(e){function t(){o.off(Cm.METRICS_INITIALISATION_COMPLETE,t,this),o.trigger(Cm.BECAME_REPORTING_PLAYER)}function n(e,n){n&&(a=n,o.on(Cm.METRICS_INITIALISATION_COMPLETE,t,this))}function r(){a=null}function i(e,t){e===s.DVB_ERRORS&&a&&a.report(e,t)}e=e||{};var a,o=e.eventBus,s=e.metricsConstants;return{initialize:n,reset:r,handleNewMetric:i}}function Yi(e){function t(){var e=c;e.length&&a&&a.report(u,e),c=[]}function n(e,n,r,i){n&&(o=f.validateN(r),a=n,i&&i.length&&(s=i),u=f.reconstructFullMetricName(e,r,i),l=setInterval(t,o))}function r(){clearInterval(l),l=null,o=null,s=null,c=[],a=null}function i(e,t){e===d.HTTP_REQUEST&&(s&&s!==t.type||c.push(t))}e=e||{};var a,o,s,u,l,c=[],f=Um(this.context).getInstance(),d=e.metricsConstants;return{initialize:n,reset:r,handleNewMetric:i}}function Ki(){function e(e,t){r=e,i=t}function t(){i=null,r=void 0}function n(e,t){e===r&&i&&i.report(r,t)}var r,i;return{initialize:e,reset:t,handleNewMetric:n}}function Vi(e){function t(t,n){var r,u=t.match(a);if(u){try{r=s[u[1]](o).create({eventBus:e.eventBus,metricsConstants:e.metricsConstants}),r.initialize(u[1],n,u[3],u[5])}catch(e){r=null,i.error("MetricsHandlerFactory: Could not create handler for type ".concat(u[1]," with args ").concat(u[3],", ").concat(u[5]," (").concat(e.message,")"))}return r}}function n(e,t){s[e]=t}function r(e){delete s[e]}e=e||{};var i=e.debug,a=/([a-zA-Z]*)(\(([0-9]*)(\,\s*([a-zA-Z]*))?\))?/,o=this.context,s={BufferLevel:Bm,DVBErrors:km,HttpList:Gm,PlayList:Ym,RepSwitchList:Ym,TcpList:Ym};return{create:t,register:n,unregister:r}}function Hi(e){function t(e){a.forEach(function(t){t.handleNewMetric(e.metric,e.value,e.mediaType)})}function n(e,n){e.split(",").forEach(function(e,t,r){var i;if(-1!==e.indexOf("(")&&-1===e.indexOf(")")){var o=r[t+1];o&&-1===o.indexOf("(")&&-1!==o.indexOf(")")&&(e+=","+o,delete r[t+1])}(i=l.create(e,n))&&a.push(i)}),s.on(u.METRIC_ADDED,t,i),s.on(u.METRIC_UPDATED,t,i)}function r(){s.off(u.METRIC_ADDED,t,i),s.off(u.METRIC_UPDATED,t,i),a.forEach(function(e){return e.reset()}),a=[]}e=e||{};var i,a=[],o=this.context,s=e.eventBus,u=e.events,l=Km(o).getInstance({debug:e.debug,eventBus:e.eventBus,metricsConstants:e.metricsConstants});return i={initialize:n,reset:r}}function qi(e){function t(t){try{a=wm(o).create({mediaElement:e.mediaElement}),a.initialize(t.Range),i=xm(o).create({debug:e.debug,metricsConstants:e.metricsConstants}),i.initialize(t.Reporting,a),r=Vm(o).create({debug:e.debug,eventBus:e.eventBus,metricsConstants:e.metricsConstants,events:e.events}),r.initialize(t.metrics,i)}catch(e){throw n(),e}}function n(){r&&r.reset(),i&&i.reset(),a&&a.reset()}e=e||{};var r,i,a,o=this.context;return{initialize:t,reset:n}}function ji(e){function t(e,t,n){var a,o,s=r.getMpd(e),u=0;return t?u=s.availabilityStartTime.getTime()/1e3:(a=this.getRegularPeriods(s),a.length&&(u=a[0].start)),o=u,n&&n.hasOwnProperty(i.START_TIME)&&(o+=n.starttime),o}function n(e){var n=[];return e.Metrics_asArray&&e.Metrics_asArray.forEach(function(a){var o=new qm,s=r.getIsDynamic(e);a.hasOwnProperty("metrics")&&(o.metrics=a.metrics,a.Range_asArray&&a.Range_asArray.forEach(function(n){var i=new jm;i.starttime=t(e,s,n),n.hasOwnProperty("duration")?i.duration=n.duration:i.duration=r.getDuration(e),i._useWallClockTime=s,o.Range.push(i)}),a.Reporting_asArray&&(a.Reporting_asArray.forEach(function(e){var t=new zm;if(e.hasOwnProperty(i.SCHEME_ID_URI)){t.schemeIdUri=e.schemeIdUri;for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);o.Reporting.push(t)}}),n.push(o)))}),n}e=e||{};var r=e.dashManifestModel,i=e.constants;return{getMetrics:n}}function zi(e){function t(t){if(!t.error){var n=Object.keys(i);Wm(a).getInstance({dashManifestModel:e.dashManifestModel,constants:e.constants}).getMetrics(t.manifest).forEach(function(t){var r=JSON.stringify(t);if(i.hasOwnProperty(r))n.splice(r,1);else try{var o=Hm(a).create(e);o.initialize(t),i[r]=o}catch(e){}}),n.forEach(function(e){i[e].reset(),delete i[e]}),o.trigger(Cm.METRICS_INITIALISATION_COMPLETE)}}function n(){Object.keys(i).forEach(function(e){i[e].reset()}),i={}}function r(){o.off(s.MANIFEST_UPDATED,t),o.off(s.STREAM_TEARDOWN_COMPLETE,n)}e=e||{};var i={},a=this.context,o=e.eventBus,s=e.events;return function(){o.on(s.MANIFEST_UPDATED,t),o.on(s.STREAM_TEARDOWN_COMPLETE,n)}(),{reset:r}}function Wi(){function e(e){return r=Nm(i).getInstance({eventBus:e.eventBus,metricsModel:e.metricsModel,metricsConstants:e.metricsConstants,events:e.events}),Xm(i).create(e)}function t(){return Fm(i).getInstance()}function n(){return Km(i).getInstance()}var r,i=this.context;return{createMetricsReporting:e,getReportingFactory:t,getMetricsHandlerFactory:n}}function Xi(e){function t(){if(!(x&&x.hasOwnProperty("on")&&P&&P.hasOwnProperty("getSupportedKeySystemsFromContentProtection")))throw new Error("Missing config parameter(s)")}function n(e){if(!e)throw new Error("mediaInfo can not be null or undefined");t(),x.on(U.INTERNAL_KEY_MESSAGE,S,this),x.on(U.INTERNAL_KEY_STATUS_CHANGED,v,this),C.push(e);var n=P.getSupportedKeySystemsFromContentProtection(e.contentProtection);n&&n.length>0&&y(n,!0)}function r(e){return P.getSupportedKeySystemsFromContentProtection(e)}function i(e,t){var n=Zm.getPSSHForKeySystem(L,e),r=E(L);if(n){for(var i=F.getAllInitData(),a=0;a<i.length;a++)if(P.initDataEquals(n,i[a]))return void b.warn("DRM: Ignoring initData because we have already seen it!");try{F.createKeySession(n,r,_(L),t)}catch(e){x.trigger(U.KEY_SESSION_CREATED,{data:null,error:new Fu(t_.KEY_SESSION_CREATED_ERROR_CODE,t_.KEY_SESSION_CREATED_ERROR_MESSAGE+e.message)})}}else e?F.createKeySession(e,r,_(L),t):x.trigger(U.KEY_SESSION_CREATED,{data:null,error:new Fu(t_.KEY_SESSION_CREATED_ERROR_CODE,t_.KEY_SESSION_CREATED_ERROR_MESSAGE+"Selected key system is "+L.systemString+".  needkey/encrypted event contains no initData corresponding to that key system!")})}function a(e,t){F.loadKeySession(e,t,_(L))}function o(e){F.removeKeySession(e)}function s(e){F.closeKeySession(e)}function u(e){F.setServerCertificate(e)}function l(e){e?(F.setMediaElement(e),x.on(U.NEED_KEY,R,this)):null===e&&(F.setMediaElement(e),x.off(U.NEED_KEY,R,this))}function c(e){w=e}function d(e){O=e}function h(e){N=e,P.setProtectionData(e)}function g(){F&&F.stop()}function p(){x.off(U.INTERNAL_KEY_MESSAGE,S,this),x.off(U.INTERNAL_KEY_STATUS_CHANGED,v,this),l(null),L=void 0,F&&(F.reset(),F=null),Y.forEach(function(e){return clearTimeout(e)}),Y=[],C=[]}function E(e){var t=null;if(e){var n=e.systemString;N&&(t=n in N?N[n]:null)}return t}function m(e){var t=E(e),n=[],r=[],i=t&&t.audioRobustness&&t.audioRobustness.length>0?t.audioRobustness:O,a=t&&t.videoRobustness&&t.videoRobustness.length>0?t.videoRobustness:O,o=_(e),s=t&&t.distinctiveIdentifier?t.distinctiveIdentifier:"optional",u=t&&t.persistentState?t.persistentState:"temporary"===o?"optional":"required";return C.forEach(function(e){e.type===G.AUDIO?n.push(new $m(e.codec,i)):e.type===G.VIDEO&&r.push(new $m(e.codec,a))}),new Jm(n,r,s,u,[o])}function _(e){var t=E(e);return t&&t.sessionType?t.sessionType:w}function y(e,t){var n,r=this,o=[];if(L){for(n=0;n<e.length;n++)if(L===e[n].ks){var s=function(){o.push({ks:e[n].ks,configs:[m(L)]});var s=function o(s){x.off(U.KEY_SYSTEM_ACCESS_COMPLETE,o,r),s.error?t||x.trigger(U.KEY_SYSTEM_SELECTED,{error:new Fu(t_.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE,t_.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE+s.error)}):(b.info("DRM: KeySystem Access Granted"),x.trigger(U.KEY_SYSTEM_SELECTED,{data:s.data}),e[n].sessionId?a(e[n].sessionId,e[n].initData):e[n].initData&&i(e[n].initData,e[n].cdmData))};return x.on(U.KEY_SYSTEM_ACCESS_COMPLETE,s,r),F.requestKeySystemAccess(o),"break"}();if("break"===s)break}}else if(void 0===L){L=null,M.push(e);for(var u=0;u<e.length;u++)o.push({ks:e[u].ks,configs:[m(e[u].ks)]});var l,c=function e(n){x.off(U.KEY_SYSTEM_ACCESS_COMPLETE,e,r),n.error?(L=void 0,x.off(U.INTERNAL_KEY_SYSTEM_SELECTED,f,r),t||x.trigger(U.KEY_SYSTEM_SELECTED,{data:null,error:new Fu(t_.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE,t_.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE+n.error)})):(l=n.data,b.info("DRM: KeySystem Access Granted ("+l.keySystem.systemString+")!  Selecting key system..."),F.selectKeySystem(l))},f=function e(o){if(x.off(U.INTERNAL_KEY_SYSTEM_SELECTED,e,r),x.off(U.KEY_SYSTEM_ACCESS_COMPLETE,c,r),o.error)L=void 0,t||x.trigger(U.KEY_SYSTEM_SELECTED,{data:null,error:new Fu(t_.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE,t_.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE+"Error selecting key system! -- "+o.error)});else{if(!F)return;L=F.getKeySystem(),x.trigger(U.KEY_SYSTEM_SELECTED,{data:l});var s=E(L);s&&s.serverCertificate&&s.serverCertificate.length>0&&F.setServerCertificate(k.decodeArray(s.serverCertificate).buffer);for(var u=0;u<M.length;u++)for(n=0;n<M[u].length;n++)if(L===M[u][n].ks){if(P.isClearKey(L)&&s&&s.hasOwnProperty("clearkeys")){var f={kids:Object.keys(s.clearkeys)};M[u][n].initData=(new TextEncoder).encode(JSON.stringify(f))}M[u][n].sessionId?a(M[u][n].sessionId,M[u][n].initData):null!==M[u][n].initData&&i(M[u][n].initData,M[u][n].cdmData);break}}};x.on(U.INTERNAL_KEY_SYSTEM_SELECTED,f,r),x.on(U.KEY_SYSTEM_ACCESS_COMPLETE,c,r),F.requestKeySystemAccess(o)}else M.push(e)}function T(e,t){x.trigger(U.LICENSE_REQUEST_COMPLETE,{data:e,error:t})}function v(e){e.error?x.trigger(U.KEY_STATUSES_CHANGED,{data:null,error:e.error}):b.debug("DRM: key status = "+e.status)}function S(e){b.debug("DRM: onKeyMessage");var t=e.data;x.trigger(U.KEY_MESSAGE,{data:t});var n=t.messageType?t.messageType:"license-request",r=t.message,i=t.sessionToken,a=E(L),o=L?L.systemString:null,s=P.getLicenseServer(L,a,n),u={sessionToken:i,messageType:n};if(!r||0===r.byteLength)return void T(u,new Fu(t_.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_CODE,t_.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_MESSAGE));if(!s)return b.debug("DRM: License server request not required for this message (type = "+e.data.messageType+").  Session ID = "+i.getSessionID()),void T(u);if(P.isClearKey(L)){var l=P.processClearKeyLicenseRequest(L,a,r);if(l)return b.debug("DRM: ClearKey license request handled by application!"),T(u),void F.updateKeySession(i,l)}var c=null;if(a&&a.serverURL){var d=a.serverURL;"string"==typeof d&&""!==d?c=d:"object"===f(d)&&d.hasOwnProperty(n)&&(c=d[n])}else a&&a.laURL&&""!==a.laURL?c=a.laURL:(c=L.getLicenseServerURLFromInitData(Zm.getPSSHData(i.initData)))||(c=e.data.laURL);if(!(c=s.getServerURLFromMessage(c,r,n)))return void T(u,new Fu(t_.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_CODE,t_.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_MESSAGE));var h={},g=!1,p=function(e){if(e)for(var t in e)"authorization"===t.toLowerCase()&&(g=!0),h[t]=e[t]};a&&p(a.httpRequestHeaders),p(L.getRequestHeadersFromMessage(r)),a&&"boolean"==typeof a.withCredentials&&(g=a.withCredentials);var m=function(e,t,n,r){var i=e.response?s.getErrorResponse(e.response,n,r):"NONE";T(t,new Fu(t_.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,t_.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+n+' update, XHR complete. status is "'+e.statusText+'" ('+e.status+"), readyState is "+e.readyState+".  Response is "+i))},_=function(e){if(F)if(200===e.status){var t=s.getLicenseMessage(e.response,o,n);null!==t?(T(u),F.updateKeySession(i,t)):m(e,u,o,n)}else m(e,u,o,n)},y=function(e){T(u,new Fu(t_.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,t_.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+o+' update, XHR aborted. status is "'+e.statusText+'" ('+e.status+"), readyState is "+e.readyState))},v=function(e){T(u,new Fu(t_.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,t_.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+o+' update, XHR error. status is "'+e.statusText+'" ('+e.status+"), readyState is "+e.readyState))},S=L.getLicenseRequestFromMessage(r),R=s.getHTTPMethod(n),I=s.getResponseType(o,n),D=a&&!isNaN(a.httpTimeout)?a.httpTimeout:o_;A(c,h,R,I,g,S,i_,D,_,y,v)}function A(e,t,n,r,i,a,o,s,u,l,c){var f=new XMLHttpRequest;f.open(n,e,!0),f.responseType=r,f.withCredentials=i,s>0&&(f.timeout=s);for(var d in t)f.setRequestHeader(d,t[d]);var h=function(){o--,setTimeout(function(){A(e,t,n,r,i,a,o,s,u,l,c)},a_)};f.onload=function(){200===this.status||o<=0?u(this):(b.warn("License request failed ("+this.status+"). Retrying it... Pending retries: "+o),h())},f.ontimeout=f.onerror=function(){o<=0?c(this):(b.warn("License request network request failed . Retrying it... Pending retries: "+o),h())},f.onabort=function(){l(this)},f.send(a)}function R(e,t){if(b.debug("DRM: onNeedKey"),"cenc"!==e.key.initDataType)return void b.warn("DRM:  Only 'cenc' initData is supported!  Ignoring initData of type: "+e.key.initDataType);if(0===C.length&&(b.warn("DRM: onNeedKey called before initializeForMedia, wait until initialized"),(t=void 0===t?1:t+1)<n_))return void Y.push(setTimeout(function(){R(e,t)},r_));var n=e.key.initData;if(ArrayBuffer.isView(n)&&(n=n.buffer),L){var r=Zm.getPSSHForKeySystem(L,n);if(r)for(var i=F.getAllInitData(),a=0;a<i.length;a++)if(P.initDataEquals(r,i[a]))return void b.warn("DRM: Ignoring initData because we have already seen it!")}b.debug("DRM: initData:",String.fromCharCode.apply(null,new Uint8Array(n)));var o=P.getSupportedKeySystems(n,N);if(0===o.length)return void b.debug("DRM: Received needkey event with initData, but we don't support any of the key systems!");y(o,!1)}function I(){return P?P.getKeySystems():[]}e=e||{};var D,b,M,C,N,w,O,L,P=e.protectionKeyController,F=e.protectionModel,x=e.eventBus,U=e.events,B=e.debug,k=e.BASE64,G=e.constants,Y=[];return D={initializeForMedia:n,createKeySession:i,loadKeySession:a,removeKeySession:o,closeKeySession:s,setServerCertificate:u,setMediaElement:l,setSessionType:c,setRobustnessLevel:d,setProtectionData:h,getSupportedKeySystemsFromContentProtection:r,getKeySystems:I,stop:g,reset:p},function(){b=B.getLogger(D),M=[],C=[],w="temporary",O=""}(),D}function Qi(e){function t(e,t){var n=null;if(e){for(var r=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t))),i=[],a=0;a<r.kids.length;a++){var o=r.kids[a],s=e.clearkeys&&e.clearkeys.hasOwnProperty(o)?e.clearkeys[o]:null;if(!s)throw new Error("DRM: ClearKey keyID ("+o+") is not known!");i.push(new u_(o,s))}n=new l_(i)}return n}function n(e){return Zm.parseInitDataFromContentProtection(e,u)}function r(){return null}function i(e){return new Uint8Array(e)}function a(){return null}function o(){return null}function s(){return null}e=e||{};var u=e.BASE64;return{uuid:d_,schemeIdURI:g_,systemString:h_,getInitData:n,getRequestHeadersFromMessage:r,getLicenseRequestFromMessage:i,getLicenseServerURLFromInitData:a,getCDMData:o,getSessionId:s,getClearKeysFromProtectionData:t}}function Zi(e){function t(e,t){var n=null;if(e){for(var r=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t))),i=[],a=0;a<r.kids.length;a++){var o=r.kids[a],s=e.clearkeys&&e.clearkeys.hasOwnProperty(o)?e.clearkeys[o]:null;if(!s)throw new Error("DRM: ClearKey keyID ("+o+") is not known!");i.push(new u_(o,s))}n=new l_(i),c.warn("ClearKey schemeIdURI is using W3C Common PSSH systemID (1077efec-c0b2-4d02-ace3-3c1e52e2fb4b) in Content Protection. See DASH-IF IOP v4.1 section 7.6.2.4")}return n}function n(e){return Zm.parseInitDataFromContentProtection(e,l)}function r(){return null}function i(e){return new Uint8Array(e)}function a(){return null}function o(){return null}function s(){return null}var u,l=e.BASE64,c=e.debug.getLogger(u);return u={uuid:E_,schemeIdURI:__,systemString:m_,getInitData:n,getRequestHeadersFromMessage:r,getLicenseRequestFromMessage:i,getLicenseServerURLFromInitData:a,getCDMData:o,getSessionId:s,getClearKeysFromProtectionData:t}}function $i(e){function t(e){e&&(u=e)}function n(e){return Zm.parseInitDataFromContentProtection(e,l)}function r(){return null}function i(e){return new Uint8Array(e)}function a(){return null}function o(){return null}function s(e){return u&&u.sessionId?u.sessionId:e&&e.sessionId?e.sessionId:null}e=e||{};var u=null,l=e.BASE64;return{uuid:T_,schemeIdURI:S_,systemString:v_,init:t,getInitData:n,getRequestHeadersFromMessage:r,getLicenseRequestFromMessage:i,getLicenseServerURLFromInitData:a,getCDMData:o,getSessionId:s}}function Ji(e){function t(){if(!f||!f.hasOwnProperty("decodeArray")||!f.hasOwnProperty("decodeArray"))throw new Error("Missing config parameter(s)")}function n(e){var t,n,r={},i=new DOMParser,a="utf16"===c?new Uint16Array(e):new Uint8Array(e);t=String.fromCharCode.apply(null,a),n=i.parseFromString(t,"application/xml");for(var o=n.getElementsByTagName("name"),s=n.getElementsByTagName("value"),u=0;u<o.length;u++)r[o[u].childNodes[0].nodeValue]=s[u].childNodes[0].nodeValue;return r.hasOwnProperty("Content")&&(r["Content-Type"]=r.Content,delete r.Content),r.hasOwnProperty("Content-Type")||(r["Content-Type"]="text/xml; charset="+c),r}function r(e){var n=null,r=new DOMParser,i="utf16"===c?new Uint16Array(e):new Uint8Array(e);t();var a=String.fromCharCode.apply(null,i),o=r.parseFromString(a,"application/xml");if(o.getElementsByTagName("Challenge")[0]){var s=o.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue;s&&(n=f.decode(s))}else if(o.getElementsByTagName("parsererror").length)return e;return n}function i(e){if(e)for(var t=new DataView(e),n=t.getUint16(4,!0),r=6,i=new DOMParser,a=0;a<n;a++){var o=t.getUint16(r,!0);r+=2;var s=t.getUint16(r,!0);if(r+=2,1===o){var u=e.slice(r,r+s),l=String.fromCharCode.apply(null,new Uint16Array(u)),c=i.parseFromString(l,"application/xml");if(c.getElementsByTagName("LA_URL")[0]){var f=c.getElementsByTagName("LA_URL")[0].childNodes[0].nodeValue;if(f)return f}if(c.getElementsByTagName("LUI_URL")[0]){var d=c.getElementsByTagName("LUI_URL")[0].childNodes[0].nodeValue;if(d)return d}}else r+=s}return null}function a(e){var n,r,i,a,o,s=new Uint8Array([112,115,115,104,0,0,0,0]),u=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),l=0,c=null;if(t(),"pssh"in e)return Zm.parseInitDataFromContentProtection(e,f);if("pro"in e)c=f.decodeArray(e.pro.__text);else{if(!("prheader"in e))return null;c=f.decodeArray(e.prheader.__text)}return n=c.length,r=4+s.length+u.length+4+n,i=new ArrayBuffer(r),a=new Uint8Array(i),o=new DataView(i),o.setUint32(l,r),l+=4,a.set(s,l),l+=s.length,a.set(u,l),l+=u.length,o.setUint32(l,n),l+=4,a.set(c,l),l+=n,a.buffer}function o(e){if("utf8"!==e&&"utf16"!==e)throw new Error("Illegal PlayReady message format! -- "+e);c=e}function s(e){e&&(R_=e)}function u(){var e,n,r,i;if(t(),R_&&R_.cdmData){for(e=[],i=0;i<R_.cdmData.length;++i)e.push(R_.cdmData.charCodeAt(i)),e.push(0);for(e=String.fromCharCode.apply(null,e),e=f.encode(e),n=M_.replace("%CUSTOMDATA%",e),r=[],i=0;i<n.length;++i)r.push(n.charCodeAt(i)),r.push(0)
;return new Uint8Array(r).buffer}return null}function l(e){return R_&&R_.sessionId?R_.sessionId:e&&e.sessionId?e.sessionId:null}e=e||{};var c="utf16",f=e.BASE64;return{uuid:I_,schemeIdURI:b_,systemString:D_,getInitData:a,getRequestHeadersFromMessage:n,getLicenseRequestFromMessage:r,getLicenseServerURLFromInitData:i,getCDMData:u,getSessionId:l,setPlayReadyMessageFormat:o,init:s}}function ea(e){function t(){if(!s||!s.hasOwnProperty("decodeArray"))throw new Error("Missing config parameter(s)")}function n(e){return e}function r(){return"POST"}function i(e){return u[e].responseType}function a(e,n){return t(),u[n].getLicenseMessage(e)}function o(e,t){return u[t].getErrorResponse(e)}e=e||{};var s=e.BASE64,u={};u[f_.WIDEVINE_KEYSTEM_STRING]={responseType:"json",getLicenseMessage:function(e){return s.decodeArray(e.license)},getErrorResponse:function(e){return e}},u[f_.PLAYREADY_KEYSTEM_STRING]={responseType:"arraybuffer",getLicenseMessage:function(e){return e},getErrorResponse:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}};return{getServerURLFromMessage:n,getHTTPMethod:r,getResponseType:i,getLicenseMessage:a,getErrorResponse:o}}function ta(){function e(e){var t=String.fromCharCode.apply(null,new Uint8Array(e));return decodeURIComponent(escape(t))}function t(t){if(window.DOMParser){var n=e(t),r=new window.DOMParser,i=r.parseFromString(n,"text/xml"),a=i?i.getElementsByTagNameNS(u,"Envelope")[0]:null,o=a?a.getElementsByTagNameNS(u,"Body")[0]:null;if(o?o.getElementsByTagNameNS(u,"Fault")[0]:null)return null}return t}function n(t){var n="",r="",i="",a=-1,o=-1;if(window.DOMParser){var s=e(t),l=new window.DOMParser,c=l.parseFromString(s,"text/xml"),f=c?c.getElementsByTagNameNS(u,"Envelope")[0]:null,d=f?f.getElementsByTagNameNS(u,"Body")[0]:null,h=d?d.getElementsByTagNameNS(u,"Fault")[0]:null,g=h?h.getElementsByTagName("detail")[0]:null,p=g?g.getElementsByTagName("Exception")[0]:null,E=null;if(null===h)return s;E=h.getElementsByTagName("faultstring")[0].firstChild,n=E?E.nodeValue:null,null!==p&&(E=p.getElementsByTagName("StatusCode")[0],r=E?E.firstChild.nodeValue:null,E=p.getElementsByTagName("Message")[0],i=E?E.firstChild.nodeValue:null,a=i?i.lastIndexOf("[")+1:-1,o=i?i.indexOf("]"):-1,i=i?i.substring(a,o):"")}var m="code: ".concat(r,", name: ").concat(n);return i&&(m+=", message: ".concat(i)),m}function r(e){return e}function i(){return"POST"}function a(){return"arraybuffer"}function o(e){return t.call(this,e)}function s(e){return n.call(this,e)}var u="http://schemas.xmlsoap.org/soap/envelope/";return{getServerURLFromMessage:r,getHTTPMethod:i,getResponseType:a,getLicenseMessage:o,getErrorResponse:s}}function na(){function e(e){return e}function t(){return"POST"}function n(){return"arraybuffer"}function r(e){return e}function i(e){return String.fromCharCode.apply(null,new Uint8Array(e))}return{getServerURLFromMessage:e,getHTTPMethod:t,getResponseType:n,getLicenseMessage:r,getErrorResponse:i}}function ra(){function e(e,t){var n=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t)));e+="/?";for(var r=0;r<n.kids.length;r++)e+=n.kids[r]+"&";return e=e.substring(0,e.length-1)}function t(){return"GET"}function n(){return"json"}function r(e){if(!e.hasOwnProperty("keys"))return null;for(var t=[],n=0;n<e.keys.length;n++){var r=e.keys[n],i=r.kid.replace(/=/g,""),a=r.k.replace(/=/g,"");t.push(new u_(i,a))}return new l_(t)}function i(e){return String.fromCharCode.apply(null,new Uint8Array(e))}return{getServerURLFromMessage:e,getHTTPMethod:t,getResponseType:n,getLicenseMessage:r,getErrorResponse:i}}function ia(){function e(e){e&&(e.debug&&(d=e.debug,h=d.getLogger(f)),e.BASE64&&(p=e.BASE64))}function t(){g=[];var e;e=C_(_).getInstance({BASE64:p}),g.push(e),e=A_(_).getInstance({BASE64:p}),g.push(e),e=p_(_).getInstance({BASE64:p}),g.push(e),E=e,e=y_(_).getInstance({BASE64:p,debug:d}),g.push(e),m=e}function n(){return g}function r(e){for(var t=0;t<g.length;t++)if(g[t].systemString===e)return g[t];return null}function i(e){return e===E||e===m}function a(e,t){if(e.byteLength===t.byteLength){for(var n=new Uint8Array(e),r=new Uint8Array(t),i=0;i<n.length;i++)if(n[i]!==r[i])return!1;return!0}return!1}function o(e){var t,n,r,i,a=[];if(e)for(r=0;r<g.length;++r)for(n=g[r],i=0;i<e.length;++i)if(t=e[i],t.schemeIdUri.toLowerCase()===n.schemeIdURI){var o=n.getInitData(t);o?a.push({ks:g[r],initData:o,cdmData:n.getCDMData(),sessionId:n.getSessionId(t)}):this.isClearKey(n)&&a.push({ks:n,initData:null})}return a}function s(e,t){for(var n,r,i,a=[],o=Zm.parsePSSHList(e),s=0;s<g.length;++s)n=g[s],r=n.systemString,i=!t||r in t,n.uuid in o&&i&&a.push({ks:n,initData:o[n.uuid],cdmData:n.getCDMData(),sessionId:n.getSessionId()});return a}function u(e,t,n){if("license-release"===n||"individualization-request"===n)return null;var r=null;return t&&t.hasOwnProperty("drmtoday")?r=N_(_).getInstance({BASE64:p}):e.systemString===f_.WIDEVINE_KEYSTEM_STRING?r=O_(_).getInstance():e.systemString===f_.PLAYREADY_KEYSTEM_STRING?r=w_(_).getInstance():e.systemString===f_.CLEARKEY_KEYSTEM_STRING&&(r=L_(_).getInstance()),r}function l(e,t,n){try{return e.getClearKeysFromProtectionData(t,n)}catch(e){return h.error("Failed to retrieve clearkeys from ProtectionData"),null}}function c(e){for(var t=0;t<g.length;t++){var n=g[t];n.hasOwnProperty("init")&&n.init(function(t){var n=null;return e&&(n=t in e?e[t]:null),n}(n.systemString))}}var f,d,h,g,p,E,m,_=this.context;return f={initialize:t,setProtectionData:c,isClearKey:i,initDataEquals:a,getKeySystems:n,getKeySystemBySystemString:r,getSupportedKeySystemsFromContentProtection:o,getSupportedKeySystems:s,getLicenseServer:u,processClearKeyLicenseRequest:l,setConfig:e}}function aa(e){function t(){var e,t=I.length;0!==t?function(){for(var n=function(e){m(e),0===I.length&&(A?(A.removeEventListener("encrypted",D),A.setMediaKeys(null).then(function(){C.trigger(N.TEARDOWN_COMPLETE)})):C.trigger(N.TEARDOWN_COMPLETE))},r=0;r<t;r++)e=I[r],function(t){e.session.closed.then(function(){n(t)}),p(e).catch(function(){n(t)})}(e)}():C.trigger(N.TEARDOWN_COMPLETE)}function n(){for(var e,t=0;t<I.length;t++)e=I[t],e.getUsable()||p(e).catch(function(){m(e)})}function r(){return S}function i(){for(var e=[],t=0;t<I.length;t++)I[t].initData&&e.push(I[t].initData);return e}function a(e){g(e,0)}function o(e){e.mksa.createMediaKeys().then(function(t){S=e.keySystem,R=t,A?A.setMediaKeys(R).then(function(){C.trigger(N.INTERNAL_KEY_SYSTEM_SELECTED)}):C.trigger(N.INTERNAL_KEY_SYSTEM_SELECTED)}).catch(function(){C.trigger(N.INTERNAL_KEY_SYSTEM_SELECTED,{error:"Error selecting keys system ("+e.keySystem.systemString+")! Could not create MediaKeys -- TODO"})})}function s(e){A!==e&&(A&&(A.removeEventListener("encrypted",D),A.setMediaKeys&&A.setMediaKeys(null)),(A=e)&&(A.addEventListener("encrypted",D),A.setMediaKeys&&R&&A.setMediaKeys(R)))}function u(e){if(!S||!R)throw new Error("Can not set server certificate until you have selected a key system");R.setServerCertificate(e).then(function(){v.info("DRM: License server certificate successfully updated."),C.trigger(N.SERVER_CERTIFICATE_UPDATED)}).catch(function(e){C.trigger(N.SERVER_CERTIFICATE_UPDATED,{error:new Fu(t_.SERVER_CERTIFICATE_UPDATED_ERROR_CODE,t_.SERVER_CERTIFICATE_UPDATED_ERROR_MESSAGE+e.name)})})}function l(e,t,n){if(!S||!R)throw new Error("Can not create sessions until you have selected a key system");var r=R.createSession(n),i=y(r,e,n),a=this.getKeySystem(),o=a.systemString===f_.CLEARKEY_KEYSTEM_STRING&&t&&t.clearkeys?"keyids":"cenc";r.generateRequest(o,e).then(function(){v.debug("DRM: Session created.  SessionID = "+i.getSessionID()),C.trigger(N.KEY_SESSION_CREATED,{data:i})}).catch(function(e){m(i),C.trigger(N.KEY_SESSION_CREATED,{data:null,error:new Fu(t_.KEY_SESSION_CREATED_ERROR_CODE,t_.KEY_SESSION_CREATED_ERROR_MESSAGE+"Error generating key request -- "+e.name)})})}function c(e,t){var n=e.session;b.isClearKey(S)&&(t=t.toJWK()),n.update(t).catch(function(t){C.trigger(N.KEY_ERROR,{data:new Fu(t_.MEDIA_KEYERR_CODE,"Error sending update() message! "+t.name,e)})})}function f(e,t,n){if(!S||!R)throw new Error("Can not load sessions until you have selected a key system");for(var r=0;r<I.length;r++)if(e===I[r].sessionId)return void v.warn("DRM: Ignoring session ID because we have already seen it!");var i=R.createSession(n),a=y(i,t,n,e);i.load(e).then(function(t){t?(v.debug("DRM: Session loaded.  SessionID = "+a.getSessionID()),C.trigger(N.KEY_SESSION_CREATED,{data:a})):(m(a),C.trigger(N.KEY_SESSION_CREATED,{data:null,error:new Fu(t_.KEY_SESSION_CREATED_ERROR_CODE,t_.KEY_SESSION_CREATED_ERROR_MESSAGE+"Could not load session! Invalid Session ID ("+e+")")}))}).catch(function(t){m(a),C.trigger(N.KEY_SESSION_CREATED,{data:null,error:new Fu(t_.KEY_SESSION_CREATED_ERROR_CODE,t_.KEY_SESSION_CREATED_ERROR_MESSAGE+"Could not load session ("+e+")! "+t.name)})})}function d(e){e.session.remove().then(function(){v.debug("DRM: Session removed.  SessionID = "+e.getSessionID()),C.trigger(N.KEY_SESSION_REMOVED,{data:e.getSessionID()})},function(t){C.trigger(N.KEY_SESSION_REMOVED,{data:null,error:"Error removing session ("+e.getSessionID()+"). "+t.name})})}function h(e){p(e).catch(function(t){m(e),C.trigger(N.KEY_SESSION_CLOSED,{data:null,error:"Error closing session ("+e.getSessionID()+") "+t.name})})}function g(e,t){if(void 0===navigator.requestMediaKeySystemAccess||"function"!=typeof navigator.requestMediaKeySystemAccess)return void C.trigger(N.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Insecure origins are not allowed"});!function(t){var n=e[t].ks,r=e[t].configs,i=n.systemString;i===f_.PLAYREADY_KEYSTEM_STRING&&"required"===r[0].persistentState&&(i+=".recommendation"),navigator.requestMediaKeySystemAccess(i,r).then(function(e){var t="function"==typeof e.getConfiguration?e.getConfiguration():null,r=new k_(n,t);r.mksa=e,C.trigger(N.KEY_SYSTEM_ACCESS_COMPLETE,{data:r})}).catch(function(n){++t<e.length?g(e,t):C.trigger(N.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Key system access denied! "+n.message})})}(t)}function p(e){var t=e.session;return t.removeEventListener("keystatuseschange",e),t.removeEventListener("message",e),t.close()}function E(){return{handleEvent:function(e){switch(e.type){case"encrypted":if(e.initData){var t=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;C.trigger(N.NEED_KEY,{key:new U_(t,e.initDataType)})}}}}}function m(e){for(var t=0;t<I.length;t++)if(I[t]===e){I.splice(t,1);break}}function _(e){var t,n;return e&&e.length>0&&(e[0]&&("string"==typeof e[0]?t=e[0]:n=e[0]),e[1]&&("string"==typeof e[1]?t=e[1]:n=e[1])),{status:t,keyId:n}}function y(e,t,n,r){var i={session:e,initData:t,sessionId:r,handleEvent:function(e){switch(e.type){case"keystatuseschange":C.trigger(N.KEY_STATUSES_CHANGED,{data:this}),e.target.keyStatuses.forEach(function(){var e=_(arguments);switch(e.status){case"expired":C.trigger(N.INTERNAL_KEY_STATUS_CHANGED,{error:new Fu(t_.KEY_STATUS_CHANGED_EXPIRED_ERROR_CODE,t_.KEY_STATUS_CHANGED_EXPIRED_ERROR_MESSAGE)});break;default:C.trigger(N.INTERNAL_KEY_STATUS_CHANGED,e)}});break;case"message":var t=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;C.trigger(N.INTERNAL_KEY_MESSAGE,{data:new B_(this,t,void 0,e.messageType)})}},getSessionID:function(){return e.sessionId},getExpirationTime:function(){return e.expiration},getKeyStatuses:function(){return e.keyStatuses},getUsable:function(){var t=!1;return e.keyStatuses.forEach(function(){"usable"===_(arguments).status&&(t=!0)}),t},getSessionType:function(){return n}};return e.addEventListener("keystatuseschange",i),e.addEventListener("message",i),e.closed.then(function(){m(i),v.debug("DRM: Session closed.  SessionID = "+i.getSessionID()),C.trigger(N.KEY_SESSION_CLOSED,{data:i.getSessionID()})}),I.push(i),i}e=e||{};var T,v,S,A,R,I,D,b,M=this.context,C=e.eventBus,N=e.events,w=e.debug;return T={getAllInitData:i,requestKeySystemAccess:a,getKeySystem:r,selectKeySystem:o,setMediaElement:s,setServerCertificate:u,createKeySession:l,updateKeySession:c,loadKeySession:f,removeKeySession:d,closeKeySession:h,stop:n,reset:t},function(){v=w.getLogger(T),S=null,A=null,R=null,I=[],b=P_(M).getInstance(),D=E()}(),T}function oa(e){function t(){try{for(var e=0;e<S.length;e++)l(S[e]);_&&_.removeEventListener(C.needkey,A),D.trigger(b.TEARDOWN_COMPLETE)}catch(e){D.trigger(b.TEARDOWN_COMPLETE,{error:"Error tearing down key sessions and MediaKeys! -- "+e.message})}}function n(){return y}function r(){for(var e=[],t=0;t<S.length;t++)e.push(S[t].initData);return e}function i(e){for(var t=!1,n=0;n<e.length;n++)for(var r=e[n].ks.systemString,i=e[n].configs,a=null,o=null,s=0;s<i.length;s++){var u=i[s].audioCapabilities,l=i[s].videoCapabilities;if(u&&0!==u.length){a=[];for(var c=0;c<u.length;c++)window[C.MediaKeys].isTypeSupported(r,u[c].contentType)&&a.push(u[c])}if(l&&0!==l.length){o=[];for(var f=0;f<l.length;f++)window[C.MediaKeys].isTypeSupported(r,l[f].contentType)&&o.push(l[f])}if(!(!a&&!o||a&&0===a.length||o&&0===o.length)){t=!0;var d=new Jm(a,o),h=R.getKeySystemBySystemString(r);D.trigger(b.KEY_SYSTEM_ACCESS_COMPLETE,{data:new k_(h,d)});break}}t||D.trigger(b.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Key system access denied! -- No valid audio/video content configurations detected!"})}function a(e){try{T=e.mediaKeys=new window[C.MediaKeys](e.keySystem.systemString),y=e.keySystem,v=e,_&&g(),D.trigger(b.INTERNAL_KEY_SYSTEM_SELECTED)}catch(e){D.trigger(b.INTERNAL_KEY_SYSTEM_SELECTED,{error:"Error selecting keys system ("+y.systemString+")! Could not create MediaKeys -- TODO"})}}function o(e){_!==e&&(_&&_.removeEventListener(C.needkey,A),(_=e)&&(_.addEventListener(C.needkey,A),T&&g()))}function s(e,t,n,r){if(!y||!T||!v)throw new Error("Can not create sessions until you have selected a key system");var i=null;if(v.ksConfiguration.videoCapabilities&&v.ksConfiguration.videoCapabilities.length>0&&(i=v.ksConfiguration.videoCapabilities[0]),null===i&&v.ksConfiguration.audioCapabilities&&v.ksConfiguration.audioCapabilities.length>0&&(i=v.ksConfiguration.audioCapabilities[0]),null===i)throw new Error("Can not create sessions for unknown content types.");var a=i.contentType,o=T.createSession(a,new Uint8Array(e),r?new Uint8Array(r):null),s=p(o,e);o.addEventListener(C.error,s),o.addEventListener(C.message,s),o.addEventListener(C.ready,s),o.addEventListener(C.close,s),S.push(s),m.debug("DRM: Session created.  SessionID = "+s.getSessionID()),D.trigger(b.KEY_SESSION_CREATED,{data:s})}function u(e,t){var n=e.session;R.isClearKey(y)?n.update(new Uint8Array(t.toJWK())):n.update(new Uint8Array(t))}function l(e){var t=e.session;t.removeEventListener(C.error,e),t.removeEventListener(C.message,e),t.removeEventListener(C.ready,e),t.removeEventListener(C.close,e);for(var n=0;n<S.length;n++)if(S[n]===e){S.splice(n,1);break}t[C.release]()}function c(){}function f(){}function d(){}function h(){return{handleEvent:function(e){switch(e.type){case C.needkey:if(e.initData){var t=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;D.trigger(b.NEED_KEY,{key:new U_(t,"cenc")})}}}}}function g(){var e=null,t=function(){_.removeEventListener("loadedmetadata",e),_[C.setMediaKeys](T),D.trigger(b.VIDEO_ELEMENT_SELECTED)};_.readyState>=1?t():(e=t.bind(this),_.addEventListener("loadedmetadata",e))}function p(e,t){return{session:e,initData:t,getSessionID:function(){return this.session.sessionId},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"},handleEvent:function(e){switch(e.type){case C.error:;D.trigger(b.KEY_ERROR,{data:new Fu(t_.MEDIA_KEYERR_CODE,"KeyError",this)});break;case C.message:var t=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;D.trigger(b.INTERNAL_KEY_MESSAGE,{data:new B_(this,t,e.destinationURL)});break;case C.ready:m.debug("DRM: Key added."),D.trigger(b.KEY_ADDED);break;case C.close:m.debug("DRM: Session closed.  SessionID = "+this.getSessionID()),D.trigger(b.KEY_SESSION_CLOSED,{data:this.getSessionID()})}}}}e=e||{};var E,m,_,y,T,v,S,A,R,I=this.context,D=e.eventBus,b=e.events,M=e.debug,C=e.api;return E={getAllInitData:r,requestKeySystemAccess:i,getKeySystem:n,selectKeySystem:a,setMediaElement:o,createKeySession:s,updateKeySession:u,closeKeySession:l,setServerCertificate:c,loadKeySession:f,removeKeySession:d,stop:t,reset:t},function(){m=M.getLogger(E),_=null,y=null,T=null,v=null,S=[],R=P_(I).getInstance(),A=h()}(),E}function sa(e){function t(){_&&p();for(var e=0;e<S.length;e++)l(S[e]);D.trigger(b.TEARDOWN_COMPLETE)}function n(){return y}function r(){for(var e=[],t=0;t<v.length;t++)e.push(v[t].initData);for(var n=0;n<S.length;n++)e.push(S[n].initData);return e}function i(e){var t=_;t||(t=document.createElement("video"));for(var n=!1,r=0;r<e.length;r++)for(var i=e[r].ks.systemString,a=e[r].configs,o=null,s=0;s<a.length;s++){var u=a[s].videoCapabilities;if(u&&0!==u.length){o=[];for(var l=0;l<u.length;l++)""!==t.canPlayType(u[l].contentType,i)&&o.push(u[l])}if(o&&(!o||0!==o.length)){n=!0;var c=new Jm(null,o),f=T.getKeySystemBySystemString(i);D.trigger(b.KEY_SYSTEM_ACCESS_COMPLETE,{data:new k_(f,c)});break}}n||D.trigger(b.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Key system access denied! -- No valid audio/video content configurations detected!"})}function a(e){y=e.keySystem,D.trigger(b.INTERNAL_KEY_SYSTEM_SELECTED)}function o(e){if(_!==e){if(_){p();for(var t=0;t<S.length;t++)l(S[t]);S=[]}_=e,_&&(_.addEventListener(C.keyerror,R),_.addEventListener(C.needkey,R),_.addEventListener(C.keymessage,R),_.addEventListener(C.keyadded,R),D.trigger(b.VIDEO_ELEMENT_SELECTED))}}function s(e){if(!y)throw new Error("Can not create sessions until you have selected a key system");if(A||0===S.length){var t={sessionID:null,initData:e,getSessionID:function(){return this.sessionID},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"}};return v.push(t),_[C.generateKeyRequest](y.systemString,new Uint8Array(e)),t}throw new Error("Multiple sessions not allowed!")}function u(e,t){var n=e.sessionID;if(T.isClearKey(y))for(var r=0;r<t.keyPairs.length;r++)_[C.addKey](y.systemString,t.keyPairs[r].key,t.keyPairs[r].keyID,n);else _[C.addKey](y.systemString,new Uint8Array(t),new Uint8Array(e.initData),n)}function l(e){try{_[C.cancelKeyRequest](y.systemString,e.sessionID)}catch(t){D.trigger(b.KEY_SESSION_CLOSED,{data:null,error:"Error closing session ("+e.sessionID+") "+t.message})}}function c(){}function f(){}function d(){}function h(){return{handleEvent:function(e){var t=null;switch(e.type){case C.needkey:var n=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;D.trigger(b.NEED_KEY,{key:new U_(n,"cenc")});break;case C.keyerror:if(t=g(S,e.sessionId),t||(t=g(v,e.sessionId)),t){var r=t_.MEDIA_KEYERR_CODE,i="";switch(e.errorCode.code){case 1:r=t_.MEDIA_KEYERR_UNKNOWN_CODE,i+="MEDIA_KEYERR_UNKNOWN - "+t_.MEDIA_KEYERR_UNKNOWN_MESSAGE;break;case 2:r=t_.MEDIA_KEYERR_CLIENT_CODE,i+="MEDIA_KEYERR_CLIENT - "+t_.MEDIA_KEYERR_CLIENT_MESSAGE;break;case 3:r=t_.MEDIA_KEYERR_SERVICE_CODE,i+="MEDIA_KEYERR_SERVICE - "+t_.MEDIA_KEYERR_SERVICE_MESSAGE;break;case 4:r=t_.MEDIA_KEYERR_OUTPUT_CODE,i+="MEDIA_KEYERR_OUTPUT - "+t_.MEDIA_KEYERR_OUTPUT_MESSAGE;break;case 5:r=t_.MEDIA_KEYERR_HARDWARECHANGE_CODE,i+="MEDIA_KEYERR_HARDWARECHANGE - "+t_.MEDIA_KEYERR_HARDWARECHANGE_MESSAGE;break;case 6:r=t_.MEDIA_KEYERR_DOMAIN_CODE,i+="MEDIA_KEYERR_DOMAIN - "+t_.MEDIA_KEYERR_DOMAIN_MESSAGE}i+="  System Code = "+e.systemCode,D.trigger(b.KEY_ERROR,{data:new Fu(r,i,t)})}else m.error("No session token found for key error");break;case C.keyadded:t=g(S,e.sessionId),t||(t=g(v,e.sessionId)),t?(m.debug("DRM: Key added."),D.trigger(b.KEY_ADDED,{data:t})):m.debug("No session token found for key added");break;case C.keymessage:if(A=null!==e.sessionId&&void 0!==e.sessionId,A?!(t=g(S,e.sessionId))&&v.length>0&&(t=v.shift(),S.push(t),t.sessionID=e.sessionId,D.trigger(b.KEY_SESSION_CREATED,{data:t})):v.length>0&&(t=v.shift(),S.push(t),0!==v.length&&(N.mediaKeyMessageError(t_.MEDIA_KEY_MESSAGE_ERROR_MESSAGE),N.error(new Fu(t_.MEDIA_KEY_MESSAGE_ERROR_CODE,t_.MEDIA_KEY_MESSAGE_ERROR_MESSAGE)))),t){var a=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;t.keyMessage=a,D.trigger(b.INTERNAL_KEY_MESSAGE,{data:new B_(t,a,e.defaultURL)})}else m.warn("No session token found for key message")}}}}function g(e,t){if(t&&e){for(var n=e.length,r=0;r<n;r++)if(e[r].sessionID==t)return e[r];return null}return null}function p(){_.removeEventListener(C.keyerror,R),_.removeEventListener(C.needkey,R),_.removeEventListener(C.keymessage,R),_.removeEventListener(C.keyadded,R)}e=e||{};var E,m,_,y,T,v,S,A,R,I=this.context,D=e.eventBus,b=e.events,M=e.debug,C=e.api,N=e.errHandler;return E={getAllInitData:r,requestKeySystemAccess:i,getKeySystem:n,selectKeySystem:a,setMediaElement:o,createKeySession:s,updateKeySession:u,closeKeySession:l,setServerCertificate:c,loadKeySession:f,removeKeySession:d,stop:t,reset:t},function(){m=M.getLogger(E),_=null,y=null,v=[],S=[],T=P_(I).getInstance(),R=h()}(),E}function ua(){function e(e){var n=null,r=P_(i).getInstance();r.setConfig({debug:e.debug,BASE64:e.BASE64}),r.initialize();var a=t(e);return!n&&a&&(n=s_(i).create({protectionModel:a,protectionKeyController:r,eventBus:e.eventBus,debug:e.debug,events:e.events,BASE64:e.BASE64,constants:e.constants}),e.capabilities.setEncryptedMediaSupported(!0)),n}function t(e){var t=e.debug,a=t.getLogger(r),o=e.eventBus,s=e.errHandler,u=e.videoModel?e.videoModel.getElement():null;return u&&void 0===u.onencrypted||u&&void 0===u.mediaKeys?n(u,H_)?(a.info("EME detected on this user agent! (ProtectionModel_3Feb2014)"),Y_(i).create({debug:t,eventBus:o,events:e.events,api:n(u,H_)})):n(u,V_)?(a.info("EME detected on this user agent! (ProtectionModel_01b)"),K_(i).create({debug:t,eventBus:o,errHandler:s,events:e.events,api:n(u,V_)})):(a.warn("No supported version of EME detected on this user agent! - Attempts to play encrypted content will fail!"),null):(a.info("EME detected on this user agent! (ProtectionModel_21Jan2015)"),G_(i).create({debug:t,eventBus:o,events:e.events}))}function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];if("function"==typeof e[r[Object.keys(r)[0]]])return r}return null}var r,i=this.context;return r={createProtectionSystem:e}}function la(){window.removeEventListener("load",la),z_.createAll()}function ca(){window.dashjs&&(window.clearInterval(j_),z_.createAll())}function fa(e){return Array.isArray(e)?e.slice(0):e.split(".")}function da(e,t,n){for(t=fa(t);t.length;){if(void 0===e||null===e)return n;e=e[t.shift()]}return void 0===e||null===e?n:e}function ha(e){return[$_.WIDEVINE,$_.PLAYREADY,$_.CLEARKEY].filter(function(t){return t===e}).length}function ga(e,t){var n={serverURL:t[e][$_.LICENSE_SERVER]};return t[e][$_.HTTP_HEADERS]&&(n.httpRequestHeaders=t[e][$_.HTTP_HEADERS]),n}function pa(e){var t={};return Object.keys(e).forEach(function(n){ha(n)&&(t[n]=ga(n,e))}),t}function Ea(){return"localhost"===location.hostname||"127.0.0.1"===location.hostname}function ma(){return"https:"===location.protocol}function _a(e,t,n,r){if(r){n.dash&&(n.emit(W_.RECOVER,{type:"dash"}),Aa(n));var i=!da(e,"live",!1),a={seek_timer:null,initial_stream_init:!0,errored:!1,recover_count:0};if(n.reaper.put("dash",Rm().create()),n.on(W_.RECOVER,function(e){Da(n,r.src,e)}),n.on(W_.SOURCE,function(e){Aa(n,e)}),n.on(W_.REAP,function(e){Aa(n,e)}),n.on(W_.SET_QUALITY,function(e){Sa(n,e)}),n.on(X_.SET,function(e){va(n,e)}),n.dash.on(Rm.events.SOURCE_INITIALIZED,function(){a.initial_stream_init=!0,a.recover_count=0}),n.dash.on(Rm.events.STREAM_INITIALIZED,function(){i&&n.setOpts({live:n.dash.isDynamic()}),ya(n),Ta(n,a),e.poster&&(n.style.display="none")}),n.dash.on(Rm.events.TRACK_CHANGE_RENDERED,function(e){"audio"===e.mediaType&&e.newMediaInfo&&n.emit(X_.SWITCH,e.newMediaInfo)}),n.dash.on(Rm.events.PLAYBACK_PROGRESS,function(){Ra(n)}),n.dash.on(Rm.events.ERROR,function(e){Ia(n,a,e)}),n.dash.on(Rm.events.PLAYBACK_SEEKING,function(){Ca(a,function(){ba(a,n)})}),n.dash.on(Rm.events.PLAYBACK_SEEKED,function(){Ma(a)}),n.dash.on(q_.events.KEY_ERROR,function(e){Ia(n,a,e)}),n.dash.on(q_.events.LICENSE_REQUEST_COMPLETE,function(e){e.error&&Ia(n,a,e)}),r.drm){if(!ma()&&!Ea())return void n.emit(W_.ERROR,{message:"Secure page required for DRM"});n.dash.setProtectionData(pa(r.drm))}n.dash.initialize(n,r.src,!!e.autoplay)}}function ya(e){var t=(e.dash.getBitrateInfoListFor("video")||[]).sort(function(e,t){return t.width-e.width});t.push({text:"AUTO",qualityIndex:-1}),e.emit(W_.QUALITIES,t)}function Ta(e,t){if(t.initial_stream_init){t.initial_stream_init=!1;var n=(e.dash.getTracksFor("audio")||[]).map(function(e){return e.autoselect=!0,e});e.emit(X_.TRACKS,n)}}function va(e,t){e.dash.setCurrentTrack(t.data)}function Sa(e,t){var n=t.data.qualityIndex;e.dash.setAutoSwitchQualityFor("video",-1===n),-1!==n&&e.dash.setQualityFor("video",n)}function Aa(e){e.dash&&e.dash.reset(),e.off(X_.SET,va),e.off(W_.SET_QUALITY,Sa)}function Ra(e){var t=e.dash.isDynamic(),n=Na(e,"video"),r=e.dash.getDVRWindowSize(),i=t?e.dash.getDVRSeekOffset(e.dash.duration()):0;e.setOpts({live:t,initial_live_offset:e.opts.initial_live_offset||e.currentTime,live_duration:e.currentTime-e.opts.initial_live_offset||0,live_now:i,live_rebuffer_budget:0,live_dvr_window:t?r:0,live_seekable_range:n?{head:n.end,tail:Math.max(n.end-r,n.start)}:0})}function Ia(e,t,n){if(!t.errored){if(t.recover_count<ey)return t.recover_count+=1,void Da(e,e.src);t.errored=!0,e.emit(W_.ERROR,{message:da(n,"error.message",da(n,"event.message","playback failed"))}),Aa(e)}}function Da(e,t,n){0!=e.reaper&&(n&&"dash"!==da(n,"data.type")||(e.dash.setAutoPlay(!0),e.dash.attachSource(t)))}function ba(e,t){e.seek_timer=0,t.emit(W_.RECOVER,{type:"dash"})}function Ma(e){e.seek_timer&&(clearTimeout(e.seek_timer),e.seek_timer=0)}function Ca(e,t){Ma(e),e.seek_timer=setTimeout(t,J_)}function Na(e,t){var n=e.dash.getDashMetrics(t),r=n.getCurrentDVRInfo(e.dash.getMetricsFor(t));return r?r.range:0}var wa=/\.mpd$/,Oa="application/dash+xml",La=[Oa],Pa="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},Fa=function(e){try{return!!e()}catch(e){return!0}},xa=!Fa(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),Ua=function(e){return"object"==typeof e?null!==e:"function"==typeof e},Ba=function(e){if(!Ua(e))throw TypeError(e+" is not an object!");return e},ka=c(function(e){var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)}),Ga=ka.document,Ya=Ua(Ga)&&Ua(Ga.createElement),Ka=function(e){return Ya?Ga.createElement(e):{}},Va=!xa&&!Fa(function(){return 7!=Object.defineProperty(Ka("div"),"a",{get:function(){return 7}}).a}),Ha=function(e,t){if(!Ua(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!Ua(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!Ua(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!Ua(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")},qa=Object.defineProperty,ja=xa?Object.defineProperty:function(e,t,n){if(Ba(e),t=Ha(t,!0),Ba(n),Va)try{return qa(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e},za={f:ja},Wa=function(){var e=Ba(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t};xa&&"g"!=/./g.flags&&za.f(RegExp.prototype,"flags",{configurable:!0,get:Wa});var Xa=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},Qa=xa?function(e,t,n){return za.f(e,t,Xa(1,n))}:function(e,t,n){return e[t]=n,e},Za={}.hasOwnProperty,$a=function(e,t){return Za.call(e,t)},Ja=0,eo=Math.random(),to=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++Ja+eo).toString(36))},no=c(function(e){var t=e.exports={version:"2.6.0"};"number"==typeof __e&&(__e=t)}),ro=(no.version,c(function(e){var t=to("src"),n=Function.toString,r=(""+n).split("toString");no.inspectSource=function(e){return n.call(e)},(e.exports=function(e,n,i,a){var o="function"==typeof i;o&&($a(i,"name")||Qa(i,"name",n)),e[n]!==i&&(o&&($a(i,t)||Qa(i,t,e[n]?""+e[n]:r.join(String(n)))),e===ka?e[n]=i:a?e[n]?e[n]=i:Qa(e,n,i):(delete e[n],Qa(e,n,i)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[t]||n.call(this)})})),io=/./.toString,ao=function(e){ro(RegExp.prototype,"toString",e,!0)};Fa(function(){return"/a/b"!=io.call({source:"a",flags:"b"})})?ao(function(){var e=Ba(this);return"/".concat(e.source,"/","flags"in e?e.flags:!xa&&e instanceof RegExp?Wa.call(e):void 0)}):"toString"!=io.name&&ao(function(){return io.call(this)});var oo=Date.prototype,so=oo.toString,uo=oo.getTime;new Date(NaN)+""!="Invalid Date"&&ro(oo,"toString",function(){var e=uo.call(this);return e===e?so.call(this):"Invalid Date"});var lo={}.toString,co=function(e){return lo.call(e).slice(8,-1)},fo=c(function(e){var t=ka["__core-js_shared__"]||(ka["__core-js_shared__"]={});(e.exports=function(e,n){return t[e]||(t[e]=void 0!==n?n:{})})("versions",[]).push({version:no.version,mode:"global",copyright:"© 2018 Denis Pushkarev (zloirock.ru)"})}),ho=c(function(e){var t=fo("wks"),n=ka.Symbol,r="function"==typeof n;(e.exports=function(e){return t[e]||(t[e]=r&&n[e]||(r?n:to)("Symbol."+e))}).store=t}),go=ho("toStringTag"),po="Arguments"==co(function(){return arguments}()),Eo=function(e,t){try{return e[t]}catch(e){}},mo=function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=Eo(t=Object(e),go))?n:po?co(t):"Object"==(r=co(t))&&"function"==typeof t.callee?"Arguments":r},_o={};_o[ho("toStringTag")]="z",_o+""!="[object z]"&&ro(Object.prototype,"toString",function(){return"[object "+mo(this)+"]"},!0);var yo=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e},To=function(e,t,n){if(yo(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}},vo=function(e,t,n){var r,i,a,o,s=e&vo.F,u=e&vo.G,l=e&vo.S,c=e&vo.P,f=e&vo.B,d=u?ka:l?ka[t]||(ka[t]={}):(ka[t]||{}).prototype,h=u?no:no[t]||(no[t]={}),g=h.prototype||(h.prototype={});u&&(n=t);for(r in n)i=!s&&d&&void 0!==d[r],a=(i?d:n)[r],o=f&&i?To(a,ka):c&&"function"==typeof a?To(Function.call,a):a,d&&ro(d,r,a,e&vo.U),h[r]!=a&&Qa(h,r,o),c&&g[r]!=a&&(g[r]=a)};ka.core=no,vo.F=1,vo.G=2,vo.S=4,vo.P=8,vo.B=16,vo.W=32,vo.U=64,vo.R=128;var So=vo,Ao=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==co(e)?e.split(""):Object(e)},Ro=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e},Io=function(e){return Ao(Ro(e))},Do=Math.ceil,bo=Math.floor,Mo=function(e){return isNaN(e=+e)?0:(e>0?bo:Do)(e)},Co=Math.min,No=function(e){return e>0?Co(Mo(e),9007199254740991):0},wo=Math.max,Oo=Math.min,Lo=function(e,t){return e=Mo(e),e<0?wo(e+t,0):Oo(e,t)},Po=function(e){return function(t,n,r){var i,a=Io(t),o=No(a.length),s=Lo(r,o);if(e&&n!=n){for(;o>s;)if((i=a[s++])!=i)return!0}else for(;o>s;s++)if((e||s in a)&&a[s]===n)return e||s||0;return!e&&-1}},Fo=function(e,t){return!!e&&Fa(function(){t?e.call(null,function(){},1):e.call(null)})},xo=Po(!1),Uo=[].indexOf,Bo=!!Uo&&1/[1].indexOf(1,-0)<0;So(So.P+So.F*(Bo||!Fo(Uo)),"Array",{indexOf:function(e){return Bo?Uo.apply(this,arguments)||0:xo(this,e,arguments[1])}});var ko={}.propertyIsEnumerable,Go={f:ko},Yo=Object.getOwnPropertyDescriptor,Ko=xa?Yo:function(e,t){if(e=Io(e),t=Ha(t,!0),Va)try{return Yo(e,t)}catch(e){}if($a(e,t))return Xa(!Go.f.call(e,t),e[t])},Vo={f:Ko},Ho=function(e,t){if(Ba(e),!Ua(t)&&null!==t)throw TypeError(t+": can't set as prototype!")},qo={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,n){try{n=To(Function.call,Vo.f(Object.prototype,"__proto__").set,2),n(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,r){return Ho(e,r),t?e.__proto__=r:n(e,r),e}}({},!1):void 0),check:Ho
},jo=qo.set,zo=function(e,t,n){var r,i=t.constructor;return i!==n&&"function"==typeof i&&(r=i.prototype)!==n.prototype&&Ua(r)&&jo&&jo(e,r),e},Wo=fo("keys"),Xo=function(e){return Wo[e]||(Wo[e]=to(e))},Qo=Po(!1),Zo=Xo("IE_PROTO"),$o=function(e,t){var n,r=Io(e),i=0,a=[];for(n in r)n!=Zo&&$a(r,n)&&a.push(n);for(;t.length>i;)$a(r,n=t[i++])&&(~Qo(a,n)||a.push(n));return a},Jo="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),es=Jo.concat("length","prototype"),ts=Object.getOwnPropertyNames||function(e){return $o(e,es)},ns={f:ts},rs="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff",is="["+rs+"]",as="​",os=RegExp("^"+is+is+"*"),ss=RegExp(is+is+"*$"),us=function(e,t,n){var r={},i=Fa(function(){return!!rs[e]()||as[e]()!=as}),a=r[e]=i?t(ls):rs[e];n&&(r[n]=a),So(So.P+So.F*i,"String",r)},ls=us.trim=function(e,t){return e=String(Ro(e)),1&t&&(e=e.replace(os,"")),2&t&&(e=e.replace(ss,"")),e},cs=us,fs=Object.keys||function(e){return $o(e,Jo)},ds=xa?Object.defineProperties:function(e,t){Ba(e);for(var n,r=fs(t),i=r.length,a=0;i>a;)za.f(e,n=r[a++],t[n]);return e},hs=ka.document,gs=hs&&hs.documentElement,ps=Xo("IE_PROTO"),Es=function(){},ms=function(){var e,t=Ka("iframe"),n=Jo.length;for(t.style.display="none",gs.appendChild(t),t.src="javascript:",e=t.contentWindow.document,e.open(),e.write("<script>document.F=Object<\/script>"),e.close(),ms=e.F;n--;)delete ms.prototype[Jo[n]];return ms()},_s=Object.create||function(e,t){var n;return null!==e?(Es.prototype=Ba(e),n=new Es,Es.prototype=null,n[ps]=e):n=ms(),void 0===t?n:ds(n,t)},ys=ns.f,Ts=Vo.f,vs=za.f,Ss=cs.trim,As=ka.Number,Rs=As,Is=As.prototype,Ds="Number"==co(_s(Is)),bs="trim"in String.prototype,Ms=function(e){var t=Ha(e,!1);if("string"==typeof t&&t.length>2){t=bs?t.trim():Ss(t,3);var n,r,i,a=t.charCodeAt(0);if(43===a||45===a){if(88===(n=t.charCodeAt(2))||120===n)return NaN}else if(48===a){switch(t.charCodeAt(1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+t}for(var o,s=t.slice(2),u=0,l=s.length;u<l;u++)if((o=s.charCodeAt(u))<48||o>i)return NaN;return parseInt(s,r)}}return+t};if(!As(" 0o1")||!As("0b1")||As("+0x1")){As=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof As&&(Ds?Fa(function(){Is.valueOf.call(n)}):"Number"!=co(n))?zo(new Rs(Ms(t)),n,As):Ms(t)};for(var Cs,Ns=xa?ys(Rs):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),ws=0;Ns.length>ws;ws++)$a(Rs,Cs=Ns[ws])&&!$a(As,Cs)&&vs(As,Cs,Ts(Rs,Cs));As.prototype=Is,Is.constructor=As,ro(ka,"Number",As)}var Os=function(e){return Object(Ro(e))},Ls=Array.isArray||function(e){return"Array"==co(e)},Ps=ho("species"),Fs=function(e){var t;return Ls(e)&&(t=e.constructor,"function"!=typeof t||t!==Array&&!Ls(t.prototype)||(t=void 0),Ua(t)&&null===(t=t[Ps])&&(t=void 0)),void 0===t?Array:t},xs=function(e,t){return new(Fs(e))(t)},Us=function(e,t){var n=1==e,r=2==e,i=3==e,a=4==e,o=6==e,s=5==e||o,u=t||xs;return function(t,l,c){for(var f,d,h=Os(t),g=Ao(h),p=To(l,c,3),E=No(g.length),m=0,_=n?u(t,E):r?u(t,0):void 0;E>m;m++)if((s||m in g)&&(f=g[m],d=p(f,m,h),e))if(n)_[m]=d;else if(d)switch(e){case 3:return!0;case 5:return f;case 6:return m;case 2:_.push(f)}else if(a)return!1;return o?-1:i||a?a:_}},Bs=Us(1);So(So.P+So.F*!Fo([].map,!0),"Array",{map:function(e){return Bs(this,e,arguments[1])}});var ks=function(e,t,n,r,i){yo(t);var a=Os(e),o=Ao(a),s=No(a.length),u=i?s-1:0,l=i?-1:1;if(n<2)for(;;){if(u in o){r=o[u],u+=l;break}if(u+=l,i?u<0:s<=u)throw TypeError("Reduce of empty array with no initial value")}for(;i?u>=0:s>u;u+=l)u in o&&(r=t(r,o[u],u,a));return r};So(So.P+So.F*!Fo([].reduce,!0),"Array",{reduce:function(e){return ks(this,e,arguments.length,arguments[1],!1)}});var Gs=function(){function e(){d(this,e),this.init()}return g(e,[{key:"init",value:function(){this.STREAM="stream",this.VIDEO="video",this.AUDIO="audio",this.TEXT="text",this.FRAGMENTED_TEXT="fragmentedText",this.EMBEDDED_TEXT="embeddedText",this.MUXED="muxed",this.IMAGE="image",this.LOCATION="Location",this.INITIALIZE="initialize",this.TEXT_SHOWING="showing",this.TEXT_HIDDEN="hidden",this.CC1="CC1",this.CC3="CC3",this.STPP="stpp",this.TTML="ttml",this.VTT="vtt",this.WVTT="wvtt",this.UTF8="utf-8",this.SUGGESTED_PRESENTATION_DELAY="suggestedPresentationDelay",this.SCHEME_ID_URI="schemeIdUri",this.START_TIME="starttime",this.ABR_STRATEGY_DYNAMIC="abrDynamic",this.ABR_STRATEGY_BOLA="abrBola",this.ABR_STRATEGY_THROUGHPUT="abrThroughput",this.MOVING_AVERAGE_SLIDING_WINDOW="slidingWindow",this.MOVING_AVERAGE_EWMA="ewma",this.BAD_ARGUMENT_ERROR="Invalid Arguments",this.MISSING_CONFIG_ERROR="Missing config parameter(s)"}}]),e}(),Ys=new Gs,Ks=function(){function e(){d(this,e),this.init()}return g(e,[{key:"init",value:function(){this.TCP_CONNECTION="TcpList",this.HTTP_REQUEST="HttpList",this.TRACK_SWITCH="RepSwitchList",this.BUFFER_LEVEL="BufferLevel",this.BUFFER_STATE="BufferState",this.DVR_INFO="DVRInfo",this.DROPPED_FRAMES="DroppedFrames",this.SCHEDULING_INFO="SchedulingInfo",this.REQUESTS_QUEUE="RequestsQueue",this.MANIFEST_UPDATE="ManifestUpdate",this.MANIFEST_UPDATE_STREAM_INFO="ManifestUpdatePeriodInfo",this.MANIFEST_UPDATE_TRACK_INFO="ManifestUpdateRepresentationInfo",this.PLAY_LIST="PlayList",this.DVB_ERRORS="DVBErrors"}}]),e}(),Vs=new Ks,Hs=Us(0),qs=Fo([].forEach,!0);So(So.P+So.F*!qs,"Array",{forEach:function(e){return Hs(this,e,arguments[1])}}),So(So.S,"Date",{now:function(){return(new Date).getTime()}});var js=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)},zs=[].slice,Ws={},Xs=function(e,t,n){if(!(t in Ws)){for(var r=[],i=0;i<t;i++)r[i]="a["+i+"]";Ws[t]=Function("F,a","return new F("+r.join(",")+")")}return Ws[t](e,n)},Qs=Function.bind||function(e){var t=yo(this),n=zs.call(arguments,1),r=function(){var i=n.concat(zs.call(arguments));return this instanceof r?Xs(t,i.length,i):js(t,i,e)};return Ua(t.prototype)&&(r.prototype=t.prototype),r};So(So.P,"Function",{bind:Qs});var Zs=Us(2);So(So.P+So.F*!Fo([].filter,!0),"Array",{filter:function(e){return Zs(this,e,arguments[1])}});var $s=Us(3);So(So.P+So.F*!Fo([].some,!0),"Array",{some:function(e){return $s(this,e,arguments[1])}});var Js=za.f,eu=Function.prototype,tu=/^\s*function ([^ (]*)/;"name"in eu||xa&&Js(eu,"name",{configurable:!0,get:function(){try{return(""+this).match(tu)[1]}catch(e){return""}}});var nu=function(){function e(e,t,n,r){!r[e]&&t&&(r[e]={instance:t,override:n})}function t(e,t){for(var n in h){var r=h[n];if(r.context===e&&r.name===t)return r.instance}return null}function n(e,t,n){for(var r in h){var i=h[r];if(i.context===e&&i.name===t)return void(h[r].instance=n)}h.push({name:t,context:e,instance:n})}function r(e,t){return t[e]}function i(e,t,n){e in n&&(n[e]=t)}function a(e,t){i(e,t,p)}function o(e){return r(e,p)}function s(e){var t=r(e.__dashjs_factory_name,p);return t||(t=function(t){return void 0===t&&(t={}),{create:function(){return f(e,t,arguments)}}},p[e.__dashjs_factory_name]=t),t}function u(e,t){i(e,t,g)}function l(e){return r(e,g)}function c(e){var n=r(e.__dashjs_factory_name,g);return n||(n=function(n){var r;return void 0===n&&(n={}),{getInstance:function(){return r||(r=t(n,e.__dashjs_factory_name)),r||(r=f(e,n,arguments),h.push({name:e.__dashjs_factory_name,context:n,instance:r})),r}}},g[e.__dashjs_factory_name]=n),n}function f(e,t,n){var r,i=e.__dashjs_factory_name,a=t[i];if(a){var o=a.instance;if(!a.override)return o.apply({context:t,factory:d},n);r=e.apply({context:t},n),o=o.apply({context:t,factory:d,parent:r},n);for(var s in o)r.hasOwnProperty(s)&&(r[s]=o[s])}else r=e.apply({context:t},n);return r.getClassName=function(){return i},r}var d,h=[],g={},p={};return d={extend:e,getSingletonInstance:t,setSingletonInstance:n,getSingletonFactory:c,getSingletonFactoryByName:l,updateSingletonFactory:u,getClassFactory:s,getClassFactoryByName:o,updateClassFactory:a}}(),ru=0;v.__dashjs_factory_name="EventBus";var iu=nu.getSingletonFactory(v);iu.EVENT_PRIORITY_LOW=ru,iu.EVENT_PRIORITY_HIGH=5e3,nu.updateSingletonFactory(v.__dashjs_factory_name,iu);var au=function(){function e(){d(this,e)}return g(e,[{key:"extend",value:function(e,t){if(e){var n=!!t&&t.override,r=!!t&&t.publicOnly;for(var i in e)!e.hasOwnProperty(i)||this[i]&&!n||r&&-1===e[i].indexOf("public_")||(this[i]=e[i])}}}]),e}(),ou=function(e){function t(){var e;return d(this,t),e=T(this,m(t).call(this)),e.BUFFERING_COMPLETED="bufferingCompleted",e.BUFFER_CLEARED="bufferCleared",e.BUFFER_LEVEL_UPDATED="bufferLevelUpdated",e.BYTES_APPENDED="bytesAppended",e.BYTES_APPENDED_END_FRAGMENT="bytesAppendedEndFragment",e.CHECK_FOR_EXISTENCE_COMPLETED="checkForExistenceCompleted",e.CURRENT_TRACK_CHANGED="currentTrackChanged",e.DATA_UPDATE_COMPLETED="dataUpdateCompleted",e.DATA_UPDATE_STARTED="dataUpdateStarted",e.INITIALIZATION_LOADED="initializationLoaded",e.INIT_FRAGMENT_LOADED="initFragmentLoaded",e.INIT_REQUESTED="initRequested",e.INTERNAL_MANIFEST_LOADED="internalManifestLoaded",e.LIVE_EDGE_SEARCH_COMPLETED="liveEdgeSearchCompleted",e.LOADING_COMPLETED="loadingCompleted",e.LOADING_PROGRESS="loadingProgress",e.LOADING_DATA_PROGRESS="loadingDataProgress",e.LOADING_ABANDONED="loadingAborted",e.MANIFEST_UPDATED="manifestUpdated",e.MEDIA_FRAGMENT_LOADED="mediaFragmentLoaded",e.QUOTA_EXCEEDED="quotaExceeded",e.REPRESENTATION_UPDATED="representationUpdated",e.SEGMENTS_LOADED="segmentsLoaded",e.SERVICE_LOCATION_BLACKLIST_ADD="serviceLocationBlacklistAdd",e.SERVICE_LOCATION_BLACKLIST_CHANGED="serviceLocationBlacklistChanged",e.SOURCEBUFFER_REMOVE_COMPLETED="sourceBufferRemoveCompleted",e.STREAMS_COMPOSED="streamsComposed",e.STREAM_BUFFERING_COMPLETED="streamBufferingCompleted",e.STREAM_COMPLETED="streamCompleted",e.TEXT_TRACKS_QUEUE_INITIALIZED="textTracksQueueInitialized",e.TIMED_TEXT_REQUESTED="timedTextRequested",e.TIME_SYNCHRONIZATION_COMPLETED="timeSynchronizationComplete",e.URL_RESOLUTION_FAILED="urlResolutionFailed",e.VIDEO_CHUNK_RECEIVED="videoChunkReceived",e.WALLCLOCK_TIME_UPDATED="wallclockTimeUpdated",e.XLINK_ELEMENT_LOADED="xlinkElementLoaded",e.XLINK_READY="xlinkReady",e}return E(t,e),t}(au),su=function(e){function t(){return d(this,t),T(this,m(t).apply(this,arguments))}return E(t,e),t}(ou),uu=new su,lu=function e(){d(this,e),this.action=e.ACTION_DOWNLOAD,this.startTime=NaN,this.mediaType=null,this.mediaInfo=null,this.type=null,this.duration=NaN,this.timescale=NaN,this.range=null,this.url=null,this.serviceLocation=null,this.requestStartDate=null,this.firstByteDate=null,this.requestEndDate=null,this.quality=NaN,this.index=NaN,this.availabilityStartTime=null,this.availabilityEndTime=null,this.wallStartTime=null,this.bytesLoaded=NaN,this.bytesTotal=NaN,this.delayLoadingTime=NaN,this.responseType="arraybuffer",this.representationId=null};lu.ACTION_DOWNLOAD="download",lu.ACTION_COMPLETE="complete";var cu=0,fu=1,du=2,hu=3,gu=4,pu=5;S.__dashjs_factory_name="Debug";var Eu=nu.getSingletonFactory(S);Eu.LOG_LEVEL_NONE=cu,Eu.LOG_LEVEL_FATAL=fu,Eu.LOG_LEVEL_ERROR=du,Eu.LOG_LEVEL_WARNING=hu,Eu.LOG_LEVEL_INFO=gu,Eu.LOG_LEVEL_DEBUG=pu,nu.updateSingletonFactory(S.__dashjs_factory_name,Eu);var mu="loading",_u="executed",yu="failed";A.__dashjs_factory_name="FragmentModel";var Tu=nu.getClassFactory(A);Tu.FRAGMENT_MODEL_LOADING=mu,Tu.FRAGMENT_MODEL_EXECUTED=_u,Tu.FRAGMENT_MODEL_CANCELED="canceled",Tu.FRAGMENT_MODEL_FAILED=yu,nu.updateClassFactory(A.__dashjs_factory_name,Tu);var vu=function(e){return function(t,n){var r,i,a=String(Ro(t)),o=Mo(n),s=a.length;return o<0||o>=s?e?"":void 0:(r=a.charCodeAt(o),r<55296||r>56319||o+1===s||(i=a.charCodeAt(o+1))<56320||i>57343?e?a.charAt(o):r:e?a.slice(o,o+2):i-56320+(r-55296<<10)+65536)}}(!0),Su=function(e,t,n){return t+(n?vu(e,t).length:1)},Au=RegExp.prototype.exec,Ru=function(e,t){var n=e.exec;if("function"==typeof n){var r=n.call(e,t);if("object"!=typeof r)throw new TypeError("RegExp exec method returned something other than an Object or null");return r}if("RegExp"!==mo(e))throw new TypeError("RegExp#exec called on incompatible receiver");return Au.call(e,t)},Iu=RegExp.prototype.exec,Du=String.prototype.replace,bu=Iu,Mu=function(){var e=/a/,t=/b*/g;return Iu.call(e,"a"),Iu.call(t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),Cu=void 0!==/()??/.exec("")[1];(Mu||Cu)&&(bu=function(e){var t,n,r,i,a=this;return Cu&&(n=new RegExp("^"+a.source+"$(?!\\s)",Wa.call(a))),Mu&&(t=a.lastIndex),r=Iu.call(a,e),Mu&&r&&(a.lastIndex=a.global?r.index+r[0].length:t),Cu&&r&&r.length>1&&Du.call(r[0],n,function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(r[i]=void 0)}),r});var Nu=bu;So({target:"RegExp",proto:!0,forced:Nu!==/./.exec},{exec:Nu});var wu=ho("species"),Ou=!Fa(function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}),Lu=function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2===n.length&&"a"===n[0]&&"b"===n[1]}(),Pu=function(e,t,n){var r=ho(e),i=!Fa(function(){var t={};return t[r]=function(){return 7},7!=""[e](t)}),a=i?!Fa(function(){var t=!1,n=/a/;return n.exec=function(){return t=!0,null},"split"===e&&(n.constructor={},n.constructor[wu]=function(){return n}),n[r](""),!t}):void 0;if(!i||!a||"replace"===e&&!Ou||"split"===e&&!Lu){var o=/./[r],s=n(Ro,r,""[e],function(e,t,n,r,a){return t.exec===Nu?i&&!a?{done:!0,value:o.call(t,n,r)}:{done:!0,value:e.call(n,t,r)}:{done:!1}}),u=s[0],l=s[1];ro(String.prototype,e,u),Qa(RegExp.prototype,r,2==t?function(e,t){return l.call(e,this,t)}:function(e){return l.call(e,this)})}};Pu("match",1,function(e,t,n,r){return[function(n){var r=e(this),i=void 0==n?void 0:n[t];return void 0!==i?i.call(n,r):new RegExp(n)[t](String(r))},function(e){var t=r(n,e,this);if(t.done)return t.value;var i=Ba(e),a=String(this);if(!i.global)return Ru(i,a);var o=i.unicode;i.lastIndex=0;for(var s,u=[],l=0;null!==(s=Ru(i,a));){var c=String(s[0]);u[l]=c,""===c&&(i.lastIndex=Su(a,No(i.lastIndex),o)),l++}return 0===l?null:u}]});var Fu=function e(t,n,r){d(this,e),this.code=t||null,this.message=n||null,this.data=r||null},xu=[].sort,Uu=[1,2,3];So(So.P+So.F*(Fa(function(){Uu.sort(void 0)})||!Fa(function(){Uu.sort(null)})||!Fo(xu)),"Array",{sort:function(e){return void 0===e?xu.call(Os(this)):xu.call(Os(this),yo(e))}});for(var Bu,ku=to("typed_array"),Gu=to("view"),Yu=!(!ka.ArrayBuffer||!ka.DataView),Ku=Yu,Vu=0,Hu="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");Vu<9;)(Bu=ka[Hu[Vu++]])?(Qa(Bu.prototype,ku,!0),Qa(Bu.prototype,Gu,!0)):Ku=!1;var qu={ABV:Yu,CONSTR:Ku,TYPED:ku,VIEW:Gu},ju=function(e,t,n){for(var r in t)ro(e,r,t[r],n);return e},zu=function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!");return e},Wu=function(e){if(void 0===e)return 0;var t=Mo(e),n=No(t);if(t!==n)throw RangeError("Wrong length!");return n},Xu=function(e){for(var t=Os(this),n=No(t.length),r=arguments.length,i=Lo(r>1?arguments[1]:void 0,n),a=r>2?arguments[2]:void 0,o=void 0===a?n:Lo(a,n);o>i;)t[i++]=e;return t},Qu=za.f,Zu=ho("toStringTag"),$u=function(e,t,n){e&&!$a(e=n?e:e.prototype,Zu)&&Qu(e,Zu,{configurable:!0,value:t})},Ju=c(function(e,t){function n(e,t,n){var r,i,a,o=new Array(n),s=8*n-t-1,u=(1<<s)-1,l=u>>1,c=23===t?R(2,-24)-R(2,-77):0,f=0,d=e<0||0===e&&1/e<0?1:0;for(e=A(e),e!=e||e===v?(i=e!=e?1:0,r=u):(r=I(D(e)/b),e*(a=R(2,-r))<1&&(r--,a*=2),e+=r+l>=1?c/a:c*R(2,1-l),e*a>=2&&(r++,a/=2),r+l>=u?(i=0,r=u):r+l>=1?(i=(e*a-1)*R(2,t),r+=l):(i=e*R(2,l-1)*R(2,t),r=0));t>=8;o[f++]=255&i,i/=256,t-=8);for(r=r<<t|i,s+=t;s>0;o[f++]=255&r,r/=256,s-=8);return o[--f]|=128*d,o}function r(e,t,n){var r,i=8*n-t-1,a=(1<<i)-1,o=a>>1,s=i-7,u=n-1,l=e[u--],c=127&l;for(l>>=7;s>0;c=256*c+e[u],u--,s-=8);for(r=c&(1<<-s)-1,c>>=-s,s+=t;s>0;r=256*r+e[u],u--,s-=8);if(0===c)c=1-o;else{if(c===a)return r?NaN:l?-v:v;r+=R(2,t),c-=o}return(l?-1:1)*r*R(2,c-t)}function i(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]}function a(e){return[255&e]}function o(e){return[255&e,e>>8&255]}function s(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]}function u(e){return n(e,52,8)}function l(e){return n(e,23,4)}function c(e,t,n){g(e[p],t,{get:function(){return this[n]}})}function f(e,t,n,r){var i=+n,a=Wu(i);if(a+t>e[C])throw T(E);var o=e[M]._b,s=a+e[N],u=o.slice(s,s+t);return r?u:u.reverse()}function d(e,t,n,r,i,a){var o=+n,s=Wu(o);if(s+t>e[C])throw T(E);for(var u=e[M]._b,l=s+e[N],c=r(+i),f=0;f<t;f++)u[l+f]=c[a?f:t-f-1]}var h=ns.f,g=za.f,p="prototype",E="Wrong index!",m=ka.ArrayBuffer,_=ka.DataView,y=ka.Math,T=ka.RangeError,v=ka.Infinity,S=m,A=y.abs,R=y.pow,I=y.floor,D=y.log,b=y.LN2,M=xa?"_b":"buffer",C=xa?"_l":"byteLength",N=xa?"_o":"byteOffset";if(qu.ABV){if(!Fa(function(){m(1)})||!Fa(function(){new m(-1)})||Fa(function(){return new m,new m(1.5),new m(NaN),"ArrayBuffer"!=m.name})){m=function(e){return zu(this,m),new S(Wu(e))};for(var w,O=m[p]=S[p],L=h(S),P=0;L.length>P;)(w=L[P++])in m||Qa(m,w,S[w]);O.constructor=m}var F=new _(new m(2)),x=_[p].setInt8;F.setInt8(0,2147483648),F.setInt8(1,2147483649),!F.getInt8(0)&&F.getInt8(1)||ju(_[p],{setInt8:function(e,t){x.call(this,e,t<<24>>24)},setUint8:function(e,t){x.call(this,e,t<<24>>24)}},!0)}else m=function(e){zu(this,m,"ArrayBuffer");var t=Wu(e);this._b=Xu.call(new Array(t),0),this[C]=t},_=function(e,t,n){zu(this,_,"DataView"),zu(e,m,"DataView");var r=e[C],i=Mo(t);if(i<0||i>r)throw T("Wrong offset!");if(n=void 0===n?r-i:No(n),i+n>r)throw T("Wrong length!");this[M]=e,this[N]=i,this[C]=n},xa&&(c(m,"byteLength","_l"),c(_,"buffer","_b"),c(_,"byteLength","_l"),c(_,"byteOffset","_o")),ju(_[p],{getInt8:function(e){return f(this,1,e)[0]<<24>>24},getUint8:function(e){return f(this,1,e)[0]},getInt16:function(e){var t=f(this,2,e,arguments[1]);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=f(this,2,e,arguments[1]);return t[1]<<8|t[0]},getInt32:function(e){return i(f(this,4,e,arguments[1]))},getUint32:function(e){return i(f(this,4,e,arguments[1]))>>>0},getFloat32:function(e){return r(f(this,4,e,arguments[1]),23,4)},getFloat64:function(e){return r(f(this,8,e,arguments[1]),52,8)},setInt8:function(e,t){d(this,1,e,a,t)},setUint8:function(e,t){d(this,1,e,a,t)},setInt16:function(e,t){d(this,2,e,o,t,arguments[2])},setUint16:function(e,t){d(this,2,e,o,t,arguments[2])},setInt32:function(e,t){d(this,4,e,s,t,arguments[2])},setUint32:function(e,t){d(this,4,e,s,t,arguments[2])},setFloat32:function(e,t){d(this,4,e,l,t,arguments[2])},setFloat64:function(e,t){d(this,8,e,u,t,arguments[2])}});$u(m,"ArrayBuffer"),$u(_,"DataView"),Qa(_[p],qu.VIEW,!0),t.ArrayBuffer=m,t.DataView=_}),el={},tl=ho("iterator"),nl=Array.prototype,rl=function(e){return void 0!==e&&(el.Array===e||nl[tl]===e)},il=Xo("IE_PROTO"),al=Object.prototype,ol=Object.getPrototypeOf||function(e){return e=Os(e),$a(e,il)?e[il]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?al:null},sl=ho("iterator"),ul=no.getIteratorMethod=function(e){if(void 0!=e)return e[sl]||e["@@iterator"]||el[mo(e)]},ll=ho("species"),cl=function(e,t){var n,r=Ba(e).constructor;return void 0===r||void 0==(n=Ba(r)[ll])?t:yo(n)},fl=ho("unscopables"),dl=Array.prototype;void 0==dl[fl]&&Qa(dl,fl,{});var hl=function(e){dl[fl][e]=!0},gl=function(e,t){return{value:t,done:!!e}},pl={};Qa(pl,ho("iterator"),function(){return this});var El=function(e,t,n){e.prototype=_s(pl,{next:Xa(1,n)}),$u(e,t+" Iterator")},ml=ho("iterator"),_l=!([].keys&&"next"in[].keys()),yl=function(){return this},Tl=function(e,t,n,r,i,a,o){El(n,t,r);var s,u,l,c=function(e){if(!_l&&e in g)return g[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},f=t+" Iterator",d="values"==i,h=!1,g=e.prototype,p=g[ml]||g["@@iterator"]||i&&g[i],E=p||c(i),m=i?d?c("entries"):E:void 0,_="Array"==t?g.entries||p:p;if(_&&(l=ol(_.call(new e)))!==Object.prototype&&l.next&&($u(l,f,!0),"function"!=typeof l[ml]&&Qa(l,ml,yl)),d&&p&&"values"!==p.name&&(h=!0,E=function(){return p.call(this)}),(_l||h||!g[ml])&&Qa(g,ml,E),el[t]=E,el[f]=yl,i)if(s={values:d?E:c("values"),keys:a?E:c("keys"),entries:m},o)for(u in s)u in g||ro(g,u,s[u]);else So(So.P+So.F*(_l||h),t,s);return s}(Array,"Array",function(e,t){this._t=Io(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,gl(1)):"keys"==t?gl(0,n):"values"==t?gl(0,e[n]):gl(0,[n,e[n]])},"values");el.Arguments=el.Array,hl("keys"),hl("values"),hl("entries");var vl=ho("iterator"),Sl=!1;try{[7][vl]().return=function(){Sl=!0}}catch(e){}var Al=function(e,t){if(!t&&!Sl)return!1;var n=!1;try{var r=[7],i=r[vl]();i.next=function(){return{done:n=!0}},r[vl]=function(){return i},e(r)}catch(e){}return n},Rl=ho("species"),Il=function(e){var t=ka[e];xa&&t&&!t[Rl]&&za.f(t,Rl,{configurable:!0,get:function(){return this}})},Dl=[].copyWithin||function(e,t){var n=Os(this),r=No(n.length),i=Lo(e,r),a=Lo(t,r),o=arguments.length>2?arguments[2]:void 0,s=Math.min((void 0===o?r:Lo(o,r))-a,r-i),u=1;for(a<i&&i<a+s&&(u=-1,a+=s-1,i+=s-1);s-- >0;)a in n?n[i]=n[a]:delete n[i],i+=u,a+=u;return n},bl=c(function(e){if(xa){var t=ka,n=Fa,r=So,i=qu,a=Ju,o=To,s=zu,u=Xa,l=Qa,c=ju,f=Mo,d=No,h=Wu,g=Lo,p=Ha,E=$a,m=mo,_=Ua,y=Os,T=rl,v=_s,S=ol,A=ns.f,R=ul,I=to,D=ho,b=Us,M=Po,C=cl,N=Tl,w=el,O=Al,L=Il,P=Xu,F=Dl,x=za,U=Vo,B=x.f,k=U.f,G=t.RangeError,Y=t.TypeError,K=t.Uint8Array,V=Array.prototype,H=a.ArrayBuffer,q=a.DataView,j=b(0),z=b(2),W=b(3),X=b(4),Q=b(5),Z=b(6),$=M(!0),J=M(!1),ee=N.values,te=N.keys,ne=N.entries,re=V.lastIndexOf,ie=V.reduce,ae=V.reduceRight,oe=V.join,se=V.sort,ue=V.slice,le=V.toString,ce=V.toLocaleString,fe=D("iterator"),de=D("toStringTag"),he=I("typed_constructor"),ge=I("def_constructor"),pe=i.CONSTR,Ee=i.TYPED,me=i.VIEW,_e=b(1,function(e,t){return Ae(C(e,e[ge]),t)}),ye=n(function(){return 1===new K(new Uint16Array([1]).buffer)[0]}),Te=!!K&&!!K.prototype.set&&n(function(){new K(1).set({})}),ve=function(e,t){var n=f(e);if(n<0||n%t)throw G("Wrong offset!");return n},Se=function(e){if(_(e)&&Ee in e)return e;throw Y(e+" is not a typed array!")},Ae=function(e,t){if(!(_(e)&&he in e))throw Y("It is not a typed array constructor!");return new e(t)},Re=function(e,t){return Ie(C(e,e[ge]),t)},Ie=function(e,t){for(var n=0,r=t.length,i=Ae(e,r);r>n;)i[n]=t[n++];return i},De=function(e,t,n){B(e,t,{get:function(){return this._d[n]}})},be=function(e){var t,n,r,i,a,s,u=y(e),l=arguments.length,c=l>1?arguments[1]:void 0,f=void 0!==c,h=R(u);if(void 0!=h&&!T(h)){for(s=h.call(u),r=[],t=0;!(a=s.next()).done;t++)r.push(a.value);u=r}for(f&&l>2&&(c=o(c,arguments[2],2)),t=0,n=d(u.length),i=Ae(this,n);n>t;t++)i[t]=f?c(u[t],t):u[t];return i},Me=function(){for(var e=0,t=arguments.length,n=Ae(this,t);t>e;)n[e]=arguments[e++];return n},Ce=!!K&&n(function(){ce.call(new K(1))}),Ne=function(){return ce.apply(Ce?ue.call(Se(this)):Se(this),arguments)},we={copyWithin:function(e,t){return F.call(Se(this),e,t,arguments.length>2?arguments[2]:void 0)},every:function(e){return X(Se(this),e,arguments.length>1?arguments[1]:void 0)},fill:function(e){return P.apply(Se(this),arguments)},filter:function(e){return Re(this,z(Se(this),e,arguments.length>1?arguments[1]:void 0))},find:function(e){return Q(Se(this),e,arguments.length>1?arguments[1]:void 0)},findIndex:function(e){return Z(Se(this),e,arguments.length>1?arguments[1]:void 0)},forEach:function(e){j(Se(this),e,arguments.length>1?arguments[1]:void 0)},indexOf:function(e){return J(Se(this),e,arguments.length>1?arguments[1]:void 0)},includes:function(e){return $(Se(this),e,arguments.length>1?arguments[1]:void 0)},join:function(e){return oe.apply(Se(this),arguments)},lastIndexOf:function(e){return re.apply(Se(this),arguments)},map:function(e){return _e(Se(this),e,arguments.length>1?arguments[1]:void 0)},reduce:function(e){return ie.apply(Se(this),arguments)},reduceRight:function(e){return ae.apply(Se(this),arguments)},reverse:function(){for(var e,t=this,n=Se(t).length,r=Math.floor(n/2),i=0;i<r;)e=t[i],t[i++]=t[--n],t[n]=e;return t},some:function(e){return W(Se(this),e,arguments.length>1?arguments[1]:void 0)},sort:function(e){return se.call(Se(this),e)},subarray:function(e,t){var n=Se(this),r=n.length,i=g(e,r);return new(C(n,n[ge]))(n.buffer,n.byteOffset+i*n.BYTES_PER_ELEMENT,d((void 0===t?r:g(t,r))-i))}},Oe=function(e,t){return Re(this,ue.call(Se(this),e,t))},Le=function(e){Se(this);var t=ve(arguments[1],1),n=this.length,r=y(e),i=d(r.length),a=0;if(i+t>n)throw G("Wrong length!");for(;a<i;)this[t+a]=r[a++]},Pe={entries:function(){return ne.call(Se(this))},keys:function(){return te.call(Se(this))},values:function(){return ee.call(Se(this))}},Fe=function(e,t){return _(e)&&e[Ee]&&"symbol"!=typeof t&&t in e&&String(+t)==String(t)},xe=function(e,t){return Fe(e,t=p(t,!0))?u(2,e[t]):k(e,t)},Ue=function(e,t,n){return!(Fe(e,t=p(t,!0))&&_(n)&&E(n,"value"))||E(n,"get")||E(n,"set")||n.configurable||E(n,"writable")&&!n.writable||E(n,"enumerable")&&!n.enumerable?B(e,t,n):(e[t]=n.value,e)};pe||(U.f=xe,x.f=Ue),r(r.S+r.F*!pe,"Object",{getOwnPropertyDescriptor:xe,defineProperty:Ue}),n(function(){le.call({})})&&(le=ce=function(){return oe.call(this)});var Be=c({},we);c(Be,Pe),l(Be,fe,Pe.values),c(Be,{slice:Oe,set:Le,constructor:function(){},toString:le,toLocaleString:Ne}),De(Be,"buffer","b"),De(Be,"byteOffset","o"),De(Be,"byteLength","l"),De(Be,"length","e"),B(Be,de,{get:function(){return this[Ee]}}),e.exports=function(e,a,o,u){u=!!u;var c=e+(u?"Clamped":"")+"Array",f="get"+e,g="set"+e,p=t[c],E=p||{},y=p&&S(p),T=!p||!i.ABV,R={},I=p&&p.prototype,D=function(e,t){var n=e._d;return n.v[f](t*a+n.o,ye)},b=function(e,t,n){var r=e._d;u&&(n=(n=Math.round(n))<0?0:n>255?255:255&n),r.v[g](t*a+r.o,n,ye)},M=function(e,t){B(e,t,{get:function(){return D(this,t)},set:function(e){return b(this,t,e)},enumerable:!0})};T?(p=o(function(e,t,n,r){s(e,p,c,"_d");var i,o,u,f,g=0,E=0;if(_(t)){if(!(t instanceof H||"ArrayBuffer"==(f=m(t))||"SharedArrayBuffer"==f))return Ee in t?Ie(p,t):be.call(p,t);i=t,E=ve(n,a);var y=t.byteLength;if(void 0===r){if(y%a)throw G("Wrong length!");if((o=y-E)<0)throw G("Wrong length!")}else if((o=d(r)*a)+E>y)throw G("Wrong length!");u=o/a}else u=h(t),o=u*a,i=new H(o);for(l(e,"_d",{b:i,o:E,l:o,e:u,v:new q(i)});g<u;)M(e,g++)}),I=p.prototype=v(Be),l(I,"constructor",p)):n(function(){p(1)})&&n(function(){new p(-1)})&&O(function(e){new p,new p(null),new p(1.5),new p(e)},!0)||(p=o(function(e,t,n,r){s(e,p,c);var i;return _(t)?t instanceof H||"ArrayBuffer"==(i=m(t))||"SharedArrayBuffer"==i?void 0!==r?new E(t,ve(n,a),r):void 0!==n?new E(t,ve(n,a)):new E(t):Ee in t?Ie(p,t):be.call(p,t):new E(h(t))}),j(y!==Function.prototype?A(E).concat(A(y)):A(E),function(e){e in p||l(p,e,E[e])}),p.prototype=I,I.constructor=p);var C=I[fe],N=!!C&&("values"==C.name||void 0==C.name),P=Pe.values;l(p,he,!0),l(I,Ee,c),l(I,me,!0),l(I,ge,p),(u?new p(1)[de]==c:de in I)||B(I,de,{get:function(){return c}}),R[c]=p,r(r.G+r.W+r.F*(p!=E),R),r(r.S,c,{BYTES_PER_ELEMENT:a}),r(r.S+r.F*n(function(){E.of.call(p,1)}),c,{from:be,of:Me}),"BYTES_PER_ELEMENT"in I||l(I,"BYTES_PER_ELEMENT",a),r(r.P,c,we),L(c),r(r.P+r.F*Te,c,{set:Le}),r(r.P+r.F*!N,c,Pe),I.toString!=le&&(I.toString=le),r(r.P+r.F*n(function(){new p(1).slice()}),c,{slice:Oe}),r(r.P+r.F*(n(function(){return[1,2].toLocaleString()!=new p([1,2]).toLocaleString()})||!n(function(){I.toLocaleString.call([1,2])})),c,{toLocaleString:Ne}),w[c]=N?C:P,N||l(I,fe,P)}}else e.exports=function(){}});bl("Uint8",1,function(e){return function(t,n,r){return e(this,t,n,r)}}),So(So.G+So.W+So.F*!qu.ABV,{DataView:Ju.DataView});var Ml=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t};Pu("search",1,function(e,t,n,r){return[function(n){var r=e(this),i=void 0==n?void 0:n[t];return void 0!==i?i.call(n,r):new RegExp(n)[t](String(r))},function(e){var t=r(n,e,this);if(t.done)return t.value;var i=Ba(e),a=String(this),o=i.lastIndex;Ml(o,0)||(i.lastIndex=0);var s=Ru(i,a);return Ml(i.lastIndex,o)||(i.lastIndex=o),null===s?-1:s.index}]});var Cl=function e(){d(this,e),this.tcpid=null,this.type=null,this.url=null,this.actualurl=null,this.range=null,this.trequest=null,this.tresponse=null,this.responsecode=null,this.interval=null,this.trace=[],this._stream=null,this._tfinish=null,this._mediaduration=null,this._responseHeaders=null,this._serviceLocation=null},Nl=function e(){d(this,e),this.s=null,this.d=null,this.b=[]};Cl.GET="GET",Cl.HEAD="HEAD",Cl.MPD_TYPE="MPD",Cl.XLINK_EXPANSION_TYPE="XLinkExpansion",Cl.INIT_SEGMENT_TYPE="InitializationSegment",Cl.INDEX_SEGMENT_TYPE="IndexSegment",Cl.MEDIA_SEGMENT_TYPE="MediaSegment",Cl.BITSTREAM_SWITCHING_SEGMENT_TYPE="BitstreamSwitchingSegment",Cl.OTHER_TYPE="other";for(var wl=function e(){d(this,e),this.captionData=null,this.label=null,this.lang=null,this.defaultTrack=!1,this.kind=null,this.isFragmented=!1,this.isEmbedded=!1},Ol=ho("iterator"),Ll=ho("toStringTag"),Pl=el.Array,Fl={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},xl=fs(Fl),Ul=0;Ul<xl.length;Ul++){var Bl,kl=xl[Ul],Gl=Fl[kl],Yl=ka[kl],Kl=Yl&&Yl.prototype;if(Kl&&(Kl[Ol]||Qa(Kl,Ol,Pl),Kl[Ll]||Qa(Kl,Ll,kl),el[kl]=Pl,Gl))for(Bl in Tl)Kl[Bl]||ro(Kl,Bl,Tl[Bl],!0)}var Vl=function(){function e(t){if(d(this,e),this.offset=t._offset,this.type=t.type,this.size=t.size,this.boxes=[],t.boxes)for(var n=0;n<t.boxes.length;n++)this.boxes.push(new e(t.boxes[n]));switch(this.isComplete=!0,t.type){case"sidx":if(this.timescale=t.timescale,this.earliest_presentation_time=t.earliest_presentation_time,this.first_offset=t.first_offset,this.references=t.references,t.references){this.references=[];for(var r=0;r<t.references.length;r++){var i={reference_type:t.references[r].reference_type,referenced_size:t.references[r].referenced_size,subsegment_duration:t.references[r].subsegment_duration};this.references.push(i)}}break;case"emsg":this.id=t.id,this.value=t.value,this.timescale=t.timescale,this.scheme_id_uri=t.scheme_id_uri,this.presentation_time_delta=1===t.version?t.presentation_time:t.presentation_time_delta,this.event_duration=t.event_duration,this.message_data=t.message_data;break;case"mdhd":this.timescale=t.timescale;break;case"mfhd":this.sequence_number=t.sequence_number;break;case"subs":this.entry_count=t.entry_count,this.entries=t.entries;break;case"tfhd":this.base_data_offset=t.base_data_offset,this.sample_description_index=t.sample_description_index,this.default_sample_duration=t.default_sample_duration,this.default_sample_size=t.default_sample_size,this.default_sample_flags=t.default_sample_flags,this.flags=t.flags;break;case"tfdt":this.version=t.version,this.baseMediaDecodeTime=t.baseMediaDecodeTime,this.flags=t.flags;break;case"trun":if(this.sample_count=t.sample_count,this.first_sample_flags=t.first_sample_flags,this.data_offset=t.data_offset,this.flags=t.flags,this.samples=t.samples,t.samples){this.samples=[];for(var a=0,o=t.samples.length;a<o;a++){var s={sample_size:t.samples[a].sample_size,sample_duration:t.samples[a].sample_duration,sample_composition_time_offset:t.samples[a].sample_composition_time_offset};this.samples.push(s)}}}}return g(e,[{key:"getChildBox",value:function(e){for(var t=0;t<this.boxes.length;t++)if(this.boxes[t].type===e)return this.boxes[t]}},{key:"getChildBoxes",value:function(e){
for(var t=[],n=0;n<this.boxes.length;n++)this.boxes[n].type===e&&t.push(this.boxes[n]);return t}}]),e}();R.__dashjs_factory_name="IsoFile";var Hl=nu.getClassFactory(R),ql=c(function(e,t){var n={};n.parseBuffer=function(e){return new r(e).parse()},n.addBoxProcessor=function(e,t){"string"==typeof e&&"function"==typeof t&&(i.prototype._boxProcessors[e]=t)},n.createFile=function(){return new r},n.createBox=function(e,t,n){var r=i.create(e);return t&&t.append(r,n),r},n.createFullBox=function(e,t,r){var i=n.createBox(e,t,r);return i.version=0,i.flags=0,i},n.Utils={},n.Utils.dataViewToString=function(e,t){var n=t||"utf-8";if("undefined"!=typeof TextDecoder)return new TextDecoder(n).decode(e);var r=[],i=0;if("utf-8"===n)for(;i<e.byteLength;){var a=e.getUint8(i++);a<128||(a<224?(a=(31&a)<<6,a|=63&e.getUint8(i++)):a<240?(a=(15&a)<<12,a|=(63&e.getUint8(i++))<<6,a|=63&e.getUint8(i++)):(a=(7&a)<<18,a|=(63&e.getUint8(i++))<<12,a|=(63&e.getUint8(i++))<<6,a|=63&e.getUint8(i++))),r.push(String.fromCharCode(a))}else for(;i<e.byteLength;)r.push(String.fromCharCode(e.getUint8(i++)));return r.join("")},n.Utils.utf8ToByteArray=function(e){var t,n;if("undefined"!=typeof TextEncoder)t=(new TextEncoder).encode(e);else for(t=[],n=0;n<e.length;++n){var r=e.charCodeAt(n);r<128?t.push(r):r<2048?(t.push(192|r>>6),t.push(128|63&r)):r<65536?(t.push(224|r>>12),t.push(128|63&r>>6),t.push(128|63&r)):(t.push(240|r>>18),t.push(128|63&r>>12),t.push(128|63&r>>6),t.push(128|63&r))}return t},n.Utils.appendBox=function(e,t,n){if(t._offset=e._cursor.offset,t._root=e._root?e._root:e,t._raw=e._raw,t._parent=e,-1!==n){if(void 0===n||null===n)return void e.boxes.push(t);var r,i=-1;if("number"==typeof n)i=n;else{if("string"==typeof n)r=n;else{if("object"!=typeof n||!n.type)return void e.boxes.push(t);r=n.type}for(var a=0;a<e.boxes.length;a++)if(r===e.boxes[a].type){i=a+1;break}}e.boxes.splice(i,0,t)}},t.parseBuffer=n.parseBuffer,t.addBoxProcessor=n.addBoxProcessor,t.createFile=n.createFile,t.createBox=n.createBox,t.createFullBox=n.createFullBox,t.Utils=n.Utils,n.Cursor=function(e){this.offset=void 0===e?0:e};var r=function(e){this._cursor=new n.Cursor,this.boxes=[],e&&(this._raw=new DataView(e))};r.prototype.fetch=function(e){var t=this.fetchAll(e,!0);return t.length?t[0]:null},r.prototype.fetchAll=function(e,t){var n=[];return r._sweep.call(this,e,n,t),n},r.prototype.parse=function(){for(this._cursor.offset=0,this.boxes=[];this._cursor.offset<this._raw.byteLength;){var e=i.parse(this);if(void 0===e.type)break;this.boxes.push(e)}return this},r._sweep=function(e,t,n){this.type&&this.type==e&&t.push(this);for(var i in this.boxes){if(t.length&&n)return;r._sweep.call(this.boxes[i],e,t,n)}},r.prototype.write=function(){var e,t=0;for(e=0;e<this.boxes.length;e++)t+=this.boxes[e].getLength(!1);var n=new Uint8Array(t);for(this._rawo=new DataView(n.buffer),this.bytes=n,this._cursor.offset=0,e=0;e<this.boxes.length;e++)this.boxes[e].write();return n.buffer},r.prototype.append=function(e,t){n.Utils.appendBox(this,e,t)};var i=function(){this._cursor=new n.Cursor};i.parse=function(e){var t=new i;return t._offset=e._cursor.offset,t._root=e._root?e._root:e,t._raw=e._raw,t._parent=e,t._parseBox(),e._cursor.offset=t._raw.byteOffset+t._raw.byteLength,t},i.create=function(e){var t=new i;return t.type=e,t.boxes=[],t},i.prototype._boxContainers=["dinf","edts","mdia","meco","mfra","minf","moof","moov","mvex","stbl","strk","traf","trak","tref","udta","vttc","sinf","schi","encv","enca"],i.prototype._boxProcessors={},i.prototype._procField=function(e,t,n){this._parsing?this[e]=this._readField(t,n):this._writeField(t,n,this[e])},i.prototype._procFieldArray=function(e,t,n,r){var i;if(this._parsing)for(this[e]=[],i=0;i<t;i++)this[e][i]=this._readField(n,r);else for(i=0;i<this[e].length;i++)this._writeField(n,r,this[e][i])},i.prototype._procFullBox=function(){this._procField("version","uint",8),this._procField("flags","uint",24)},i.prototype._procEntries=function(e,t,n){var r;if(this._parsing)for(this[e]=[],r=0;r<t;r++)this[e].push({}),n.call(this,this[e][r]);else for(r=0;r<t;r++)n.call(this,this[e][r])},i.prototype._procSubEntries=function(e,t,n,r){var i;if(this._parsing)for(e[t]=[],i=0;i<n;i++)e[t].push({}),r.call(this,e[t][i]);else for(i=0;i<n;i++)r.call(this,e[t][i])},i.prototype._procEntryField=function(e,t,n,r){this._parsing?e[t]=this._readField(n,r):this._writeField(n,r,e[t])},i.prototype._procSubBoxes=function(e,t){var n;if(this._parsing)for(this[e]=[],n=0;n<t;n++)this[e].push(i.parse(this));else for(n=0;n<t;n++)this._rawo?this[e][n].write():this.size+=this[e][n].getLength()},i.prototype._readField=function(e,t){switch(e){case"uint":return this._readUint(t);case"int":return this._readInt(t);case"template":return this._readTemplate(t);case"string":return-1===t?this._readTerminatedString():this._readString(t);case"data":return this._readData(t);case"utf8":return this._readUTF8String();default:return-1}},i.prototype._readInt=function(e){var t=null,n=this._cursor.offset-this._raw.byteOffset;switch(e){case 8:t=this._raw.getInt8(n);break;case 16:t=this._raw.getInt16(n);break;case 32:t=this._raw.getInt32(n);break;case 64:var r=this._raw.getInt32(n),i=this._raw.getInt32(n+4);t=r*Math.pow(2,32)+i}return this._cursor.offset+=e>>3,t},i.prototype._readUint=function(e){var t,n,r=null,i=this._cursor.offset-this._raw.byteOffset;switch(e){case 8:r=this._raw.getUint8(i);break;case 16:r=this._raw.getUint16(i);break;case 24:t=this._raw.getUint16(i),n=this._raw.getUint8(i+2),r=(t<<8)+n;break;case 32:r=this._raw.getUint32(i);break;case 64:t=this._raw.getUint32(i),n=this._raw.getUint32(i+4),r=t*Math.pow(2,32)+n}return this._cursor.offset+=e>>3,r},i.prototype._readString=function(e){for(var t="",n=0;n<e;n++){var r=this._readUint(8);t+=String.fromCharCode(r)}return t},i.prototype._readTemplate=function(e){return this._readUint(e/2)+this._readUint(e/2)/Math.pow(2,e/2)},i.prototype._readTerminatedString=function(){for(var e="";this._cursor.offset-this._offset<this._raw.byteLength;){var t=this._readUint(8);if(0===t)break;e+=String.fromCharCode(t)}return e},i.prototype._readData=function(e){var t=e>0?e:this._raw.byteLength-(this._cursor.offset-this._offset);if(t>0){var n=new Uint8Array(this._raw.buffer,this._cursor.offset,t);return this._cursor.offset+=t,n}return null},i.prototype._readUTF8String=function(){var e=this._raw.byteLength-(this._cursor.offset-this._offset),t=null;return e>0&&(t=new DataView(this._raw.buffer,this._cursor.offset,e),this._cursor.offset+=e),t?n.Utils.dataViewToString(t):t},i.prototype._parseBox=function(){if(this._parsing=!0,this._cursor.offset=this._offset,this._offset+8>this._raw.buffer.byteLength)return void(this._root._incomplete=!0);switch(this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this.size){case 0:this._raw=new DataView(this._raw.buffer,this._offset,this._raw.byteLength-this._cursor.offset+8);break;case 1:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.largesize);break;default:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.size)}this._incomplete||(this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type)?this._parseContainerBox():this._data=this._readData())},i.prototype._parseFullBox=function(){this.version=this._readUint(8),this.flags=this._readUint(24)},i.prototype._parseContainerBox=function(){for(this.boxes=[];this._cursor.offset-this._raw.byteOffset<this._raw.byteLength;)this.boxes.push(i.parse(this))},i.prototype.append=function(e,t){n.Utils.appendBox(this,e,t)},i.prototype.getLength=function(){if(this._parsing=!1,this._rawo=null,this.size=0,this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type))for(var e=0;e<this.boxes.length;e++)this.size+=this.boxes[e].getLength();return this._data&&this._writeData(this._data),this.size},i.prototype.write=function(){switch(this._parsing=!1,this._cursor.offset=this._parent._cursor.offset,this.size){case 0:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.parent._rawo.byteLength-this._cursor.offset);break;case 1:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.largesize);break;default:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.size)}if(this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type))for(var e=0;e<this.boxes.length;e++)this.boxes[e].write();return this._data&&this._writeData(this._data),this._parent._cursor.offset+=this.size,this.size},i.prototype._writeInt=function(e,t){if(this._rawo){var n=this._cursor.offset-this._rawo.byteOffset;switch(e){case 8:this._rawo.setInt8(n,t);break;case 16:this._rawo.setInt16(n,t);break;case 32:this._rawo.setInt32(n,t);break;case 64:var r=Math.floor(t/Math.pow(2,32)),i=t-r*Math.pow(2,32);this._rawo.setUint32(n,r),this._rawo.setUint32(n+4,i)}this._cursor.offset+=e>>3}else this.size+=e>>3},i.prototype._writeUint=function(e,t){if(this._rawo){var n,r,i=this._cursor.offset-this._rawo.byteOffset;switch(e){case 8:this._rawo.setUint8(i,t);break;case 16:this._rawo.setUint16(i,t);break;case 24:n=(16776960&t)>>8,r=255&t,this._rawo.setUint16(i,n),this._rawo.setUint8(i+2,r);break;case 32:this._rawo.setUint32(i,t);break;case 64:n=Math.floor(t/Math.pow(2,32)),r=t-n*Math.pow(2,32),this._rawo.setUint32(i,n),this._rawo.setUint32(i+4,r)}this._cursor.offset+=e>>3}else this.size+=e>>3},i.prototype._writeString=function(e,t){for(var n=0;n<e;n++)this._writeUint(8,t.charCodeAt(n))},i.prototype._writeTerminatedString=function(e){if(0!==e.length){for(var t=0;t<e.length;t++)this._writeUint(8,e.charCodeAt(t));this._writeUint(8,0)}},i.prototype._writeTemplate=function(e,t){var n=Math.floor(t),r=(t-n)*Math.pow(2,e/2);this._writeUint(e/2,n),this._writeUint(e/2,r)},i.prototype._writeData=function(e){var t;if(e)if(this._rawo){if(e instanceof Array){for(var n=this._cursor.offset-this._rawo.byteOffset,t=0;t<e.length;t++)this._rawo.setInt8(n+t,e[t]);this._cursor.offset+=e.length}e instanceof Uint8Array&&(this._root.bytes.set(e,this._cursor.offset),this._cursor.offset+=e.length)}else this.size+=e.length},i.prototype._writeUTF8String=function(e){var t=n.Utils.utf8ToByteArray(e);if(this._rawo)for(var r=new DataView(this._rawo.buffer,this._cursor.offset,t.length),i=0;i<t.length;i++)r.setUint8(i,t[i]);else this.size+=t.length},i.prototype._writeField=function(e,t,n){switch(e){case"uint":this._writeUint(t,n);break;case"int":this._writeInt(t,n);break;case"template":this._writeTemplate(t,n);break;case"string":-1==t?this._writeTerminatedString(n):this._writeString(t,n);break;case"data":this._writeData(n);break;case"utf8":this._writeUTF8String(n)}},i.prototype._boxProcessors.avc1=i.prototype._boxProcessors.encv=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procField("pre_defined1","uint",16),this._procField("reserved2","uint",16),this._procFieldArray("pre_defined2",3,"uint",32),this._procField("width","uint",16),this._procField("height","uint",16),this._procField("horizresolution","template",32),this._procField("vertresolution","template",32),this._procField("reserved3","uint",32),this._procField("frame_count","uint",16),this._procFieldArray("compressorname",32,"uint",8),this._procField("depth","uint",16),this._procField("pre_defined3","int",16),this._procField("config","data",-1)},i.prototype._boxProcessors.dref=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count)},i.prototype._boxProcessors.elst=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,function(e){this._procEntryField(e,"segment_duration","uint",1===this.version?64:32),this._procEntryField(e,"media_time","int",1===this.version?64:32),this._procEntryField(e,"media_rate_integer","int",16),this._procEntryField(e,"media_rate_fraction","int",16)})},i.prototype._boxProcessors.emsg=function(){this._procFullBox(),1==this.version?(this._procField("timescale","uint",32),this._procField("presentation_time","uint",64),this._procField("event_duration","uint",32),this._procField("id","uint",32),this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1)):(this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1),this._procField("timescale","uint",32),this._procField("presentation_time_delta","uint",32),this._procField("event_duration","uint",32),this._procField("id","uint",32)),this._procField("message_data","data",-1)},i.prototype._boxProcessors.free=i.prototype._boxProcessors.skip=function(){this._procField("data","data",-1)},i.prototype._boxProcessors.frma=function(){this._procField("data_format","uint",32)},i.prototype._boxProcessors.ftyp=i.prototype._boxProcessors.styp=function(){this._procField("major_brand","string",4),this._procField("minor_version","uint",32);var e=-1;this._parsing&&(e=(this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset))/4),this._procFieldArray("compatible_brands",e,"string",4)},i.prototype._boxProcessors.hdlr=function(){this._procFullBox(),this._procField("pre_defined","uint",32),this._procField("handler_type","string",4),this._procFieldArray("reserved",3,"uint",32),this._procField("name","string",-1)},i.prototype._boxProcessors.mdat=function(){this._procField("data","data",-1)},i.prototype._boxProcessors.mdhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",1==this.version?64:32),this._parsing||"string"!=typeof this.language||(this.language=this.language.charCodeAt(0)-96<<10|this.language.charCodeAt(1)-96<<5|this.language.charCodeAt(2)-96),this._procField("language","uint",16),this._parsing&&(this.language=String.fromCharCode(96+(this.language>>10&31),96+(this.language>>5&31),96+(31&this.language))),this._procField("pre_defined","uint",16)},i.prototype._boxProcessors.mehd=function(){this._procFullBox(),this._procField("fragment_duration","uint",1==this.version?64:32)},i.prototype._boxProcessors.mfhd=function(){this._procFullBox(),this._procField("sequence_number","uint",32)},i.prototype._boxProcessors.mfro=function(){this._procFullBox(),this._procField("mfra_size","uint",32)},i.prototype._boxProcessors.mp4a=i.prototype._boxProcessors.enca=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procField("channelcount","uint",16),this._procField("samplesize","uint",16),this._procField("pre_defined","uint",16),this._procField("reserved3","uint",16),this._procField("samplerate","template",32),this._procField("esds","data",-1)},i.prototype._boxProcessors.mvhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",1==this.version?64:32),this._procField("rate","template",32),this._procField("volume","template",16),this._procField("reserved1","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procFieldArray("matrix",9,"template",32),this._procFieldArray("pre_defined",6,"uint",32),this._procField("next_track_ID","uint",32)},i.prototype._boxProcessors.payl=function(){this._procField("cue_text","utf8")},i.prototype._boxProcessors.pssh=function(){this._procFullBox(),this._procFieldArray("SystemID",16,"uint",8),this._procField("DataSize","uint",32),this._procFieldArray("Data",this.DataSize,"uint",8)},i.prototype._boxProcessors.schm=function(){this._procFullBox(),this._procField("scheme_type","uint",32),this._procField("scheme_version","uint",32),1&this.flags&&this._procField("scheme_uri","string",-1)},i.prototype._boxProcessors.sdtp=function(){this._procFullBox();var e=-1;this._parsing&&(e=this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset)),this._procFieldArray("sample_dependency_table",e,"uint",8)},i.prototype._boxProcessors.sidx=function(){this._procFullBox(),this._procField("reference_ID","uint",32),this._procField("timescale","uint",32),this._procField("earliest_presentation_time","uint",1==this.version?64:32),this._procField("first_offset","uint",1==this.version?64:32),this._procField("reserved","uint",16),this._procField("reference_count","uint",16),this._procEntries("references",this.reference_count,function(e){this._parsing||(e.reference=(1&e.reference_type)<<31,e.reference|=2147483647&e.referenced_size,e.sap=(1&e.starts_with_SAP)<<31,e.sap|=(3&e.SAP_type)<<28,e.sap|=268435455&e.SAP_delta_time),this._procEntryField(e,"reference","uint",32),this._procEntryField(e,"subsegment_duration","uint",32),this._procEntryField(e,"sap","uint",32),this._parsing&&(e.reference_type=e.reference>>31&1,e.referenced_size=2147483647&e.reference,e.starts_with_SAP=e.sap>>31&1,e.SAP_type=e.sap>>28&7,e.SAP_delta_time=268435455&e.sap)})},i.prototype._boxProcessors.smhd=function(){this._procFullBox(),this._procField("balance","uint",16),this._procField("reserved","uint",16)},i.prototype._boxProcessors.ssix=function(){this._procFullBox(),this._procField("subsegment_count","uint",32),this._procEntries("subsegments",this.subsegment_count,function(e){this._procEntryField(e,"ranges_count","uint",32),this._procSubEntries(e,"ranges",e.ranges_count,function(e){this._procEntryField(e,"level","uint",8),this._procEntryField(e,"range_size","uint",24)})})},i.prototype._boxProcessors.stsd=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count)},i.prototype._boxProcessors.subs=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,function(e){this._procEntryField(e,"sample_delta","uint",32),this._procEntryField(e,"subsample_count","uint",16),this._procSubEntries(e,"subsamples",e.subsample_count,function(e){this._procEntryField(e,"subsample_size","uint",1===this.version?32:16),this._procEntryField(e,"subsample_priority","uint",8),this._procEntryField(e,"discardable","uint",8),this._procEntryField(e,"codec_specific_parameters","uint",32)})})},i.prototype._boxProcessors.tenc=function(){this._procFullBox(),this._procField("default_IsEncrypted","uint",24),this._procField("default_IV_size","uint",8),this._procFieldArray("default_KID",16,"uint",8)},i.prototype._boxProcessors.tfdt=function(){this._procFullBox(),this._procField("baseMediaDecodeTime","uint",1==this.version?64:32)},i.prototype._boxProcessors.tfhd=function(){this._procFullBox(),this._procField("track_ID","uint",32),1&this.flags&&this._procField("base_data_offset","uint",64),2&this.flags&&this._procField("sample_description_offset","uint",32),8&this.flags&&this._procField("default_sample_duration","uint",32),16&this.flags&&this._procField("default_sample_size","uint",32),32&this.flags&&this._procField("default_sample_flags","uint",32)},i.prototype._boxProcessors.tfra=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._parsing||(this.reserved=0,this.reserved|=(48&this.length_size_of_traf_num)<<4,this.reserved|=(12&this.length_size_of_trun_num)<<2,this.reserved|=3&this.length_size_of_sample_num),this._procField("reserved","uint",32),this._parsing&&(this.length_size_of_traf_num=(48&this.reserved)>>4,this.length_size_of_trun_num=(12&this.reserved)>>2,this.length_size_of_sample_num=3&this.reserved),this._procField("number_of_entry","uint",32),this._procEntries("entries",this.number_of_entry,function(e){this._procEntryField(e,"time","uint",1===this.version?64:32),this._procEntryField(e,"moof_offset","uint",1===this.version?64:32),this._procEntryField(e,"traf_number","uint",8*(this.length_size_of_traf_num+1)),this._procEntryField(e,"trun_number","uint",8*(this.length_size_of_trun_num+1)),this._procEntryField(e,"sample_number","uint",8*(this.length_size_of_sample_num+1))})},i.prototype._boxProcessors.tkhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("track_ID","uint",32),this._procField("reserved1","uint",32),this._procField("duration","uint",1==this.version?64:32),this._procFieldArray("reserved2",2,"uint",32),this._procField("layer","uint",16),this._procField("alternate_group","uint",16),this._procField("volume","template",16),this._procField("reserved3","uint",16),this._procFieldArray("matrix",9,"template",32),this._procField("width","template",32),this._procField("height","template",32)},i.prototype._boxProcessors.trex=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._procField("default_sample_description_index","uint",32),this._procField("default_sample_duration","uint",32),this._procField("default_sample_size","uint",32),this._procField("default_sample_flags","uint",32)},i.prototype._boxProcessors.trun=function(){this._procFullBox(),this._procField("sample_count","uint",32),1&this.flags&&this._procField("data_offset","int",32),4&this.flags&&this._procField("first_sample_flags","uint",32),this._procEntries("samples",this.sample_count,function(e){256&this.flags&&this._procEntryField(e,"sample_duration","uint",32),512&this.flags&&this._procEntryField(e,"sample_size","uint",32),1024&this.flags&&this._procEntryField(e,"sample_flags","uint",32),2048&this.flags&&this._procEntryField(e,"sample_composition_time_offset",1===this.version?"int":"uint",32)})},i.prototype._boxProcessors["url "]=i.prototype._boxProcessors["urn "]=function(){this._procFullBox(),"urn "===this.type&&this._procField("name","string",-1),this._procField("location","string",-1)},i.prototype._boxProcessors.vlab=function(){this._procField("source_label","utf8")},i.prototype._boxProcessors.vmhd=function(){this._procFullBox(),this._procField("graphicsmode","uint",16),this._procFieldArray("opcolor",3,"uint",16)},i.prototype._boxProcessors.vttC=function(){this._procField("config","utf8")},i.prototype._boxProcessors.vtte=function(){}}),jl=(ql.parseBuffer,ql.addBoxProcessor,ql.createFile,ql.createBox,ql.createFullBox,ql.Utils,function e(t,n,r){d(this,e),this.lastCompletedOffset=t,this.found=n,this.size=r});I.__dashjs_factory_name="BoxParser";var zl=nu.getSingletonFactory(I);N.__dashjs_factory_name="CustomTimeRanges";var Wl=nu.getClassFactory(N),Xl=Math.max,Ql=Math.min,Zl=Math.floor,$l=/\$([$&`']|\d\d?|<[^>]*>)/g,Jl=/\$([$&`']|\d\d?)/g,ec=function(e){return void 0===e?e:String(e)};Pu("replace",2,function(e,t,n,r){function i(e,t,r,i,a,o){var s=r+e.length,u=i.length,l=Jl;return void 0!==a&&(a=Os(a),l=$l),n.call(o,l,function(n,o){var l;switch(o.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,r);case"'":return t.slice(s);case"<":l=a[o.slice(1,-1)];break;default:var c=+o;if(0===c)return o;if(c>u){var f=Zl(c/10);return 0===f?o:f<=u?void 0===i[f-1]?o.charAt(1):i[f-1]+o.charAt(1):o}l=i[c-1]}return void 0===l?"":l})}return[function(r,i){var a=e(this),o=void 0==r?void 0:r[t];return void 0!==o?o.call(r,a,i):n.call(String(a),r,i)},function(e,t){var a=r(n,e,this,t);if(a.done)return a.value;var o=Ba(e),s=String(this),u="function"==typeof t;u||(t=String(t));var l=o.global;if(l){var c=o.unicode;o.lastIndex=0}for(var f=[];;){var d=Ru(o,s);if(null===d)break;if(f.push(d),!l)break;""===String(d[0])&&(o.lastIndex=Su(s,No(o.lastIndex),c))}for(var h="",g=0,p=0;p<f.length;p++){d=f[p];for(var E=String(d[0]),m=Xl(Ql(Mo(d.index),s.length),0),_=[],y=1;y<d.length;y++)_.push(ec(d[y]));var T=d.groups;if(u){var v=[E].concat(_,m,s);void 0!==T&&v.push(T);var S=String(t.apply(void 0,v))}else S=i(E,s,m,_,T,t);m>=g&&(h+=s.slice(g,m)+S,g=m+E.length)}return h+s.slice(g)}]});var tc=c(function(e,t){!function(e){e.ns_tt="http://www.w3.org/ns/ttml",e.ns_tts="http://www.w3.org/ns/ttml#styling",e.ns_ttp="http://www.w3.org/ns/ttml#parameter",e.ns_xml="http://www.w3.org/XML/1998/namespace",e.ns_itts="http://www.w3.org/ns/ttml/profile/imsc1#styling",e.ns_ittp="http://www.w3.org/ns/ttml/profile/imsc1#parameter",e.ns_smpte="http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt",e.ns_ebutts="urn:ebu:tt:style"}(t)}),nc=c(function(e,t){!function(e){var t=/#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})?/,n=/rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,r=/rgba\(\s*(\d+),\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,i={transparent:[0,0,0,0],black:[0,0,0,255],silver:[192,192,192,255],gray:[128,128,128,255],white:[255,255,255,255],maroon:[128,0,0,255],red:[255,0,0,255],purple:[128,0,128,255],fuchsia:[255,0,255,255],magenta:[255,0,255,255],green:[0,128,0,255],lime:[0,255,0,255],olive:[128,128,0,255],yellow:[255,255,0,255],navy:[0,0,128,255],blue:[0,0,255,255],teal:[0,128,128,255],aqua:[0,255,255,255],cyan:[0,255,255,255]};e.parseColor=function(e){var a,o=null,s=i[e.toLowerCase()];return void 0!==s?o=s:null!==(a=t.exec(e))?o=[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16),void 0!==a[4]?parseInt(a[4],16):255]:null!==(a=n.exec(e))?o=[parseInt(a[1]),parseInt(a[2]),parseInt(a[3]),255]:null!==(a=r.exec(e))&&(o=[parseInt(a[1]),parseInt(a[2]),parseInt(a[3]),parseInt(a[4])]),o};var a=/^((?:\+|\-)?\d*(?:\.\d+)?)(px|em|c|%)$/;e.parseLength=function(e){var t,n=null;return null!==(t=a.exec(e))&&(n={value:parseFloat(t[1]),unit:t[2]}),n}}(t)}),rc=c(function(e,t){!function(e,t,n){function r(e,t,n,r,i,a,o,s){this.name=t,this.ns=e,this.qname=e+" "+t,this.inherit=i,this.animatable=a,this.initial=n,this.applies=r,this.parse=o,this.compute=s}e.all=[new r(t.ns_tts,"backgroundColor","transparent",["body","div","p","region","span"],!1,!0,n.parseColor,null),new r(t.ns_tts,"color","white",["span"],!0,!0,n.parseColor,null),new r(t.ns_tts,"direction","ltr",["p","span"],!0,!0,function(e){return e},null),new r(t.ns_tts,"display","auto",["body","div","p","region","span"],!1,!0,function(e){return e},null),new r(t.ns_tts,"displayAlign","before",["region"],!1,!0,function(e){return e},null),new r(t.ns_tts,"extent","auto",["tt","region"],!1,!0,function(e){if("auto"===e)return e;var t=e.split(" ");if(2!==t.length)return null;var r=n.parseLength(t[0]),i=n.parseLength(t[1]);return i&&r?{h:i,w:r}:null},function(e,t,n,r,i){var a,o;if("auto"===r)a=1;else if("%"===r.h.unit)a=r.h.value/100;else{if("px"!==r.h.unit)return null;a=r.h.value/e.pxDimensions.h}if("auto"===r)o=1;else if("%"===r.w.unit)o=r.w.value/100;else{if("px"!==r.w.unit)return null;o=r.w.value/e.pxDimensions.w}return{h:a,w:o}}),new r(t.ns_tts,"fontFamily","default",["span"],!0,!0,function(e){var t=e.split(","),n=[];for(var r in t)"'"!==t[r].charAt(0)&&'"'!==t[r].charAt(0)&&"default"===t[r]?n.push("monospaceSerif"):n.push(t[r]);return n},null),new r(t.ns_tts,"fontSize","1c",["span"],!0,!0,n.parseLength,function(t,n,r,i,a){var o;if("%"===i.unit)o=null!==n?n.styleAttrs[e.byName.fontSize.qname]*i.value/100:i.value/100/t.cellResolution.h;else if("em"===i.unit)o=null!==n?n.styleAttrs[e.byName.fontSize.qname]*i.value:i.value/t.cellResolution.h;else if("c"===i.unit)o=i.value/t.cellResolution.h;else{if("px"!==i.unit)return null;o=i.value/t.pxDimensions.h}return o}),new r(t.ns_tts,"fontStyle","normal",["span"],!0,!0,function(e){return e},null),new r(t.ns_tts,"fontWeight","normal",["span"],!0,!0,function(e){return e},null),new r(t.ns_tts,"lineHeight","normal",["p"],!0,!0,function(e){return"normal"===e?e:n.parseLength(e)},function(t,n,r,i,a){var o;if("normal"===i)o=i;else if("%"===i.unit)o=r.styleAttrs[e.byName.fontSize.qname]*i.value/100;else if("em"===i.unit)o=r.styleAttrs[e.byName.fontSize.qname]*i.value;else if("c"===i.unit)o=i.value/t.cellResolution.h;else{if("px"!==i.unit)return null;o=i.value/t.pxDimensions.h}return o}),new r(t.ns_tts,"opacity",1,["region"],!1,!0,parseFloat,null),new r(t.ns_tts,"origin","auto",["region"],!1,!0,function(e){if("auto"===e)return e;var t=e.split(" ");if(2!==t.length)return null;var r=n.parseLength(t[0]),i=n.parseLength(t[1]);return i&&r?{h:i,w:r}:null},function(e,t,n,r,i){var a,o;if("auto"===r)a=0;else if("%"===r.h.unit)a=r.h.value/100;else{if("px"!==r.h.unit)return null;a=r.h.value/e.pxDimensions.h}if("auto"===r)o=0;else if("%"===r.w.unit)o=r.w.value/100;else{if("px"!==r.w.unit)return null;o=r.w.value/e.pxDimensions.w}return{h:a,w:o}}),new r(t.ns_tts,"overflow","hidden",["region"],!1,!0,function(e){return e},null),new r(t.ns_tts,"padding","0px",["region"],!1,!0,function(e){var t=e.split(" ");if(t.length>4)return null;var r=[];for(var i in t){var a=n.parseLength(t[i]);if(!a)return null;r.push(a)}return r},function(t,n,r,i,a){var o;if(1===i.length)o=[i[0],i[0],i[0],i[0]];else if(2===i.length)o=[i[0],i[1],i[0],i[1]];else if(3===i.length)o=[i[0],i[1],i[2],i[1]];else{if(4!==i.length)return null;o=[i[0],i[1],i[2],i[3]]}var s=r.styleAttrs[e.byName.writingMode.qname];if("lrtb"===s||"lr"===s)o=[o[0],o[3],o[2],o[1]];else if("rltb"===s||"rl"===s)o=[o[0],o[1],o[2],o[3]];else if("tblr"===s)o=[o[3],o[0],o[1],o[2]];else{if("tbrl"!==s&&"tb"!==s)return null;o=[o[3],o[2],o[1],o[0]]}var u=[];for(var l in o)if(0===o[l].value)u[l]=0;else if("%"===o[l].unit)u[l]="0"===l||"2"===l?r.styleAttrs[e.byName.extent.qname].h*o[l].value/100:r.styleAttrs[e.byName.extent.qname].w*o[l].value/100;else if("em"===o[l].unit)u[l]=r.styleAttrs[e.byName.fontSize.qname]*o[l].value;else if("c"===o[l].unit)u[l]=o[l].value/t.cellResolution.h;else{if("px"!==o[l].unit)return null;u[l]="0"===l||"2"===l?o[l].value/t.pxDimensions.h:o[l].value/t.pxDimensions.w}return u}),new r(t.ns_tts,"showBackground","always",["region"],!1,!0,function(e){return e},null),new r(t.ns_tts,"textAlign","start",["p"],!0,!0,function(e){return e},function(e,t,n,r,i){return"left"===r?"start":"right"===r?"end":r}),new r(t.ns_tts,"textDecoration","none",["span"],!0,!0,function(e){return e.split(" ")},null),new r(t.ns_tts,"textOutline","none",["span"],!0,!0,function(e){if("none"===e)return e;var t={},r=e.split(" ");if(0===r.length||r.length>2)return null;var i=n.parseColor(r[0]);if(t.color=i,null!==i&&r.shift(),1!==r.length)return null;var a=n.parseLength(r[0]);return a?(t.thickness=a,t):null},function(t,n,r,i,a){if("none"===i)return i;var o={};if(null===i.color?o.color=r.styleAttrs[e.byName.color.qname]:o.color=i.color,"%"===i.thickness.unit)o.thickness=r.styleAttrs[e.byName.fontSize.qname]*i.thickness.value/100;else if("em"===i.thickness.unit)o.thickness=r.styleAttrs[e.byName.fontSize.qname]*i.thickness.value;else if("c"===i.thickness.unit)o.thickness=i.thickness.value/t.cellResolution.h;else{if("px"!==i.thickness.unit)return null;o.thickness=i.thickness.value/t.pxDimensions.h}return o}),new r(t.ns_tts,"unicodeBidi","normal",["span","p"],!1,!0,function(e){return e},null),new r(t.ns_tts,"visibility","visible",["body","div","p","region","span"],!0,!0,function(e){return e},null),new r(t.ns_tts,"wrapOption","wrap",["span"],!0,!0,function(e){return e},null),new r(t.ns_tts,"writingMode","lrtb",["region"],!1,!0,function(e){return e},null),new r(t.ns_tts,"zIndex","auto",["region"],!1,!0,function(e){var t;return"auto"===e?t=e:(t=parseInt(e),isNaN(t)&&(t=null)),t},null),new r(t.ns_ebutts,"linePadding","0c",["p"],!0,!1,n.parseLength,function(e,t,n,r,i){return"c"===r.unit?r.value/e.cellResolution.h:null
}),new r(t.ns_ebutts,"multiRowAlign","auto",["p"],!0,!1,function(e){return e},null),new r(t.ns_smpte,"backgroundImage",null,["div"],!1,!1,function(e){return e},null),new r(t.ns_itts,"forcedDisplay","false",["body","div","p","region","span"],!0,!0,function(e){return"true"===e},null),new r(t.ns_itts,"fillLineGap","false",["p"],!0,!0,function(e){return"true"===e},null)],e.byQName={};for(var i in e.all)e.byQName[e.all[i].qname]=e.all[i];e.byName={};for(var a in e.all)e.byName[e.all[a].name]=e.all[a]}(t,"undefined"==typeof imscNames?tc:imscNames,"undefined"==typeof imscUtils?nc:imscUtils)}),ic=c(function(e,t){!function(e,t,n){function r(e,t,o,l,c,f,d,h,g){if(t<d.begin||t>=d.end)return null;var p="regionID"in d&&""!==d.regionID?d.regionID:f;if(null!==c&&p!==o.id&&(!("contents"in d)||"contents"in d&&0===d.contents.length||""!==p))return null;var E=new s(d);for(var m in d.sets)t<d.sets[m].begin||t>=d.sets[m].end||(E.styleAttrs[d.sets[m].qname]=d.sets[m].value);var _={};for(var y in E.styleAttrs)if(_[y]=!0,y===n.byName.writingMode.qname&&!(n.byName.direction.qname in E.styleAttrs)){var T=E.styleAttrs[y];"lrtb"===T||"lr"===T?E.styleAttrs[n.byName.direction.qname]="ltr":"rltb"!==T&&"rl"!==T||(E.styleAttrs[n.byName.direction.qname]="rtl")}if(null!==c)for(var v in n.all){var S=n.all[v];if(S.qname===n.byName.textDecoration.qname){var A=c.styleAttrs[S.qname],R=E.styleAttrs[S.qname],I=[];void 0===R?I=A:-1===R.indexOf("none")?((-1===R.indexOf("noUnderline")&&-1!==A.indexOf("underline")||-1!==R.indexOf("underline"))&&I.push("underline"),(-1===R.indexOf("noLineThrough")&&-1!==A.indexOf("lineThrough")||-1!==R.indexOf("lineThrough"))&&I.push("lineThrough"),(-1===R.indexOf("noOverline")&&-1!==A.indexOf("overline")||-1!==R.indexOf("overline"))&&I.push("overline")):I.push("none"),E.styleAttrs[S.qname]=I}else S.inherit&&S.qname in c.styleAttrs&&!(S.qname in E.styleAttrs)&&(E.styleAttrs[S.qname]=c.styleAttrs[S.qname])}for(var D in n.all){var b=n.all[D];b.qname in E.styleAttrs||("region"===E.kind||!1===b.inherit&&null!==b.initial)&&(E.styleAttrs[b.qname]=b.parse(b.initial),_[b.qname]=!0)}for(var M in n.all){var C=n.all[M];if(C.qname in _&&null!==C.compute){var N=C.compute(e,c,E,E.styleAttrs[C.qname],g);null!==N?E.styleAttrs[C.qname]=N:u(h,"Style '"+C.qname+"' on element '"+E.kind+"' cannot be computed")}}if("none"===E.styleAttrs[n.byName.display.qname])return null;var w;null===c?w=null===l?[]:[l]:"contents"in d&&(w=d.contents);for(var O in w){var L=r(e,t,o,l,E,p,w[O],h,g);null!==L&&E.contents.push(L.element)}for(var P in E.styleAttrs){-1===n.byQName[P].applies.indexOf(E.kind)&&delete E.styleAttrs[P]}if("span"===E.kind&&E.text&&"default"===E.space){var F=E.text.replace(/\s+/g," ");E.text=F}if("p"===E.kind){var x=[];i(E,x);for(var U=0,B="after_br",k=0;;)if("after_br"===B)U>=x.length||"br"===x[U].kind?(B="before_br",k=U,U--):("preserve"!==x[U].space&&(x[U].text=x[U].text.replace(/^\s+/g,"")),x[U].text.length>0?(B="looking_br",U++):x.splice(U,1));else if("before_br"===B)if(U<0||"br"===x[U].kind){if(B="after_br",(U=k+1)>=x.length)break}else if("preserve"!==x[U].space&&(x[U].text=x[U].text.replace(/\s+$/g,"")),x[U].text.length>0){if(B="after_br",(U=k+1)>=x.length)break}else x.splice(U,1),U--;else U>=x.length||"br"===x[U].kind?(B="before_br",k=U,U--):U++;a(E)}return"div"===E.kind&&n.byName.backgroundImage.qname in E.styleAttrs||"br"===E.kind||"contents"in E&&E.contents.length>0||"span"===E.kind&&null!==E.text||"region"===E.kind&&"always"===E.styleAttrs[n.byName.showBackground.qname]?{region_id:p,element:E}:null}function i(e,t){if("contents"in e)for(var n in e.contents)i(e.contents[n],t);else t.push(e)}function a(e){if("br"===e.kind)return!1;if("text"in e)return 0===e.text.length;if("contents"in e){for(var t=e.contents.length;t--;)a(e.contents[t])&&e.contents.splice(t,1);return 0===e.contents.length}}function o(e){this.contents=[],this.aspectRatio=e.aspectRatio}function s(e){this.kind=e.kind||"region",e.id&&(this.id=e.id),this.styleAttrs={};for(var t in e.styleAttrs)this.styleAttrs[t]=e.styleAttrs[t];"text"in e?this.text=e.text:"br"!==e.kind&&(this.contents=[]),"space"in e&&(this.space=e.space)}function u(e,t){if(e&&e.error&&e.error(t))throw t}e.generateISD=function(e,t,n){var i=new o(e),a={};for(var s in e.head.layout.regions){var u=r(e,t,e.head.layout.regions[s],e.body,null,"",e.head.layout.regions[s],n,a);null!==u&&i.contents.push(u.element)}return i}}(t,"undefined"==typeof imscNames||imscNames,"undefined"==typeof imscStyles?rc:imscStyles)}),ac=[],oc=[],sc="undefined"!=typeof Uint8Array?Uint8Array:Array,uc=!1,lc={}.toString,cc=Array.isArray||function(e){return"[object Array]"==lc.call(e)};G.TYPED_ARRAY_SUPPORT=void 0===Pa.TYPED_ARRAY_SUPPORT||Pa.TYPED_ARRAY_SUPPORT,G.poolSize=8192,G._augment=function(e){return e.__proto__=G.prototype,e},G.from=function(e,t,n){return Y(null,e,t,n)},G.TYPED_ARRAY_SUPPORT&&(G.prototype.__proto__=Uint8Array.prototype,G.__proto__=Uint8Array),G.alloc=function(e,t,n){return V(null,e,t,n)},G.allocUnsafe=function(e){return H(null,e)},G.allocUnsafeSlow=function(e){return H(null,e)},G.isBuffer=we,G.compare=function(e,t){if(!Q(e)||!Q(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,a=Math.min(n,r);i<a;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},G.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},G.concat=function(e,t){if(!cc(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return G.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=G.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var a=e[n];if(!Q(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,i),i+=a.length}return r},G.byteLength=Z,G.prototype._isBuffer=!0,G.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)J(this,t,t+1);return this},G.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)J(this,t,t+3),J(this,t+1,t+2);return this},G.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)J(this,t,t+7),J(this,t+1,t+6),J(this,t+2,t+5),J(this,t+3,t+4);return this},G.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?le(this,0,e):$.apply(this,arguments)},G.prototype.equals=function(e){if(!Q(e))throw new TypeError("Argument must be a Buffer");return this===e||0===G.compare(this,e)},G.prototype.inspect=function(){var e="";return this.length>0&&(e=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(e+=" ... ")),"<Buffer "+e+">"},G.prototype.compare=function(e,t,n,r,i){if(!Q(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,r>>>=0,i>>>=0,this===e)return 0;for(var a=i-r,o=n-t,s=Math.min(a,o),u=this.slice(r,i),l=e.slice(t,n),c=0;c<s;++c)if(u[c]!==l[c]){a=u[c],o=l[c];break}return a<o?-1:o<a?1:0},G.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},G.prototype.indexOf=function(e,t,n){return ee(this,e,t,n,!0)},G.prototype.lastIndexOf=function(e,t,n){return ee(this,e,t,n,!1)},G.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var a=!1;;)switch(r){case"hex":return ne(this,e,t,n);case"utf8":case"utf-8":return re(this,e,t,n);case"ascii":return ie(this,e,t,n);case"latin1":case"binary":return ae(this,e,t,n);case"base64":return oe(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return se(this,e,t,n);default:if(a)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),a=!0}},G.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var fc=4096;G.prototype.slice=function(e,t){var n=this.length;e=~~e,t=void 0===t?n:~~t,e<0?(e+=n)<0&&(e=0):e>n&&(e=n),t<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);var r;if(G.TYPED_ARRAY_SUPPORT)r=this.subarray(e,t),r.__proto__=G.prototype;else{var i=t-e;r=new G(i,void 0);for(var a=0;a<i;++a)r[a]=this[a+e]}return r},G.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||pe(e,t,this.length);for(var r=this[e],i=1,a=0;++a<t&&(i*=256);)r+=this[e+a]*i;return r},G.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||pe(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},G.prototype.readUInt8=function(e,t){return t||pe(e,1,this.length),this[e]},G.prototype.readUInt16LE=function(e,t){return t||pe(e,2,this.length),this[e]|this[e+1]<<8},G.prototype.readUInt16BE=function(e,t){return t||pe(e,2,this.length),this[e]<<8|this[e+1]},G.prototype.readUInt32LE=function(e,t){return t||pe(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},G.prototype.readUInt32BE=function(e,t){return t||pe(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},G.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||pe(e,t,this.length);for(var r=this[e],i=1,a=0;++a<t&&(i*=256);)r+=this[e+a]*i;return i*=128,r>=i&&(r-=Math.pow(2,8*t)),r},G.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||pe(e,t,this.length);for(var r=t,i=1,a=this[e+--r];r>0&&(i*=256);)a+=this[e+--r]*i;return i*=128,a>=i&&(a-=Math.pow(2,8*t)),a},G.prototype.readInt8=function(e,t){return t||pe(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},G.prototype.readInt16LE=function(e,t){t||pe(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},G.prototype.readInt16BE=function(e,t){t||pe(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},G.prototype.readInt32LE=function(e,t){return t||pe(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},G.prototype.readInt32BE=function(e,t){return t||pe(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},G.prototype.readFloatLE=function(e,t){return t||pe(e,4,this.length),x(this,e,!0,23,4)},G.prototype.readFloatBE=function(e,t){return t||pe(e,4,this.length),x(this,e,!1,23,4)},G.prototype.readDoubleLE=function(e,t){return t||pe(e,8,this.length),x(this,e,!0,52,8)},G.prototype.readDoubleBE=function(e,t){return t||pe(e,8,this.length),x(this,e,!1,52,8)},G.prototype.writeUIntLE=function(e,t,n,r){if(e=+e,t|=0,n|=0,!r){Ee(this,e,t,n,Math.pow(2,8*n)-1,0)}var i=1,a=0;for(this[t]=255&e;++a<n&&(i*=256);)this[t+a]=e/i&255;return t+n},G.prototype.writeUIntBE=function(e,t,n,r){if(e=+e,t|=0,n|=0,!r){Ee(this,e,t,n,Math.pow(2,8*n)-1,0)}var i=n-1,a=1;for(this[t+i]=255&e;--i>=0&&(a*=256);)this[t+i]=e/a&255;return t+n},G.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||Ee(this,e,t,1,255,0),G.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},G.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||Ee(this,e,t,2,65535,0),G.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):me(this,e,t,!0),t+2},G.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||Ee(this,e,t,2,65535,0),G.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):me(this,e,t,!1),t+2},G.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||Ee(this,e,t,4,4294967295,0),G.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):_e(this,e,t,!0),t+4},G.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||Ee(this,e,t,4,4294967295,0),G.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):_e(this,e,t,!1),t+4},G.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);Ee(this,e,t,n,i-1,-i)}var a=0,o=1,s=0;for(this[t]=255&e;++a<n&&(o*=256);)e<0&&0===s&&0!==this[t+a-1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+n},G.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);Ee(this,e,t,n,i-1,-i)}var a=n-1,o=1,s=0;for(this[t+a]=255&e;--a>=0&&(o*=256);)e<0&&0===s&&0!==this[t+a+1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+n},G.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||Ee(this,e,t,1,127,-128),G.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},G.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||Ee(this,e,t,2,32767,-32768),G.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):me(this,e,t,!0),t+2},G.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||Ee(this,e,t,2,32767,-32768),G.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):me(this,e,t,!1),t+2},G.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||Ee(this,e,t,4,2147483647,-2147483648),G.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):_e(this,e,t,!0),t+4},G.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||Ee(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),G.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):_e(this,e,t,!1),t+4},G.prototype.writeFloatLE=function(e,t,n){return Te(this,e,t,!0,n)},G.prototype.writeFloatBE=function(e,t,n){return Te(this,e,t,!1,n)},G.prototype.writeDoubleLE=function(e,t,n){return ve(this,e,t,!0,n)},G.prototype.writeDoubleBE=function(e,t,n){return ve(this,e,t,!1,n)},G.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,a=r-n;if(this===e&&n<t&&t<r)for(i=a-1;i>=0;--i)e[i+t]=this[i+n];else if(a<1e3||!G.TYPED_ARRAY_SUPPORT)for(i=0;i<a;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+a),t);return a},G.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!G.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0);var a;if("number"==typeof e)for(a=t;a<n;++a)this[a]=e;else{var o=Q(e)?e:Ie(new G(e,r).toString()),s=o.length;for(a=0;a<n-t;++a)this[a+t]=o[a%s]}return this};var dc=/[^+\/0-9A-Za-z-_]/g;Pe.prototype=Object.create(null),Fe.EventEmitter=Fe,Fe.usingDomains=!1,Fe.prototype.domain=void 0,Fe.prototype._events=void 0,Fe.prototype._maxListeners=void 0,Fe.defaultMaxListeners=10,Fe.init=function(){this.domain=null,Fe.usingDomains&&(!(void 0).active||this instanceof(void 0).Domain||(this.domain=(void 0).active)),this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new Pe,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Fe.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},Fe.prototype.getMaxListeners=function(){return xe(this)},Fe.prototype.emit=function(e){var t,n,r,i,a,o,s,u="error"===e;if(o=this._events)u=u&&null==o.error;else if(!u)return!1;if(s=this.domain,u){if(t=arguments[1],!s){if(t instanceof Error)throw t;var l=new Error('Uncaught, unspecified "error" event. ('+t+")");throw l.context=t,l}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=s,t.domainThrown=!1,s.emit("error",t),!1}if(!(n=o[e]))return!1;var c="function"==typeof n;switch(r=arguments.length){case 1:Ue(n,c,this);break;case 2:Be(n,c,this,arguments[1]);break;case 3:ke(n,c,this,arguments[1],arguments[2]);break;case 4:Ge(n,c,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(r-1),a=1;a<r;a++)i[a-1]=arguments[a];Ye(n,c,this,i)}return!0},Fe.prototype.addListener=function(e,t){return Ke(this,e,t,!1)},Fe.prototype.on=Fe.prototype.addListener,Fe.prototype.prependListener=function(e,t){return Ke(this,e,t,!0)},Fe.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,He(this,e,t)),this},Fe.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,He(this,e,t)),this},Fe.prototype.removeListener=function(e,t){var n,r,i,a,o;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(n=r[e]))return this;if(n===t||n.listener&&n.listener===t)0==--this._eventsCount?this._events=new Pe:(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,a=n.length;a-- >0;)if(n[a]===t||n[a].listener&&n[a].listener===t){o=n[a].listener,i=a;break}if(i<0)return this;if(1===n.length){if(n[0]=void 0,0==--this._eventsCount)return this._events=new Pe,this;delete r[e]}else je(n,i);r.removeListener&&this.emit("removeListener",e,o||t)}return this},Fe.prototype.removeAllListeners=function(e){var t,n;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=new Pe,this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=new Pe:delete n[e]),this;if(0===arguments.length){for(var r,i=Object.keys(n),a=0;a<i.length;++a)"removeListener"!==(r=i[a])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=new Pe,this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this},Fe.prototype.listeners=function(e){var t,n,r=this._events;return r?(t=r[e],n=t?"function"==typeof t?[t.listener||t]:We(t):[]):n=[],n},Fe.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):qe.call(e,t)},Fe.prototype.listenerCount=qe,Fe.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var hc=Xe,gc=Qe;"function"==typeof Pa.setTimeout&&(hc=setTimeout),"function"==typeof Pa.clearTimeout&&(gc=clearTimeout);var pc,Ec=[],mc=!1,_c=-1;nt.prototype.run=function(){this.fun.apply(null,this.array)};var yc,Tc={},vc=[],Sc={},Ac={},Rc={},Ic=rt,Dc=rt,bc=rt,Mc=rt,Cc=rt,Nc=rt,wc=rt,Oc=Pa.performance||{},Lc=Oc.now||Oc.mozNow||Oc.msNow||Oc.oNow||Oc.webkitNow||function(){return(new Date).getTime()},Pc=new Date,Fc={nextTick:tt,title:"browser",browser:!0,env:Tc,argv:vc,version:"",versions:Sc,on:Ic,addListener:Dc,once:bc,off:Mc,removeListener:Cc,removeAllListeners:Nc,emit:wc,binding:it,cwd:at,chdir:ot,umask:st,hrtime:ut,platform:"browser",release:Ac,config:Rc,uptime:lt};yc="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e};var xc,Uc=yc,Bc=/%[sdj%]/g,kc={};dt.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},dt.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},xt.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},xt.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},xt.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},xt.prototype.clear=function(){this.head=this.tail=null,this.length=0},xt.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n},xt.prototype.concat=function(e){if(0===this.length)return G.alloc(0);if(1===this.length)return this.head.data;for(var t=G.allocUnsafe(e>>>0),n=this.head,r=0;n;)n.data.copy(t,r),r+=n.data.length,n=n.next;return t};var Gc=G.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};Bt.prototype.write=function(e){for(var t="";this.charLength;){var n=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,0,n),this.charReceived+=n,this.charReceived<this.charLength)return"";e=e.slice(n,e.length),t=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var r=t.charCodeAt(t.length-1);if(!(r>=55296&&r<=56319)){if(this.charReceived=this.charLength=0,0===e.length)return t;break}this.charLength+=this.surrogateSize,t=""}this.detectIncompleteChar(e);var i=e.length;this.charLength&&(e.copy(this.charBuffer,0,e.length-this.charReceived,i),i-=this.charReceived),t+=e.toString(this.encoding,0,i);var i=t.length-1,r=t.charCodeAt(i);if(r>=55296&&r<=56319){var a=this.surrogateSize;return this.charLength+=a,this.charReceived+=a,this.charBuffer.copy(this.charBuffer,a,0,a),e.copy(this.charBuffer,0,0,a),t.substring(0,i)}return t},Bt.prototype.detectIncompleteChar=function(e){for(var t=e.length>=3?3:e.length;t>0;t--){var n=e[e.length-t];if(1==t&&n>>5==6){this.charLength=2;break}if(t<=2&&n>>4==14){this.charLength=3;break}if(t<=3&&n>>3==30){this.charLength=4;break}}this.charReceived=t},Bt.prototype.end=function(e){var t="";if(e&&e.length&&(t=this.write(e)),this.charReceived){var n=this.charReceived,r=this.charBuffer,i=this.encoding;t+=r.slice(0,n).toString(i)}return t};var Yc=Object.freeze({StringDecoder:Bt});qt.ReadableState=Ht;var Kc=function(e){if(bt(xc)&&(xc=Fc.env.NODE_DEBUG||""),e=e.toUpperCase(),!kc[e])if(new RegExp("\\b"+e+"\\b","i").test(xc)){kc[e]=function(){var t=ct.apply(null,arguments);console.error("%s %d: %s",e,0,t)}}else kc[e]=function(){};return kc[e]}("stream");Uc(qt,Fe),qt.prototype.push=function(e,t){var n=this._readableState;return n.objectMode||"string"!=typeof e||(t=t||n.defaultEncoding)!==n.encoding&&(e=G.from(e,t),t=""),jt(this,n,e,t,!1)},qt.prototype.unshift=function(e){return jt(this,this._readableState,e,"",!0)},qt.prototype.isPaused=function(){return!1===this._readableState.flowing},qt.prototype.setEncoding=function(e){return this._readableState.decoder=new Bt(e),this._readableState.encoding=e,this};var Vc=8388608;qt.prototype.read=function(e){Kc("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return Kc("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?dn(this):$t(this),null;if(0===(e=Xt(e,t))&&t.ended)return 0===t.length&&dn(this),null;var r=t.needReadable;Kc("need readable",r),(0===t.length||t.length-e<t.highWaterMark)&&(r=!0,Kc("length less than watermark",r)),t.ended||t.reading?(r=!1,Kc("reading or ended",r)):r&&(Kc("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=Xt(n,t)));var i;return i=e>0?un(e,t):null,null===i?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&dn(this)),null!==i&&this.emit("data",i),i},qt.prototype._read=function(e){this.emit("error",new Error("not implemented"))},qt.prototype.pipe=function(e,t){function n(e){Kc("onunpipe"),e===c&&i()}function r(){Kc("onend"),e.end()}function i(){Kc("cleanup"),e.removeListener("close",s),e.removeListener("finish",u),e.removeListener("drain",g),e.removeListener("error",o),e.removeListener("unpipe",n),c.removeListener("end",r),c.removeListener("end",i),c.removeListener("data",a),p=!0,!f.awaitDrain||e._writableState&&!e._writableState.needDrain||g()}function a(t){Kc("ondata"),E=!1,!1!==e.write(t)||E||((1===f.pipesCount&&f.pipes===e||f.pipesCount>1&&-1!==pn(f.pipes,e))&&!p&&(Kc("false write response, pause",c._readableState.awaitDrain),c._readableState.awaitDrain++,E=!0),c.pause())}function o(t){Kc("onerror",t),l(),e.removeListener("error",o),0===Vt(e,"error")&&e.emit("error",t)}function s(){e.removeListener("finish",u),l()}function u(){Kc("onfinish"),e.removeListener("close",s),l()}function l(){Kc("unpipe"),c.unpipe(e)}var c=this,f=this._readableState;switch(f.pipesCount){case 0:f.pipes=e;break;case 1:f.pipes=[f.pipes,e];break;default:f.pipes.push(e)}f.pipesCount+=1,Kc("pipe count=%d opts=%j",f.pipesCount,t);var d=!t||!1!==t.end,h=d?r:i;f.endEmitted?tt(h):c.once("end",h),e.on("unpipe",n);var g=nn(c);e.on("drain",g);var p=!1,E=!1;return c.on("data",a),Kt(e,"error",o),e.once("close",s),e.once("finish",u),e.emit("pipe",c),f.flowing||(Kc("pipe resume"),c.resume()),e},qt.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this),this);if(!e){var n=t.pipes,r=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var i=0;i<r;i++)n[i].emit("unpipe",this);return this}var a=pn(t.pipes,e);return-1===a?this:(t.pipes.splice(a,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this),this)},qt.prototype.on=function(e,t){var n=Fe.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var r=this._readableState;r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&$t(this):tt(rn,this))}return n},qt.prototype.addListener=qt.prototype.on,qt.prototype.resume=function(){var e=this._readableState;return e.flowing||(Kc("resume"),e.flowing=!0,an(this,e)),this},qt.prototype.pause=function(){return Kc("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(Kc("pause"),this._readableState.flowing=!1,this.emit("pause")),this},qt.prototype.wrap=function(e){var t=this._readableState,n=!1,r=this;e.on("end",function(){if(Kc("wrapped end"),t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&r.push(e)}r.push(null)}),e.on("data",function(i){if(Kc("wrapped data"),t.decoder&&(i=t.decoder.write(i)),(!t.objectMode||null!==i&&void 0!==i)&&(t.objectMode||i&&i.length)){r.push(i)||(n=!0,e.pause())}});for(var i in e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));return gn(["error","close","destroy","pause","resume"],function(t){e.on(t,r.emit.bind(r,t))}),r._read=function(t){Kc("wrapped _read",t),n&&(n=!1,e.resume())},r},qt._fromList=un,yn.WritableState=_n,Uc(yn,Fe),_n.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},yn.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},yn.prototype.write=function(e,t,n){var r=this._writableState,i=!1;return"function"==typeof t&&(n=t,t=null),G.isBuffer(e)?t="buffer":t||(t=r.defaultEncoding),"function"!=typeof n&&(n=En),r.ended?Tn(this,n):vn(this,r,e,n)&&(r.pendingcb++,i=An(this,r,e,t,n)),i},yn.prototype.cork=function(){this._writableState.corked++},yn.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||Nn(this,e))},yn.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},yn.prototype._write=function(e,t,n){n(new Error("not implemented"))},yn.prototype._writev=null,yn.prototype.end=function(e,t,n){var r=this._writableState;"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!==e&&void 0!==e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||Pn(this,r,n)},Uc(xn,qt);for(var Hc=Object.keys(yn.prototype),qc=0;qc<Hc.length;qc++){var jc=Hc[qc];xn.prototype[jc]||(xn.prototype[jc]=yn.prototype[jc])}Uc(Yn,xn),Yn.prototype.push=function(e,t){return this._transformState.needTransform=!1,xn.prototype.push.call(this,e,t)},Yn.prototype._transform=function(e,t,n){throw new Error("Not implemented")},Yn.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},Yn.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},Uc(Vn,Yn),Vn.prototype._transform=function(e,t,n){n(null,e)},Uc(Hn,Fe),Hn.Readable=qt,Hn.Writable=yn,Hn.Duplex=xn,Hn.Transform=Yn,Hn.PassThrough=Vn,Hn.Stream=Hn,Hn.prototype.pipe=function(e,t){function n(t){e.writable&&!1===e.write(t)&&u.pause&&u.pause()}function r(){u.readable&&u.resume&&u.resume()}function i(){l||(l=!0,e.end())}function a(){l||(l=!0,"function"==typeof e.destroy&&e.destroy())}function o(e){if(s(),0===Fe.listenerCount(this,"error"))throw e}function s(){u.removeListener("data",n),e.removeListener("drain",r),u.removeListener("end",i),u.removeListener("close",a),u.removeListener("error",o),e.removeListener("error",o),u.removeListener("end",s),u.removeListener("close",s),e.removeListener("close",s)}var u=this;u.on("data",n),e.on("drain",r),e._isStdio||t&&!1===t.end||(u.on("end",i),u.on("close",a));var l=!1;return u.on("error",o),e.on("error",o),u.on("end",s),u.on("close",s),e.on("close",s),e.emit("pipe",u),e};var zc=Object.freeze({default:Hn,Readable:qt,Writable:yn,Duplex:xn,Transform:Yn,PassThrough:Vn,Stream:Hn}),Wc=zc&&Hn||zc,Xc=c(function(e,t){!function(e){function t(n,i){if(!(this instanceof t))return new t(n,i);var a=this;r(a),a.q=a.c="",a.bufferCheckPosition=e.MAX_BUFFER_LENGTH,a.opt=i||{},a.opt.lowercase=a.opt.lowercase||a.opt.lowercasetags,a.looseCase=a.opt.lowercase?"toLowerCase":"toUpperCase",a.tags=[],a.closed=a.closedRoot=a.sawRoot=!1,a.tag=a.error=null,a.strict=!!n,a.noscript=!(!n&&!a.opt.noscript),a.state=q.BEGIN,a.strictEntities=a.opt.strictEntities,a.ENTITIES=a.strictEntities?Object.create(e.XML_ENTITIES):Object.create(e.ENTITIES),a.attribList=[],a.opt.xmlns&&(a.ns=Object.create(k)),a.trackPosition=!1!==a.opt.position,a.trackPosition&&(a.position=a.line=a.column=0),f(a,"onready")}function n(t){for(var n=Math.max(e.MAX_BUFFER_LENGTH,10),r=0,i=0,a=b.length;i<a;i++){var o=t[b[i]].length;if(o>n)switch(b[i]){case"textNode":h(t);break;case"cdata":d(t,"oncdata",t.cdata),t.cdata="";break;case"script":d(t,"onscript",t.script),t.script="";break;default:p(t,"Max buffer length exceeded: "+b[i])}r=Math.max(r,o)}var s=e.MAX_BUFFER_LENGTH-r;t.bufferCheckPosition=s+t.position}function r(e){for(var t=0,n=b.length;t<n;t++)e[b[t]]=""}function i(e){h(e),""!==e.cdata&&(d(e,"oncdata",e.cdata),e.cdata=""),""!==e.script&&(d(e,"onscript",e.script),e.script="")}function a(e,t){return new o(e,t)}function o(e,n){
if(!(this instanceof o))return new o(e,n);M.apply(this),this._parser=new t(e,n),this.writable=!0,this.readable=!0;var r=this;this._parser.onend=function(){r.emit("end")},this._parser.onerror=function(e){r.emit("error",e),r._parser.error=null},this._decoder=null,C.forEach(function(e){Object.defineProperty(r,"on"+e,{get:function(){return r._parser["on"+e]},set:function(t){if(!t)return r.removeAllListeners(e),r._parser["on"+e]=t,t;r.on(e,t)},enumerable:!0,configurable:!1})})}function s(e){return e.split("").reduce(function(e,t){return e[t]=!0,e},{})}function u(e){return"[object RegExp]"===Object.prototype.toString.call(e)}function l(e,t){return u(e)?!!t.match(e):e[t]}function c(e,t){return!l(e,t)}function f(e,t,n){e[t]&&e[t](n)}function d(e,t,n){e.textNode&&h(e),f(e,t,n)}function h(e){e.textNode=g(e.opt,e.textNode),e.textNode&&f(e,"ontext",e.textNode),e.textNode=""}function g(e,t){return e.trim&&(t=t.trim()),e.normalize&&(t=t.replace(/\s+/g," ")),t}function p(e,t){return h(e),e.trackPosition&&(t+="\nLine: "+e.line+"\nColumn: "+e.column+"\nChar: "+e.c),t=new Error(t),e.error=t,f(e,"onerror",t),e}function E(e){return e.sawRoot&&!e.closedRoot&&m(e,"Unclosed root tag"),e.state!==q.BEGIN&&e.state!==q.BEGIN_WHITESPACE&&e.state!==q.TEXT&&p(e,"Unexpected end"),h(e),e.c="",e.closed=!0,f(e,"onend"),t.call(e,e.strict,e.opt),e}function m(e,n){if("object"!=typeof e||!(e instanceof t))throw new Error("bad call to strictFail");e.strict&&p(e,n)}function _(e){e.strict||(e.tagName=e.tagName[e.looseCase]());var t=e.tags[e.tags.length-1]||e,n=e.tag={name:e.tagName,attributes:{}};e.opt.xmlns&&(n.ns=t.ns),e.attribList.length=0,d(e,"onopentagstart",n)}function y(e,t){var n=e.indexOf(":"),r=n<0?["",e]:e.split(":"),i=r[0],a=r[1];return t&&"xmlns"===e&&(i="xmlns",a=""),{prefix:i,local:a}}function T(e){if(e.strict||(e.attribName=e.attribName[e.looseCase]()),-1!==e.attribList.indexOf(e.attribName)||e.tag.attributes.hasOwnProperty(e.attribName))return void(e.attribName=e.attribValue="");if(e.opt.xmlns){var t=y(e.attribName,!0),n=t.prefix,r=t.local;if("xmlns"===n)if("xml"===r&&e.attribValue!==U)m(e,"xml: prefix must be bound to "+U+"\nActual: "+e.attribValue);else if("xmlns"===r&&e.attribValue!==B)m(e,"xmlns: prefix must be bound to "+B+"\nActual: "+e.attribValue);else{var i=e.tag,a=e.tags[e.tags.length-1]||e;i.ns===a.ns&&(i.ns=Object.create(a.ns)),i.ns[r]=e.attribValue}e.attribList.push([e.attribName,e.attribValue])}else e.tag.attributes[e.attribName]=e.attribValue,d(e,"onattribute",{name:e.attribName,value:e.attribValue});e.attribName=e.attribValue=""}function v(e,t){if(e.opt.xmlns){var n=e.tag,r=y(e.tagName);n.prefix=r.prefix,n.local=r.local,n.uri=n.ns[r.prefix]||"",n.prefix&&!n.uri&&(m(e,"Unbound namespace prefix: "+JSON.stringify(e.tagName)),n.uri=r.prefix);var i=e.tags[e.tags.length-1]||e;n.ns&&i.ns!==n.ns&&Object.keys(n.ns).forEach(function(t){d(e,"onopennamespace",{prefix:t,uri:n.ns[t]})});for(var a=0,o=e.attribList.length;a<o;a++){var s=e.attribList[a],u=s[0],l=s[1],c=y(u,!0),f=c.prefix,h=c.local,g=""===f?"":n.ns[f]||"",p={name:u,value:l,prefix:f,local:h,uri:g};f&&"xmlns"!==f&&!g&&(m(e,"Unbound namespace prefix: "+JSON.stringify(f)),p.uri=f),e.tag.attributes[u]=p,d(e,"onattribute",p)}e.attribList.length=0}e.tag.isSelfClosing=!!t,e.sawRoot=!0,e.tags.push(e.tag),d(e,"onopentag",e.tag),t||(e.noscript||"script"!==e.tagName.toLowerCase()?e.state=q.TEXT:e.state=q.SCRIPT,e.tag=null,e.tagName=""),e.attribName=e.attribValue="",e.attribList.length=0}function S(e){if(!e.tagName)return m(e,"Weird empty close tag."),e.textNode+="</>",void(e.state=q.TEXT);if(e.script){if("script"!==e.tagName)return e.script+="</"+e.tagName+">",e.tagName="",void(e.state=q.SCRIPT);d(e,"onscript",e.script),e.script=""}var t=e.tags.length,n=e.tagName;e.strict||(n=n[e.looseCase]());for(var r=n;t--;){if(e.tags[t].name===r)break;m(e,"Unexpected close tag")}if(t<0)return m(e,"Unmatched closing tag: "+e.tagName),e.textNode+="</"+e.tagName+">",void(e.state=q.TEXT);e.tagName=n;for(var i=e.tags.length;i-- >t;){var a=e.tag=e.tags.pop();e.tagName=e.tag.name,d(e,"onclosetag",e.tagName);var o={};for(var s in a.ns)o[s]=a.ns[s];var u=e.tags[e.tags.length-1]||e;e.opt.xmlns&&a.ns!==u.ns&&Object.keys(a.ns).forEach(function(t){var n=a.ns[t];d(e,"onclosenamespace",{prefix:t,uri:n})})}0===t&&(e.closedRoot=!0),e.tagName=e.attribValue=e.attribName="",e.attribList.length=0,e.state=q.TEXT}function A(e){var t,n=e.entity,r=n.toLowerCase(),i="";return e.ENTITIES[n]?e.ENTITIES[n]:e.ENTITIES[r]?e.ENTITIES[r]:(n=r,"#"===n.charAt(0)&&("x"===n.charAt(1)?(n=n.slice(2),t=parseInt(n,16),i=t.toString(16)):(n=n.slice(1),t=parseInt(n,10),i=t.toString(10))),n=n.replace(/^0+/,""),i.toLowerCase()!==n?(m(e,"Invalid character entity"),"&"+e.entity+";"):String.fromCodePoint(t))}function R(e,t){"<"===t?(e.state=q.OPEN_WAKA,e.startTagPosition=e.position):c(N,t)&&(m(e,"Non-whitespace before first tag."),e.textNode=t,e.state=q.TEXT)}function I(e,t){var n="";return t<e.length&&(n=e.charAt(t)),n}function D(e){var t=this;if(this.error)throw this.error;if(t.closed)return p(t,"Cannot write after close. Assign an onready handler.");if(null===e)return E(t);"object"==typeof e&&(e=e.toString());for(var r=0,i="";;){if(i=I(e,r++),t.c=i,!i)break;switch(t.trackPosition&&(t.position++,"\n"===i?(t.line++,t.column=0):t.column++),t.state){case q.BEGIN:if(t.state=q.BEGIN_WHITESPACE,"\ufeff"===i)continue;R(t,i);continue;case q.BEGIN_WHITESPACE:R(t,i);continue;case q.TEXT:if(t.sawRoot&&!t.closedRoot){for(var a=r-1;i&&"<"!==i&&"&"!==i;)(i=I(e,r++))&&t.trackPosition&&(t.position++,"\n"===i?(t.line++,t.column=0):t.column++);t.textNode+=e.substring(a,r-1)}"<"!==i||t.sawRoot&&t.closedRoot&&!t.strict?(!c(N,i)||t.sawRoot&&!t.closedRoot||m(t,"Text data outside of root node."),"&"===i?t.state=q.TEXT_ENTITY:t.textNode+=i):(t.state=q.OPEN_WAKA,t.startTagPosition=t.position);continue;case q.SCRIPT:"<"===i?t.state=q.SCRIPT_ENDING:t.script+=i;continue;case q.SCRIPT_ENDING:"/"===i?t.state=q.CLOSE_TAG:(t.script+="<"+i,t.state=q.SCRIPT);continue;case q.OPEN_WAKA:if("!"===i)t.state=q.SGML_DECL,t.sgmlDecl="";else if(l(N,i));else if(l(Y,i))t.state=q.OPEN_TAG,t.tagName=i;else if("/"===i)t.state=q.CLOSE_TAG,t.tagName="";else if("?"===i)t.state=q.PROC_INST,t.procInstName=t.procInstBody="";else{if(m(t,"Unencoded <"),t.startTagPosition+1<t.position){var o=t.position-t.startTagPosition;i=new Array(o).join(" ")+i}t.textNode+="<"+i,t.state=q.TEXT}continue;case q.SGML_DECL:(t.sgmlDecl+i).toUpperCase()===F?(d(t,"onopencdata"),t.state=q.CDATA,t.sgmlDecl="",t.cdata=""):t.sgmlDecl+i==="--"?(t.state=q.COMMENT,t.comment="",t.sgmlDecl=""):(t.sgmlDecl+i).toUpperCase()===x?(t.state=q.DOCTYPE,(t.doctype||t.sawRoot)&&m(t,"Inappropriately located doctype declaration"),t.doctype="",t.sgmlDecl=""):">"===i?(d(t,"onsgmldeclaration",t.sgmlDecl),t.sgmlDecl="",t.state=q.TEXT):l(L,i)?(t.state=q.SGML_DECL_QUOTED,t.sgmlDecl+=i):t.sgmlDecl+=i;continue;case q.SGML_DECL_QUOTED:i===t.q&&(t.state=q.SGML_DECL,t.q=""),t.sgmlDecl+=i;continue;case q.DOCTYPE:">"===i?(t.state=q.TEXT,d(t,"ondoctype",t.doctype),t.doctype=!0):(t.doctype+=i,"["===i?t.state=q.DOCTYPE_DTD:l(L,i)&&(t.state=q.DOCTYPE_QUOTED,t.q=i));continue;case q.DOCTYPE_QUOTED:t.doctype+=i,i===t.q&&(t.q="",t.state=q.DOCTYPE);continue;case q.DOCTYPE_DTD:t.doctype+=i,"]"===i?t.state=q.DOCTYPE:l(L,i)&&(t.state=q.DOCTYPE_DTD_QUOTED,t.q=i);continue;case q.DOCTYPE_DTD_QUOTED:t.doctype+=i,i===t.q&&(t.state=q.DOCTYPE_DTD,t.q="");continue;case q.COMMENT:"-"===i?t.state=q.COMMENT_ENDING:t.comment+=i;continue;case q.COMMENT_ENDING:"-"===i?(t.state=q.COMMENT_ENDED,t.comment=g(t.opt,t.comment),t.comment&&d(t,"oncomment",t.comment),t.comment=""):(t.comment+="-"+i,t.state=q.COMMENT);continue;case q.COMMENT_ENDED:">"!==i?(m(t,"Malformed comment"),t.comment+="--"+i,t.state=q.COMMENT):t.state=q.TEXT;continue;case q.CDATA:"]"===i?t.state=q.CDATA_ENDING:t.cdata+=i;continue;case q.CDATA_ENDING:"]"===i?t.state=q.CDATA_ENDING_2:(t.cdata+="]"+i,t.state=q.CDATA);continue;case q.CDATA_ENDING_2:">"===i?(t.cdata&&d(t,"oncdata",t.cdata),d(t,"onclosecdata"),t.cdata="",t.state=q.TEXT):"]"===i?t.cdata+="]":(t.cdata+="]]"+i,t.state=q.CDATA);continue;case q.PROC_INST:"?"===i?t.state=q.PROC_INST_ENDING:l(N,i)?t.state=q.PROC_INST_BODY:t.procInstName+=i;continue;case q.PROC_INST_BODY:if(!t.procInstBody&&l(N,i))continue;"?"===i?t.state=q.PROC_INST_ENDING:t.procInstBody+=i;continue;case q.PROC_INST_ENDING:">"===i?(d(t,"onprocessinginstruction",{name:t.procInstName,body:t.procInstBody}),t.procInstName=t.procInstBody="",t.state=q.TEXT):(t.procInstBody+="?"+i,t.state=q.PROC_INST_BODY);continue;case q.OPEN_TAG:l(K,i)?t.tagName+=i:(_(t),">"===i?v(t):"/"===i?t.state=q.OPEN_TAG_SLASH:(c(N,i)&&m(t,"Invalid character in tag name"),t.state=q.ATTRIB));continue;case q.OPEN_TAG_SLASH:">"===i?(v(t,!0),S(t)):(m(t,"Forward-slash in opening tag not followed by >"),t.state=q.ATTRIB);continue;case q.ATTRIB:if(l(N,i))continue;">"===i?v(t):"/"===i?t.state=q.OPEN_TAG_SLASH:l(Y,i)?(t.attribName=i,t.attribValue="",t.state=q.ATTRIB_NAME):m(t,"Invalid attribute name");continue;case q.ATTRIB_NAME:"="===i?t.state=q.ATTRIB_VALUE:">"===i?(m(t,"Attribute without value"),t.attribValue=t.attribName,T(t),v(t)):l(N,i)?t.state=q.ATTRIB_NAME_SAW_WHITE:l(K,i)?t.attribName+=i:m(t,"Invalid attribute name");continue;case q.ATTRIB_NAME_SAW_WHITE:if("="===i)t.state=q.ATTRIB_VALUE;else{if(l(N,i))continue;m(t,"Attribute without value"),t.tag.attributes[t.attribName]="",t.attribValue="",d(t,"onattribute",{name:t.attribName,value:""}),t.attribName="",">"===i?v(t):l(Y,i)?(t.attribName=i,t.state=q.ATTRIB_NAME):(m(t,"Invalid attribute name"),t.state=q.ATTRIB)}continue;case q.ATTRIB_VALUE:if(l(N,i))continue;l(L,i)?(t.q=i,t.state=q.ATTRIB_VALUE_QUOTED):(m(t,"Unquoted attribute value"),t.state=q.ATTRIB_VALUE_UNQUOTED,t.attribValue=i);continue;case q.ATTRIB_VALUE_QUOTED:if(i!==t.q){"&"===i?t.state=q.ATTRIB_VALUE_ENTITY_Q:t.attribValue+=i;continue}T(t),t.q="",t.state=q.ATTRIB_VALUE_CLOSED;continue;case q.ATTRIB_VALUE_CLOSED:l(N,i)?t.state=q.ATTRIB:">"===i?v(t):"/"===i?t.state=q.OPEN_TAG_SLASH:l(Y,i)?(m(t,"No whitespace between attributes"),t.attribName=i,t.attribValue="",t.state=q.ATTRIB_NAME):m(t,"Invalid attribute name");continue;case q.ATTRIB_VALUE_UNQUOTED:if(c(P,i)){"&"===i?t.state=q.ATTRIB_VALUE_ENTITY_U:t.attribValue+=i;continue}T(t),">"===i?v(t):t.state=q.ATTRIB;continue;case q.CLOSE_TAG:if(t.tagName)">"===i?S(t):l(K,i)?t.tagName+=i:t.script?(t.script+="</"+t.tagName,t.tagName="",t.state=q.SCRIPT):(c(N,i)&&m(t,"Invalid tagname in closing tag"),t.state=q.CLOSE_TAG_SAW_WHITE);else{if(l(N,i))continue;c(Y,i)?t.script?(t.script+="</"+i,t.state=q.SCRIPT):m(t,"Invalid tagname in closing tag."):t.tagName=i}continue;case q.CLOSE_TAG_SAW_WHITE:if(l(N,i))continue;">"===i?S(t):m(t,"Invalid characters in closing tag");continue;case q.TEXT_ENTITY:case q.ATTRIB_VALUE_ENTITY_Q:case q.ATTRIB_VALUE_ENTITY_U:var s,u;switch(t.state){case q.TEXT_ENTITY:s=q.TEXT,u="textNode";break;case q.ATTRIB_VALUE_ENTITY_Q:s=q.ATTRIB_VALUE_QUOTED,u="attribValue";break;case q.ATTRIB_VALUE_ENTITY_U:s=q.ATTRIB_VALUE_UNQUOTED,u="attribValue"}";"===i?(t[u]+=A(t),t.entity="",t.state=s):l(t.entity.length?H:V,i)?t.entity+=i:(m(t,"Invalid character in entity name"),t[u]+="&"+t.entity+i,t.entity="",t.state=s);continue;default:throw new Error(t,"Unknown state: "+t.state)}}return t.position>=t.bufferCheckPosition&&n(t),t}e.parser=function(e,n){return new t(e,n)},e.SAXParser=t,e.SAXStream=o,e.createStream=a,e.MAX_BUFFER_LENGTH=65536;var b=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];e.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(e){function t(){}return t.prototype=e,new t}),Object.keys||(Object.keys=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}),t.prototype={end:function(){E(this)},write:D,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){i(this)}};var M;try{M=Wc.Stream}catch(e){M=function(){}}var C=e.EVENTS.filter(function(e){return"error"!==e&&"end"!==e});o.prototype=Object.create(M.prototype,{constructor:{value:o}}),o.prototype.write=function(e){if("function"==typeof G&&"function"==typeof we&&we(e)){if(!this._decoder){var t=Yc.StringDecoder;this._decoder=new t("utf8")}e=this._decoder.write(e)}return this._parser.write(e.toString()),this.emit("data",e),!0},o.prototype.end=function(e){return e&&e.length&&this.write(e),this._parser.end(),!0},o.prototype.on=function(e,t){var n=this;return n._parser["on"+e]||-1===C.indexOf(e)||(n._parser["on"+e]=function(){var t=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);t.splice(0,0,e),n.emit.apply(n,t)}),M.prototype.on.call(n,e,t)};var N="\r\n\t ",w="0124356789",O="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",L="'\"",P=N+">",F="[CDATA[",x="DOCTYPE",U="http://www.w3.org/XML/1998/namespace",B="http://www.w3.org/2000/xmlns/",k={xml:U,xmlns:B};N=s(N),w=s(w),O=s(O);var Y=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,K=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/,V=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,H=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/;L=s(L),P=s(P);var q=0;e.STATE={BEGIN:q++,BEGIN_WHITESPACE:q++,TEXT:q++,TEXT_ENTITY:q++,OPEN_WAKA:q++,SGML_DECL:q++,SGML_DECL_QUOTED:q++,DOCTYPE:q++,DOCTYPE_QUOTED:q++,DOCTYPE_DTD:q++,DOCTYPE_DTD_QUOTED:q++,COMMENT_STARTING:q++,COMMENT:q++,COMMENT_ENDING:q++,COMMENT_ENDED:q++,CDATA:q++,CDATA_ENDING:q++,CDATA_ENDING_2:q++,PROC_INST:q++,PROC_INST_BODY:q++,PROC_INST_ENDING:q++,OPEN_TAG:q++,OPEN_TAG_SLASH:q++,ATTRIB:q++,ATTRIB_NAME:q++,ATTRIB_NAME_SAW_WHITE:q++,ATTRIB_VALUE:q++,ATTRIB_VALUE_QUOTED:q++,ATTRIB_VALUE_CLOSED:q++,ATTRIB_VALUE_UNQUOTED:q++,ATTRIB_VALUE_ENTITY_Q:q++,ATTRIB_VALUE_ENTITY_U:q++,CLOSE_TAG:q++,CLOSE_TAG_SAW_WHITE:q++,SCRIPT:q++,SCRIPT_ENDING:q++},e.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},e.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(e.ENTITIES).forEach(function(t){var n=e.ENTITIES[t],r="number"==typeof n?String.fromCharCode(n):n;e.ENTITIES[t]=r});for(var j in e.STATE)e.STATE[e.STATE[j]]=j;q=e.STATE,String.fromCodePoint||function(){var e=String.fromCharCode,t=Math.floor,n=function(){var n,r,i=[],a=-1,o=arguments.length;if(!o)return"";for(var s="";++a<o;){var u=Number(arguments[a]);if(!isFinite(u)||u<0||u>1114111||t(u)!==u)throw RangeError("Invalid code point: "+u);u<=65535?i.push(u):(u-=65536,n=55296+(u>>10),r=u%1024+56320,i.push(n,r)),(a+1===o||i.length>16384)&&(s+=e.apply(null,i),i.length=0)}return s};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:n,configurable:!0,writable:!0}):String.fromCodePoint=n}()}(t)}),Qc=c(function(e,t){!function(e,t,n,r,i){function a(e,t,n,r){var i=r&&"seq"===r.timeContainer,o=0;r&&(o=i&&n?n.end:r.begin),t.begin=t.explicit_begin?t.explicit_begin+o:o;var s=t.begin,u=null;for(var l in t.sets)a(e,t.sets[l],u,t),s="seq"===t.timeContainer?t.sets[l].end:Math.max(s,t.sets[l].end),u=t.sets[l];if("contents"in t)for(var c in t.contents)a(e,t.contents[c],u,t),s="seq"===t.timeContainer?t.contents[c].end:Math.max(s,t.contents[c].end),u=t.contents[c];else s=i?t.begin:Number.POSITIVE_INFINITY;null!==t.explicit_end&&null!==t.explicit_dur?t.end=Math.min(t.begin+t.explicit_dur,o+t.explicit_end):null===t.explicit_end&&null!==t.explicit_dur?t.end=t.begin+t.explicit_dur:null!==t.explicit_end&&null===t.explicit_dur?t.end=o+t.explicit_end:t.end=s,delete t.explicit_begin,delete t.explicit_dur,delete t.explicit_end,e._registerEvent(t)}function o(e){this.node=e}function s(){this.events=[],this.head=null,this.body=null}function u(){this.styling=null,this.layout=null}function l(){this.styles={}}function c(){this.id=null,this.styleAttrs=null,this.styleRefs=null}function f(){this.regions={}}function d(e){this.kind=e}function h(e){this.id=e}function g(e){this.regionID=e}function p(e){this.styleAttrs=e}function E(e){this.sets=e}function m(e){this.contents=e}function _(e,t,n){this.explicit_begin=e,this.explicit_end=t,this.explicit_dur=n}function y(){d.call(this,"body")}function T(){d.call(this,"div")}function v(){d.call(this,"p")}function S(){d.call(this,"span")}function A(){d.call(this,"span")}function R(){d.call(this,"br")}function I(){}function D(){}function b(e){return e&&"xml:id"in e.attributes?e.attributes["xml:id"].value||null:null}function M(e){return e&&"region"in e.attributes?e.attributes.region.value:""}function C(e,t){var n=e&&"timeContainer"in e.attributes?e.attributes.timeContainer.value:null;return n&&"par"!==n?"seq"===n?"seq":(V(t,"Illegal value of timeContainer (assuming 'par')"),"par"):"par"}function N(e){return e&&"style"in e.attributes?e.attributes.style.value.split(" "):[]}function w(e,t){var n={};if(null!==e)for(var i in e.attributes){var a=e.attributes[i].uri+" "+e.attributes[i].local,o=r.byQName[a];if(void 0!==o){var s=o.parse(e.attributes[i].value);null!==s?(n[a]=s,o===r.byName.zIndex&&K(t,"zIndex attribute present but not used by IMSC1 since regions do not overlap")):V(t,"Cannot parse styling attribute "+a+" --\x3e "+e.attributes[i].value)}}return n}function O(e,t,n){for(var r in e.attributes)if(e.attributes[r].uri===t&&e.attributes[r].local===n)return e.attributes[r].value;return null}function L(e,t){var r=O(e,n.ns_ittp,"aspectRatio"),i=null;if(null!==r){var a=/(\d+) (\d+)/,o=a.exec(r);if(null!==o){var s=parseInt(o[1]),u=parseInt(o[2]);0!==s&&0!==u?i=s/u:V(t,"Illegal aspectRatio values (ignoring)")}else V(t,"Malformed aspectRatio attribute (ignoring)")}return i}function P(e,t){var r=O(e,n.ns_ttp,"cellResolution"),i=15,a=32;if(null!==r){var o=/(\d+) (\d+)/,s=o.exec(r);null!==s?(a=parseInt(s[1]),i=parseInt(s[2])):K(t,"Malformed cellResolution value (using initial value instead)")}return{w:a,h:i}}function F(e,t){var r,i=O(e,n.ns_ttp,"frameRate"),a=30;if(null!==i){r=/(\d+)/.exec(i),null!==r?a=parseInt(r[1]):K(t,"Malformed frame rate attribute (using initial value instead)")}var o=O(e,n.ns_ttp,"frameRateMultiplier"),s=1;if(null!==o){r=/(\d+) (\d+)/.exec(o),null!==r?s=parseInt(r[1])/parseInt(r[2]):K(t,"Malformed frame rate multiplier attribute (using initial value instead)")}var u=s*a,l=1,c=O(e,n.ns_ttp,"tickRate");if(null===c)null!==i&&(l=u);else{r=/(\d+)/.exec(c),null!==r?l=parseInt(r[1]):K(t,"Malformed tick rate attribute (using initial value instead)")}return{effectiveFrameRate:u,tickRate:l}}function x(e,t){var r=O(e,n.ns_tts,"extent");if(null===r)return null;var a=r.split(" ");if(2!==a.length)return K(t,"Malformed extent (ignoring)"),null;var o=i.parseLength(a[0]),s=i.parseLength(a[1]);return s&&o?{h:s,w:o}:(K(t,"Malformed extent values (ignoring)"),null)}function U(e,t,n){var r,i=/^(\d{2,}):(\d\d):(\d\d(?:\.\d+)?)$/,a=/^(\d{2,}):(\d\d):(\d\d)\:(\d{2,})$/,o=/^(\d+(?:\.\d+)?)f$/,s=/^(\d+(?:\.\d+)?)t$/,u=/^(\d+(?:\.\d+)?)ms$/,l=/^(\d+(?:\.\d+)?)s$/,c=/^(\d+(?:\.\d+)?)h$/,f=/^(\d+(?:\.\d+)?)m$/,d=null;return null!==(r=o.exec(n))?null!==t&&(d=parseFloat(r[1])/t):null!==(r=s.exec(n))?null!==e&&(d=parseFloat(r[1])/e):null!==(r=u.exec(n))?d=parseFloat(r[1])/1e3:null!==(r=l.exec(n))?d=parseFloat(r[1]):null!==(r=c.exec(n))?d=3600*parseFloat(r[1]):null!==(r=f.exec(n))?d=60*parseFloat(r[1]):null!==(r=i.exec(n))?d=3600*parseInt(r[1])+60*parseInt(r[2])+parseFloat(r[3]):null!==(r=a.exec(n))&&null!==t&&(d=3600*parseInt(r[1])+60*parseInt(r[2])+parseInt(r[3])+(null===r[4]?0:parseInt(r[4])/t)),d}function B(e,t,n,r){var i=null;n&&"begin"in n.attributes&&null===(i=U(e.tickRate,e.effectiveFrameRate,n.attributes.begin.value))&&K(r,"Malformed begin value "+n.attributes.begin.value+" (using 0)");var a=null;n&&"dur"in n.attributes&&null===(a=U(e.tickRate,e.effectiveFrameRate,n.attributes.dur.value))&&K(r,"Malformed dur value "+n.attributes.dur.value+" (ignoring)");var o=null;return n&&"end"in n.attributes&&null===(o=U(e.tickRate,e.effectiveFrameRate,n.attributes.end.value))&&K(r,"Malformed end value (ignoring)"),{explicit_begin:i,explicit_end:o,explicit_dur:a}}function k(e,t,n){for(;t.styleRefs.length>0;){var r=t.styleRefs.pop();r in e.styles?(k(e,e.styles[r],n),Y(e.styles[r].styleAttrs,t.styleAttrs)):V(n,"Non-existant style id referenced")}}function G(e,t,n,r){for(var i=t.length-1;i>=0;i--){var a=t[i];a in e.styles?Y(e.styles[a].styleAttrs,n):V(r,"Non-existant style id referenced")}}function Y(e,t){for(var n in e)n in t||(t[n]=e[n])}function K(e,t){if(e&&e.warn&&e.warn(t))throw t}function V(e,t){if(e&&e.error&&e.error(t))throw t}function H(e,t){throw e&&e.fatal&&e.fatal(t),t}function q(e,t){for(var n,r=0,i=e.length-1;r<=i;){n=Math.floor((r+i)/2);var a=e[n];if(a<t)r=n+1;else{if(!(a>t))return{found:!0,index:n};i=n-1}}return{found:!1,index:r}}e.fromXML=function(e,r,i){var d=t.parser(!0,{xmlns:!0}),h=[],g=[],p=[],E=0,m=null;d.onclosetag=function(e){if(h[0]instanceof l)for(var t in h[0].styles)k(h[0],h[0].styles[t],r);else if(h[0]instanceof v||h[0]instanceof S){if(h[0].contents.length>1){var a,s=[h[0].contents[0]];for(a=1;a<h[0].contents.length;a++)h[0].contents[a]instanceof A&&s[s.length-1]instanceof A?s[s.length-1].text+=h[0].contents[a].text:s.push(h[0].contents[a]);h[0].contents=s}h[0]instanceof S&&1===h[0].contents.length&&h[0].contents[0]instanceof A&&(h[0].text=h[0].contents[0].text,delete h[0].contents)}else h[0]instanceof o&&(h[0].node.uri===n.ns_tt&&"metadata"===h[0].node.local?E--:E>0&&i&&"onCloseTag"in i&&i.onCloseTag());p.shift(),g.shift(),h.shift()},d.ontext=function(e){if(void 0===h[0]);else if(h[0]instanceof S||h[0]instanceof v){var t=new A;t.initFromText(m,h[0],e,p[0],r),h[0].contents.push(t)}else h[0]instanceof o&&E>0&&i&&"onText"in i&&i.onText(e)},d.onopentag=function(e){var t=e.attributes["xml:space"];t?p.unshift(t.value):0===p.length?p.unshift("default"):p.unshift(p[0]);var a=e.attributes["xml:lang"];if(a?g.unshift(a.value):0===g.length?g.unshift(""):g.unshift(g[0]),e.uri===n.ns_tt)if("tt"===e.local)null!==m&&H(r,"Two <tt> elements at ("+this.line+","+this.column+")"),m=new s,m.initFromNode(e,r),h.unshift(m);else if("head"===e.local)h[0]instanceof s||H(r,"Parent of <head> element is not <tt> at ("+this.line+","+this.column+")"),null!==m.head&&H("Second <head> element at ("+this.line+","+this.column+")"),m.head=new u,h.unshift(m.head);else if("styling"===e.local)h[0]instanceof u||H(r,"Parent of <styling> element is not <head> at ("+this.line+","+this.column+")"),null!==m.head.styling&&H("Second <styling> element at ("+this.line+","+this.column+")"),m.head.styling=new l,h.unshift(m.head.styling);else if("style"===e.local){var d;h[0]instanceof l?(d=new c,d.initFromNode(e,r),d.id?m.head.styling.styles[d.id]=d:V(r,"<style> element missing @id attribute"),h.unshift(d)):h[0]instanceof I?(d=new c,d.initFromNode(e,r),Y(d.styleAttrs,h[0].styleAttrs),h.unshift(d)):H(r,"Parent of <style> element is not <styling> or <region> at ("+this.line+","+this.column+")")}else if("layout"===e.local)h[0]instanceof u||H(r,"Parent of <layout> element is not <head> at "+this.line+","+this.column+")"),null!==m.head.layout&&H(r,"Second <layout> element at "+this.line+","+this.column+")"),m.head.layout=new f,h.unshift(m.head.layout);else if("region"===e.local){h[0]instanceof f||H(r,"Parent of <region> element is not <layout> at "+this.line+","+this.column+")");var _=new I;_.initFromNode(m,e,r),!_.id||_.id in m.head.layout.regions?V(r,"Ignoring <region> with duplicate or missing @id at "+this.line+","+this.column+")"):m.head.layout.regions[_.id]=_,h.unshift(_)}else if("body"===e.local){h[0]instanceof s||H(r,"Parent of <body> element is not <tt> at "+this.line+","+this.column+")"),null!==m.body&&H(r,"Second <body> element at "+this.line+","+this.column+")");var A=new y;A.initFromNode(m,e,r),m.body=A,h.unshift(A)}else if("div"===e.local){h[0]instanceof T||h[0]instanceof y||H(r,"Parent of <div> element is not <body> or <div> at "+this.line+","+this.column+")");var b=new T;b.initFromNode(m,h[0],e,r),h[0].contents.push(b),h.unshift(b)}else if("p"===e.local){h[0]instanceof T||H(r,"Parent of <p> element is not <div> at "+this.line+","+this.column+")");var M=new v;M.initFromNode(m,h[0],e,r),h[0].contents.push(M),h.unshift(M)}else if("span"===e.local){h[0]instanceof S||h[0]instanceof v||H(r,"Parent of <span> element is not <span> or <p> at "+this.line+","+this.column+")");var C=new S;C.initFromNode(m,h[0],e,p[0],r),h[0].contents.push(C),h.unshift(C)}else if("br"===e.local){h[0]instanceof S||h[0]instanceof v||H(r,"Parent of <br> element is not <span> or <p> at "+this.line+","+this.column+")");var N=new R;N.initFromNode(m,h[0],e,r),h[0].contents.push(N),h.unshift(N)}else if("set"===e.local){h[0]instanceof S||h[0]instanceof v||h[0]instanceof T||h[0]instanceof y||h[0]instanceof I||h[0]instanceof R||H(r,"Parent of <set> element is not a content element or a region at "+this.line+","+this.column+")");var w=new D;w.initFromNode(m,h[0],e,r),h[0].sets.push(w),h.unshift(w)}else h.unshift(new o(e));else h.unshift(new o(e));if(h[0]instanceof o)if(e.uri===n.ns_tt&&"metadata"===e.local)E++;else if(E>0&&i&&"onOpenTag"in i){var O=[];for(var L in e.attributes)O[e.attributes[L].uri+" "+e.attributes[L].local]={uri:e.attributes[L].uri,local:e.attributes[L].local,value:e.attributes[L].value};i.onOpenTag(e.uri,e.local,O)}},d.write(e).close(),null!==m.head?delete m.head.styling:m.head=new u,null===m.head.layout&&(m.head.layout=new f);var _=!1;for(var b in m.head.layout.regions){_=!0;break}if(!_){var M=I.prototype.createDefaultRegion();m.head.layout.regions[M.id]=M}for(var C in m.head.layout.regions)a(m,m.head.layout.regions[C],null,null);return m.body&&a(m,m.body,null,null),m},s.prototype.initFromNode=function(e,t){this.cellResolution=P(e,t);var r=F(e,t);this.effectiveFrameRate=r.effectiveFrameRate,this.tickRate=r.tickRate,this.aspectRatio=L(e,t);var i=O(e,n.ns_ttp,"timeBase");null!==i&&"media"!==i&&H(t,"Unsupported time base");var a=x(e,t);null===a?this.pxDimensions={h:480,w:640}:("px"===a.h.unit&&"px"===a.w.unit||H(t,"Extent on TT must be in px or absent"),this.pxDimensions={h:a.h.value,w:a.w.value})},s.prototype._registerEvent=function(e){if(!(e.end<=e.begin)){var t=q(this.events,e.begin);if(t.found||this.events.splice(t.index,0,e.begin),e.end!==Number.POSITIVE_INFINITY){var n=q(this.events,e.end);n.found||this.events.splice(n.index,0,e.end)}}},s.prototype.getMediaTimeRange=function(){return[this.events[0],this.events[this.events.length-1]]},s.prototype.getMediaTimeEvents=function(){return this.events},c.prototype.initFromNode=function(e,t){this.id=b(e),this.styleAttrs=w(e,t),this.styleRefs=N(e)},h.prototype.initFromNode=function(e,t,n,r){this.id=b(n)},g.prototype.initFromNode=function(e,t,n,r){this.regionID=M(n)},p.prototype.initFromNode=function(e,t,n,r){this.styleAttrs=w(n,r),null!==e.head&&null!==e.head.styling&&G(e.head.styling,N(n),this.styleAttrs,r)},E.prototype.initFromNode=function(e,t,n,r){this.sets=[]},m.prototype.initFromNode=function(e,t,n,r){this.contents=[]},_.prototype.initFromNode=function(e,t,n,r){var i=B(e,t,n,r);this.explicit_begin=i.explicit_begin,this.explicit_end=i.explicit_end,this.explicit_dur=i.explicit_dur,this.timeContainer=C(n,r)},y.prototype.initFromNode=function(e,t,n){p.prototype.initFromNode.call(this,e,null,t,n),_.prototype.initFromNode.call(this,e,null,t,n),E.prototype.initFromNode.call(this,e,null,t,n),g.prototype.initFromNode.call(this,e,null,t,n),m.prototype.initFromNode.call(this,e,null,t,n)},T.prototype.initFromNode=function(e,t,n,r){p.prototype.initFromNode.call(this,e,t,n,r),_.prototype.initFromNode.call(this,e,t,n,r),E.prototype.initFromNode.call(this,e,t,n,r),g.prototype.initFromNode.call(this,e,t,n,r),m.prototype.initFromNode.call(this,e,t,n,r)},v.prototype.initFromNode=function(e,t,n,r){p.prototype.initFromNode.call(this,e,t,n,r),_.prototype.initFromNode.call(this,e,t,n,r),E.prototype.initFromNode.call(this,e,t,n,r),g.prototype.initFromNode.call(this,e,t,n,r),m.prototype.initFromNode.call(this,e,t,n,r)},S.prototype.initFromNode=function(e,t,n,r,i){p.prototype.initFromNode.call(this,e,t,n,i),_.prototype.initFromNode.call(this,e,t,n,i),E.prototype.initFromNode.call(this,e,t,n,i),g.prototype.initFromNode.call(this,e,t,n,i),m.prototype.initFromNode.call(this,e,t,n,i),this.space=r},A.prototype.initFromText=function(e,t,n,r,i){_.prototype.initFromNode.call(this,e,t,null,i),this.text=n,this.space=r},R.prototype.initFromNode=function(e,t,n,r){g.prototype.initFromNode.call(this,e,t,n,r),_.prototype.initFromNode.call(this,e,t,n,r)},I.prototype.createDefaultRegion=function(){var e=new I;return h.call(e,""),p.call(e,{}),E.call(e,[]),_.call(e,0,Number.POSITIVE_INFINITY,null),e},I.prototype.initFromNode=function(e,t,n){h.prototype.initFromNode.call(this,e,null,t,n),p.prototype.initFromNode.call(this,e,null,t,n),_.prototype.initFromNode.call(this,e,null,t,n),E.prototype.initFromNode.call(this,e,null,t,n),
null!==e.head&&null!==e.head.styling&&G(e.head.styling,N(t),this.styleAttrs,n)},D.prototype.initFromNode=function(e,t,n,r){_.prototype.initFromNode.call(this,e,t,n,r);var i=w(n,r);this.qname=null,this.value=null;for(var a in i){if(this.qname){V(r,"More than one style specified on set");break}this.qname=a,this.value=i[a]}}}(t,"undefined"==typeof sax?Xc:sax,"undefined"==typeof imscNames?tc:imscNames,"undefined"==typeof imscStyles?rc:imscStyles,"undefined"==typeof imscUtils?nc:imscUtils)}),Zc=c(function(e,t){!function(e,t,n){function r(e,t,c){var f;if("region"===c.kind?(f=document.createElement("div"),f.style.position="absolute"):"body"===c.kind?f=document.createElement("div"):"div"===c.kind?f=document.createElement("div"):"p"===c.kind?f=document.createElement("p"):"span"===c.kind?f=document.createElement("span"):"br"===c.kind&&(f=document.createElement("br")),!f)return void d(e.errorHandler,"Error processing ISD element kind: "+c.kind);f.style.margin="0";for(var g in h){var p=h[g],E=c.styleAttrs[p.qname];void 0!==E&&null!==p.map&&p.map(e,f,c,E)}var m=f;if("region"===c.kind){var _=c.styleAttrs[n.byName.writingMode.qname];"lrtb"===_||"lr"===_?(e.ipd="lr",e.bpd="tb"):"rltb"===_||"rl"===_?(e.ipd="rl",e.bpd="tb"):"tblr"===_?(e.ipd="tb",e.bpd="lr"):"tbrl"!==_&&"tb"!==_||(e.ipd="tb",e.bpd="rl")}var y=c.styleAttrs[n.byName.linePadding.qname];if(y&&y>0){var T=Math.ceil(y*e.h)+"px";"tb"===e.bpd?(m.style.paddingLeft=T,m.style.paddingRight=T):(m.style.paddingTop=T,m.style.paddingBottom=T),e.lp=y}var v=c.styleAttrs[n.byName.multiRowAlign.qname];if(v&&"auto"!==v){var S=document.createElement("span");S.style.display="inline-block",S.style.textAlign=v,f.appendChild(S),m=S,e.mra=v}if(c.styleAttrs[n.byName.fillLineGap.qname]&&(e.flg=!0),"span"===c.kind&&c.text)if(e.lp||e.mra||e.flg)for(var A="",R=0;R<c.text.length;R++){A+=c.text.charAt(R);var I=c.text.charCodeAt(R);if(I<55296||I>56319||R===c.text.length){var D=document.createElement("span");D.textContent=A,f.appendChild(D),A=""}}else f.textContent=c.text;t.appendChild(f);for(var b in c.contents)r(e,m,c.contents[b]);var M=[];if((e.lp||e.mra||e.flg)&&"p"===c.kind&&(l(e,m,M,null),e.mra&&(a(M),e.mra=null),e.lp&&(i(M,e.lp*e.h,e),e.lp=null),e.flg)){var C=u(m.getBoundingClientRect(),e);o(M,C.before,C.after,e),e.flg=null}if("region"===c.kind&&(l(e,m,M),"tb"===e.bpd&&e.enableRollUp&&c.contents.length>0&&"after"===c.styleAttrs[n.byName.displayAlign.qname])){var N=""===c.id?"_":c.id,w=new s(N,M);if(e.currentISDState[w.id]=w,e.previousISDState&&w.id in e.previousISDState&&e.previousISDState[w.id].plist.length>0&&w.plist.length>1&&w.plist[w.plist.length-2].text===e.previousISDState[w.id].plist[e.previousISDState[w.id].plist.length-1].text){var O=f.firstElementChild,L=w.plist[w.plist.length-1].after-w.plist[w.plist.length-1].before;O.style.bottom="-"+L+"px",O.style.transition="transform 0.4s",O.style.position="relative",O.style.transform="translateY(-"+L+"px)"}}}function i(e,t,n){for(var r in e){var i=e[r].elements.length,a=e[r].elements[e[r].start_elem],o=e[r].elements[e[r].end_elem],s=Math.ceil(t)+"px",u="-"+Math.ceil(t)+"px";0!==i&&("lr"===n.ipd?(a.node.style.borderLeftColor=a.bgcolor||"#00000000",a.node.style.borderLeftStyle="solid",a.node.style.borderLeftWidth=s,a.node.style.marginLeft=u):"rl"===n.ipd?(a.node.style.borderRightColor=a.bgcolor||"#00000000",a.node.style.borderRightStyle="solid",a.node.style.borderRightWidth=s,a.node.style.marginRight=u):"tb"===n.ipd&&(a.node.style.borderTopColor=a.bgcolor||"#00000000",a.node.style.borderTopStyle="solid",a.node.style.borderTopWidth=s,a.node.style.marginTop=u),"lr"===n.ipd?(o.node.style.borderRightColor=o.bgcolor||"#00000000",o.node.style.borderRightStyle="solid",o.node.style.borderRightWidth=s,o.node.style.marginRight=u):"rl"===n.ipd?(o.node.style.borderLeftColor=o.bgcolor||"#00000000",o.node.style.borderLeftStyle="solid",o.node.style.borderLeftWidth=s,o.node.style.marginLeft=u):"tb"===n.ipd&&(o.node.style.borderBottomColor=o.bgcolor||"#00000000",o.node.style.borderBottomStyle="solid",o.node.style.borderBottomWidth=s,o.node.style.marginBottom=u))}}function a(e){for(var t=0;t<e.length-1;t++){var n=e[t].elements.length;if(0!==n&&!1===e[t].br){var r=document.createElement("br"),i=e[t].elements[n-1].node;i.parentElement.insertBefore(r,i.nextSibling)}}}function o(e,t,n,r){for(var i=Math.sign(n-t),a=0;a<=e.length;a++){var o;o=0===a?t:a===e.length?n:(e[a].before+e[a-1].after)/2;var s,u;if(a>0)for(var l=0;l<e[a-1].elements.length;l++)null!==e[a-1].elements[l].bgcolor&&(u=e[a-1].elements[l],i*(u.after-o)<0&&(s=Math.ceil(Math.abs(o-u.after))+"px",u.node.style.backgroundColor=u.bgcolor,"lr"===r.bpd?u.node.style.paddingRight=s:"rl"===r.bpd?u.node.style.paddingLeft=s:"tb"===r.bpd&&(u.node.style.paddingBottom=s)));if(a<e.length)for(var c=0;c<e[a].elements.length;c++)u=e[a].elements[c],null!==u.bgcolor&&i*(u.before-o)>0&&(s=Math.ceil(Math.abs(u.before-o))+"px",u.node.style.backgroundColor=u.bgcolor,"lr"===r.bpd?u.node.style.paddingLeft=s:"rl"===r.bpd?u.node.style.paddingRight=s:"tb"===r.bpd&&(u.node.style.paddingTop=s))}}function s(e,t){this.id=e,this.plist=t}function u(e,t){var n={before:null,after:null,start:null,end:null};return"tb"===t.bpd?(n.before=e.top,n.after=e.bottom,"lr"===t.ipd?(n.start=e.left,n.end=e.right):(n.start=e.right,n.end=e.left)):"lr"===t.bpd?(n.before=e.left,n.after=e.right,n.start=e.top,n.end=e.bottom):"rl"===t.bpd&&(n.before=e.right,n.after=e.left,n.start=e.top,n.end=e.bottom),n}function l(e,t,n,r){var i=t.style.backgroundColor||r;if(0===t.childElementCount)if("span"===t.localName){var a=t.getBoundingClientRect();if(0===a.height||0===a.width)return;var o=u(a,e);if(0!==n.length&&c(o.before,o.after,n[n.length-1].before,n[n.length-1].after)){var s=Math.sign(o.after-o.before),f=Math.sign(o.end-o.start);s*(o.before-n[n.length-1].before)<0&&(n[n.length-1].before=o.before),s*(o.after-n[n.length-1].after)>0&&(n[n.length-1].after=o.after),f*(o.start-n[n.length-1].start)<0&&(n[n.length-1].start=o.start,n[n.length-1].start_elem=n[n.length-1].elements.length),f*(o.end-n[n.length-1].end)>0&&(n[n.length-1].end=o.end,n[n.length-1].end_elem=n[n.length-1].elements.length)}else n.push({before:o.before,after:o.after,start:o.start,end:o.end,start_elem:0,end_elem:0,elements:[],text:"",br:!1});n[n.length-1].text+=t.textContent,n[n.length-1].elements.push({node:t,bgcolor:i,before:o.before,after:o.after})}else"br"===t.localName&&0!==n.length&&(n[n.length-1].br=!0);else for(var d=t.firstChild;d;)d.nodeType===Node.ELEMENT_NODE&&l(e,d,n,i),d=d.nextSibling}function c(e,t,n,r){return t<r&&e>n||r<=t&&n>=e}function f(e,t){this.qname=e,this.map=t}function d(e,t){if(e&&e.error&&e.error(t))throw t}e.render=function(e,t,n,i,a,o,s,u,l){var c=i||t.clientHeight,f=a||t.clientWidth;if(null!==e.aspectRatio){var d=c*e.aspectRatio;d>f?c=Math.round(f/e.aspectRatio):f=d}var h=document.createElement("div");h.style.position="relative",h.style.width=f+"px",h.style.height=c+"px",h.style.margin="auto",h.style.top=0,h.style.bottom=0,h.style.left=0,h.style.right=0,h.style.zIndex=0;var g={h:c,w:f,regionH:null,regionW:null,imgResolver:n,displayForcedOnlyMode:o||!1,isd:e,errorHandler:s,previousISDState:u,enableRollUp:l||!1,currentISDState:{},flg:null,lp:null,mra:null,ipd:null,bpd:null};t.appendChild(h);for(var p in e.contents)r(g,h,e.contents[p]);return g.currentISDState};var h=[new f("http://www.w3.org/ns/ttml#styling backgroundColor",function(e,t,n,r){0!==r[3]&&(t.style.backgroundColor="rgba("+r[0].toString()+","+r[1].toString()+","+r[2].toString()+","+(r[3]/255).toString()+")")}),new f("http://www.w3.org/ns/ttml#styling color",function(e,t,n,r){t.style.color="rgba("+r[0].toString()+","+r[1].toString()+","+r[2].toString()+","+(r[3]/255).toString()+")"}),new f("http://www.w3.org/ns/ttml#styling direction",function(e,t,n,r){t.style.direction=r}),new f("http://www.w3.org/ns/ttml#styling display",function(e,t,n,r){}),new f("http://www.w3.org/ns/ttml#styling displayAlign",function(e,t,n,r){t.style.display="flex",t.style.flexDirection="column","before"===r?t.style.justifyContent="flex-start":"center"===r?t.style.justifyContent="center":"after"===r&&(t.style.justifyContent="flex-end")}),new f("http://www.w3.org/ns/ttml#styling extent",function(e,t,n,r){e.regionH=r.h*e.h,e.regionW=r.w*e.w;var i=0,a=0,o=n.styleAttrs["http://www.w3.org/ns/ttml#styling padding"];o&&(i=(o[0]+o[2])*e.h,a=(o[1]+o[3])*e.w),t.style.height=e.regionH-i+"px",t.style.width=e.regionW-a+"px"}),new f("http://www.w3.org/ns/ttml#styling fontFamily",function(e,t,n,r){var i=[];for(var a in r)"monospaceSerif"===r[a]?(i.push("Courier New"),i.push('"Liberation Mono"'),i.push("Courier"),i.push("monospace")):"proportionalSansSerif"===r[a]?(i.push("Arial"),i.push("Helvetica"),i.push('"Liberation Sans"'),i.push("sans-serif")):"monospace"===r[a]?i.push("monospace"):"sansSerif"===r[a]?i.push("sans-serif"):"serif"===r[a]?i.push("serif"):"monospaceSansSerif"===r[a]?(i.push("Consolas"),i.push("monospace")):"proportionalSerif"===r[a]?i.push("serif"):i.push(r[a]);t.style.fontFamily=i.join(",")}),new f("http://www.w3.org/ns/ttml#styling fontSize",function(e,t,n,r){t.style.fontSize=r*e.h+"px"}),new f("http://www.w3.org/ns/ttml#styling fontStyle",function(e,t,n,r){t.style.fontStyle=r}),new f("http://www.w3.org/ns/ttml#styling fontWeight",function(e,t,n,r){t.style.fontWeight=r}),new f("http://www.w3.org/ns/ttml#styling lineHeight",function(e,t,n,r){t.style.lineHeight="normal"===r?"normal":r*e.h+"px"}),new f("http://www.w3.org/ns/ttml#styling opacity",function(e,t,n,r){t.style.opacity=r}),new f("http://www.w3.org/ns/ttml#styling origin",function(e,t,n,r){t.style.top=r.h*e.h+"px",t.style.left=r.w*e.w+"px"}),new f("http://www.w3.org/ns/ttml#styling overflow",function(e,t,n,r){t.style.overflow=r}),new f("http://www.w3.org/ns/ttml#styling padding",function(e,t,n,r){var i=[];i[0]=r[0]*e.h+"px",i[1]=r[3]*e.w+"px",i[2]=r[2]*e.h+"px",i[3]=r[1]*e.w+"px",t.style.padding=i.join(" ")}),new f("http://www.w3.org/ns/ttml#styling showBackground",null),new f("http://www.w3.org/ns/ttml#styling textAlign",function(e,t,r,i){var a,o=r.styleAttrs[n.byName.direction.qname];a="start"===i?"rtl"===o?"right":"left":"end"===i?"rtl"===o?"left":"right":i,t.style.textAlign=a}),new f("http://www.w3.org/ns/ttml#styling textDecoration",function(e,t,n,r){t.style.textDecoration=r.join(" ").replace("lineThrough","line-through")}),new f("http://www.w3.org/ns/ttml#styling textOutline",function(e,t,n,r){t.style.textShadow="none"===r?"":"rgba("+r.color[0].toString()+","+r.color[1].toString()+","+r.color[2].toString()+","+(r.color[3]/255).toString()+") 0px 0px "+r.thickness*e.h+"px"}),new f("http://www.w3.org/ns/ttml#styling unicodeBidi",function(e,t,n,r){var i;i="bidiOverride"===r?"bidi-override":r,t.style.unicodeBidi=i}),new f("http://www.w3.org/ns/ttml#styling visibility",function(e,t,n,r){t.style.visibility=r}),new f("http://www.w3.org/ns/ttml#styling wrapOption",function(e,t,n,r){"wrap"===r?"preserve"===n.space?t.style.whiteSpace="pre-wrap":t.style.whiteSpace="normal":"preserve"===n.space?t.style.whiteSpace="pre":t.style.whiteSpace="noWrap"}),new f("http://www.w3.org/ns/ttml#styling writingMode",function(e,t,n,r){"lrtb"===r||"lr"===r?t.style.writingMode="horizontal-tb":"rltb"===r||"rl"===r?t.style.writingMode="horizontal-tb":"tblr"===r?t.style.writingMode="vertical-lr":"tbrl"!==r&&"tb"!==r||(t.style.writingMode="vertical-rl")}),new f("http://www.w3.org/ns/ttml#styling zIndex",function(e,t,n,r){t.style.zIndex=r}),new f("http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt backgroundImage",function(e,t,n,r){if(null!==e.imgResolver&&null!==r){var i=document.createElement("img"),a=e.imgResolver(r,i);a&&(i.src=a),i.height=e.regionH,i.width=e.regionW,t.appendChild(i)}}),new f("http://www.w3.org/ns/ttml/profile/imsc1#styling forcedDisplay",function(e,t,n,r){e.displayForcedOnlyMode&&!1===r&&(t.style.visibility="hidden")})],g={};for(var p in h)g[h[p].qname]=h[p]}(t,"undefined"==typeof imscNames||imscNames,"undefined"==typeof imscStyles?rc:imscStyles)}),$c=ic.generateISD,Jc=Qc.fromXML,ef=Zc.render;qn.__dashjs_factory_name="TextTracks";var tf=nu.getSingletonFactory(qn);cs("trim",function(e){return function(){return e(this,3)}});var nf=/"/g,rf=function(e,t,n,r){var i=String(Ro(e)),a="<"+t;return""!==n&&(a+=" "+n+'="'+String(r).replace(nf,"&quot;")+'"'),a+">"+i+"</"+t+">"};!function(e,t){var n={};n[e]=t(rf),So(So.P+So.F*Fa(function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}),"String",n)}("italics",function(e){return function(){return e(this,"i","","")}}),jn.__dashjs_factory_name="EmbeddedTextHtmlRender";var af=nu.getSingletonFactory(jn),of=c(function(e,t){!function(e){var t={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},n=function(e){var n=e;return t.hasOwnProperty(e)&&(n=t[e]),String.fromCharCode(n)},r={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},i={17:2,18:4,21:6,22:8,23:10,19:13,20:15},a={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},o={25:2,26:4,29:6,30:8,31:10,27:13,28:15},s=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],u={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(e){this.time=e},log:function(e,t){var n=this.verboseFilter[e];this.verboseLevel>=n&&console.log(this.time+" ["+e+"] "+t)}},l=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].toString(16));return t},c=function(e,t,n,r,i){this.foreground=e||"white",this.underline=t||!1,this.italics=n||!1,this.background=r||"black",this.flash=i||!1};c.prototype={reset:function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},setStyles:function(e){for(var t=["foreground","underline","italics","background","flash"],n=0;n<t.length;n++){var r=t[n];e.hasOwnProperty(r)&&(this[r]=e[r])}},isDefault:function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},equals:function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash},copy:function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash},toString:function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}};var f=function(e,t,n,r,i,a){this.uchar=e||" ",this.penState=new c(t,n,r,i,a)};f.prototype={reset:function(){this.uchar=" ",this.penState.reset()},setChar:function(e,t){this.uchar=e,this.penState.copy(t)},setPenState:function(e){this.penState.copy(e)},equals:function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)},copy:function(e){this.uchar=e.uchar,this.penState.copy(e.penState)},isEmpty:function(){return" "===this.uchar&&this.penState.isDefault()}};var d=function(){this.chars=[];for(var e=0;e<32;e++)this.chars.push(new f);this.pos=0,this.currPenState=new c};d.prototype={equals:function(e){for(var t=!0,n=0;n<32;n++)if(!this.chars[n].equals(e.chars[n])){t=!1;break}return t},copy:function(e){for(var t=0;t<32;t++)this.chars[t].copy(e.chars[t])},isEmpty:function(){for(var e=!0,t=0;t<32;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e},setCursor:function(e){this.pos!==e&&(this.pos=e),this.pos<0?(u.log("ERROR","Negative cursor position "+this.pos),this.pos=0):this.pos>32&&(u.log("ERROR","Too large cursor position "+this.pos),this.pos=32)},moveCursor:function(e){var t=this.pos+e;if(e>1)for(var n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)},backSpace:function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},insertChar:function(e){e>=144&&this.backSpace();var t=n(e);if(this.pos>=32)return void u.log("ERROR","Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)},clearFromPos:function(e){var t;for(t=e;t<32;t++)this.chars[t].reset()},clear:function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},clearToEndOfRow:function(){this.clearFromPos(this.pos)},getTextString:function(){for(var e=[],t=!0,n=0;n<32;n++){var r=this.chars[n].uchar;" "!==r&&(t=!1),e.push(r)}return t?"":e.join("")},setPenStyles:function(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}};var h=function(){this.rows=[];for(var e=0;e<15;e++)this.rows.push(new d);this.currRow=14,this.nrRollUpRows=null,this.reset()};h.prototype={reset:function(){for(var e=0;e<15;e++)this.rows[e].clear();this.currRow=14},equals:function(e){for(var t=!0,n=0;n<15;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t},copy:function(e){for(var t=0;t<15;t++)this.rows[t].copy(e.rows[t])},isEmpty:function(){for(var e=!0,t=0;t<15;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e},backSpace:function(){this.rows[this.currRow].backSpace()},clearToEndOfRow:function(){this.rows[this.currRow].clearToEndOfRow()},insertChar:function(e){this.rows[this.currRow].insertChar(e)},setPen:function(e){this.rows[this.currRow].setPenStyles(e)},moveCursor:function(e){this.rows[this.currRow].moveCursor(e)},setCursor:function(e){u.log("INFO","setCursor: "+e),this.rows[this.currRow].setCursor(e)},setPAC:function(e){u.log("INFO","pacData = "+JSON.stringify(e));var t=e.row-1;this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.currRow=t;var n=this.rows[this.currRow];if(null!==e.indent){var r=e.indent,i=Math.max(r-1,0);n.setCursor(e.indent),e.color=n.chars[i].penState.foreground}var a={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(a)},setBkgData:function(e){u.log("INFO","bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)},setRollUpRows:function(e){this.nrRollUpRows=e},rollUp:function(){if(null===this.nrRollUpRows)return void u.log("DEBUG","roll_up but nrRollUpRows not set yet");u.log("TEXT",this.getDisplayText());var e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),u.log("INFO","Rolling up")},getDisplayText:function(e){e=e||!1;for(var t=[],n="",r=-1,i=0;i<15;i++){var a=this.rows[i].getTextString();a&&(r=i+1,e?t.push("Row "+r+': "'+a+'"'):t.push(a.trim()))}return t.length>0&&(n=e?"["+t.join(" | ")+"]":t.join("\n")),n},getTextAndFormat:function(){return this.rows}};var g=function(e,t){this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new h,this.nonDisplayedMemory=new h,this.lastOutputScreen=new h,this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null};g.prototype={modes:["MODE_ROLL-UP","MODE_POP-ON","MODE_PAINT-ON","MODE_TEXT"],reset:function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.lastCueEndTime=null},getHandler:function(){return this.outputFilter},setHandler:function(e){this.outputFilter=e},setPAC:function(e){this.writeScreen.setPAC(e)},setBkgData:function(e){this.writeScreen.setBkgData(e)},setMode:function(e){e!==this.mode&&(this.mode=e,u.log("INFO","MODE="+e),"MODE_POP-ON"==this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)},insertChars:function(e){for(var t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);var n=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";u.log("INFO",n+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(u.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},cc_RCL:function(){u.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},cc_BS:function(){u.log("INFO","BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},cc_AOF:function(){},cc_AON:function(){},cc_DER:function(){u.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},cc_RU:function(e){u.log("INFO","RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)},cc_FON:function(){u.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})},cc_RDC:function(){u.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},cc_TR:function(){u.log("INFO","TR"),this.setMode("MODE_TEXT")},cc_RTD:function(){u.log("INFO","RTD"),this.setMode("MODE_TEXT")},cc_EDM:function(){u.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate()},cc_CR:function(){u.log("CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate()},cc_ENM:function(){u.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},cc_EOC:function(){if(u.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,u.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate()},cc_TO:function(e){u.log("INFO","TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)},cc_MIDROW:function(e){var t={flash:!1};if(t.underline=e%2==1,t.italics=e>=46,t.italics)t.foreground="white";else{var n=Math.floor(e/2)-16,r=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=r[n]}u.log("INFO","MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)},outputDataUpdate:function(){var e=u.time;null!==e&&this.outputFilter&&(this.outputFilter.updateData&&this.outputFilter.updateData(e,this.displayedMemory),null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.lastOutputScreen),this.cueStartTime=this.displayedMemory.isEmpty()?null:e):this.cueStartTime=e,this.lastOutputScreen.copy(this.displayedMemory))},cueSplitAtTime:function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}};var p=function(e,t,n){this.field=e||1,this.outputs=[t,n],this.channels=[new g(1,t),new g(2,n)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.bufferedData=[],this.startTime=null,this.lastTime=null,this.dataCounters={padding:0,char:0,cmd:0,other:0}};p.prototype={getHandler:function(e){return this.channels[e].getHandler()},setHandler:function(e,t){this.channels[e].setHandler(t)},addData:function(e,t){var n,r,i,a=!1;this.lastTime=e,u.setTime(e);for(var o=0;o<t.length;o+=2)if(r=127&t[o],i=127&t[o+1],r>=16&&r<=31&&r===this.lastCmdA&&i===this.lastCmdB)this.lastCmdA=null,this.lastCmdB=null,u.log("DEBUG","Repeated command ("+l([r,i])+") is dropped");else if(0!==r||0!==i){if(u.log("DATA","["+l([t[o],t[o+1]])+"] -> ("+l([r,i])+")"),n=this.parseCmd(r,i),n||(n=this.parseMidrow(r,i)),n||(n=this.parsePAC(r,i)),n||(n=this.parseBackgroundAttributes(r,i)),!n&&(a=this.parseChars(r,i)))if(this.currChNr&&this.currChNr>=0){var s=this.channels[this.currChNr-1];s.insertChars(a)}else u.log("WARNING","No channel found yet. TEXT-MODE?");n?this.dataCounters.cmd+=2:a?this.dataCounters.char+=2:(this.dataCounters.other+=2,u.log("WARNING","Couldn't parse cleaned data "+l([r,i])+" orig: "+l([t[o],t[o+1]])))}else this.dataCounters.padding+=2},parseCmd:function(e,t){var n=null,r=(20===e||21===e||28===e||29===e)&&32<=t&&t<=47,i=(23===e||31===e)&&33<=t&&t<=35;if(!r&&!i)return!1;n=20===e||21===e||23===e?1:2;var a=this.channels[n-1];return 20===e||21===e||28===e||29===e?32===t?a.cc_RCL():33===t?a.cc_BS():34===t?a.cc_AOF():35===t?a.cc_AON():36===t?a.cc_DER():37===t?a.cc_RU(2):38===t?a.cc_RU(3):39===t?a.cc_RU(4):40===t?a.cc_FON():41===t?a.cc_RDC():42===t?a.cc_TR():43===t?a.cc_RTD():44===t?a.cc_EDM():45===t?a.cc_CR():46===t?a.cc_ENM():47===t&&a.cc_EOC():a.cc_TO(t-32),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=n,!0},parseMidrow:function(e,t){var n=null;if((17===e||25===e)&&32<=t&&t<=47){if((n=17===e?1:2)!==this.currChNr)return u.log("ERROR","Mismatch channel in midrow parsing"),!1;var r=this.channels[n-1];return r.insertChars([32]),r.cc_MIDROW(t),u.log("DEBUG","MIDROW ("+l([e,t])+")"),this.lastCmdA=e,this.lastCmdB=t,!0}return!1},parsePAC:function(e,t){var n=null,s=null,u=(17<=e&&e<=23||25<=e&&e<=31)&&64<=t&&t<=127,l=(16===e||24===e)&&64<=t&&t<=95;if(!u&&!l)return!1;n=e<=23?1:2,s=64<=t&&t<=95?1===n?r[e]:a[e]:1===n?i[e]:o[e];var c=this.interpretPAC(s,t);return this.channels[n-1].setPAC(c),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=n,!0},interpretPAC:function(e,t){var n=t,r={color:null,italics:!1,indent:null,underline:!1,row:e};return n=t>95?t-96:t-64,r.underline=1==(1&n),n<=13?r.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(r.italics=!0,r.color="white"):r.indent=4*Math.floor((n-16)/2),r},parseChars:function(e,t){var r=null,i=null,a=null;if(e>=25?(r=2,a=e-8):(r=1,a=e),17<=a&&a<=19){var o=t;o=17===a?t+80:18===a?t+112:t+144,u.log("INFO","Special char '"+n(o)+"' in channel "+r),i=[o],this.lastCmdA=e,this.lastCmdB=t}else 32<=e&&e<=127&&(i=0===t?[e]:[e,t],this.lastCmdA=null,this.lastCmdB=null);if(i){var s=l(i);u.log("DEBUG","Char codes =  "+s.join(","))}return i},parseBackgroundAttributes:function(e,t){var n,r,i,a,o=(16===e||24===e)&&32<=t&&t<=47,u=(23===e||31===e)&&45<=t&&t<=47;return!(!o&&!u)&&(n={},16===e||24===e?(r=Math.floor((t-32)/2),n.background=s[r],t%2==1&&(n.background=n.background+"_semi")):45===t?n.background="transparent":(n.foreground="black",47===t&&(n.underline=!0)),i=e<24?1:2,a=this.channels[i-1],a.setBkgData(n),this.lastCmdA=e,this.lastCmdB=t,!0)},reset:function(){for(var e=0;e<this.channels.length;e++)this.channels[e]&&this.channels[e].reset();this.lastCmdA=null,this.lastCmdB=null},cueSplitAtTime:function(e){for(var t=0;t<this.channels.length;t++)this.channels[t]&&this.channels[t].cueSplitAtTime(e)}};var E=function(e,t,n){for(var r=0,i=t,a=[];i<t+n;){if(r=e.getUint32(i),6===(31&e.getUint8(i+4)))for(var o=i+5,s=-1;o<i+4+r-1;){s=0;for(var u=255;255===u;)u=e.getUint8(o),s+=u,o++;var l=0;for(u=255;255===u;)u=e.getUint8(o),l+=u,o++;(function(e,t,n,r){if(4!==e||t<8)return null;var i=n.getUint8(r),a=n.getUint16(r+1),o=n.getUint32(r+3),s=n.getUint8(r+7);return 181==i&&49==a&&1195456820==o&&3==s})(s,l,e,o)&&a.push([o,l]),o+=l}i+=r+4}return a},m=function(e,t){var n=t[0],r=[[],[]];n+=8;var i=31&e.getUint8(n);n+=2;for(var a=0;a<i;a++){var o=e.getUint8(n),s=4&o,u=3&o;n++;var l=e.getUint8(n);n++;var c=e.getUint8(n);n++,s&&(127&l)+(127&c)!=0&&(0===u?(r[0].push(l),r[0].push(c)):1===u&&(r[1].push(l),r[1].push(c)))}return r};e.logger=u,e.PenState=c,e.CaptionScreen=h,e.Cea608Parser=p,e.findCea608Nalus=E,e.extractCea608DataFromRange=m}(t)}),sf=function(){function e(){d(this,e)}return g(e,[{key:"extend",value:function(e,t){if(e){var n=!!t&&t.override,r=!!t&&t.publicOnly;for(var i in e)!e.hasOwnProperty(i)||this[i]&&!n||r&&-1===e[i].indexOf("public_")||(this[i]=e[i])}}}]),e}(),uf=function(e){function t(){var e;return d(this,t),e=T(this,m(t).call(this)),e.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE=10,e.MANIFEST_LOADER_LOADING_FAILURE_ERROR_CODE=11,e.XLINK_LOADER_LOADING_FAILURE_ERROR_CODE=12,e.SEGMENTS_UPDATE_FAILED_ERROR_CODE=13,e.SEGMENTS_UNAVAILABLE_ERROR_CODE=14,e.SEGMENT_BASE_LOADER_ERROR_CODE=15,e.TIME_SYNC_FAILED_ERROR_CODE=16,e.FRAGMENT_LOADER_LOADING_FAILURE_ERROR_CODE=17,e.FRAGMENT_LOADER_NULL_REQUEST_ERROR_CODE=18,e.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE=19,e.APPEND_ERROR_CODE=20,e.REMOVE_ERROR_CODE=21,e.DATA_UPDATE_FAILED_ERROR_CODE=22,e.CAPABILITY_MEDIASOURCE_ERROR_CODE=23,e.CAPABILITY_MEDIAKEYS_ERROR_CODE=24,e.DOWNLOAD_ERROR_ID_MANIFEST_CODE=25,e.DOWNLOAD_ERROR_ID_MANIFEST="manifest",e.DOWNLOAD_ERROR_ID_SIDX_CODE=26,e.DOWNLOAD_ERROR_ID_CONTENT_CODE=27,e.DOWNLOAD_ERROR_ID_CONTENT="content",e.DOWNLOAD_ERROR_ID_INITIALIZATION_CODE=28,e.DOWNLOAD_ERROR_ID_INITIALIZATION="initialization",e.DOWNLOAD_ERROR_ID_XLINK_CODE=29,e.DOWNLOAD_ERROR_ID_XLINK="xlink",e.MANIFEST_ERROR_ID_CODEC_CODE=30,e.MANIFEST_ERROR_ID_PARSE_CODE=31,e.MANIFEST_ERROR_ID_NOSTREAMS_CODE=32,e.TIMED_TEXT_ERROR_ID_PARSE_CODE=33,e.MANIFEST_ERROR_ID_MULTIPLEXED_CODE=34,e.MEDIASOURCE_TYPE_UNSUPPORTED_CODE=35,e.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE="parsing failed for ",e.MANIFEST_LOADER_LOADING_FAILURE_ERROR_MESSAGE="Failed loading manifest: ",e.XLINK_LOADER_LOADING_FAILURE_ERROR_MESSAGE="Failed loading Xlink element: ",e.SEGMENTS_UPDATE_FAILED_ERROR_MESSAGE="Segments update failed",e.SEGMENTS_UNAVAILABLE_ERROR_MESSAGE="no segments are available yet",e.SEGMENT_BASE_LOADER_ERROR_MESSAGE="error loading segments",e.TIME_SYNC_FAILED_ERROR_MESSAGE="Failed to synchronize time",e.FRAGMENT_LOADER_NULL_REQUEST_ERROR_MESSAGE="request is null",e.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE="Failed to resolve a valid URL",e.APPEND_ERROR_MESSAGE="chunk is not defined",e.REMOVE_ERROR_MESSAGE="buffer is not defined",e.DATA_UPDATE_FAILED_ERROR_MESSAGE="Data update failed",e.CAPABILITY_MEDIASOURCE_ERROR_MESSAGE="mediasource is not supported",e.CAPABILITY_MEDIAKEYS_ERROR_MESSAGE="mediakeys is not supported",e.TIMED_TEXT_ERROR_MESSAGE_PARSE="parsing error :",e.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE="Error creating source buffer of type : ",e}return E(t,e),t}(sf),lf=new uf;zn.__dashjs_factory_name="TextSourceBuffer";var cf=nu.getSingletonFactory(zn),ff=ho("match"),df=function(e){var t;return Ua(e)&&(void 0!==(t=e[ff])?!!t:"RegExp"==co(e))},hf=Math.min,gf=[].push,pf="length",Ef=!!function(){try{return new RegExp("x","y")}catch(e){}}();Pu("split",2,function(e,t,n,r){var i=n;return"c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1)[pf]||2!="ab".split(/(?:ab)*/)[pf]||4!=".".split(/(.?)(.?)/)[pf]||".".split(/()()/)[pf]>1||"".split(/.?/)[pf]?i=function(e,t){var r=String(this);if(void 0===e&&0===t)return[];if(!df(e))return n.call(r,e,t);for(var i,a,o,s=[],u=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),l=0,c=void 0===t?4294967295:t>>>0,f=new RegExp(e.source,u+"g");(i=Nu.call(f,r))&&!((a=f.lastIndex)>l&&(s.push(r.slice(l,i.index)),i[pf]>1&&i.index<r[pf]&&gf.apply(s,i.slice(1)),o=i[0][pf],l=a,s[pf]>=c));)f.lastIndex===i.index&&f.lastIndex++;return l===r[pf]?!o&&f.test("")||s.push(""):s.push(r.slice(l)),s[pf]>c?s.slice(0,c):s}:"0".split(void 0,0)[pf]&&(i=function(e,t){return void 0===e&&0===t?[]:n.call(this,e,t)}),[function(n,r){var a=e(this),o=void 0==n?void 0:n[t];return void 0!==o?o.call(n,a,r):i.call(String(a),n,r)},function(e,t){var a=r(i,e,this,t,i!==n);if(a.done)return a.value;var o=Ba(e),s=String(this),u=cl(o,RegExp),l=o.unicode,c=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(Ef?"y":"g"),f=new u(Ef?o:"^(?:"+o.source+")",c),d=void 0===t?4294967295:t>>>0;if(0===d)return[];if(0===s.length)return null===Ru(f,s)?[s]:[];for(var h=0,g=0,p=[];g<s.length;){f.lastIndex=Ef?g:0;var E,m=Ru(f,Ef?s:s.slice(g))
;if(null===m||(E=hf(No(f.lastIndex+(Ef?0:g)),s.length))===h)g=Su(s,g,l);else{if(p.push(s.slice(h,g)),p.length===d)return p;for(var _=1;_<=m.length-1;_++)if(p.push(m[_]),p.length===d)return p;g=h=E}}return p.push(s.slice(h)),p}]});var mf="WEBVTT";Wn.__dashjs_factory_name="VTTParser";var _f=nu.getSingletonFactory(Wn);Xn.__dashjs_factory_name="TTMLParser";var yf=nu.getSingletonFactory(Xn);Qn.__dashjs_factory_name="TextController";var Tf=nu.getSingletonFactory(Qn),vf=.1;Zn.__dashjs_factory_name="SourceBufferSink";var Sf=nu.getClassFactory(Zn);So(So.S+So.F*!xa,"Object",{defineProperty:za.f}),$n.__dashjs_factory_name="PreBufferSink";var Af=nu.getClassFactory($n);So(So.S,"Array",{isArray:Ls});var Rf=-1,If={DEFAULT:.5,STRONG:1,WEAK:0};Jn.__dashjs_factory_name="SwitchRequest";var Df=nu.getClassFactory(Jn);Df.NO_CHANGE=Rf,Df.PRIORITY=If,nu.updateClassFactory(Jn.__dashjs_factory_name,Df),er.__dashjs_factory_name="ThroughputRule";var bf=nu.getClassFactory(er);tr.__dashjs_factory_name="InsufficientBufferRule";var Mf=nu.getClassFactory(tr);nr.__dashjs_factory_name="AbandonRequestsRule";var Cf=nu.getClassFactory(nr);rr.__dashjs_factory_name="DroppedFramesRule";var Nf=nu.getClassFactory(rr);ir.__dashjs_factory_name="SwitchHistoryRule";var wf=nu.getClassFactory(ir),Of=0,Lf=1,Pf=2,Ff=10,xf=2,Uf=.99;ar.__dashjs_factory_name="BolaRule";var Bf=nu.getClassFactory(ar),kf="qualitySwitchRules",Gf="abandonFragmentRules";or.__dashjs_factory_name="ABRRulesCollection";var Yf=nu.getClassFactory(or);Yf.QUALITY_SWITCH_RULES=kf,Yf.ABANDON_FRAGMENT_RULES=Gf,nu.updateSingletonFactory(or.__dashjs_factory_name,Yf);var Kf=function e(){d(this,e),this.mediaType=null,this.bitrate=null,this.width=null,this.height=null,this.scanType=null,this.qualityIndex=NaN};sr.__dashjs_factory_name="RulesContext";var Vf=nu.getClassFactory(sr),Hf=8;ur.__dashjs_factory_name="SwitchRequestHistory";var qf=nu.getClassFactory(ur);lr.__dashjs_factory_name="DroppedFramesHistory";var jf=nu.getClassFactory(lr);cr.__dashjs_factory_name="ThroughputHistory";var zf=nu.getClassFactory(cr),Wf="abandonload",Xf="allowload",Qf=1e3,Zf=100,$f=0;fr.__dashjs_factory_name="AbrController";var Jf=nu.getSingletonFactory(fr);Jf.ABANDON_LOAD=Wf,Jf.QUALITY_DEFAULT=$f,nu.updateSingletonFactory(fr.__dashjs_factory_name,Jf);var ed="neverReplace",td="alwaysReplace",nd="highestBitrate",rd="widestRange",id=nd;dr.__dashjs_factory_name="MediaController";var ad=nu.getSingletonFactory(dr);ad.TRACK_SWITCH_MODE_NEVER_REPLACE=ed,ad.TRACK_SWITCH_MODE_ALWAYS_REPLACE=td,ad.TRACK_SELECTION_MODE_HIGHEST_BITRATE=nd,ad.TRACK_SELECTION_MODE_WIDEST_RANGE=rd,ad.DEFAULT_INIT_TRACK_SELECTION_MODE=id,nu.updateSingletonFactory(dr.__dashjs_factory_name,ad),hr.__dashjs_factory_name="InitCache";var od=nu.getSingletonFactory(hr),sd="bufferLoaded",ud="bufferStalled",ld=.5,cd=.5,fd=.01,dd=22,hd="BufferController";gr.__dashjs_factory_name=hd;var gd=nu.getClassFactory(gr);gd.BUFFER_LOADED=sd,gd.BUFFER_EMPTY=ud,nu.updateClassFactory(gr.__dashjs_factory_name,gd);var pd=500;pr.__dashjs_factory_name="PlaybackController";var Ed=nu.getSingletonFactory(pr),md=za.f,_d=ns.f,yd=ka.RegExp,Td=yd,vd=yd.prototype,Sd=/a/g,Ad=/a/g,Rd=new yd(Sd)!==Sd;if(xa&&(!Rd||Fa(function(){return Ad[ho("match")]=!1,yd(Sd)!=Sd||yd(Ad)==Ad||"/a/i"!=yd(Sd,"i")}))){yd=function(e,t){var n=this instanceof yd,r=df(e),i=void 0===t;return!n&&r&&e.constructor===yd&&i?e:zo(Rd?new Td(r&&!i?e.source:e,t):Td((r=e instanceof yd)?e.source:e,r&&i?Wa.call(e):t),n?this:vd,yd)};for(var Id=_d(Td),Dd=0;Id.length>Dd;)!function(e){e in yd||md(yd,e,{configurable:!0,get:function(){return Td[e]},set:function(t){Td[e]=t}})}(Id[Dd++]);vd.constructor=yd,yd.prototype=vd,ro(ka,"RegExp",yd)}Il("RegExp");!function(e,t){var n=(no.Object||{})[e]||Object[e],r={};r[e]=t(n),So(So.S+So.F*Fa(function(){n(1)}),"Object",r)}("keys",function(){return function(e){return fs(Os(e))}});var bd=ka.isFinite;So(So.S,"Number",{isFinite:function(e){return"number"==typeof e&&bd(e)}}),Er.__dashjs_factory_name="LiveEdgeFinder";var Md=nu.getClassFactory(Er),Cd="NotFragmentedTextBufferController";mr.__dashjs_factory_name=Cd;var Nd=nu.getClassFactory(mr);_r.__dashjs_factory_name="TextBufferController";var wd=nu.getClassFactory(_r),Od=function e(){d(this,e),this.start=null,this.mstart=null,this.starttype=null,this.trace=[]};Od.INITIAL_PLAYOUT_START_REASON="initial_playout",Od.SEEK_START_REASON="seek",Od.RESUME_FROM_PAUSE_START_REASON="resume",Od.METRICS_COLLECTION_START_REASON="metrics_collection_start";var Ld=function e(){d(this,e),this.representationid=null,this.subreplevel=null,this.start=null,this.mstart=null,this.duration=null,this.playbackspeed=null,this.stopreason=null};Ld.REPRESENTATION_SWITCH_STOP_REASON="representation_switch",Ld.REBUFFERING_REASON="rebuffering",Ld.USER_REQUEST_STOP_REASON="user_request",Ld.END_OF_PERIOD_STOP_REASON="end_of_period",Ld.END_OF_CONTENT_STOP_REASON="end_of_content",Ld.METRICS_COLLECTION_STOP_REASON="metrics_collection_end",Ld.FAILURE_STOP_REASON="failure",yr.__dashjs_factory_name="BufferLevelRule";var Pd=nu.getClassFactory(yr);Tr.__dashjs_factory_name="NextFragmentRequestRule";var Fd=nu.getClassFactory(Tr),xd=function e(){d(this,e),this.indexRange=null,this.index=null,this.mediaRange=null,this.media=null,this.duration=NaN,this.replacementTime=null,this.replacementNumber=NaN,this.mediaStartTime=NaN,this.presentationStartTime=NaN,this.availabilityStartTime=NaN,this.availabilityEndTime=NaN,this.availabilityIdx=NaN,this.wallStartTime=NaN,this.representation=null};Nr.__dashjs_factory_name="ScheduleController";var Ud=nu.getClassFactory(Nr),Bd=function(){function e(){d(this,e),this.init()}return g(e,[{key:"init",value:function(){this.BASE_URL="BaseURL",this.SEGMENT_BASE="SegmentBase",this.SEGMENT_TEMPLATE="SegmentTemplate",this.SEGMENT_LIST="SegmentList",this.SEGMENT_URL="SegmentURL",this.SEGMENT_TIMELINE="SegmentTimeline",this.SEGMENT_PROFILES="segmentProfiles",this.ADAPTATION_SET="AdaptationSet",this.REPRESENTATION="Representation",this.REPRESENTATION_INDEX="RepresentationIndex",this.SUB_REPRESENTATION="SubRepresentation",this.INITIALIZATION="Initialization",this.INITIALIZATION_MINUS="initialization",this.MPD="MPD",this.PERIOD="Period",this.ASSET_IDENTIFIER="AssetIdentifier",this.EVENT_STREAM="EventStream",this.ID="id",this.PROFILES="profiles",this.SERVICE_LOCATION="serviceLocation",this.RANGE="range",this.INDEX="index",this.MEDIA="media",this.BYTE_RANGE="byteRange",this.INDEX_RANGE="indexRange",this.MEDIA_RANGE="mediaRange",this.VALUE="value",this.CONTENT_TYPE="contentType",this.MIME_TYPE="mimeType",this.BITSTREAM_SWITCHING="BitstreamSwitching",this.BITSTREAM_SWITCHING_MINUS="bitstreamSwitching",this.CODECS="codecs",this.DEPENDENCY_ID="dependencyId",this.MEDIA_STREAM_STRUCTURE_ID="mediaStreamStructureId",this.METRICS="Metrics",this.METRICS_MINUS="metrics",this.REPORTING="Reporting",this.WIDTH="width",this.HEIGHT="height",this.SAR="sar",this.FRAMERATE="frameRate",this.AUDIO_SAMPLING_RATE="audioSamplingRate",this.MAXIMUM_SAP_PERIOD="maximumSAPPeriod",this.START_WITH_SAP="startWithSAP",this.MAX_PLAYOUT_RATE="maxPlayoutRate",this.CODING_DEPENDENCY="codingDependency",this.SCAN_TYPE="scanType",this.FRAME_PACKING="FramePacking",this.AUDIO_CHANNEL_CONFIGURATION="AudioChannelConfiguration",this.CONTENT_PROTECTION="ContentProtection",this.ESSENTIAL_PROPERTY="EssentialProperty",this.SUPPLEMENTAL_PROPERTY="SupplementalProperty",this.INBAND_EVENT_STREAM="InbandEventStream",this.ACCESSIBILITY="Accessibility",this.ROLE="Role",this.RATING="Rating",this.CONTENT_COMPONENT="ContentComponent",this.SUBSET="Subset",this.LANG="lang",this.VIEWPOINT="Viewpoint",this.ROLE_ASARRAY="Role_asArray",this.ACCESSIBILITY_ASARRAY="Accessibility_asArray",this.AUDIOCHANNELCONFIGURATION_ASARRAY="AudioChannelConfiguration_asArray",this.CONTENTPROTECTION_ASARRAY="ContentProtection_asArray",this.MAIN="main",this.DYNAMIC="dynamic",this.MEDIA_PRESENTATION_DURATION="mediaPresentationDuration",this.MINIMUM_UPDATE_PERIOD="minimumUpdatePeriod",this.CODEC_PRIVATE_DATA="codecPrivateData",this.BANDWITH="bandwidth",this.SOURCE_URL="sourceURL",this.TIMESCALE="timescale",this.DURATION="duration",this.START_NUMBER="startNumber",this.PRESENTATION_TIME_OFFSET="presentationTimeOffset",this.AVAILABILITY_START_TIME="availabilityStartTime",this.AVAILABILITY_END_TIME="availabilityEndTime",this.TIMESHIFT_BUFFER_DEPTH="timeShiftBufferDepth",this.MAX_SEGMENT_DURATION="maxSegmentDuration",this.PRESENTATION_TIME="presentationTime",this.MIN_BUFFER_TIME="minBufferTime",this.MAX_SUBSEGMENT_DURATION="maxSubsegmentDuration",this.START="start",this.AVAILABILITY_TIME_OFFSET="availabilityTimeOffset",this.AVAILABILITY_TIME_COMPLETE="availabilityTimeComplete",this.CENC_DEFAULT_KID="cenc:default_KID",this.DVB_PRIORITY="dvb:priority",this.DVB_WEIGHT="dvb:weight"}}]),e}(),kd=new Bd,Gd=function(){function e(){d(this,e),this.id=null,this.index=-1,this.adaptation=null,this.segmentInfoType=null,this.initialization=null,this.codecs=null,this.codecPrivateData=null,this.segmentDuration=NaN,this.timescale=1,this.startNumber=1,this.indexRange=null,this.range=null,this.presentationTimeOffset=0,this.MSETimeOffset=NaN,this.segmentAvailabilityRange=null,this.availableSegmentsNumber=0,this.bandwidth=NaN,this.width=NaN,this.height=NaN,this.scanType=null,this.maxPlayoutRate=NaN,this.availabilityTimeOffset=0,this.availabilityTimeComplete=!0}return g(e,null,[{key:"hasInitialization",value:function(e){return null!==e.initialization||null!==e.range}},{key:"hasSegments",value:function(e){return e.segmentInfoType!==kd.BASE_URL&&e.segmentInfoType!==kd.SEGMENT_BASE&&!e.indexRange}}]),e}();wr.__dashjs_factory_name="RepresentationController";var Yd=nu.getClassFactory(wr),Kd=[].lastIndexOf,Vd=!!Kd&&1/[1].lastIndexOf(1,-0)<0;So(So.P+So.F*(Vd||!Fo(Kd)),"Array",{lastIndexOf:function(e){if(Vd)return Kd.apply(this,arguments)||0;var t=Io(this),n=No(t.length),r=n-1;for(arguments.length>1&&(r=Math.min(r,Mo(arguments[1]))),r<0&&(r=n+r);r>=0;r--)if(r in t&&t[r]===e)return r||0;return-1}}),Or.__dashjs_factory_name="URLUtils";var Hd=nu.getSingletonFactory(Or);Lr.__dashjs_factory_name="TimelineSegmentsGetter";var qd=nu.getClassFactory(Lr);Pr.__dashjs_factory_name="TemplateSegmentsGetter";var jd=nu.getClassFactory(Pr);Fr.__dashjs_factory_name="ListSegmentsGetter";var zd=nu.getClassFactory(Fr);xr.__dashjs_factory_name="SegmentsGetter";var Wd=nu.getClassFactory(xr);Ur.__dashjs_factory_name="RequestModifier";var Xd=nu.getSingletonFactory(Ur);Br.__dashjs_factory_name="XHRLoader";var Qd=nu.getClassFactory(Br),Zd=ho,$d={f:Zd},Jd=za.f,eh=function(e){var t=no.Symbol||(no.Symbol=ka.Symbol||{});"_"==e.charAt(0)||e in t||Jd(t,e,{value:$d.f(e)})};eh("asyncIterator");var th=c(function(e){var t=to("meta"),n=za.f,r=0,i=Object.isExtensible||function(){return!0},a=!Fa(function(){return i(Object.preventExtensions({}))}),o=function(e){n(e,t,{value:{i:"O"+ ++r,w:{}}})},s=function(e,n){if(!Ua(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!$a(e,t)){if(!i(e))return"F";if(!n)return"E";o(e)}return e[t].i},u=function(e,n){if(!$a(e,t)){if(!i(e))return!0;if(!n)return!1;o(e)}return e[t].w},l=function(e){return a&&c.NEED&&i(e)&&!$a(e,t)&&o(e),e},c=e.exports={KEY:t,NEED:!1,fastKey:s,getWeak:u,onFreeze:l}}),nh=(th.KEY,th.NEED,th.fastKey,th.getWeak,th.onFreeze,Object.getOwnPropertySymbols),rh={f:nh},ih=function(e){var t=fs(e),n=rh.f;if(n)for(var r,i=n(e),a=Go.f,o=0;i.length>o;)a.call(e,r=i[o++])&&t.push(r);return t},ah=ns.f,oh={}.toString,sh="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],uh=function(e){try{return ah(e)}catch(e){return sh.slice()}},lh=function(e){return sh&&"[object Window]"==oh.call(e)?uh(e):ah(Io(e))},ch={f:lh},fh=th.KEY,dh=Vo.f,hh=za.f,gh=ch.f,ph=ka.Symbol,Eh=ka.JSON,mh=Eh&&Eh.stringify,_h=ho("_hidden"),yh=ho("toPrimitive"),Th={}.propertyIsEnumerable,vh=fo("symbol-registry"),Sh=fo("symbols"),Ah=fo("op-symbols"),Rh=Object.prototype,Ih="function"==typeof ph,Dh=ka.QObject,bh=!Dh||!Dh.prototype||!Dh.prototype.findChild,Mh=xa&&Fa(function(){return 7!=_s(hh({},"a",{get:function(){return hh(this,"a",{value:7}).a}})).a})?function(e,t,n){var r=dh(Rh,t);r&&delete Rh[t],hh(e,t,n),r&&e!==Rh&&hh(Rh,t,r)}:hh,Ch=function(e){var t=Sh[e]=_s(ph.prototype);return t._k=e,t},Nh=Ih&&"symbol"==typeof ph.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof ph},wh=function(e,t,n){return e===Rh&&wh(Ah,t,n),Ba(e),t=Ha(t,!0),Ba(n),$a(Sh,t)?(n.enumerable?($a(e,_h)&&e[_h][t]&&(e[_h][t]=!1),n=_s(n,{enumerable:Xa(0,!1)})):($a(e,_h)||hh(e,_h,Xa(1,{})),e[_h][t]=!0),Mh(e,t,n)):hh(e,t,n)},Oh=function(e,t){Ba(e);for(var n,r=ih(t=Io(t)),i=0,a=r.length;a>i;)wh(e,n=r[i++],t[n]);return e},Lh=function(e,t){return void 0===t?_s(e):Oh(_s(e),t)},Ph=function(e){var t=Th.call(this,e=Ha(e,!0));return!(this===Rh&&$a(Sh,e)&&!$a(Ah,e))&&(!(t||!$a(this,e)||!$a(Sh,e)||$a(this,_h)&&this[_h][e])||t)},Fh=function(e,t){if(e=Io(e),t=Ha(t,!0),e!==Rh||!$a(Sh,t)||$a(Ah,t)){var n=dh(e,t);return!n||!$a(Sh,t)||$a(e,_h)&&e[_h][t]||(n.enumerable=!0),n}},xh=function(e){for(var t,n=gh(Io(e)),r=[],i=0;n.length>i;)$a(Sh,t=n[i++])||t==_h||t==fh||r.push(t);return r},Uh=function(e){for(var t,n=e===Rh,r=gh(n?Ah:Io(e)),i=[],a=0;r.length>a;)!$a(Sh,t=r[a++])||n&&!$a(Rh,t)||i.push(Sh[t]);return i};Ih||(ph=function(){if(this instanceof ph)throw TypeError("Symbol is not a constructor!");var e=to(arguments.length>0?arguments[0]:void 0),t=function(n){this===Rh&&t.call(Ah,n),$a(this,_h)&&$a(this[_h],e)&&(this[_h][e]=!1),Mh(this,e,Xa(1,n))};return xa&&bh&&Mh(Rh,e,{configurable:!0,set:t}),Ch(e)},ro(ph.prototype,"toString",function(){return this._k}),Vo.f=Fh,za.f=wh,ns.f=ch.f=xh,Go.f=Ph,rh.f=Uh,xa&&ro(Rh,"propertyIsEnumerable",Ph,!0),$d.f=function(e){return Ch(ho(e))}),So(So.G+So.W+So.F*!Ih,{Symbol:ph});for(var Bh="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),kh=0;Bh.length>kh;)ho(Bh[kh++]);for(var Gh=fs(ho.store),Yh=0;Gh.length>Yh;)eh(Gh[Yh++]);So(So.S+So.F*!Ih,"Symbol",{for:function(e){return $a(vh,e+="")?vh[e]:vh[e]=ph(e)},keyFor:function(e){if(!Nh(e))throw TypeError(e+" is not a symbol!");for(var t in vh)if(vh[t]===e)return t},useSetter:function(){bh=!0},useSimple:function(){bh=!1}}),So(So.S+So.F*!Ih,"Object",{create:Lh,defineProperty:wh,defineProperties:Oh,getOwnPropertyDescriptor:Fh,getOwnPropertyNames:xh,getOwnPropertySymbols:Uh}),Eh&&So(So.S+So.F*(!Ih||Fa(function(){var e=ph();return"[null]"!=mh([e])||"{}"!=mh({a:e})||"{}"!=mh(Object(e))})),"JSON",{stringify:function(e){for(var t,n,r=[e],i=1;arguments.length>i;)r.push(arguments[i++]);if(n=t=r[1],(Ua(t)||void 0!==e)&&!Nh(e))return Ls(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!Nh(t))return t}),r[1]=t,mh.apply(Eh,r)}}),ph.prototype[yh]||Qa(ph.prototype,yh,ph.prototype.valueOf),$u(ph,"Symbol"),$u(Math,"Math",!0),$u(ka.JSON,"JSON",!0),kr.__dashjs_factory_name="FetchLoader";var Kh=nu.getClassFactory(kr);Gr.__dashjs_factory_name="HTTPLoader";var Vh=nu.getClassFactory(Gr);Yr.__dashjs_factory_name="SegmentBaseLoader";var Hh=nu.getSingletonFactory(Yr);Kr.__dashjs_factory_name="EBMLParser";var qh=nu.getClassFactory(Kr);Vr.__dashjs_factory_name="WebmSegmentBaseLoader";var jh=nu.getSingletonFactory(Vr);Hr.__dashjs_factory_name="DashHandler";var zh=nu.getClassFactory(Hr);qr.__dashjs_factory_name="StreamProcessor";var Wh=nu.getClassFactory(qr);jr.__dashjs_factory_name="EventController";var Xh=nu.getClassFactory(jr),Qh=function e(){d(this,e),this.streamId=null,this.mediaInfo=null,this.segmentType=null,this.quality=NaN,this.index=NaN,this.bytes=null,this.start=NaN,this.end=NaN,this.duration=NaN,this.representationId=null,this.endFragment=null},Zh=function(e){function t(e){var n;return d(this,t),n=T(this,m(t).call(this)),n.url=e||null,n.checkForExistenceOnly=!0,n}return E(t,e),t}(lu);zr.__dashjs_factory_name="FragmentLoader";var $h=nu.getClassFactory(zr);Wr.__dashjs_factory_name="FragmentController";var Jh=nu.getClassFactory(Wr),eg=function e(){d(this,e),this.url=null,this.width=null,this.height=null,this.x=null,this.y=null},tg=function e(){d(this,e),this.bitrate=0,this.width=0,this.height=0,this.tilesHor=0,this.tilesVert=0,this.widthPerTile=0,this.heightPerTile=0,this.startNumber=0,this.segmentDuration=0,this.timescale=0,this.templateUrl="",this.id=""},ng=["http://dashif.org/thumbnail_tile","http://dashif.org/guidelines/thumbnail_tile"];Xr.__dashjs_factory_name="ThumbnailTracks";var rg=nu.getClassFactory(Xr);Qr.__dashjs_factory_name="ThumbnailController";var ig=nu.getClassFactory(Qr);Zr.__dashjs_factory_name="Stream";var ag=nu.getClassFactory(Zr);$r.__dashjs_factory_name="ManifestUpdater";var og=nu.getClassFactory($r),sg=function(e){function t(){var e;return d(this,t),e=T(this,m(t).call(this)),e.AST_IN_FUTURE="astInFuture",e.BUFFER_EMPTY="bufferStalled",e.BUFFER_LOADED="bufferLoaded",e.BUFFER_LEVEL_STATE_CHANGED="bufferStateChanged",e.ERROR="error",e.FRAGMENT_LOADING_COMPLETED="fragmentLoadingCompleted",e.FRAGMENT_LOADING_PROGRESS="fragmentLoadingProgress",e.FRAGMENT_LOADING_STARTED="fragmentLoadingStarted",e.FRAGMENT_LOADING_ABANDONED="fragmentLoadingAbandoned",e.LOG="log",e.MANIFEST_LOADED="manifestLoaded",e.METRICS_CHANGED="metricsChanged",e.METRIC_CHANGED="metricChanged",e.METRIC_ADDED="metricAdded",e.METRIC_UPDATED="metricUpdated",e.PERIOD_SWITCH_COMPLETED="periodSwitchCompleted",e.PERIOD_SWITCH_STARTED="periodSwitchStarted",e.QUALITY_CHANGE_REQUESTED="qualityChangeRequested",e.QUALITY_CHANGE_RENDERED="qualityChangeRendered",e.TRACK_CHANGE_RENDERED="trackChangeRendered",e.SOURCE_INITIALIZED="sourceInitialized",e.STREAM_INITIALIZED="streamInitialized",e.STREAM_TEARDOWN_COMPLETE="streamTeardownComplete",e.TEXT_TRACKS_ADDED="allTextTracksAdded",e.TEXT_TRACK_ADDED="textTrackAdded",e.TTML_PARSED="ttmlParsed",e.TTML_TO_PARSE="ttmlToParse",e.CAPTION_RENDERED="captionRendered",e.CAPTION_CONTAINER_RESIZE="captionContainerResize",e.CAN_PLAY="canPlay",e.PLAYBACK_ENDED="playbackEnded",e.PLAYBACK_ERROR="playbackError",e.PLAYBACK_NOT_ALLOWED="playbackNotAllowed",e.PLAYBACK_METADATA_LOADED="playbackMetaDataLoaded",e.PLAYBACK_PAUSED="playbackPaused",e.PLAYBACK_PLAYING="playbackPlaying",e.PLAYBACK_PROGRESS="playbackProgress",e.PLAYBACK_RATE_CHANGED="playbackRateChanged",e.PLAYBACK_SEEKED="playbackSeeked",e.PLAYBACK_SEEKING="playbackSeeking",e.PLAYBACK_SEEK_ASKED="playbackSeekAsked",e.PLAYBACK_STALLED="playbackStalled",e.PLAYBACK_STARTED="playbackStarted",e.PLAYBACK_TIME_UPDATED="playbackTimeUpdated",e.PLAYBACK_WAITING="playbackWaiting",e.MANIFEST_VALIDITY_CHANGED="manifestValidityChanged",e}return E(t,e),t}(au),ug=new sg,lg=5e3;Jr.__dashjs_factory_name="TimeSyncController";var cg=nu.getSingletonFactory(Jr);cg.HTTP_TIMEOUT_MS=lg,nu.updateSingletonFactory(Jr.__dashjs_factory_name,cg);var fg=Array.isArray,dg=Object.keys,hg=Object.prototype.hasOwnProperty,gg=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){var r,i,a,o=fg(t),s=fg(n);if(o&&s){if((i=t.length)!=n.length)return!1;for(r=i;0!=r--;)if(!e(t[r],n[r]))return!1;return!0}if(o!=s)return!1;var u=t instanceof Date,l=n instanceof Date;if(u!=l)return!1;if(u&&l)return t.getTime()==n.getTime();var c=t instanceof RegExp,f=n instanceof RegExp;if(c!=f)return!1;if(c&&f)return t.toString()==n.toString();var d=dg(t);if((i=d.length)!==dg(n).length)return!1;for(r=i;0!=r--;)if(!hg.call(n,d[r]))return!1;for(r=i;0!=r--;)if(a=d[r],!e(t[a],n[a]))return!1;return!0}return t!==t&&n!==n};ei.__dashjs_factory_name="ObjectUtils";var pg=nu.getSingletonFactory(ei),Eg=NaN,mg=function e(t,n){d(this,e),this.data={baseUrls:t||null,selectedIdx:n||Eg},this.children=[]};ti.__dashjs_factory_name="BaseURLTreeModel";var _g=nu.getClassFactory(ti);ni.__dashjs_factory_name="BlackListController";var yg=nu.getClassFactory(ni);ri.__dashjs_factory_name="DVBSelector";var Tg=nu.getClassFactory(ri);ii.__dashjs_factory_name="BasicSelector";var vg=nu.getClassFactory(ii);ai.__dashjs_factory_name="BaseURLSelector";var Sg=nu.getClassFactory(ai),Ag=function e(t,n,r,i){d(this,e),this.url=t||"",this.serviceLocation=n||t||"",this.dvb_priority=r||1,this.dvb_weight=i||1,this.availabilityTimeOffset=0,this.availabilityTimeComplete=!0};Ag.DEFAULT_DVB_PRIORITY=1,Ag.DEFAULT_DVB_WEIGHT=1,oi.__dashjs_factory_name="BaseURLController";var Rg=nu.getSingletonFactory(oi);si.__dashjs_factory_name="MediaSourceController";var Ig=nu.getSingletonFactory(si);ui.__dashjs_factory_name="StreamController";var Dg=nu.getSingletonFactory(ui),bg=function(e){function t(e,n){var r;return d(this,t),r=T(this,m(t).call(this)),r.url=e||null,r.type=n||null,r.mediaType=Ys.STREAM,r.responseType="",r}return E(t,e),t}(lu);li.__dashjs_factory_name="XlinkLoader";var Mg=nu.getClassFactory(li),Cg=Date.prototype.getTime,Ng=Date.prototype.toISOString,wg=function(e){return e>9?e:"0"+e},Og=Fa(function(){return"0385-07-25T07:06:39.999Z"!=Ng.call(new Date(-5e13-1))})||!Fa(function(){Ng.call(new Date(NaN))})?function(){if(!isFinite(Cg.call(this)))throw RangeError("Invalid time value");var e=this,t=e.getUTCFullYear(),n=e.getUTCMilliseconds(),r=t<0?"-":t>9999?"+":"";return r+("00000"+Math.abs(t)).slice(r?-6:-4)+"-"+wg(e.getUTCMonth()+1)+"-"+wg(e.getUTCDate())+"T"+wg(e.getUTCHours())+":"+wg(e.getUTCMinutes())+":"+wg(e.getUTCSeconds())+"."+(n>99?n:"0"+wg(n))+"Z"}:Ng;So(So.P+So.F*(Date.prototype.toISOString!==Og),"Date",{toISOString:Og});var Lg="onLoad",Pg="onActuate",Fg="urn:mpeg:dash:resolve-to-zero:2013";fi.__dashjs_factory_name="XlinkController";var xg=nu.getClassFactory(fi);di.__dashjs_factory_name="ObjectIron";var Ug=nu.getClassFactory(di),Bg=function(){function e(t,n){d(this,e),this._test=t,this._converter=n}return g(e,[{key:"test",get:function(){return this._test}},{key:"converter",get:function(){return this._converter}}]),e}(),kg=function(e){function t(){return d(this,t),T(this,m(t).call(this,function(e,t){var n,r=(n={},p(n,kd.MPD,[kd.ID,kd.PROFILES]),p(n,kd.PERIOD,[kd.ID]),p(n,kd.BASE_URL,[kd.SERVICE_LOCATION,kd.BYTE_RANGE]),p(n,kd.SEGMENT_BASE,[kd.INDEX_RANGE]),p(n,kd.INITIALIZATION,[kd.RANGE]),p(n,kd.REPRESENTATION_INDEX,[kd.RANGE]),p(n,kd.SEGMENT_LIST,[kd.INDEX_RANGE]),p(n,kd.BITSTREAM_SWITCHING,[kd.RANGE]),p(n,kd.SEGMENT_URL,[kd.MEDIA_RANGE,kd.INDEX_RANGE]),p(n,kd.SEGMENT_TEMPLATE,[kd.INDEX_RANGE,kd.MEDIA,kd.INDEX,kd.INITIALIZATION_MINUS,kd.BITSTREAM_SWITCHING_MINUS]),p(n,kd.ASSET_IDENTIFIER,[kd.VALUE,kd.ID]),p(n,kd.EVENT_STREAM,[kd.VALUE]),p(n,kd.ADAPTATION_SET,[kd.PROFILES,kd.MIME_TYPE,kd.SEGMENT_PROFILES,kd.CODECS,kd.CONTENT_TYPE]),p(n,kd.FRAME_PACKING,[kd.VALUE,kd.ID]),p(n,kd.AUDIO_CHANNEL_CONFIGURATION,[kd.VALUE,kd.ID]),p(n,kd.CONTENT_PROTECTION,[kd.VALUE,kd.ID]),p(n,kd.ESSENTIAL_PROPERTY,[kd.VALUE,kd.ID]),p(n,kd.SUPPLEMENTAL_PROPERTY,[kd.VALUE,kd.ID]),p(n,kd.INBAND_EVENT_STREAM,[kd.VALUE,kd.ID]),p(n,kd.ACCESSIBILITY,[kd.VALUE,kd.ID]),p(n,kd.ROLE,[kd.VALUE,kd.ID]),p(n,kd.RATING,[kd.VALUE,kd.ID]),p(n,kd.VIEWPOINT,[kd.VALUE,kd.ID]),p(n,kd.CONTENT_COMPONENT,[kd.CONTENT_TYPE]),p(n,kd.REPRESENTATION,[kd.ID,kd.DEPENDENCY_ID,kd.MEDIA_STREAM_STRUCTURE_ID]),p(n,kd.SUBSET,[kd.ID]),p(n,kd.METRICS,[kd.METRICS_MINUS]),p(n,kd.REPORTING,[kd.VALUE,kd.ID]),n);if(r.hasOwnProperty(t)){var i=r[t];return void 0!==i&&i.indexOf(e.name)>=0}return!1},function(e){return String(e)}))}return E(t,e),t}(Bg),Gg=/^([-])?P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/,Yg=31536e3,Kg=2592e3,Vg=86400,Hg=3600,qg=60,jg=function(e){function t(){return d(this,t),T(this,m(t).call(this,function(e){for(var t=[kd.MIN_BUFFER_TIME,kd.MEDIA_PRESENTATION_DURATION,kd.MINIMUM_UPDATE_PERIOD,kd.TIMESHIFT_BUFFER_DEPTH,kd.MAX_SEGMENT_DURATION,kd.MAX_SUBSEGMENT_DURATION,Ys.SUGGESTED_PRESENTATION_DELAY,kd.START,Ys.START_TIME,kd.DURATION],n=t.length,r=0;r<n;r++)if(e.nodeName===t[r])return Gg.test(e.value);return!1},function(e){var t=Gg.exec(e),n=parseFloat(t[2]||0)*Yg+parseFloat(t[4]||0)*Kg+parseFloat(t[6]||0)*Vg+parseFloat(t[8]||0)*Hg+parseFloat(t[10]||0)*qg+parseFloat(t[12]||0);return void 0!==t[1]&&(n=-n),n}))}return E(t,e),t}(Bg),zg=60,Wg=60,Xg=1e3,Qg=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+-])([0-9]{2})(?::?)([0-9]{2}))?/,Zg=function(e){function t(){return d(this,t),T(this,m(t).call(this,function(e){return Qg.test(e.value)},function(e){var t,n=Qg.exec(e);if(t=Date.UTC(parseInt(n[1],10),parseInt(n[2],10)-1,parseInt(n[3],10),parseInt(n[4],10),parseInt(n[5],10),n[6]&&parseInt(n[6],10)||0,n[7]&&parseFloat(n[7])*Xg||0),n[9]&&n[10]){var r=parseInt(n[9],10)*Wg+parseInt(n[10],10);t+=("+"===n[8]?-1:1)*r*zg*Xg}return new Date(t)}))}return E(t,e),t}(Bg),$g=/^[-+]?[0-9]+[.]?[0-9]*([eE][-+]?[0-9]+)?$/,Jg=function(e){function t(){return d(this,t),T(this,m(t).call(this,function(e){return $g.test(e.value)},function(e){return parseFloat(e)}))}return E(t,e),t}(Bg),ep=function(){function e(t){d(this,e);this._name=t,this._merge=function(e){return e&&e.length&&e.charAt(0)===e.charAt(0).toUpperCase()}(t)}return g(e,[{key:"name",get:function(){return this._name}},{key:"merge",get:function(){return this._merge}}]),e}(),tp=function(){function e(t,n,r){var i=this;d(this,e),this._name=t||"",this._properties=[],this._children=r||[],Array.isArray(n)&&n.forEach(function(e){i._properties.push(new ep(e))})}return g(e,[{key:"name",get:function(){return this._name}},{key:"children",get:function(){return this._children}},{key:"properties",get:function(){return this._properties}}]),e}(),np=function(e){function t(){d(this,t);var e=[kd.PROFILES,kd.WIDTH,kd.HEIGHT,kd.SAR,kd.FRAMERATE,kd.AUDIO_SAMPLING_RATE,kd.MIME_TYPE,kd.SEGMENT_PROFILES,kd.CODECS,kd.MAXIMUM_SAP_PERIOD,kd.START_WITH_SAP,kd.MAX_PLAYOUT_RATE,kd.CODING_DEPENDENCY,kd.SCAN_TYPE,kd.FRAME_PACKING,kd.AUDIO_CHANNEL_CONFIGURATION,kd.CONTENT_PROTECTION,kd.ESSENTIAL_PROPERTY,kd.SUPPLEMENTAL_PROPERTY,kd.INBAND_EVENT_STREAM];return T(this,m(t).call(this,kd.ADAPTATION_SET,e,[new tp(kd.REPRESENTATION,e,[new tp(kd.SUB_REPRESENTATION,e)])]))}return E(t,e),t}(tp),rp=function(e){function t(){d(this,t);var e=[kd.SEGMENT_BASE,kd.SEGMENT_TEMPLATE,kd.SEGMENT_LIST];return T(this,m(t).call(this,kd.PERIOD,e,[new tp(kd.ADAPTATION_SET,e,[new tp(kd.REPRESENTATION,e)])]))}return E(t,e),t}(tp);hi.__dashjs_factory_name="DashParser";var ip=nu.getClassFactory(hi);gi.__dashjs_factory_name="ManifestLoader";var ap=nu.getClassFactory(gi);pi.__dashjs_factory_name="ErrorHandler";var op=nu.getSingletonFactory(pi);Ei.__dashjs_factory_name="Capabilities";var sp=nu.getSingletonFactory(Ei),up=function e(){d(this,e),this.t=null,this.xywh=null,this.track=null,this.id=null,this.s=null,this.r=null};mi.__dashjs_factory_name="URIFragmentModel";var lp=nu.getSingletonFactory(mi);_i.__dashjs_factory_name="ManifestModel";var cp=nu.getSingletonFactory(_i),fp=function e(){d(this,e),this.schemeIdUri="",this.value=""},dp=4,hp=36e4,gp=36e4,pp=.9,Ep=1e4,mp=20,_p=80,yp=10,Tp=12,vp=20,Sp=30,Ap=60,Rp=600,Ip=.2,Dp=.8,bp=100,Mp=50,Cp=5,Np=3,wp=1e3,Op=3,Lp=500,Pp=1,Fp=500,xp=3,Up=10,Bp=5,kp=.02,Gp=0,Yp=.5,Kp=50,Vp=!1;yi.__dashjs_factory_name="MediaPlayerModel";var Hp=nu.getSingletonFactory(yi),qp=function e(){d(this,e),this.TcpList=[],this.HttpList=[],this.RepSwitchList=[],this.BufferLevel=[],this.BufferState=[],this.PlayList=[],this.DroppedFrames=[],this.SchedulingInfo=[],this.DVRInfo=[],this.ManifestUpdate=[],this.RequestsQueue=null,this.DVBErrors=[]},jp=function e(){d(this,e),this.t=null,this.mt=null,this.to=null,this.lto=null},zp=function e(){d(this,e),this.t=null,this.level=null},Wp=function e(){d(this,e),this.target=null,this.state=gd.BUFFER_EMPTY},Xp=function e(){d(this,e),this.time=null,this.range=null,this.manifestInfo=null},Qp=function e(){d(this,e),this.time=null,this.droppedFrames=null},Zp=function e(){d(this,e),this.mediaType=null,this.type=null,this.requestTime=null,this.fetchTime=null,this.availabilityStartTime=null,this.presentationStartTime=0,this.clientTimeOffset=0,this.currentTime=null,this.buffered=null,this.latency=0,this.streamInfo=[],this.representationInfo=[]},$p=function e(){d(this,e),this.id=null,this.index=null,this.start=null,this.duration=null},Jp=function e(){d(this,e),this.id=null,this.index=null,this.mediaType=null,this.streamIndex=null,this.presentationTimeOffset=null,this.startNumber=null,this.fragmentInfoType=null},eE=function e(){d(this,e),this.mediaType=null,this.t=null,this.type=null,this.startTime=null,this.availabilityStartTime=null,this.duration=null,this.quality=null,this.range=null,this.state=null},tE=function e(){d(this,e),this.loadingRequests=[],this.executedRequests=[]};Ti.__dashjs_factory_name="MetricsModel";var nE,rE,iE,aE=nu.getSingletonFactory(Ti),oE=function(e,t,n,r){try{return r?t(Ba(n)[0],n[1]):t(n)}catch(t){var i=e.return;throw void 0!==i&&Ba(i.call(e)),t}},sE=c(function(e){var t={},n={},r=e.exports=function(e,r,i,a,o){var s,u,l,c,f=o?function(){return e}:ul(e),d=To(i,a,r?2:1),h=0;if("function"!=typeof f)throw TypeError(e+" is not iterable!");if(rl(f)){for(s=No(e.length);s>h;h++)if((c=r?d(Ba(u=e[h])[0],u[1]):d(e[h]))===t||c===n)return c}else for(l=f.call(e);!(u=l.next()).done;)if((c=oE(l,d,u.value,r))===t||c===n)return c};r.BREAK=t,r.RETURN=n}),uE=ka.process,lE=ka.setImmediate,cE=ka.clearImmediate,fE=ka.MessageChannel,dE=ka.Dispatch,hE=0,gE={},pE=function(){var e=+this;if(gE.hasOwnProperty(e)){var t=gE[e];delete gE[e],t()}},EE=function(e){pE.call(e.data)};lE&&cE||(lE=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return gE[++hE]=function(){js("function"==typeof e?e:Function(e),t)},nE(hE),hE},cE=function(e){delete gE[e]},"process"==co(uE)?nE=function(e){uE.nextTick(To(pE,e,1))}:dE&&dE.now?nE=function(e){dE.now(To(pE,e,1))}:fE?(rE=new fE,iE=rE.port2,rE.port1.onmessage=EE,nE=To(iE.postMessage,iE,1)):ka.addEventListener&&"function"==typeof postMessage&&!ka.importScripts?(nE=function(e){ka.postMessage(e+"","*")},ka.addEventListener("message",EE,!1)):nE="onreadystatechange"in Ka("script")?function(e){gs.appendChild(Ka("script")).onreadystatechange=function(){gs.removeChild(this),pE.call(e)}}:function(e){setTimeout(To(pE,e,1),0)});var mE,_E,yE,TE,vE={set:lE,clear:cE},SE=vE.set,AE=ka.MutationObserver||ka.WebKitMutationObserver,RE=ka.process,IE=ka.Promise,DE="process"==co(RE),bE=function(e){return new vi(e)},ME={f:bE},CE=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}},NE=ka.navigator,wE=NE&&NE.userAgent||"",OE=function(e,t){if(Ba(e),Ua(t)&&t.constructor===e)return t;var n=ME.f(e);return(0,n.resolve)(t),n.promise},LE=vE.set,PE=function(){var e,t,n,r=function(){var r,i;for(DE&&(r=RE.domain)&&r.exit();e;){i=e.fn,e=e.next;try{i()}catch(r){throw e?n():t=void 0,r}}t=void 0,r&&r.enter()};if(DE)n=function(){RE.nextTick(r)};else if(!AE||ka.navigator&&ka.navigator.standalone)if(IE&&IE.resolve){var i=IE.resolve(void 0);n=function(){i.then(r)}}else n=function(){SE.call(ka,r)};else{var a=!0,o=document.createTextNode("");new AE(r).observe(o,{characterData:!0}),n=function(){o.data=a=!a}}return function(r){var i={fn:r,next:void 0};t&&(t.next=i),e||(e=i,n()),t=i}}(),FE=ka.TypeError,xE=ka.process,UE=xE&&xE.versions,BE=UE&&UE.v8||"",kE=ka.Promise,GE="process"==mo(xE),YE=function(){},KE=_E=ME.f,VE=!!function(){try{var e=kE.resolve(1),t=(e.constructor={})[ho("species")]=function(e){e(YE,YE)};return(GE||"function"==typeof PromiseRejectionEvent)&&e.then(YE)instanceof t&&0!==BE.indexOf("6.6")&&-1===wE.indexOf("Chrome/66")}catch(e){}}(),HE=function(e){var t;return!(!Ua(e)||"function"!=typeof(t=e.then))&&t},qE=function(e,t){if(!e._n){e._n=!0;var n=e._c;PE(function(){for(var r=e._v,i=1==e._s,a=0;n.length>a;)!function(t){var n,a,o,s=i?t.ok:t.fail,u=t.resolve,l=t.reject,c=t.domain;try{s?(i||(2==e._h&&WE(e),e._h=1),!0===s?n=r:(c&&c.enter(),n=s(r),c&&(c.exit(),o=!0)),n===t.promise?l(FE("Promise-chain cycle")):(a=HE(n))?a.call(n,u,l):u(n)):l(r)}catch(e){c&&!o&&c.exit(),l(e)}}(n[a++]);e._c=[],e._n=!1,t&&!e._h&&jE(e)})}},jE=function(e){LE.call(ka,function(){var t,n,r,i=e._v,a=zE(e);if(a&&(t=CE(function(){GE?xE.emit("unhandledRejection",i,e):(n=ka.onunhandledrejection)?n({promise:e,reason:i
}):(r=ka.console)&&r.error&&r.error("Unhandled promise rejection",i)}),e._h=GE||zE(e)?2:1),e._a=void 0,a&&t.e)throw t.v})},zE=function(e){return 1!==e._h&&0===(e._a||e._c).length},WE=function(e){LE.call(ka,function(){var t;GE?xE.emit("rejectionHandled",e):(t=ka.onrejectionhandled)&&t({promise:e,reason:e._v})})},XE=function(e){var t=this;t._d||(t._d=!0,t=t._w||t,t._v=e,t._s=2,t._a||(t._a=t._c.slice()),qE(t,!0))},QE=function(e){var t,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw FE("Promise can't be resolved itself");(t=HE(e))?PE(function(){var r={_w:n,_d:!1};try{t.call(e,To(QE,r,1),To(XE,r,1))}catch(e){XE.call(r,e)}}):(n._v=e,n._s=1,qE(n,!1))}catch(e){XE.call({_w:n,_d:!1},e)}}};VE||(kE=function(e){zu(this,kE,"Promise","_h"),yo(e),mE.call(this);try{e(To(QE,this,1),To(XE,this,1))}catch(e){XE.call(this,e)}},mE=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},mE.prototype=ju(kE.prototype,{then:function(e,t){var n=KE(cl(this,kE));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=GE?xE.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&qE(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),yE=function(){var e=new mE;this.promise=e,this.resolve=To(QE,e,1),this.reject=To(XE,e,1)},ME.f=KE=function(e){return e===kE||e===TE?new yE(e):_E(e)}),So(So.G+So.W+So.F*!VE,{Promise:kE}),$u(kE,"Promise"),Il("Promise"),TE=no.Promise,So(So.S+So.F*!VE,"Promise",{reject:function(e){var t=KE(this);return(0,t.reject)(e),t.promise}}),So(So.S+So.F*!VE,"Promise",{resolve:function(e){return OE(this,e)}}),So(So.S+So.F*!(VE&&Al(function(e){kE.all(e).catch(YE)})),"Promise",{all:function(e){var t=this,n=KE(t),r=n.resolve,i=n.reject,a=CE(function(){var n=[],a=0,o=1;sE(e,!1,function(e){var s=a++,u=!1;n.push(void 0),o++,t.resolve(e).then(function(e){u||(u=!0,n[s]=e,--o||r(n))},i)}),--o||r(n)});return a.e&&i(a.v),n.promise},race:function(e){var t=this,n=KE(t),r=n.reject,i=CE(function(){sE(e,!1,function(e){t.resolve(e).then(n.resolve,r)})});return i.e&&r(i.v),n.promise}}),Si.__dashjs_factory_name="VideoModel";var ZE=nu.getSingletonFactory(Si),$E=[{oldKey:"dashjs_vbitrate",newKey:"dashjs_video_bitrate"},{oldKey:"dashjs_abitrate",newKey:"dashjs_audio_bitrate"},{oldKey:"dashjs_vsettings",newKey:"dashjs_video_settings"},{oldKey:"dashjs_asettings",newKey:"dashjs_audio_settings"}],JE="dashjs_?_bitrate",em="dashjs_?_settings",tm="localStorage",nm="sessionStorage",rm="LastBitrate",im="LastMediaSettings";Ai.__dashjs_factory_name="DOMStorage";var am=nu.getSingletonFactory(Ai),om="2.9.3",sm=function e(){d(this,e),this.id=null,this.quality=null,this.DVRWindow=null,this.fragmentDuration=null,this.mediaInfo=null,this.MSETimeOffset=null},um=function(){function e(){d(this,e),this.id=null,this.index=null,this.type=null,this.streamInfo=null,this.representationCount=0,this.lang=null,this.viewpoint=null,this.accessibility=null,this.audioChannelConfiguration=null,this.roles=null,this.codec=null,this.mimeType=null,this.contentProtection=null,this.isText=!1,this.KID=null,this.bitrateList=null}return g(e,[{key:"isMediaInfoEqual",value:function(e){if(!e)return!1;var t=this.id===e.id,n=this.viewpoint===e.viewpoint,r=this.lang===e.lang,i=this.roles.toString()===e.roles.toString(),a=this.accessibility.toString()===e.accessibility.toString(),o=this.audioChannelConfiguration.toString()===e.audioChannelConfiguration.toString();return t&&n&&r&&i&&a&&o}}]),e}(),lm=function e(){d(this,e),this.id=null,this.index=null,this.start=NaN,this.duration=NaN,this.manifestInfo=null,this.isLast=!0},cm=function e(){d(this,e),this.DVRWindowSize=NaN,this.loadedTime=null,this.availableFrom=null,this.minBufferTime=NaN,this.duration=NaN,this.isDynamic=!1,this.maxFragmentDuration=null},fm=function e(){d(this,e),this.duration=NaN,this.presentationTime=NaN,this.id=NaN,this.messageData="",this.eventStream=null,this.presentationTimeDelta=NaN};Ii.__dashjs_factory_name="DashAdapter";var dm=nu.getSingletonFactory(Ii);So(So.S,"Number",{MAX_SAFE_INTEGER:9007199254740991});var hm=Math.floor,gm=function(e){return!Ua(e)&&isFinite(e)&&hm(e)===e};So(So.S,"Number",{isInteger:gm});var pm=function e(){d(this,e),this.period=null,this.index=-1,this.type=null},Em=function e(){d(this,e),this.id=null,this.index=-1,this.duration=NaN,this.start=NaN,this.mpd=null};Em.DEFAULT_ID="defaultId";var mm=function e(){d(this,e),this.manifest=null,this.suggestedPresentationDelay=0,this.availabilityStartTime=null,this.availabilityEndTime=Number.POSITIVE_INFINITY,this.timeShiftBufferDepth=Number.POSITIVE_INFINITY,this.maxSegmentDuration=Number.POSITIVE_INFINITY,this.minimumUpdatePeriod=NaN,this.mediaPresentationDuration=NaN},_m=function e(){d(this,e),this.adaptionSet=null,this.representation=null,this.period=null,this.timescale=1,this.value="",this.schemeIdUri=""};Di.__dashjs_factory_name="DashManifestModel";var ym=nu.getSingletonFactory(Di),Tm=function(){function e(){d(this,e)}return g(e,null,[{key:"round10",value:function(e,t){return bi("round",e,t)}}]),e}();Mi.__dashjs_factory_name="DashMetrics";var vm=nu.getSingletonFactory(Mi);Ci.__dashjs_factory_name="TimelineConverter";var Sm=nu.getSingletonFactory(Ci),Am=c(function(e,t){var n={};n.encode=function(e){for(var t=[],n=0;n<e.length;++n){var r=e.charCodeAt(n);r<128?t.push(r):r<2048?(t.push(192|r>>6),t.push(128|63&r)):r<65536?(t.push(224|r>>12),t.push(128|63&r>>6),t.push(128|63&r)):(t.push(240|r>>18),t.push(128|63&r>>12),t.push(128|63&r>>6),t.push(128|63&r))}return t},n.decode=function(e){for(var t=[],n=0;n<e.length;){var r=e[n++];r<128||(r<224?(r=(31&r)<<6,r|=63&e[n++]):r<240?(r=(15&r)<<12,r|=(63&e[n++])<<6,r|=63&e[n++]):(r=(7&r)<<18,r|=(63&e[n++])<<12,r|=(63&e[n++])<<6,r|=63&e[n++])),t.push(String.fromCharCode(r))}return t.join("")};var r={};!function(e){var t=function(t){for(var n=0,r=[],i=0|t.length/3;0<i--;){var a=(t[n]<<16)+(t[n+1]<<8)+t[n+2];n+=3,r.push(e.charAt(63&a>>18)),r.push(e.charAt(63&a>>12)),r.push(e.charAt(63&a>>6)),r.push(e.charAt(63&a))}if(2==t.length-n){var a=(t[n]<<16)+(t[n+1]<<8);r.push(e.charAt(63&a>>18)),r.push(e.charAt(63&a>>12)),r.push(e.charAt(63&a>>6)),r.push("=")}else if(1==t.length-n){var a=t[n]<<16;r.push(e.charAt(63&a>>18)),r.push(e.charAt(63&a>>12)),r.push("==")}return r.join("")},i=function(){for(var t=[],n=0;n<e.length;++n)t[e.charCodeAt(n)]=n;return t["=".charCodeAt(0)]=0,t}(),o=function(e){for(var t=0,n=[],r=0|e.length/4;0<r--;){var a=(i[e.charCodeAt(t)]<<18)+(i[e.charCodeAt(t+1)]<<12)+(i[e.charCodeAt(t+2)]<<6)+i[e.charCodeAt(t+3)];n.push(255&a>>16),n.push(255&a>>8),n.push(255&a),t+=4}return n&&("="==e.charAt(t-2)?(n.pop(),n.pop()):"="==e.charAt(t-1)&&n.pop()),n},u={};u.encode=function(e){for(var t=[],n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t},u.decode=function(e){for(var t=0;t<s.length;++t)a[t]=String.fromCharCode(a[t]);return a.join("")},r.decodeArray=function(e){var t=o(e);return new Uint8Array(t)},r.encodeASCII=function(e){var n=u.encode(e);return t(n)},r.decodeASCII=function(e){var t=o(e);return u.decode(t)},r.encode=function(e){var r=n.encode(e);return t(r)},r.decode=function(e){var t=o(e);return n.decode(t)}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),t.decode=r.decode,t.decodeArray=r.decodeArray,t.encode=r.encode,t.encodeASCII=r.encodeASCII});Am.decode,Am.decodeArray,Am.encode,Am.encodeASCII;Ni.__dashjs_factory_name="MediaPlayer";var Rm=nu.getClassFactory(Ni);Rm.events=ug,Rm.errors=lf,nu.updateClassFactory(Ni.__dashjs_factory_name,Rm);var Im="undefined"!=typeof window&&window||Pa,Dm=Im.dashjs;Dm||(Dm=Im.dashjs={}),Dm.MediaPlayer=Rm,Dm.FactoryMaker=nu,Dm.Debug=Eu,Dm.Version=Ri();var bm=function e(){d(this,e),this.mpdurl=null,this.errorcode=null,this.terror=null,this.url=null,this.ipaddress=null,this.servicelocation=null};bm.SSL_CONNECTION_FAILED_PREFIX="SSL",bm.DNS_RESOLUTION_FAILED="C00",bm.HOST_UNREACHABLE="C01",bm.CONNECTION_REFUSED="C02",bm.CONNECTION_ERROR="C03",bm.CORRUPT_MEDIA_ISOBMFF="M00",bm.CORRUPT_MEDIA_OTHER="M01",bm.BASE_URL_CHANGED="F00",bm.BECAME_REPORTER="S00";var Mm=function(e){function t(){var e;return d(this,t),e=T(this,m(t).call(this)),e.METRICS_INITIALISATION_COMPLETE="internal_metricsReportingInitialized",e.BECAME_REPORTING_PLAYER="internal_becameReportingPlayer",e}return E(t,e),t}(au),Cm=new Mm;wi.__dashjs_factory_name="DVBErrorsTranslator";var Nm=dashjs.FactoryMaker.getSingletonFactory(wi);Oi.__dashjs_factory_name="RangeController";var wm=dashjs.FactoryMaker.getClassFactory(Oi);Li.__dashjs_factory_name="MetricSerialiser";var Om=dashjs.FactoryMaker.getSingletonFactory(Li);bl("Uint32",4,function(e){return function(t,n,r){return e(this,t,n,r)}}),Pi.__dashjs_factory_name="RNG";var Lm=dashjs.FactoryMaker.getSingletonFactory(Pi);Fi.__dashjs_factory_name="DVBReporting";var Pm=dashjs.FactoryMaker.getClassFactory(Fi);xi.__dashjs_factory_name="ReportingFactory";var Fm=dashjs.FactoryMaker.getSingletonFactory(xi);Ui.__dashjs_factory_name="ReportingController";var xm=dashjs.FactoryMaker.getClassFactory(Ui);Bi.__dashjs_factory_name="HandlerHelpers";var Um=dashjs.FactoryMaker.getSingletonFactory(Bi);ki.__dashjs_factory_name="BufferLevelHandler";var Bm=dashjs.FactoryMaker.getClassFactory(ki),km=dashjs.FactoryMaker.getClassFactory(Gi);Yi.__dashjs_factory_name="HttpListHandler";var Gm=dashjs.FactoryMaker.getClassFactory(Yi);Ki.__dashjs_factory_name="GenericMetricHandler";var Ym=dashjs.FactoryMaker.getClassFactory(Ki);Vi.__dashjs_factory_name="MetricsHandlerFactory";var Km=dashjs.FactoryMaker.getSingletonFactory(Vi);Hi.__dashjs_factory_name="MetricsHandlersController";var Vm=dashjs.FactoryMaker.getClassFactory(Hi);qi.__dashjs_factory_name="MetricsController";var Hm=dashjs.FactoryMaker.getClassFactory(qi),qm=function e(){d(this,e),this.metrics="",this.Range=[],this.Reporting=[]},jm=function e(){d(this,e),this.starttime=0,this.duration=1/0,this._useWallClockTime=!1},zm=function e(){d(this,e),this.schemeIdUri="",this.value=""};ji.__dashjs_factory_name="ManifestParsing";var Wm=dashjs.FactoryMaker.getSingletonFactory(ji);zi.__dashjs_factory_name="MetricsCollectionController";var Xm=dashjs.FactoryMaker.getClassFactory(zi);Wi.__dashjs_factory_name="MetricsReporting";var Qm=dashjs.FactoryMaker.getClassFactory(Wi);Qm.events=Cm,dashjs.FactoryMaker.updateClassFactory(Wi.__dashjs_factory_name,Qm);var Zm=function(){function e(){d(this,e)}return g(e,null,[{key:"findCencContentProtection",value:function(e){for(var t=null,n=0;n<e.length;++n){var r=e[n];"urn:mpeg:dash:mp4protection:2011"===r.schemeIdUri.toLowerCase()&&"cenc"===r.value.toLowerCase()&&(t=r)}return t}},{key:"getPSSHData",value:function(e){var t=8,n=new DataView(e),r=n.getUint8(t);return t+=20,r>0&&(t+=4+16*n.getUint32(t)),t+=4,e.slice(t)}},{key:"getPSSHForKeySystem",value:function(t,n){var r=e.parsePSSHList(n);return r.hasOwnProperty(t.uuid.toLowerCase())?r[t.uuid.toLowerCase()]:null}},{key:"parseInitDataFromContentProtection",value:function(e,t){return"pssh"in e?t.decodeArray(e.pssh.__text).buffer:null}},{key:"parsePSSHList",value:function(e){if(null===e)return[];for(var t=new DataView(e.buffer||e),n={},r=0;;){var i=void 0,a=void 0,o=void 0,s=void 0,u=r;if(r>=t.buffer.byteLength)break;if(i=t.getUint32(r),a=r+i,r+=4,1886614376===t.getUint32(r))if(r+=4,0===(o=t.getUint8(r))||1===o){r++,r+=3,s="";var l=void 0,c=void 0;for(l=0;l<4;l++)c=t.getUint8(r+l).toString(16),s+=1===c.length?"0"+c:c;for(r+=4,s+="-",l=0;l<2;l++)c=t.getUint8(r+l).toString(16),s+=1===c.length?"0"+c:c;for(r+=2,s+="-",l=0;l<2;l++)c=t.getUint8(r+l).toString(16),s+=1===c.length?"0"+c:c;for(r+=2,s+="-",l=0;l<2;l++)c=t.getUint8(r+l).toString(16),s+=1===c.length?"0"+c:c;for(r+=2,s+="-",l=0;l<6;l++)c=t.getUint8(r+l).toString(16),s+=1===c.length?"0"+c:c;r+=6,s=s.toLowerCase(),t.getUint32(r),r+=4,n[s]=t.buffer.slice(u,a),r=a}else r=a;else r=a}return n}}]),e}(),$m=function e(t,n){d(this,e),this.contentType=t,this.robustness=n},Jm=function e(t,n,r,i,a){d(this,e),this.initDataTypes=["cenc"],t&&t.length&&(this.audioCapabilities=t),n&&n.length&&(this.videoCapabilities=n),this.distinctiveIdentifier=r,this.persistentState=i,this.sessionTypes=a},e_=function(e){function t(){var e;return d(this,t),e=T(this,m(t).call(this)),e.MEDIA_KEYERR_CODE=100,e.MEDIA_KEYERR_UNKNOWN_CODE=101,e.MEDIA_KEYERR_CLIENT_CODE=102,e.MEDIA_KEYERR_SERVICE_CODE=103,e.MEDIA_KEYERR_OUTPUT_CODE=104,e.MEDIA_KEYERR_HARDWARECHANGE_CODE=105,e.MEDIA_KEYERR_DOMAIN_CODE=106,e.MEDIA_KEY_MESSAGE_ERROR_CODE=107,e.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_CODE=108,e.SERVER_CERTIFICATE_UPDATED_ERROR_CODE=109,e.KEY_STATUS_CHANGED_EXPIRED_ERROR_CODE=110,e.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_CODE=111,e.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE=112,e.KEY_SESSION_CREATED_ERROR_CODE=113,e.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE=114,e.MEDIA_KEYERR_UNKNOWN_MESSAGE="An unspecified error occurred. This value is used for errors that don't match any of the other codes.",e.MEDIA_KEYERR_CLIENT_MESSAGE="The Key System could not be installed or updated.",e.MEDIA_KEYERR_SERVICE_MESSAGE="The message passed into update indicated an error from the license service.",e.MEDIA_KEYERR_OUTPUT_MESSAGE="There is no available output device with the required characteristics for the content protection system.",e.MEDIA_KEYERR_HARDWARECHANGE_MESSAGE="A hardware configuration change caused a content protection error.",e.MEDIA_KEYERR_DOMAIN_MESSAGE="An error occurred in a multi-device domain licensing configuration. The most common error is a failure to join the domain.",e.MEDIA_KEY_MESSAGE_ERROR_MESSAGE="Multiple key sessions were creates with a user-agent that does not support sessionIDs!! Unpredictable behavior ahead!",e.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_MESSAGE="DRM: Empty key message from CDM",e.SERVER_CERTIFICATE_UPDATED_ERROR_MESSAGE="Error updating server certificate -- ",e.KEY_STATUS_CHANGED_EXPIRED_ERROR_MESSAGE="DRM: KeyStatusChange error! -- License has expired",e.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_MESSAGE="DRM: No license server URL specified!",e.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE="DRM: KeySystem Access Denied! -- ",e.KEY_SESSION_CREATED_ERROR_MESSAGE="DRM: unable to create session! --",e.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE="DRM: licenser error! --",e}return E(t,e),t}(sf),t_=new e_,n_=5,r_=500,i_=3,a_=1e3,o_=8e3;Xi.__dashjs_factory_name="ProtectionController";var s_=dashjs.FactoryMaker.getClassFactory(Xi),u_=function e(t,n){d(this,e),this.keyID=t,this.key=n},l_=function(){function e(t,n){if(d(this,e),n&&"persistent"!==n&&"temporary"!==n)throw new Error("Invalid ClearKey key set type!  Must be one of 'persistent' or 'temporary'");this.keyPairs=t,this.type=n}return g(e,[{key:"toJWK",value:function(){var e,t=this.keyPairs.length,n={keys:[]};for(e=0;e<t;e++){var r={kty:"oct",alg:"A128KW",kid:this.keyPairs[e].keyID,k:this.keyPairs[e].key};n.keys.push(r)}this.type&&(n.type=this.type);var i=JSON.stringify(n),a=i.length,o=new ArrayBuffer(a),s=new Uint8Array(o);for(e=0;e<a;e++)s[e]=i.charCodeAt(e);return o}}]),e}(),c_=function(){function e(){d(this,e),this.init()}return g(e,[{key:"init",value:function(){this.CLEARKEY_KEYSTEM_STRING="org.w3.clearkey",this.WIDEVINE_KEYSTEM_STRING="com.widevine.alpha",this.PLAYREADY_KEYSTEM_STRING="com.microsoft.playready"}}]),e}(),f_=new c_,d_="e2719d58-a985-b3c9-781a-b030af78d30e",h_=f_.CLEARKEY_KEYSTEM_STRING,g_="urn:uuid:"+d_;Qi.__dashjs_factory_name="KeySystemClearKey";var p_=dashjs.FactoryMaker.getSingletonFactory(Qi),E_="1077efec-c0b2-4d02-ace3-3c1e52e2fb4b",m_=f_.CLEARKEY_KEYSTEM_STRING,__="urn:uuid:"+E_;Zi.__dashjs_factory_name="KeySystemW3CClearKey";var y_=dashjs.FactoryMaker.getSingletonFactory(Zi),T_="edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",v_=f_.WIDEVINE_KEYSTEM_STRING,S_="urn:uuid:"+T_;$i.__dashjs_factory_name="KeySystemWidevine";var A_=dashjs.FactoryMaker.getSingletonFactory($i);bl("Uint16",2,function(e){return function(t,n,r){return e(this,t,n,r)}});var R_,I_="9a04f079-9840-4286-ab92-e65be0885f95",D_=f_.PLAYREADY_KEYSTEM_STRING,b_="urn:uuid:"+I_,M_='<PlayReadyCDMData type="LicenseAcquisition"><LicenseAcquisition version="1.0" Proactive="false"><CustomData encoding="base64encoded">%CUSTOMDATA%</CustomData></LicenseAcquisition></PlayReadyCDMData>';Ji.__dashjs_factory_name="KeySystemPlayReady";var C_=dashjs.FactoryMaker.getSingletonFactory(Ji);ea.__dashjs_factory_name="DRMToday";var N_=dashjs.FactoryMaker.getSingletonFactory(ea);ta.__dashjs_factory_name="PlayReady";var w_=dashjs.FactoryMaker.getSingletonFactory(ta);na.__dashjs_factory_name="Widevine";var O_=dashjs.FactoryMaker.getSingletonFactory(na);ra.__dashjs_factory_name="ClearKey";var L_=dashjs.FactoryMaker.getSingletonFactory(ra);ia.__dashjs_factory_name="ProtectionKeyController";var P_=dashjs.FactoryMaker.getSingletonFactory(ia),F_=function(e){function t(){var e;return d(this,t),e=T(this,m(t).call(this)),e.INTERNAL_KEY_MESSAGE="internalKeyMessage",e.INTERNAL_KEY_SYSTEM_SELECTED="internalKeySystemSelected",e.INTERNAL_KEY_STATUS_CHANGED="internalkeyStatusChanged",e.KEY_ADDED="public_keyAdded",e.KEY_ERROR="public_keyError",e.KEY_MESSAGE="public_keyMessage",e.KEY_SESSION_CLOSED="public_keySessionClosed",e.KEY_SESSION_CREATED="public_keySessionCreated",e.KEY_SESSION_REMOVED="public_keySessionRemoved",e.KEY_STATUSES_CHANGED="public_keyStatusesChanged",e.KEY_SYSTEM_ACCESS_COMPLETE="public_keySystemAccessComplete",e.KEY_SYSTEM_SELECTED="public_keySystemSelected",e.LICENSE_REQUEST_COMPLETE="public_licenseRequestComplete",e.NEED_KEY="needkey",e.PROTECTION_CREATED="public_protectioncreated",e.PROTECTION_DESTROYED="public_protectiondestroyed",e.SERVER_CERTIFICATE_UPDATED="serverCertificateUpdated",e.TEARDOWN_COMPLETE="protectionTeardownComplete",e.VIDEO_ELEMENT_SELECTED="videoElementSelected",e}return E(t,e),t}(au),x_=new F_,U_=function e(t,n){d(this,e),this.initData=t,this.initDataType=n},B_=function e(t,n,r,i){d(this,e),this.sessionToken=t,this.message=n,this.defaultURL=r,this.messageType=i||"license-request"},k_=function e(t,n){d(this,e),this.keySystem=t,this.ksConfiguration=n};aa.__dashjs_factory_name="ProtectionModel_21Jan2015";var G_=dashjs.FactoryMaker.getClassFactory(aa);oa.__dashjs_factory_name="ProtectionModel_3Feb2014";var Y_=dashjs.FactoryMaker.getClassFactory(oa);sa.__dashjs_factory_name="ProtectionModel_01b";var K_=dashjs.FactoryMaker.getClassFactory(sa),V_=[{generateKeyRequest:"generateKeyRequest",addKey:"addKey",cancelKeyRequest:"cancelKeyRequest",needkey:"needkey",keyerror:"keyerror",keyadded:"keyadded",keymessage:"keymessage"},{generateKeyRequest:"webkitGenerateKeyRequest",addKey:"webkitAddKey",cancelKeyRequest:"webkitCancelKeyRequest",needkey:"webkitneedkey",keyerror:"webkitkeyerror",keyadded:"webkitkeyadded",keymessage:"webkitkeymessage"}],H_=[{setMediaKeys:"setMediaKeys",MediaKeys:"MediaKeys",release:"close",needkey:"needkey",error:"keyerror",message:"keymessage",ready:"keyadded",close:"keyclose"},{setMediaKeys:"msSetMediaKeys",MediaKeys:"MSMediaKeys",release:"close",needkey:"msneedkey",error:"mskeyerror",message:"mskeymessage",ready:"mskeyadded",close:"mskeyclose"}];ua.__dashjs_factory_name="Protection";var q_=dashjs.FactoryMaker.getClassFactory(ua);q_.events=x_,q_.errors=t_,dashjs.FactoryMaker.updateClassFactory(ua.__dashjs_factory_name,q_);var j_,z_=function(){function e(e,t,n){if(!e||!/^VIDEO$/i.test(e.nodeName))return null;if(e._dashjs_player)return e._dashjs_player;var a,o=e.id||e.name||"video element";if(!(t=t||[].slice.call(e.querySelectorAll("source")).filter(function(e){return e.type==i})[0])&&e.src)t=document.createElement("source"),t.src=e.src;else if(!t&&!e.src)return null;return n=n||{},a=Rm(n).create(),a.initialize(e,t.src,e.autoplay),r||(r=a.getDebug().getLogger()),r.debug("Converted "+o+" to dash.js player and added content: "+t.src),e._dashjs_player=a,a}function t(t,r){var a=[];t=t||"[data-dashjs-player]",r=r||document;for(var o=r.querySelectorAll(t),s=0;s<o.length;s++){var u=e(o[s],null);a.push(u)}for(var l=r.querySelectorAll('source[type="'+i+'"]'),c=0;c<l.length;c++){var f=n(l[c]),d=e(f,null);a.push(d)}return a}function n(e){return/^VIDEO$/i.test(e.nodeName)?e:n(e.parentNode)}var r,i="application/dash+xml";return{create:e,createAll:t}}();!("undefined"!=typeof window&&window&&window.dashjs&&window.dashjs.skipAutoCreate)&&"undefined"!=typeof window&&window&&window.addEventListener&&("complete"===window.document.readyState?window.dashjs?z_.createAll():j_=window.setInterval(ca,500):window.addEventListener("load",la)),dashjs.Protection=q_,dashjs.MetricsReporting=Qm,dashjs.MediaPlayerFactory=z_,dashjs.Debug=Eu;var W_={MOUNT:"mount",ERROR:"error",CONTEXT_MENU:"contextmenu",CLICK:"click",DBL_CLICK:"dblclick",KEYUP:"keyup",KEYDOWN:"keydown",LOAD:"load",MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",MOUSE_UP:"mouseup",MOUSE_DOWN:"mousedown",MOUSE_MOVE:"mousemove",TOUCH_START:"touchstart",TOUCH_MOVE:"touchmove",TOUCH_END:"touchend",TOUCH_CANCEL:"touchcancel",RESIZE:"resize",SCROLL:"scroll",FULLSCREEN_ENTER:"fullscreenenter",FULLSCREEN_EXIT:"fullscreenexit",FULLSCREEN_CHANGE:"fullscreenchange",METADATA:"loadedmetadata",DATA:"loadeddata",PROGRESS:"progress",TIME_UPDATE:"timeupdate",LOAD_START:"loadstart",VOLUME_CHANGE:"volumechange",PAUSE:"pause",PLAYING:"playing",PLAY:"play",WAITING:"waiting",CAN_PLAY:"canplay",ENDED:"ended",SEEKED:"seeked",SEEKING:"seeking",DURATION_CHANGE:"durationchange",BEFORE_PLAY:"beforeplay",BEFORE_PAUSE:"beforepause",STATE:"state",CUEPOINTS:"cuepoints",CUEPOINT_START:"cuepointstart",CUEPOINT_END:"cuepointend",VIEW_ENTER:"viewenter",VIEW_LEAVE:"viewleave",SOURCE:"src",RECOVER:"recover",REAP:"reap",CONFIG:"config",QUALITIES:"qualities",SET_QUALITY:"quality:set",NON_RECOVERABLE_ERROR:"error:fatal",RECOMMENDATIONS_READY:"recommendationsready",AUDIO_ONLY_SOURCE:"audioonlysource"},X_={SET:"audio:set",SWITCH:"audio:update",TRACKS:"audio:tracks"},Q_={WIDEVINE:"com.widevine.alpha",PLAYREADY:"com.microsoft.playready",CLEARKEY:"org.w3.clearkey",FAIRPLAY:"fairplay"},Z_={LICENSE_SERVER:"license_server",KEY:"key",KEY_ID:"kid",HTTP_HEADERS:"http_headers"},$_=function(e,t){for(var n in t)e[n]=t[n];return e}(Q_,Z_),J_=1e4,ey=3;return _a.wants=l,"function"==typeof MediaSource&&function(e,t){if("object"==typeof exports&&"undefined"!=typeof module)return t;"flowplayer"in e||(e.flowplayer={extensions:[]});var n=e.flowplayer;"function"==typeof n?n(t):(Array.isArray(n.extensions)||(n.extensions=[]),~n.extensions.indexOf(t)||n.extensions.push(t))}(window,_a),_a});