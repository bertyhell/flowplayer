!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):((e=e||self).flowplayer=e.flowplayer||{},e.flowplayer.gemius=n())}(this,(function(){"use strict";function e(e,n,a){for(var r=function(e){return Array.isArray(e)?e.slice(0):e.split(".")}(n);r.length;){if(null==e)return a;var o=r.shift();if("string"!=typeof o)return a;e=e[o]}return null==e?a:e}var n=["playerID","gemiusID"],a=["programID","additionalParameters.programName","additionalParameters.programType","additionalParameters.programDuration","additionalParameters.typology"],r=["adName","adDuration","adType","campaignClassification","quality","resolution","volume"];function o(n,a){var r=[];return a.forEach((function(a){void 0===e(n,a)&&r.push(a)})),r.length&&console.warn("Missing Gemius configuration: ",r.join(", ")),0===r.length}return function(e,n){if("object"==typeof exports&&"undefined"!=typeof module)return n;"flowplayer"in e||(e.flowplayer={extensions:[]});var a=e.flowplayer;return"function"==typeof a?(a(n),n):(Array.isArray(a.extensions)||(a.extensions=[]),~a.extensions.indexOf(n)||a.extensions.push(n),n)}(window,(function(t,i,u){if("function"!=typeof GemiusPlayer)return console.warn("Gemius SDK needs to be loaded prior loading gemius plugin");var s,d=flowplayer.util.extend,l=e(t,"gemius.playerID"),f=e(t,"gemius.gemiusID"),p=e(t,"gemius.additionalParameters",{});if(o(e(t,"gemius",{}),n)){var m=new GemiusPlayer(l,f,p);m.setVideoObject(u),u.on("reap",(function(){g("stop"),m=void 0,window.removeEventListener("beforeunload",v)})),u.on("config",(function(n){s=e(n.data,"gemius",{})})),u.on("loadedmetadata",(function(){o(s,a)&&m.newProgram(s.programID,s.additionalParameters)})),window.addEventListener("beforeunload",v);var c={play:"play",pause:"pause",waiting:"buffer",seeking:"seek",ended:"complete"};if(u.on(Object.keys(c),(function(e){m.programEvent(s.programID,u.currentTime,c[e.type])})),u.ads){var y=flowplayer.AdEvents;u.ads.on(y.AD_STARTED,(function(e){var n;m.newAd(e.vast_ad_id,(n=d(d({},p),function(e){return{adDuration:e.ad.duration,adType:e.ad_type,resolution:e.ad.width+"x"+e.ad.height,volume:e.volume}}(e)),r.reduce((function(e,a){return n&&n.hasOwnProperty(a)&&(e[a]=n[a]),e}),{}))),m.adEvent(s.programID,e.vast_ad_id,u.currentTime,"play",{autoPlay:e.autoPlay,volume:e.volume})})),[y.AD_PAUSED,y.AD_COMPLETED].forEach((function(e){var n;switch(e){case y.AD_PAUSED:n="pause";break;case y.AD_COMPLETED:n="complete"}u.ads.on(e,(function(e){m.adEvent(s.programID,e.vast_ad_id,u.currentTime,n)}))}))}}function g(e){(u.ads&&u.ads.adPlaying()?m.adEvent:m.programEvent).call(m,s.programID,u.currentTime,e)}function v(){g("close")}}))}));
