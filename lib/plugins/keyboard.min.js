!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):((t=t||self).flowplayer=t.flowplayer||{},t.flowplayer.keyboard=e())}(this,(function(){"use strict";var t=[].slice;function e(t,e){for(var n in e)t[n]=e[n];return t}function n(t,e,n){for(e=function(t){return Array.isArray(t)?t.slice(0):t.split(".")}(e);e.length;){if(null==t)return n;t=t[e.shift()]}return null==t?n:t}var r=!!function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("testPassive",null,e),window.removeEventListener("testPassive",null,e)}catch(t){}return t}()&&{passive:!0},i=["touchstart","touchmove"];function o(t){return t.emit=function(n,r,i){i=i||{};var o=function(t){var e=document.createEvent("Event");return e.initEvent(t,!1,!0),e}(n);return r&&e(o,{data:r||{}}),t.dispatchEvent(o),!1===i.return_self?o:t},t.on=function(e,n){return"string"==typeof e&&(e=e.split(" ")),e.forEach((function(e){return function(t){return~i.indexOf(t)}(e)?t.addEventListener(e,n,r):t.addEventListener(e,n)})),t},t.off=function(e,n){return t.removeEventListener(e,n),t},t.one=t.once=function(e,n){return t.on(e,(function r(i){t.off(e,r),n(i)}))},t}var a=Array.isArray,u="undefined"!=typeof window&&o(window),s="undefined"!=typeof document&&o(document),f=["span","a","em","p","i"],c=f.concat(["div","strong","video","img","ol","ul","li","script"]);function l(t,e,n){var r=p(document.createElement(t));if(a(e)&&(n=e,e=!1),a(n)||(n=[n]),r.append(n.filter((function(t){return t}))),"object"!=typeof e)return r;for(var i in e)i in r?r[i]=e[i]:r.setAttribute(i,e[i]);return r}function d(e){var n=e.tagName;e.__flowplayer__=1,e.find=function(t){var n=e.querySelector(t);return n?p(n):n},e.html=function(t){return e.innerHTML=t,e},e.empty=function(){return e.innerHTML="",e},e.offset=function(){var t={top:0,left:0},n=e;do{t.left+=n.offsetLeft||0,t.top+=n.offsetTop||0}while(n=n.offsetParent);return t},e.innerWidth=function(){var t=getComputedStyle(e);return e.clientWidth-parseFloat(t.paddingLeft)-parseFloat(t.paddingRight)};var r=e.insert=function(t,n){return a(n)?n.map((function(n){return e.insert(t,n)}))[0]:p(n="string"==typeof n?e.insertAdjacentHTML(t,n):e.insertAdjacentElement?e.insertAdjacentElement(t,n):e.appendChild(n))};return e.append=r.bind(e,"beforeend"),e.prepend=r.bind(e,"afterbegin"),e.css=function(t,n){if("object"==typeof t){for(var r in t)e.css(r,t[r]);return e}return void 0===n?getComputedStyle(e)[t]:(1*n&&(n+="px"),e.style[t]=n,e)},e.show=function(){return e.css({display:~f.indexOf(n)?"inline":"block"})},e.hide=function(){return e.css({display:"none"})},e.remove=function(){var t=e.parentNode;t&&t.removeChild(e)},e.attr=function(t,n){return null==n?e.getAttribute(t):(e.setAttribute(t,n),e)},e.txt=function(t){return e.textContent=t,e},e.fp=function(t){return e.addClass("fp-"+t)},e.addClass=function(t){return t.split(" ").forEach((function(t){e.hasClass(t)||(e.className+=(e.className?" ":"")+t)})),e},e.removeClass=function(t){t=t.split(" ");var n=e.className.split(" ");return e.className=n.filter((function(e){return!~t.indexOf(e)})).join(" "),e},e.toggleClass=function(t,n){return void 0===n&&(n=!e.hasClass(t)),n?e.addClass(t):e.removeClass(t)},e.findAll=function(n){return r=e.querySelectorAll(n),t.call(r);var r},e.hasClass=function(t){return~e.className.split(" ").indexOf(t)},e}function p(t){return void 0===t||function(t){return t&&t.__flowplayer__}(t)?t:d(o(t))}function v(t,e){if("string"==typeof t&&"<"==t[0])return l(t.slice(1,-1),e);if("string"!=typeof t)return p(t);var n=e instanceof HTMLElement&&e.querySelector(".fp-"+t)||document.querySelector(t);return n?p(n):void 0}v.window=u,v.document=s,v.el=l,c.forEach((function(t){v[t]=function(e,n){return"string"==typeof e&&(e={class:e}),l(t,e,n)}}));var m="click",E="keydown",h="mouseleave",O="fullscreenenter",A="loadstart",y="playing";function R(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function _(t){var e,n,r=R("svg");return r.setAttribute("viewBox",t.coords),t.name&&r.setAttribute("class",t.name),t.title&&r.setAttribute("title",t.title),t.title&&r.setAttribute("aria-label",t.title),r.setAttribute("tabindex","0"),r.setAttribute("focusable","true"),r.appendChild((e=t.link,(n=R("use")).setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",e),n)),v(r)}var g={TOGGLE_OPEN:"menu:toggle:open",RENDER:"menu:render",PUSH:"menu:push"},b={ON:"fp-on",INVIS:"fp-invis"};function x(n,r,i){var o=i.id||"menu-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,5);return i=i||{},n.attr("role","button").attr("aria-haspopup","true").attr("aria-expanded","false").attr("aria-controls",o).attr("aria-label",i.title),i.options=i.options||[],i.id=o,x._interface(n,r,function(){var n=t.call(arguments),r=n.shift();return n.reduce(e,r)}({},i))}x.title=function(t){return v("<h3>").txt(t)},x.close=function(t){return v.span("fp-close").on(m,t).html("&times;")},x.option=function(t,e){var n=this,r=v("<li>").attr("tabindex","0").attr("role","menuitem"),i=n._attrs;t.icon&&r.append(_(t.icon)),r.append(v("<span>").txt(t.text)),r.on(m,(function(r){i.multi||n.options().forEach(x.off),n.activate(e),"function"==typeof t.onclick&&t.onclick(r,t,e,n)})),r.idx=e,n.append(r)},x._interface=function(t,e,r){t.addClass("fp-menu-container");var i=v("<ul>").attr("id",r.id).addClass("fp-menu").attr("role","menu");return r.icons&&i.addClass("fp-icons"),i._attrs=r,t.on(m,(function(t){setTimeout((function(){if(!t.defaultPrevented)return i.hasClass(b.ON)?e.emit(g.TOGGLE_OPEN,{menu:i,open:!1}):void e.emit(g.TOGGLE_OPEN,{menu:i,open:!0})}),0)})),i.on(h,(function(){e.emit(g.TOGGLE_OPEN,{menu:i,open:!1})})),e.on(g.TOGGLE_OPEN,(function(r){if(n(r,"data.menu")!==i)return i.toggleClass(b.ON,!1),t.attr("aria-expanded","false");var o=n(r,"data.open",!1);if(i.toggleClass(b.ON,o),t.attr("aria-expanded",o?"true":"false"),e.hasClass("is-accessibility"))if(o){var a=i.options()[0];a&&a.focus()}else t.focus()})),i.push=function(t){return i._attrs.options=n(i,"_attrs.options",[]),i._attrs.options.push(t),i.render()},i.select=function(t){return i.render(i.options.filter(t))},i.render=function(e){var n=i._attrs;return i.empty(),i.prepend(x.close()),n.title&&i.prepend(x.title(n.title)),n.options=e||n.options,n.options.forEach(x.option,i),t.toggleClass(b.INVIS,0==n.options.length),i._activate(),i},i.close=function(){i.hasClass(b.ON)&&e.emit(g.TOGGLE_OPEN,{menu:i,open:!1})},i._activate=function(){i.options().forEach((function(t){t.toggleClass(b.ON,t.idx===i.idx)}))},i.options=function(){return[].slice.call(i.querySelectorAll("li"))},i.activate=function(t,e){void 0===i.idx||i.idx!==t||e?i.idx=t:delete i.idx,i._activate()},i.deactivate=function(){i.activate(i.idx)},i.render(r.options),t.appendChild(i),i},x.on=function(t){return t.addClass(b.ON),t},x.off=function(t){return t.removeClass(b.ON),t},x.CONTAINER_CLASS="fp-menu",x.Events=g,x.States=b;var w,C,N={TAB:9,ENTER:13,ESCAPE:27,SPACE:32,ARROW_LEFT:37,ARROW_UP:38,ARROW_RIGHT:39,ARROW_DOWN:40,F:70,H:72,J:74,K:75,L:76,M:77},S="no-timeline",P=(C={val:w},function(t){return void 0!==t&&(C.val=t),C.val}),T=[N.ARROW_UP,N.ARROW_RIGHT,N.ARROW_LEFT,N.ARROW_DOWN],W=[N.SPACE,N.F,N.ESCAPE,N.M,N.ARROW_UP,N.ARROW_DOWN,N.ARROW_RIGHT,N.ARROW_LEFT,N.H,N.J,N.K,N.L];function L(t,e){return Math.max(Math.min(e,t),0)}function G(t,e){t.volume=L(t.volume+e,1)}function k(t,e,n){if(!(0==t.opts.seekable||t.disabled&&e)){n=n||.15;var r=t.currentTime,i=t.duration,o=0;n<1&&(o=n*i),n>=1&&(o=n),1==e&&(o=Math.abs(o)),0==e&&o>0&&(o*=-1),t.currentTime=L(r+o,i)}}function H(t,e){return!(e.altKey||e.shiftKey||e.metaKey||e.ctrlKey)&&(!!(t&&t.in_viewport&&t.started)&&(!!t.root&&(function(t){var e=document.activeElement;for(;e;){if(e===t)return!0;e=e.parentElement}return!1}(t.root)||document.activeElement===document.body)))}function M(t,e,n){n.on([A,y,O],(function(){P(n)}))}function D(t,e){return!!F(t,e)}function F(t,e){return!!t.parentElement&&(t.parentElement.matches(e)?t.parentElement:D(t.parentElement,e))}return v.document.on(E,(function(t){var e=t.which,r=P(),i=n(r,"opts.keyboard.seek_step",.15),o=document.activeElement;function a(){t.preventDefault(),t.stopPropagation()}if((e===N.SPACE||e===N.ENTER)&&o.hasAttribute("tabindex")&&D(o,".flowplayer"))return o.dispatchEvent(new MouseEvent("click",{bubbles:!0})),a();if(~T.indexOf(e)&&o.hasAttribute("aria-valuenow")){var u=~[N.ARROW_UP,N.ARROW_RIGHT].indexOf(e);if(o.matches(".fp-volume"))return G(r,u?.15:-.15),a();if(o.matches(".fp-timeline"))return k(r,u,i),a()}if((e===N.ARROW_DOWN||e===N.ARROW_UP||e===N.ESCAPE)&&D(o,".fp-menu"))return t.preventDefault(),e===N.ARROW_DOWN&&o.nextSibling&&o.nextSibling.focus(),e===N.ARROW_UP&&o.previousSibling&&o.previousSibling.focus(),void(e===N.ESCAPE&&r.root.emit(x.Events.TOGGLE_OPEN,{open:!1,menu:F(o,".fp-menu")}));if(e===N.TAB&&flowplayer.instances.forEach((function(t){t.setState("is-hovered",!0),t.setState("is-accessibility",!0)})),H(r,t)){var s=!r.hasState(S);if(e>47&&e<58&&s)return t.preventDefault(),function(t,e){var n=t.duration,r=e/10*n;r>t.currentTime&&t.disabled||n&&(t.currentTime=r)}(r,e-48);switch(~W.indexOf(e)&&t.preventDefault(),e){case N.SPACE:return r.togglePlay();case N.F:return r.toggleFullScreen();case N.ESCAPE:return r.toggleFullScreen(!1);case N.M:return r.toggleMute();case N.ARROW_UP:case N.K:return G(r,.15);case N.ARROW_DOWN:case N.J:return G(r,-.15);case N.ARROW_RIGHT:case N.L:return s&&k(r,!0,i);case N.ARROW_LEFT:case N.H:return s&&k(r,!1,i)}}})),function(t,e){if("object"==typeof exports&&"undefined"!=typeof module)return e;"flowplayer"in t||(t.flowplayer={extensions:[]});var n=t.flowplayer;"function"==typeof n?n(e):(Array.isArray(n.extensions)||(n.extensions=[]),~n.extensions.indexOf(e)||n.extensions.push(e))}(window,M),M}));
